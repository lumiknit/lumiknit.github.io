const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-CF4cTV6D.js","./index-BfQPrvhs.js","./index-BBjCxtyP.js","./index-D7aDZF-k.js","./index-yv-SWzx9.js","./index-CW7xzyij.js","./index-CR-sOhWl.js","./index-CpQVuVkA.js","./index-Dsyj-GGR.js","./index-jBL9z0_5.js","./index-ukvY-B1o.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function n(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(o){if(o.ep)return;o.ep=!0;const a=n(o);fetch(o.href,a)}})();const IS_DEV=!1,equalFn=(r,e)=>r===e,$PROXY=Symbol("solid-proxy"),SUPPORTS_PROXY=typeof Proxy=="function",$TRACK=Symbol("solid-track"),signalOptions={equals:equalFn};let runEffects=runQueue;const STALE=1,PENDING=2,UNOWNED={owned:null,cleanups:null,context:null,owner:null};var Owner=null;let Transition=null,ExternalSourceConfig=null,Listener=null,Updates=null,Effects=null,ExecCount=0;function createRoot(r,e){const n=Listener,s=Owner,o=r.length===0,a=e===void 0?s:e,l=o?UNOWNED:{owned:null,cleanups:null,context:a?a.context:null,owner:a},c=o?r:()=>r(()=>untrack(()=>cleanNode(l)));Owner=l,Listener=null;try{return runUpdates(c,!0)}finally{Listener=n,Owner=s}}function createSignal(r,e){e=e?Object.assign({},signalOptions,e):signalOptions;const n={value:r,observers:null,observerSlots:null,comparator:e.equals||void 0},s=o=>(typeof o=="function"&&(o=o(n.value)),writeSignal(n,o));return[readSignal.bind(n),s]}function createRenderEffect(r,e,n){const s=createComputation(r,e,!1,STALE);updateComputation(s)}function createEffect(r,e,n){runEffects=runUserEffects;const s=createComputation(r,e,!1,STALE);s.user=!0,Effects?Effects.push(s):updateComputation(s)}function createMemo(r,e,n){n=n?Object.assign({},signalOptions,n):signalOptions;const s=createComputation(r,e,!0,0);return s.observers=null,s.observerSlots=null,s.comparator=n.equals||void 0,updateComputation(s),readSignal.bind(s)}function batch(r){return runUpdates(r,!1)}function untrack(r){if(Listener===null)return r();const e=Listener;Listener=null;try{return r()}finally{Listener=e}}function onMount(r){createEffect(()=>untrack(r))}function onCleanup(r){return Owner===null||(Owner.cleanups===null?Owner.cleanups=[r]:Owner.cleanups.push(r)),r}function getListener(){return Listener}function getOwner(){return Owner}const[transPending,setTransPending]=createSignal(!1);function children(r){const e=createMemo(r),n=createMemo(()=>resolveChildren(e()));return n.toArray=()=>{const s=n();return Array.isArray(s)?s:s!=null?[s]:[]},n}function readSignal(){if(this.sources&&this.state)if(this.state===STALE)updateComputation(this);else{const r=Updates;Updates=null,runUpdates(()=>lookUpstream(this),!1),Updates=r}if(Listener){const r=this.observers?this.observers.length:0;Listener.sources?(Listener.sources.push(this),Listener.sourceSlots.push(r)):(Listener.sources=[this],Listener.sourceSlots=[r]),this.observers?(this.observers.push(Listener),this.observerSlots.push(Listener.sources.length-1)):(this.observers=[Listener],this.observerSlots=[Listener.sources.length-1])}return this.value}function writeSignal(r,e,n){let s=r.value;return(!r.comparator||!r.comparator(s,e))&&(r.value=e,r.observers&&r.observers.length&&runUpdates(()=>{for(let o=0;o<r.observers.length;o+=1){const a=r.observers[o],l=Transition&&Transition.running;l&&Transition.disposed.has(a),(l?!a.tState:!a.state)&&(a.pure?Updates.push(a):Effects.push(a),a.observers&&markDownstream(a)),l||(a.state=STALE)}if(Updates.length>1e6)throw Updates=[],new Error},!1)),e}function updateComputation(r){if(!r.fn)return;cleanNode(r);const e=ExecCount;runComputation(r,r.value,e)}function runComputation(r,e,n){let s;const o=Owner,a=Listener;Listener=Owner=r;try{s=r.fn(e)}catch(l){return r.pure&&(r.state=STALE,r.owned&&r.owned.forEach(cleanNode),r.owned=null),r.updatedAt=n+1,handleError(l)}finally{Listener=a,Owner=o}(!r.updatedAt||r.updatedAt<=n)&&(r.updatedAt!=null&&"observers"in r?writeSignal(r,s):r.value=s,r.updatedAt=n)}function createComputation(r,e,n,s=STALE,o){const a={fn:r,state:s,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:Owner,context:Owner?Owner.context:null,pure:n};return Owner===null||Owner!==UNOWNED&&(Owner.owned?Owner.owned.push(a):Owner.owned=[a]),a}function runTop(r){if(r.state===0)return;if(r.state===PENDING)return lookUpstream(r);if(r.suspense&&untrack(r.suspense.inFallback))return r.suspense.effects.push(r);const e=[r];for(;(r=r.owner)&&(!r.updatedAt||r.updatedAt<ExecCount);)r.state&&e.push(r);for(let n=e.length-1;n>=0;n--)if(r=e[n],r.state===STALE)updateComputation(r);else if(r.state===PENDING){const s=Updates;Updates=null,runUpdates(()=>lookUpstream(r,e[0]),!1),Updates=s}}function runUpdates(r,e){if(Updates)return r();let n=!1;e||(Updates=[]),Effects?n=!0:Effects=[],ExecCount++;try{const s=r();return completeUpdates(n),s}catch(s){n||(Effects=null),Updates=null,handleError(s)}}function completeUpdates(r){if(Updates&&(runQueue(Updates),Updates=null),r)return;const e=Effects;Effects=null,e.length&&runUpdates(()=>runEffects(e),!1)}function runQueue(r){for(let e=0;e<r.length;e++)runTop(r[e])}function runUserEffects(r){let e,n=0;for(e=0;e<r.length;e++){const s=r[e];s.user?r[n++]=s:runTop(s)}for(e=0;e<n;e++)runTop(r[e])}function lookUpstream(r,e){r.state=0;for(let n=0;n<r.sources.length;n+=1){const s=r.sources[n];if(s.sources){const o=s.state;o===STALE?s!==e&&(!s.updatedAt||s.updatedAt<ExecCount)&&runTop(s):o===PENDING&&lookUpstream(s,e)}}}function markDownstream(r){for(let e=0;e<r.observers.length;e+=1){const n=r.observers[e];n.state||(n.state=PENDING,n.pure?Updates.push(n):Effects.push(n),n.observers&&markDownstream(n))}}function cleanNode(r){let e;if(r.sources)for(;r.sources.length;){const n=r.sources.pop(),s=r.sourceSlots.pop(),o=n.observers;if(o&&o.length){const a=o.pop(),l=n.observerSlots.pop();s<o.length&&(a.sourceSlots[l]=s,o[s]=a,n.observerSlots[s]=l)}}if(r.tOwned){for(e=r.tOwned.length-1;e>=0;e--)cleanNode(r.tOwned[e]);delete r.tOwned}if(r.owned){for(e=r.owned.length-1;e>=0;e--)cleanNode(r.owned[e]);r.owned=null}if(r.cleanups){for(e=r.cleanups.length-1;e>=0;e--)r.cleanups[e]();r.cleanups=null}r.state=0}function castError(r){return r instanceof Error?r:new Error(typeof r=="string"?r:"Unknown error",{cause:r})}function handleError(r,e=Owner){throw castError(r)}function resolveChildren(r){if(typeof r=="function"&&!r.length)return resolveChildren(r());if(Array.isArray(r)){const e=[];for(let n=0;n<r.length;n++){const s=resolveChildren(r[n]);Array.isArray(s)?e.push.apply(e,s):e.push(s)}return e}return r}const FALLBACK=Symbol("fallback");function dispose(r){for(let e=0;e<r.length;e++)r[e]()}function mapArray(r,e,n={}){let s=[],o=[],a=[],l=0,c=e.length>1?[]:null;return onCleanup(()=>dispose(a)),()=>{let u=r()||[],f=u.length,d,p;return u[$TRACK],untrack(()=>{let y,x,E,Y,Z,te,ne,Ve,me;if(f===0)l!==0&&(dispose(a),a=[],s=[],o=[],l=0,c&&(c=[])),n.fallback&&(s=[FALLBACK],o[0]=createRoot(rt=>(a[0]=rt,n.fallback())),l=1);else if(l===0){for(o=new Array(f),p=0;p<f;p++)s[p]=u[p],o[p]=createRoot(g);l=f}else{for(E=new Array(f),Y=new Array(f),c&&(Z=new Array(f)),te=0,ne=Math.min(l,f);te<ne&&s[te]===u[te];te++);for(ne=l-1,Ve=f-1;ne>=te&&Ve>=te&&s[ne]===u[Ve];ne--,Ve--)E[Ve]=o[ne],Y[Ve]=a[ne],c&&(Z[Ve]=c[ne]);for(y=new Map,x=new Array(Ve+1),p=Ve;p>=te;p--)me=u[p],d=y.get(me),x[p]=d===void 0?-1:d,y.set(me,p);for(d=te;d<=ne;d++)me=s[d],p=y.get(me),p!==void 0&&p!==-1?(E[p]=o[d],Y[p]=a[d],c&&(Z[p]=c[d]),p=x[p],y.set(me,p)):a[d]();for(p=te;p<f;p++)p in E?(o[p]=E[p],a[p]=Y[p],c&&(c[p]=Z[p],c[p](p))):o[p]=createRoot(g);o=o.slice(0,l=f),s=u.slice(0)}return o});function g(y){if(a[p]=y,c){const[x,E]=createSignal(p);return c[p]=E,e(u[p],x)}return e(u[p])}}}function createComponent(r,e){return untrack(()=>r(e||{}))}function trueFn(){return!0}const propTraps={get(r,e,n){return e===$PROXY?n:r.get(e)},has(r,e){return e===$PROXY?!0:r.has(e)},set:trueFn,deleteProperty:trueFn,getOwnPropertyDescriptor(r,e){return{configurable:!0,enumerable:!0,get(){return r.get(e)},set:trueFn,deleteProperty:trueFn}},ownKeys(r){return r.keys()}};function resolveSource(r){return(r=typeof r=="function"?r():r)?r:{}}function resolveSources(){for(let r=0,e=this.length;r<e;++r){const n=this[r]();if(n!==void 0)return n}}function mergeProps(...r){let e=!1;for(let l=0;l<r.length;l++){const c=r[l];e=e||!!c&&$PROXY in c,r[l]=typeof c=="function"?(e=!0,createMemo(c)):c}if(SUPPORTS_PROXY&&e)return new Proxy({get(l){for(let c=r.length-1;c>=0;c--){const u=resolveSource(r[c])[l];if(u!==void 0)return u}},has(l){for(let c=r.length-1;c>=0;c--)if(l in resolveSource(r[c]))return!0;return!1},keys(){const l=[];for(let c=0;c<r.length;c++)l.push(...Object.keys(resolveSource(r[c])));return[...new Set(l)]}},propTraps);const n={},s=Object.create(null);for(let l=r.length-1;l>=0;l--){const c=r[l];if(!c)continue;const u=Object.getOwnPropertyNames(c);for(let f=u.length-1;f>=0;f--){const d=u[f];if(d==="__proto__"||d==="constructor")continue;const p=Object.getOwnPropertyDescriptor(c,d);if(!s[d])s[d]=p.get?{enumerable:!0,configurable:!0,get:resolveSources.bind(n[d]=[p.get.bind(c)])}:p.value!==void 0?p:void 0;else{const g=n[d];g&&(p.get?g.push(p.get.bind(c)):p.value!==void 0&&g.push(()=>p.value))}}}const o={},a=Object.keys(s);for(let l=a.length-1;l>=0;l--){const c=a[l],u=s[c];u&&u.get?Object.defineProperty(o,c,u):o[c]=u?u.value:void 0}return o}function splitProps(r,...e){if(SUPPORTS_PROXY&&$PROXY in r){const o=new Set(e.length>1?e.flat():e[0]),a=e.map(l=>new Proxy({get(c){return l.includes(c)?r[c]:void 0},has(c){return l.includes(c)&&c in r},keys(){return l.filter(c=>c in r)}},propTraps));return a.push(new Proxy({get(l){return o.has(l)?void 0:r[l]},has(l){return o.has(l)?!1:l in r},keys(){return Object.keys(r).filter(l=>!o.has(l))}},propTraps)),a}const n={},s=e.map(()=>({}));for(const o of Object.getOwnPropertyNames(r)){const a=Object.getOwnPropertyDescriptor(r,o),l=!a.get&&!a.set&&a.enumerable&&a.writable&&a.configurable;let c=!1,u=0;for(const f of e)f.includes(o)&&(c=!0,l?s[u][o]=a.value:Object.defineProperty(s[u],o,a)),++u;c||(l?n[o]=a.value:Object.defineProperty(n,o,a))}return[...s,n]}const narrowedError=r=>`Stale read from <${r}>.`;function For(r){const e="fallback"in r&&{fallback:()=>r.fallback};return createMemo(mapArray(()=>r.each,r.children,e||void 0))}function Show(r){const e=r.keyed,n=createMemo(()=>r.when,void 0,void 0),s=e?n:createMemo(n,void 0,{equals:(o,a)=>!o==!a});return createMemo(()=>{const o=s();if(o){const a=r.children;return typeof a=="function"&&a.length>0?untrack(()=>a(e?o:()=>{if(!untrack(s))throw narrowedError("Show");return n()})):a}return r.fallback},void 0,void 0)}function Switch(r){const e=children(()=>r.children),n=createMemo(()=>{const s=e(),o=Array.isArray(s)?s:[s];let a=()=>{};for(let l=0;l<o.length;l++){const c=l,u=o[l],f=a,d=createMemo(()=>f()?void 0:u.when,void 0,void 0),p=u.keyed?d:createMemo(d,void 0,{equals:(g,y)=>!g==!y});a=()=>f()||(p()?[c,d,u]:void 0)}return a});return createMemo(()=>{const s=n()();if(!s)return r.fallback;const[o,a,l]=s,c=l.children;return typeof c=="function"&&c.length>0?untrack(()=>c(l.keyed?a():()=>{if(untrack(n)()?.[0]!==o)throw narrowedError("Match");return a()})):c},void 0,void 0)}function Match(r){return r}const booleans=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"],Properties=new Set(["className","value","readOnly","noValidate","formNoValidate","isMap","noModule","playsInline",...booleans]),ChildProperties=new Set(["innerHTML","textContent","innerText","children"]),Aliases=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),PropAliases=Object.assign(Object.create(null),{class:"className",novalidate:{$:"noValidate",FORM:1},formnovalidate:{$:"formNoValidate",BUTTON:1,INPUT:1},ismap:{$:"isMap",IMG:1},nomodule:{$:"noModule",SCRIPT:1},playsinline:{$:"playsInline",VIDEO:1},readonly:{$:"readOnly",INPUT:1,TEXTAREA:1}});function getPropAlias(r,e){const n=PropAliases[r];return typeof n=="object"?n[e]?n.$:void 0:n}const DelegatedEvents=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),SVGNamespace={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"},memo=r=>createMemo(()=>r());function reconcileArrays(r,e,n){let s=n.length,o=e.length,a=s,l=0,c=0,u=e[o-1].nextSibling,f=null;for(;l<o||c<a;){if(e[l]===n[c]){l++,c++;continue}for(;e[o-1]===n[a-1];)o--,a--;if(o===l){const d=a<s?c?n[c-1].nextSibling:n[a-c]:u;for(;c<a;)r.insertBefore(n[c++],d)}else if(a===c)for(;l<o;)(!f||!f.has(e[l]))&&e[l].remove(),l++;else if(e[l]===n[a-1]&&n[c]===e[o-1]){const d=e[--o].nextSibling;r.insertBefore(n[c++],e[l++].nextSibling),r.insertBefore(n[--a],d),e[o]=n[a]}else{if(!f){f=new Map;let p=c;for(;p<a;)f.set(n[p],p++)}const d=f.get(e[l]);if(d!=null)if(c<d&&d<a){let p=l,g=1,y;for(;++p<o&&p<a&&!((y=f.get(e[p]))==null||y!==d+g);)g++;if(g>d-c){const x=e[l];for(;c<d;)r.insertBefore(n[c++],x)}else r.replaceChild(n[c++],e[l++])}else l++;else e[l++].remove()}}}const $$EVENTS="_$DX_DELEGATE";function render(r,e,n,s={}){let o;return createRoot(a=>{o=a,e===document?r():insert$1(e,r(),e.firstChild?null:void 0,n)},s.owner),()=>{o(),e.textContent=""}}function template(r,e,n,s){let o;const a=()=>{const c=s?document.createElementNS("http://www.w3.org/1998/Math/MathML","template"):document.createElement("template");return c.innerHTML=r,n?c.content.firstChild.firstChild:s?c.firstChild:c.content.firstChild},l=e?()=>untrack(()=>document.importNode(o||(o=a()),!0)):()=>(o||(o=a())).cloneNode(!0);return l.cloneNode=l,l}function delegateEvents(r,e=window.document){const n=e[$$EVENTS]||(e[$$EVENTS]=new Set);for(let s=0,o=r.length;s<o;s++){const a=r[s];n.has(a)||(n.add(a),e.addEventListener(a,eventHandler))}}function setAttribute(r,e,n){n==null?r.removeAttribute(e):r.setAttribute(e,n)}function setAttributeNS(r,e,n,s){s==null?r.removeAttributeNS(e,n):r.setAttributeNS(e,n,s)}function setBoolAttribute(r,e,n){n?r.setAttribute(e,""):r.removeAttribute(e)}function className(r,e){e==null?r.removeAttribute("class"):r.className=e}function addEventListener(r,e,n,s){if(s)Array.isArray(n)?(r[`$$${e}`]=n[0],r[`$$${e}Data`]=n[1]):r[`$$${e}`]=n;else if(Array.isArray(n)){const o=n[0];r.addEventListener(e,n[0]=a=>o.call(r,n[1],a))}else r.addEventListener(e,n,typeof n!="function"&&n)}function classList(r,e,n={}){const s=Object.keys(e||{}),o=Object.keys(n);let a,l;for(a=0,l=o.length;a<l;a++){const c=o[a];!c||c==="undefined"||e[c]||(toggleClassKey(r,c,!1),delete n[c])}for(a=0,l=s.length;a<l;a++){const c=s[a],u=!!e[c];!c||c==="undefined"||n[c]===u||!u||(toggleClassKey(r,c,!0),n[c]=u)}return n}function style(r,e,n){if(!e)return n?setAttribute(r,"style"):e;const s=r.style;if(typeof e=="string")return s.cssText=e;typeof n=="string"&&(s.cssText=n=void 0),n||(n={}),e||(e={});let o,a;for(a in n)e[a]==null&&s.removeProperty(a),delete n[a];for(a in e)o=e[a],o!==n[a]&&(s.setProperty(a,o),n[a]=o);return n}function spread(r,e={},n,s){const o={};return s||createRenderEffect(()=>o.children=insertExpression(r,e.children,o.children)),createRenderEffect(()=>typeof e.ref=="function"&&use(e.ref,r)),createRenderEffect(()=>assign(r,e,n,!0,o,!0)),o}function use(r,e,n){return untrack(()=>r(e,n))}function insert$1(r,e,n,s){if(n!==void 0&&!s&&(s=[]),typeof e!="function")return insertExpression(r,e,s,n);createRenderEffect(o=>insertExpression(r,e(),o,n),s)}function assign(r,e,n,s,o={},a=!1){e||(e={});for(const l in o)if(!(l in e)){if(l==="children")continue;o[l]=assignProp$1(r,l,null,o[l],n,a,e)}for(const l in e){if(l==="children")continue;const c=e[l];o[l]=assignProp$1(r,l,c,o[l],n,a,e)}}function toPropertyName(r){return r.toLowerCase().replace(/-([a-z])/g,(e,n)=>n.toUpperCase())}function toggleClassKey(r,e,n){const s=e.trim().split(/\s+/);for(let o=0,a=s.length;o<a;o++)r.classList.toggle(s[o],n)}function assignProp$1(r,e,n,s,o,a,l){let c,u,f,d,p;if(e==="style")return style(r,n,s);if(e==="classList")return classList(r,n,s);if(n===s)return s;if(e==="ref")a||n(r);else if(e.slice(0,3)==="on:"){const g=e.slice(3);s&&r.removeEventListener(g,s,typeof s!="function"&&s),n&&r.addEventListener(g,n,typeof n!="function"&&n)}else if(e.slice(0,10)==="oncapture:"){const g=e.slice(10);s&&r.removeEventListener(g,s,!0),n&&r.addEventListener(g,n,!0)}else if(e.slice(0,2)==="on"){const g=e.slice(2).toLowerCase(),y=DelegatedEvents.has(g);if(!y&&s){const x=Array.isArray(s)?s[0]:s;r.removeEventListener(g,x)}(y||n)&&(addEventListener(r,g,n,y),y&&delegateEvents([g]))}else if(e.slice(0,5)==="attr:")setAttribute(r,e.slice(5),n);else if(e.slice(0,5)==="bool:")setBoolAttribute(r,e.slice(5),n);else if((p=e.slice(0,5)==="prop:")||(f=ChildProperties.has(e))||!o&&((d=getPropAlias(e,r.tagName))||(u=Properties.has(e)))||(c=r.nodeName.includes("-")||"is"in l))p&&(e=e.slice(5),u=!0),e==="class"||e==="className"?className(r,n):c&&!u&&!f?r[toPropertyName(e)]=n:r[d||e]=n;else{const g=o&&e.indexOf(":")>-1&&SVGNamespace[e.split(":")[0]];g?setAttributeNS(r,g,e,n):setAttribute(r,Aliases[e]||e,n)}return n}function eventHandler(r){let e=r.target;const n=`$$${r.type}`,s=r.target,o=r.currentTarget,a=u=>Object.defineProperty(r,"target",{configurable:!0,value:u}),l=()=>{const u=e[n];if(u&&!e.disabled){const f=e[`${n}Data`];if(f!==void 0?u.call(e,f,r):u.call(e,r),r.cancelBubble)return}return e.host&&typeof e.host!="string"&&!e.host._$host&&e.contains(r.target)&&a(e.host),!0},c=()=>{for(;l()&&(e=e._$host||e.parentNode||e.host););};if(Object.defineProperty(r,"currentTarget",{configurable:!0,get(){return e||document}}),r.composedPath){const u=r.composedPath();a(u[0]);for(let f=0;f<u.length-2&&(e=u[f],!!l());f++){if(e._$host){e=e._$host,c();break}if(e.parentNode===o)break}}else c();a(s)}function insertExpression(r,e,n,s,o){for(;typeof n=="function";)n=n();if(e===n)return n;const a=typeof e,l=s!==void 0;if(r=l&&n[0]&&n[0].parentNode||r,a==="string"||a==="number"){if(a==="number"&&(e=e.toString(),e===n))return n;if(l){let c=n[0];c&&c.nodeType===3?c.data!==e&&(c.data=e):c=document.createTextNode(e),n=cleanChildren(r,n,s,c)}else n!==""&&typeof n=="string"?n=r.firstChild.data=e:n=r.textContent=e}else if(e==null||a==="boolean")n=cleanChildren(r,n,s);else{if(a==="function")return createRenderEffect(()=>{let c=e();for(;typeof c=="function";)c=c();n=insertExpression(r,c,n,s)}),()=>n;if(Array.isArray(e)){const c=[],u=n&&Array.isArray(n);if(normalizeIncomingArray(c,e,n,o))return createRenderEffect(()=>n=insertExpression(r,c,n,s,!0)),()=>n;if(c.length===0){if(n=cleanChildren(r,n,s),l)return n}else u?n.length===0?appendNodes(r,c,s):reconcileArrays(r,n,c):(n&&cleanChildren(r),appendNodes(r,c));n=c}else if(e.nodeType){if(Array.isArray(n)){if(l)return n=cleanChildren(r,n,s,e);cleanChildren(r,n,null,e)}else n==null||n===""||!r.firstChild?r.appendChild(e):r.replaceChild(e,r.firstChild);n=e}}return n}function normalizeIncomingArray(r,e,n,s){let o=!1;for(let a=0,l=e.length;a<l;a++){let c=e[a],u=n&&n[r.length],f;if(!(c==null||c===!0||c===!1))if((f=typeof c)=="object"&&c.nodeType)r.push(c);else if(Array.isArray(c))o=normalizeIncomingArray(r,c,u)||o;else if(f==="function")if(s){for(;typeof c=="function";)c=c();o=normalizeIncomingArray(r,Array.isArray(c)?c:[c],Array.isArray(u)?u:[u])||o}else r.push(c),o=!0;else{const d=String(c);u&&u.nodeType===3&&u.data===d?r.push(u):r.push(document.createTextNode(d))}}return o}function appendNodes(r,e,n=null){for(let s=0,o=e.length;s<o;s++)r.insertBefore(e[s],n)}function cleanChildren(r,e,n,s){if(n===void 0)return r.textContent="";const o=s||document.createTextNode("");if(e.length){let a=!1;for(let l=e.length-1;l>=0;l--){const c=e[l];if(o!==c){const u=c.parentNode===r;!a&&!l?u?r.replaceChild(o,c):r.insertBefore(o,n):u&&c.remove()}else a=!0}}else r.insertBefore(o,n);return[o]}const isServer=!1,isFunction=r=>typeof r=="function",resolveValue=(r,e)=>isFunction(r)?r(e):r;var ActionType;(function(r){r[r.ADD_TOAST=0]="ADD_TOAST",r[r.UPDATE_TOAST=1]="UPDATE_TOAST",r[r.UPSERT_TOAST=2]="UPSERT_TOAST",r[r.DISMISS_TOAST=3]="DISMISS_TOAST",r[r.REMOVE_TOAST=4]="REMOVE_TOAST",r[r.START_PAUSE=5]="START_PAUSE",r[r.END_PAUSE=6]="END_PAUSE"})(ActionType||(ActionType={}));const $RAW=Symbol("store-raw"),$NODE=Symbol("store-node"),$HAS=Symbol("store-has"),$SELF=Symbol("store-self");function wrap$1(r){let e=r[$PROXY];if(!e&&(Object.defineProperty(r,$PROXY,{value:e=new Proxy(r,proxyTraps$1)}),!Array.isArray(r))){const n=Object.keys(r),s=Object.getOwnPropertyDescriptors(r);for(let o=0,a=n.length;o<a;o++){const l=n[o];s[l].get&&Object.defineProperty(r,l,{enumerable:s[l].enumerable,get:s[l].get.bind(e)})}}return e}function isWrappable(r){let e;return r!=null&&typeof r=="object"&&(r[$PROXY]||!(e=Object.getPrototypeOf(r))||e===Object.prototype||Array.isArray(r))}function unwrap(r,e=new Set){let n,s,o,a;if(n=r!=null&&r[$RAW])return n;if(!isWrappable(r)||e.has(r))return r;if(Array.isArray(r)){Object.isFrozen(r)?r=r.slice(0):e.add(r);for(let l=0,c=r.length;l<c;l++)o=r[l],(s=unwrap(o,e))!==o&&(r[l]=s)}else{Object.isFrozen(r)?r=Object.assign({},r):e.add(r);const l=Object.keys(r),c=Object.getOwnPropertyDescriptors(r);for(let u=0,f=l.length;u<f;u++)a=l[u],!c[a].get&&(o=r[a],(s=unwrap(o,e))!==o&&(r[a]=s))}return r}function getNodes(r,e){let n=r[e];return n||Object.defineProperty(r,e,{value:n=Object.create(null)}),n}function getNode(r,e,n){if(r[e])return r[e];const[s,o]=createSignal(n,{equals:!1,internal:!0});return s.$=o,r[e]=s}function proxyDescriptor$1(r,e){const n=Reflect.getOwnPropertyDescriptor(r,e);return!n||n.get||!n.configurable||e===$PROXY||e===$NODE||(delete n.value,delete n.writable,n.get=()=>r[$PROXY][e]),n}function trackSelf(r){getListener()&&getNode(getNodes(r,$NODE),$SELF)()}function ownKeys(r){return trackSelf(r),Reflect.ownKeys(r)}const proxyTraps$1={get(r,e,n){if(e===$RAW)return r;if(e===$PROXY)return n;if(e===$TRACK)return trackSelf(r),n;const s=getNodes(r,$NODE),o=s[e];let a=o?o():r[e];if(e===$NODE||e===$HAS||e==="__proto__")return a;if(!o){const l=Object.getOwnPropertyDescriptor(r,e);getListener()&&(typeof a!="function"||r.hasOwnProperty(e))&&!(l&&l.get)&&(a=getNode(s,e,a)())}return isWrappable(a)?wrap$1(a):a},has(r,e){return e===$RAW||e===$PROXY||e===$TRACK||e===$NODE||e===$HAS||e==="__proto__"?!0:(getListener()&&getNode(getNodes(r,$HAS),e)(),e in r)},set(){return!0},deleteProperty(){return!0},ownKeys,getOwnPropertyDescriptor:proxyDescriptor$1};function setProperty(r,e,n,s=!1){if(!s&&r[e]===n)return;const o=r[e],a=r.length;n===void 0?(delete r[e],r[$HAS]&&r[$HAS][e]&&o!==void 0&&r[$HAS][e].$()):(r[e]=n,r[$HAS]&&r[$HAS][e]&&o===void 0&&r[$HAS][e].$());let l=getNodes(r,$NODE),c;if((c=getNode(l,e,o))&&c.$(()=>n),Array.isArray(r)&&r.length!==a){for(let u=r.length;u<a;u++)(c=l[u])&&c.$();(c=getNode(l,"length",a))&&c.$(r.length)}(c=l[$SELF])&&c.$()}function mergeStoreNode(r,e){const n=Object.keys(e);for(let s=0;s<n.length;s+=1){const o=n[s];setProperty(r,o,e[o])}}function updateArray(r,e){if(typeof e=="function"&&(e=e(r)),e=unwrap(e),Array.isArray(e)){if(r===e)return;let n=0,s=e.length;for(;n<s;n++){const o=e[n];r[n]!==o&&setProperty(r,n,o)}setProperty(r,"length",s)}else mergeStoreNode(r,e)}function updatePath(r,e,n=[]){let s,o=r;if(e.length>1){s=e.shift();const l=typeof s,c=Array.isArray(r);if(Array.isArray(s)){for(let u=0;u<s.length;u++)updatePath(r,[s[u]].concat(e),n);return}else if(c&&l==="function"){for(let u=0;u<r.length;u++)s(r[u],u)&&updatePath(r,[u].concat(e),n);return}else if(c&&l==="object"){const{from:u=0,to:f=r.length-1,by:d=1}=s;for(let p=u;p<=f;p+=d)updatePath(r,[p].concat(e),n);return}else if(e.length>1){updatePath(r[s],e,[s].concat(n));return}o=r[s],n=[s].concat(n)}let a=e[0];typeof a=="function"&&(a=a(o,n),a===o)||s===void 0&&a==null||(a=unwrap(a),s===void 0||isWrappable(o)&&isWrappable(a)&&!Array.isArray(a)?mergeStoreNode(o,a):setProperty(r,s,a))}function createStore(...[r,e]){const n=unwrap(r||{}),s=Array.isArray(n),o=wrap$1(n);function a(...l){batch(()=>{s&&l.length===1?updateArray(n,l[0]):updatePath(n,l)})}return[o,a]}const producers=new WeakMap,setterTraps={get(r,e){if(e===$RAW)return r;const n=r[e];let s;return isWrappable(n)?producers.get(n)||(producers.set(n,s=new Proxy(n,setterTraps)),s):n},set(r,e,n){return setProperty(r,e,unwrap(n)),!0},deleteProperty(r,e){return setProperty(r,e,void 0,!0),!0}};function produce(r){return e=>{if(isWrappable(e)){let n;(n=producers.get(e))||producers.set(e,n=new Proxy(e,setterTraps)),r(n)}return e}}const[store,setStore]=createStore({toasts:[],pausedAt:void 0}),createTimers=()=>{const{pausedAt:r,toasts:e}=store;if(r)return;const n=Date.now();return e.map(o=>{if(o.duration===1/0)return;const a=(o.duration||0)+o.pauseDuration-(n-o.createdAt);if(a<=0){o.visible&&dispatch({type:ActionType.DISMISS_TOAST,toastId:o.id});return}return setTimeout(()=>{dispatch({type:ActionType.DISMISS_TOAST,toastId:o.id})},a)})},removalQueue=new Map,scheduleRemoval=(r,e)=>{if(removalQueue.has(r))return;const n=setTimeout(()=>{removalQueue.delete(r),dispatch({type:ActionType.REMOVE_TOAST,toastId:r})},e);removalQueue.set(r,n)},unscheduleRemoval=r=>{const e=removalQueue.get(r);removalQueue.delete(r),e&&clearTimeout(e)},dispatch=r=>{switch(r.type){case ActionType.ADD_TOAST:setStore("toasts",o=>{const a=o;return[r.toast,...a]});break;case ActionType.DISMISS_TOAST:const{toastId:e}=r,n=store.toasts;if(e){const o=n.find(a=>a.id===e);o&&scheduleRemoval(e,o.unmountDelay),setStore("toasts",a=>a.id===e,produce(a=>a.visible=!1))}else n.forEach(o=>{scheduleRemoval(o.id,o.unmountDelay)}),setStore("toasts",o=>o.id!==void 0,produce(o=>o.visible=!1));break;case ActionType.REMOVE_TOAST:if(!r.toastId){setStore("toasts",[]);break}setStore("toasts",o=>o.filter(l=>l.id!==r.toastId));break;case ActionType.UPDATE_TOAST:r.toast.id&&unscheduleRemoval(r.toast.id),setStore("toasts",o=>o.id===r.toast.id,o=>({...o,...r.toast}));break;case ActionType.UPSERT_TOAST:store.toasts.find(o=>o.id===r.toast.id)?dispatch({type:ActionType.UPDATE_TOAST,toast:r.toast}):dispatch({type:ActionType.ADD_TOAST,toast:r.toast});break;case ActionType.START_PAUSE:setStore(produce(o=>{o.pausedAt=Date.now(),o.toasts.forEach(a=>{a.paused=!0})}));break;case ActionType.END_PAUSE:const s=r.time-(store.pausedAt||0);setStore(produce(o=>{o.pausedAt=void 0,o.toasts.forEach(a=>{a.pauseDuration+=s,a.paused=!1})}));break}},defaultTimeouts={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},defaultToastOptions={id:"",icon:"",unmountDelay:500,duration:3e3,ariaProps:{role:"status","aria-live":"polite"},className:"",style:{},position:"top-right",iconTheme:{}},defaultToasterOptions={position:"top-right",toastOptions:defaultToastOptions,gutter:8,containerStyle:{},containerClassName:""},defaultContainerPadding="16px",defaultContainerStyle={position:"fixed","z-index":9999,top:defaultContainerPadding,bottom:defaultContainerPadding,left:defaultContainerPadding,right:defaultContainerPadding,"pointer-events":"none"},generateID=(()=>{let r=0;return()=>String(++r)})(),mergeContainerOptions=r=>{setDefaultOpts(e=>({containerClassName:r.containerClassName??e.containerClassName,containerStyle:r.containerStyle??e.containerStyle,gutter:r.gutter??e.gutter,position:r.position??e.position,toastOptions:{...r.toastOptions}}))},getToastWrapperStyles=(r,e)=>{const s=r.includes("top")?{top:0,"margin-top":`${e}px`}:{bottom:0,"margin-bottom":`${e}px`},o=r.includes("center")?{"justify-content":"center"}:r.includes("right")?{"justify-content":"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:"all 230ms cubic-bezier(.21,1.02,.73,1)",...s,...o}},updateToastHeight=(r,e)=>{const n=r.getBoundingClientRect();n.height!==e.height&&dispatch({type:ActionType.UPDATE_TOAST,toast:{id:e.id,height:n.height}})},getWrapperYAxisOffset=(r,e)=>{const{toasts:n}=store,s=defaultOpts().gutter||defaultToasterOptions.gutter||8,o=n.filter(u=>(u.position||e)===e&&u.height),a=o.findIndex(u=>u.id===r.id),l=o.filter((u,f)=>f<a&&u.visible).length;return o.slice(0,l).reduce((u,f)=>u+s+(f.height||0),0)},getToastYDirection=(r,e)=>(r.position||e).includes("top")?1:-1,toastBarBase={display:"flex","align-items":"center",color:"#363636",background:"white","box-shadow":"0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05)","max-width":"350px","pointer-events":"auto",padding:"8px 10px","border-radius":"4px","line-height":"1.3","will-change":"transform"},messageContainer={display:"flex","align-items":"center",flex:"1 1 auto",margin:"4px 10px","white-space":"pre-line"},iconContainer={"flex-shrink":0,"min-width":"20px","min-height":"20px",display:"flex","align-items":"center","justify-content":"center","text-align":"center"},genSVGCubicBezier=r=>({calcMode:"spline",keyTimes:"0; 1",keySplines:r}),[defaultOpts,setDefaultOpts]=createSignal(defaultToasterOptions),createToast=(r,e="blank",n)=>({...defaultToastOptions,...defaultOpts().toastOptions,...n,type:e,message:r,pauseDuration:0,createdAt:Date.now(),visible:!0,id:n.id||generateID(),paused:!1,style:{...defaultToastOptions.style,...defaultOpts().toastOptions?.style,...n.style},duration:n.duration||defaultOpts().toastOptions?.duration||defaultTimeouts[e],position:n.position||defaultOpts().toastOptions?.position||defaultOpts().position||defaultToastOptions.position}),createToastCreator=r=>(e,n={})=>createRoot(()=>{const s=store.toasts.find(a=>a.id===n.id),o=createToast(e,r,{...s,duration:void 0,...n});return dispatch({type:ActionType.UPSERT_TOAST,toast:o}),o.id}),toast=(r,e)=>createToastCreator("blank")(r,e);untrack(()=>toast);toast.error=createToastCreator("error");toast.success=createToastCreator("success");toast.loading=createToastCreator("loading");toast.custom=createToastCreator("custom");toast.dismiss=r=>{dispatch({type:ActionType.DISMISS_TOAST,toastId:r})};toast.promise=(r,e,n)=>{const s=toast.loading(e.loading,{...n});return r.then(o=>(toast.success(resolveValue(e.success,o),{id:s,...n}),o)).catch(o=>{toast.error(resolveValue(e.error,o),{id:s,...n})}),r};toast.remove=r=>{dispatch({type:ActionType.REMOVE_TOAST,toastId:r})};var _tmpl$$h=template("<div><style>.sldt-active{z-index:9999;}.sldt-active>*{pointer-events:auto;}");const Toaster=r=>(createEffect(()=>{mergeContainerOptions(r)}),createEffect(()=>{const e=createTimers();onCleanup(()=>{e&&e.forEach(n=>n&&clearTimeout(n))})}),(()=>{var e=_tmpl$$h();return e.firstChild,insert$1(e,createComponent(For,{get each(){return store.toasts},children:n=>createComponent(ToastContainer,{toast:n})}),null),createRenderEffect(n=>{var s={...defaultContainerStyle,...r.containerStyle},o=r.containerClassName;return n.e=style(e,s,n.e),o!==n.t&&className(e,n.t=o),n},{e:void 0,t:void 0}),e})());var _tmpl$$g=template("<div>"),_tmpl$2$8=template("<div><div>");const ToastBar=r=>{let e;return createEffect(()=>{if(!e)return;const n=getToastYDirection(r.toast,r.position);r.toast.visible?e.animate([{transform:`translate3d(0,${n*-200}%,0) scale(.6)`,opacity:.5},{transform:"translate3d(0,0,0) scale(1)",opacity:1}],{duration:350,fill:"forwards",easing:"cubic-bezier(.21,1.02,.73,1)"}):e.animate([{transform:"translate3d(0,0,-1px) scale(1)",opacity:1},{transform:`translate3d(0,${n*-150}%,-1px) scale(.4)`,opacity:0}],{duration:400,fill:"forwards",easing:"cubic-bezier(.06,.71,.55,1)"})}),(()=>{var n=_tmpl$2$8(),s=n.firstChild,o=e;return typeof o=="function"?use(o,n):e=n,insert$1(n,createComponent(Switch,{get children(){return[createComponent(Match,{get when(){return r.toast.icon},get children(){var a=_tmpl$$g();return insert$1(a,()=>r.toast.icon),createRenderEffect(l=>style(a,iconContainer,l)),a}}),createComponent(Match,{get when(){return r.toast.type==="loading"},get children(){var a=_tmpl$$g();return insert$1(a,createComponent(Loader,mergeProps(()=>r.toast.iconTheme))),createRenderEffect(l=>style(a,iconContainer,l)),a}}),createComponent(Match,{get when(){return r.toast.type==="success"},get children(){var a=_tmpl$$g();return insert$1(a,createComponent(Success,mergeProps(()=>r.toast.iconTheme))),createRenderEffect(l=>style(a,iconContainer,l)),a}}),createComponent(Match,{get when(){return r.toast.type==="error"},get children(){var a=_tmpl$$g();return insert$1(a,createComponent(Error$1,mergeProps(()=>r.toast.iconTheme))),createRenderEffect(l=>style(a,iconContainer,l)),a}})]}}),s),spread(s,mergeProps(()=>r.toast.ariaProps),!1,!0),insert$1(s,()=>resolveValue(r.toast.message,r.toast)),createRenderEffect(a=>{var l=r.toast.className,c={...toastBarBase,...r.toast.style},u=messageContainer;return l!==a.e&&className(n,a.e=l),a.t=style(n,c,a.t),a.a=style(s,u,a.a),a},{e:void 0,t:void 0,a:void 0}),n})()};var _tmpl$$f=template("<div>");const ToastContainer=r=>{const e=()=>{const o=r.toast.position||defaultToastOptions.position,a=getWrapperYAxisOffset(r.toast,o);return getToastWrapperStyles(o,a)},n=createMemo(()=>e());let s;return onMount(()=>{s&&updateToastHeight(s,r.toast)}),(()=>{var o=_tmpl$$f();o.addEventListener("mouseleave",()=>dispatch({type:ActionType.END_PAUSE,time:Date.now()})),o.addEventListener("mouseenter",()=>dispatch({type:ActionType.START_PAUSE,time:Date.now()}));var a=s;return typeof a=="function"?use(a,o):s=o,insert$1(o,(()=>{var l=memo(()=>r.toast.type==="custom");return()=>l()?resolveValue(r.toast.message,r.toast):createComponent(ToastBar,{get toast(){return r.toast},get position(){return r.toast.position||defaultToastOptions.position}})})()),createRenderEffect(l=>{var c=n(),u=r.toast.visible?"sldt-active":"";return l.e=style(o,c,l.e),u!==l.t&&className(o,l.t=u),l},{e:void 0,t:void 0}),o})()};var _tmpl$$e=template('<svg><circle cx=16 cy=16 r=0><animate attributeName=opacity values="0; 1; 1"></animate><animate attributeName=r values="0; 17.5; 16"></svg>',!1,!0,!1),_tmpl$2$7=template('<svg><circle cx=16 cy=16 r=12 opacity=0><animate attributeName=opacity values="1; 0"></animate><animate attributeName=r values="12; 26"></svg>',!1,!0,!1);const MainCircle=r=>{const e={dur:"0.35s",begin:"100ms",fill:"freeze",calcMode:"spline",keyTimes:"0; 0.6; 1",keySplines:"0.25 0.71 0.4 0.88; .59 .22 .87 .63"};return(()=>{var n=_tmpl$$e(),s=n.firstChild,o=s.nextSibling;return spread(s,e,!0,!1),spread(o,e,!0,!1),createRenderEffect(()=>setAttribute(n,"fill",r.fill)),n})()},SecondaryCircle=r=>{const e={dur:"1s",begin:r.begin||"320ms",fill:"freeze",...genSVGCubicBezier("0.0 0.0 0.2 1")};return(()=>{var n=_tmpl$2$7(),s=n.firstChild,o=s.nextSibling;return spread(s,e,!0,!1),spread(o,e,!0,!1),createRenderEffect(()=>setAttribute(n,"fill",r.fill)),n})()};var _tmpl$$d=template('<svg viewBox="0 0 32 32"width=1.25rem height=1.25rem><path fill=none stroke-width=4 stroke-dasharray=22 stroke-dashoffset=22 stroke-linecap=round stroke-miterlimit=10 d=M9.8,17.2l3.8,3.6c0.1,0.1,0.3,0.1,0.4,0l9.6-9.7><animate attributeName=stroke-dashoffset values=22;0 dur=0.25s begin=250ms fill=freeze>');const Success=r=>{const e=r.primary||"#34C759";return(()=>{var n=_tmpl$$d(),s=n.firstChild,o=s.firstChild;return n.style.setProperty("overflow","visible"),insert$1(n,createComponent(MainCircle,{fill:e}),s),insert$1(n,createComponent(SecondaryCircle,{fill:e,begin:"350ms"}),s),spread(o,mergeProps(()=>genSVGCubicBezier("0.0, 0.0, 0.58, 1.0")),!0,!1),createRenderEffect(()=>setAttribute(s,"stroke",r.secondary||"#FCFCFC")),n})()};var _tmpl$$c=template('<svg viewBox="0 0 32 32"width=1.25rem height=1.25rem><path fill=none stroke-width=4 stroke-dasharray=9 stroke-dashoffset=9 stroke-linecap=round d=M16,7l0,9><animate attributeName=stroke-dashoffset values=9;0 dur=0.2s begin=250ms fill=freeze></animate></path><circle cx=16 cy=23 r=2.5 opacity=0><animate attributeName=opacity values=0;1 dur=0.25s begin=350ms fill=freeze>');const Error$1=r=>{const e=r.primary||"#FF3B30";return(()=>{var n=_tmpl$$c(),s=n.firstChild,o=s.firstChild,a=s.nextSibling,l=a.firstChild;return n.style.setProperty("overflow","visible"),insert$1(n,createComponent(MainCircle,{fill:e}),s),insert$1(n,createComponent(SecondaryCircle,{fill:e}),s),spread(o,mergeProps(()=>genSVGCubicBezier("0.0, 0.0, 0.58, 1.0")),!0,!1),spread(l,mergeProps(()=>genSVGCubicBezier("0.0, 0.0, 0.58, 1.0")),!0,!1),createRenderEffect(c=>{var u=r.secondary||"#FFFFFF",f=r.secondary||"#FFFFFF";return u!==c.e&&setAttribute(s,"stroke",c.e=u),f!==c.t&&setAttribute(a,"fill",c.t=f),c},{e:void 0,t:void 0}),n})()};var _tmpl$$b=template('<svg viewBox="0 0 32 32"width=1.25rem height=1.25rem><path fill=none stroke-width=4 stroke-miterlimit=10 d=M16,6c3,0,5.7,1.3,7.5,3.4c1.5,1.8,2.5,4,2.5,6.6c0,5.5-4.5,10-10,10S6,21.6,6,16S10.5,6,16,6z></path><path fill=none stroke-width=4 stroke-linecap=round stroke-miterlimit=10 d=M16,6c3,0,5.7,1.3,7.5,3.4c0.6,0.7,1.1,1.4,1.5,2.2><animateTransform attributeName=transform type=rotate from="0 16 16"to="360 16 16"dur=0.75s repeatCount=indefinite>');const Loader=r=>(()=>{var e=_tmpl$$b(),n=e.firstChild,s=n.nextSibling;return e.style.setProperty("overflow","visible"),createRenderEffect(o=>{var a=r.primary||"#E5E7EB",l=r.secondary||"#4b5563";return a!==o.e&&setAttribute(n,"stroke",o.e=a),l!==o.t&&setAttribute(s,"stroke",o.t=l),o},{e:void 0,t:void 0}),e})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function commonjsRequire(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var jszip_min={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var hasRequiredJszip_min;function requireJszip_min(){return hasRequiredJszip_min||(hasRequiredJszip_min=1,function(r,e){(function(n){r.exports=n()})(function(){return function n(s,o,a){function l(f,d){if(!o[f]){if(!s[f]){var p=typeof commonjsRequire=="function"&&commonjsRequire;if(!d&&p)return p(f,!0);if(c)return c(f,!0);var g=new Error("Cannot find module '"+f+"'");throw g.code="MODULE_NOT_FOUND",g}var y=o[f]={exports:{}};s[f][0].call(y.exports,function(x){var E=s[f][1][x];return l(E||x)},y,y.exports,n,s,o,a)}return o[f].exports}for(var c=typeof commonjsRequire=="function"&&commonjsRequire,u=0;u<a.length;u++)l(a[u]);return l}({1:[function(n,s,o){var a=n("./utils"),l=n("./support"),c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";o.encode=function(u){for(var f,d,p,g,y,x,E,Y=[],Z=0,te=u.length,ne=te,Ve=a.getTypeOf(u)!=="string";Z<u.length;)ne=te-Z,p=Ve?(f=u[Z++],d=Z<te?u[Z++]:0,Z<te?u[Z++]:0):(f=u.charCodeAt(Z++),d=Z<te?u.charCodeAt(Z++):0,Z<te?u.charCodeAt(Z++):0),g=f>>2,y=(3&f)<<4|d>>4,x=1<ne?(15&d)<<2|p>>6:64,E=2<ne?63&p:64,Y.push(c.charAt(g)+c.charAt(y)+c.charAt(x)+c.charAt(E));return Y.join("")},o.decode=function(u){var f,d,p,g,y,x,E=0,Y=0,Z="data:";if(u.substr(0,Z.length)===Z)throw new Error("Invalid base64 input, it looks like a data url.");var te,ne=3*(u=u.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(u.charAt(u.length-1)===c.charAt(64)&&ne--,u.charAt(u.length-2)===c.charAt(64)&&ne--,ne%1!=0)throw new Error("Invalid base64 input, bad content length.");for(te=l.uint8array?new Uint8Array(0|ne):new Array(0|ne);E<u.length;)f=c.indexOf(u.charAt(E++))<<2|(g=c.indexOf(u.charAt(E++)))>>4,d=(15&g)<<4|(y=c.indexOf(u.charAt(E++)))>>2,p=(3&y)<<6|(x=c.indexOf(u.charAt(E++))),te[Y++]=f,y!==64&&(te[Y++]=d),x!==64&&(te[Y++]=p);return te}},{"./support":30,"./utils":32}],2:[function(n,s,o){var a=n("./external"),l=n("./stream/DataWorker"),c=n("./stream/Crc32Probe"),u=n("./stream/DataLengthProbe");function f(d,p,g,y,x){this.compressedSize=d,this.uncompressedSize=p,this.crc32=g,this.compression=y,this.compressedContent=x}f.prototype={getContentWorker:function(){var d=new l(a.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new u("data_length")),p=this;return d.on("end",function(){if(this.streamInfo.data_length!==p.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),d},getCompressedWorker:function(){return new l(a.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},f.createWorkerFrom=function(d,p,g){return d.pipe(new c).pipe(new u("uncompressedSize")).pipe(p.compressWorker(g)).pipe(new u("compressedSize")).withStreamInfo("compression",p)},s.exports=f},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,s,o){var a=n("./stream/GenericWorker");o.STORE={magic:"\0\0",compressWorker:function(){return new a("STORE compression")},uncompressWorker:function(){return new a("STORE decompression")}},o.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,s,o){var a=n("./utils"),l=function(){for(var c,u=[],f=0;f<256;f++){c=f;for(var d=0;d<8;d++)c=1&c?3988292384^c>>>1:c>>>1;u[f]=c}return u}();s.exports=function(c,u){return c!==void 0&&c.length?a.getTypeOf(c)!=="string"?function(f,d,p,g){var y=l,x=g+p;f^=-1;for(var E=g;E<x;E++)f=f>>>8^y[255&(f^d[E])];return-1^f}(0|u,c,c.length,0):function(f,d,p,g){var y=l,x=g+p;f^=-1;for(var E=g;E<x;E++)f=f>>>8^y[255&(f^d.charCodeAt(E))];return-1^f}(0|u,c,c.length,0):0}},{"./utils":32}],5:[function(n,s,o){o.base64=!1,o.binary=!1,o.dir=!1,o.createFolders=!0,o.date=null,o.compression=null,o.compressionOptions=null,o.comment=null,o.unixPermissions=null,o.dosPermissions=null},{}],6:[function(n,s,o){var a=null;a=typeof Promise<"u"?Promise:n("lie"),s.exports={Promise:a}},{lie:37}],7:[function(n,s,o){var a=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",l=n("pako"),c=n("./utils"),u=n("./stream/GenericWorker"),f=a?"uint8array":"array";function d(p,g){u.call(this,"FlateWorker/"+p),this._pako=null,this._pakoAction=p,this._pakoOptions=g,this.meta={}}o.magic="\b\0",c.inherits(d,u),d.prototype.processChunk=function(p){this.meta=p.meta,this._pako===null&&this._createPako(),this._pako.push(c.transformTo(f,p.data),!1)},d.prototype.flush=function(){u.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},d.prototype.cleanUp=function(){u.prototype.cleanUp.call(this),this._pako=null},d.prototype._createPako=function(){this._pako=new l[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var p=this;this._pako.onData=function(g){p.push({data:g,meta:p.meta})}},o.compressWorker=function(p){return new d("Deflate",p)},o.uncompressWorker=function(){return new d("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,s,o){function a(y,x){var E,Y="";for(E=0;E<x;E++)Y+=String.fromCharCode(255&y),y>>>=8;return Y}function l(y,x,E,Y,Z,te){var ne,Ve,me=y.file,rt=y.compression,nt=te!==f.utf8encode,ct=c.transformTo("string",te(me.name)),ot=c.transformTo("string",f.utf8encode(me.name)),ft=me.comment,mt=c.transformTo("string",te(ft)),Ye=c.transformTo("string",f.utf8encode(ft)),ht=ot.length!==me.name.length,ee=Ye.length!==ft.length,pt="",Ot="",vt="",Rt=me.dir,bt=me.date,Mt={crc32:0,compressedSize:0,uncompressedSize:0};x&&!E||(Mt.crc32=y.crc32,Mt.compressedSize=y.compressedSize,Mt.uncompressedSize=y.uncompressedSize);var at=0;x&&(at|=8),nt||!ht&&!ee||(at|=2048);var lt=0,_t=0;Rt&&(lt|=16),Z==="UNIX"?(_t=798,lt|=function(wt,Nt){var Vt=wt;return wt||(Vt=Nt?16893:33204),(65535&Vt)<<16}(me.unixPermissions,Rt)):(_t=20,lt|=function(wt){return 63&(wt||0)}(me.dosPermissions)),ne=bt.getUTCHours(),ne<<=6,ne|=bt.getUTCMinutes(),ne<<=5,ne|=bt.getUTCSeconds()/2,Ve=bt.getUTCFullYear()-1980,Ve<<=4,Ve|=bt.getUTCMonth()+1,Ve<<=5,Ve|=bt.getUTCDate(),ht&&(Ot=a(1,1)+a(d(ct),4)+ot,pt+="up"+a(Ot.length,2)+Ot),ee&&(vt=a(1,1)+a(d(mt),4)+Ye,pt+="uc"+a(vt.length,2)+vt);var At="";return At+=`
\0`,At+=a(at,2),At+=rt.magic,At+=a(ne,2),At+=a(Ve,2),At+=a(Mt.crc32,4),At+=a(Mt.compressedSize,4),At+=a(Mt.uncompressedSize,4),At+=a(ct.length,2),At+=a(pt.length,2),{fileRecord:p.LOCAL_FILE_HEADER+At+ct+pt,dirRecord:p.CENTRAL_FILE_HEADER+a(_t,2)+At+a(mt.length,2)+"\0\0\0\0"+a(lt,4)+a(Y,4)+ct+pt+mt}}var c=n("../utils"),u=n("../stream/GenericWorker"),f=n("../utf8"),d=n("../crc32"),p=n("../signature");function g(y,x,E,Y){u.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=x,this.zipPlatform=E,this.encodeFileName=Y,this.streamFiles=y,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}c.inherits(g,u),g.prototype.push=function(y){var x=y.meta.percent||0,E=this.entriesCount,Y=this._sources.length;this.accumulate?this.contentBuffer.push(y):(this.bytesWritten+=y.data.length,u.prototype.push.call(this,{data:y.data,meta:{currentFile:this.currentFile,percent:E?(x+100*(E-Y-1))/E:100}}))},g.prototype.openedSource=function(y){this.currentSourceOffset=this.bytesWritten,this.currentFile=y.file.name;var x=this.streamFiles&&!y.file.dir;if(x){var E=l(y,x,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:E.fileRecord,meta:{percent:0}})}else this.accumulate=!0},g.prototype.closedSource=function(y){this.accumulate=!1;var x=this.streamFiles&&!y.file.dir,E=l(y,x,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(E.dirRecord),x)this.push({data:function(Y){return p.DATA_DESCRIPTOR+a(Y.crc32,4)+a(Y.compressedSize,4)+a(Y.uncompressedSize,4)}(y),meta:{percent:100}});else for(this.push({data:E.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},g.prototype.flush=function(){for(var y=this.bytesWritten,x=0;x<this.dirRecords.length;x++)this.push({data:this.dirRecords[x],meta:{percent:100}});var E=this.bytesWritten-y,Y=function(Z,te,ne,Ve,me){var rt=c.transformTo("string",me(Ve));return p.CENTRAL_DIRECTORY_END+"\0\0\0\0"+a(Z,2)+a(Z,2)+a(te,4)+a(ne,4)+a(rt.length,2)+rt}(this.dirRecords.length,E,y,this.zipComment,this.encodeFileName);this.push({data:Y,meta:{percent:100}})},g.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},g.prototype.registerPrevious=function(y){this._sources.push(y);var x=this;return y.on("data",function(E){x.processChunk(E)}),y.on("end",function(){x.closedSource(x.previous.streamInfo),x._sources.length?x.prepareNextSource():x.end()}),y.on("error",function(E){x.error(E)}),this},g.prototype.resume=function(){return!!u.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},g.prototype.error=function(y){var x=this._sources;if(!u.prototype.error.call(this,y))return!1;for(var E=0;E<x.length;E++)try{x[E].error(y)}catch{}return!0},g.prototype.lock=function(){u.prototype.lock.call(this);for(var y=this._sources,x=0;x<y.length;x++)y[x].lock()},s.exports=g},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,s,o){var a=n("../compressions"),l=n("./ZipFileWorker");o.generateWorker=function(c,u,f){var d=new l(u.streamFiles,f,u.platform,u.encodeFileName),p=0;try{c.forEach(function(g,y){p++;var x=function(te,ne){var Ve=te||ne,me=a[Ve];if(!me)throw new Error(Ve+" is not a valid compression method !");return me}(y.options.compression,u.compression),E=y.options.compressionOptions||u.compressionOptions||{},Y=y.dir,Z=y.date;y._compressWorker(x,E).withStreamInfo("file",{name:g,dir:Y,date:Z,comment:y.comment||"",unixPermissions:y.unixPermissions,dosPermissions:y.dosPermissions}).pipe(d)}),d.entriesCount=p}catch(g){d.error(g)}return d}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,s,o){function a(){if(!(this instanceof a))return new a;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var l=new a;for(var c in this)typeof this[c]!="function"&&(l[c]=this[c]);return l}}(a.prototype=n("./object")).loadAsync=n("./load"),a.support=n("./support"),a.defaults=n("./defaults"),a.version="3.10.1",a.loadAsync=function(l,c){return new a().loadAsync(l,c)},a.external=n("./external"),s.exports=a},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,s,o){var a=n("./utils"),l=n("./external"),c=n("./utf8"),u=n("./zipEntries"),f=n("./stream/Crc32Probe"),d=n("./nodejsUtils");function p(g){return new l.Promise(function(y,x){var E=g.decompressed.getContentWorker().pipe(new f);E.on("error",function(Y){x(Y)}).on("end",function(){E.streamInfo.crc32!==g.decompressed.crc32?x(new Error("Corrupted zip : CRC32 mismatch")):y()}).resume()})}s.exports=function(g,y){var x=this;return y=a.extend(y||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:c.utf8decode}),d.isNode&&d.isStream(g)?l.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):a.prepareContent("the loaded zip file",g,!0,y.optimizedBinaryString,y.base64).then(function(E){var Y=new u(y);return Y.load(E),Y}).then(function(E){var Y=[l.Promise.resolve(E)],Z=E.files;if(y.checkCRC32)for(var te=0;te<Z.length;te++)Y.push(p(Z[te]));return l.Promise.all(Y)}).then(function(E){for(var Y=E.shift(),Z=Y.files,te=0;te<Z.length;te++){var ne=Z[te],Ve=ne.fileNameStr,me=a.resolve(ne.fileNameStr);x.file(me,ne.decompressed,{binary:!0,optimizedBinaryString:!0,date:ne.date,dir:ne.dir,comment:ne.fileCommentStr.length?ne.fileCommentStr:null,unixPermissions:ne.unixPermissions,dosPermissions:ne.dosPermissions,createFolders:y.createFolders}),ne.dir||(x.file(me).unsafeOriginalName=Ve)}return Y.zipComment.length&&(x.comment=Y.zipComment),x})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,s,o){var a=n("../utils"),l=n("../stream/GenericWorker");function c(u,f){l.call(this,"Nodejs stream input adapter for "+u),this._upstreamEnded=!1,this._bindStream(f)}a.inherits(c,l),c.prototype._bindStream=function(u){var f=this;(this._stream=u).pause(),u.on("data",function(d){f.push({data:d,meta:{percent:0}})}).on("error",function(d){f.isPaused?this.generatedError=d:f.error(d)}).on("end",function(){f.isPaused?f._upstreamEnded=!0:f.end()})},c.prototype.pause=function(){return!!l.prototype.pause.call(this)&&(this._stream.pause(),!0)},c.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},s.exports=c},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,s,o){var a=n("readable-stream").Readable;function l(c,u,f){a.call(this,u),this._helper=c;var d=this;c.on("data",function(p,g){d.push(p)||d._helper.pause(),f&&f(g)}).on("error",function(p){d.emit("error",p)}).on("end",function(){d.push(null)})}n("../utils").inherits(l,a),l.prototype._read=function(){this._helper.resume()},s.exports=l},{"../utils":32,"readable-stream":16}],14:[function(n,s,o){s.exports={isNode:typeof Buffer<"u",newBufferFrom:function(a,l){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(a,l);if(typeof a=="number")throw new Error('The "data" argument must not be a number');return new Buffer(a,l)},allocBuffer:function(a){if(Buffer.alloc)return Buffer.alloc(a);var l=new Buffer(a);return l.fill(0),l},isBuffer:function(a){return Buffer.isBuffer(a)},isStream:function(a){return a&&typeof a.on=="function"&&typeof a.pause=="function"&&typeof a.resume=="function"}}},{}],15:[function(n,s,o){function a(me,rt,nt){var ct,ot=c.getTypeOf(rt),ft=c.extend(nt||{},d);ft.date=ft.date||new Date,ft.compression!==null&&(ft.compression=ft.compression.toUpperCase()),typeof ft.unixPermissions=="string"&&(ft.unixPermissions=parseInt(ft.unixPermissions,8)),ft.unixPermissions&&16384&ft.unixPermissions&&(ft.dir=!0),ft.dosPermissions&&16&ft.dosPermissions&&(ft.dir=!0),ft.dir&&(me=Z(me)),ft.createFolders&&(ct=Y(me))&&te.call(this,ct,!0);var mt=ot==="string"&&ft.binary===!1&&ft.base64===!1;nt&&nt.binary!==void 0||(ft.binary=!mt),(rt instanceof p&&rt.uncompressedSize===0||ft.dir||!rt||rt.length===0)&&(ft.base64=!1,ft.binary=!0,rt="",ft.compression="STORE",ot="string");var Ye=null;Ye=rt instanceof p||rt instanceof u?rt:x.isNode&&x.isStream(rt)?new E(me,rt):c.prepareContent(me,rt,ft.binary,ft.optimizedBinaryString,ft.base64);var ht=new g(me,Ye,ft);this.files[me]=ht}var l=n("./utf8"),c=n("./utils"),u=n("./stream/GenericWorker"),f=n("./stream/StreamHelper"),d=n("./defaults"),p=n("./compressedObject"),g=n("./zipObject"),y=n("./generate"),x=n("./nodejsUtils"),E=n("./nodejs/NodejsStreamInputAdapter"),Y=function(me){me.slice(-1)==="/"&&(me=me.substring(0,me.length-1));var rt=me.lastIndexOf("/");return 0<rt?me.substring(0,rt):""},Z=function(me){return me.slice(-1)!=="/"&&(me+="/"),me},te=function(me,rt){return rt=rt!==void 0?rt:d.createFolders,me=Z(me),this.files[me]||a.call(this,me,null,{dir:!0,createFolders:rt}),this.files[me]};function ne(me){return Object.prototype.toString.call(me)==="[object RegExp]"}var Ve={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(me){var rt,nt,ct;for(rt in this.files)ct=this.files[rt],(nt=rt.slice(this.root.length,rt.length))&&rt.slice(0,this.root.length)===this.root&&me(nt,ct)},filter:function(me){var rt=[];return this.forEach(function(nt,ct){me(nt,ct)&&rt.push(ct)}),rt},file:function(me,rt,nt){if(arguments.length!==1)return me=this.root+me,a.call(this,me,rt,nt),this;if(ne(me)){var ct=me;return this.filter(function(ft,mt){return!mt.dir&&ct.test(ft)})}var ot=this.files[this.root+me];return ot&&!ot.dir?ot:null},folder:function(me){if(!me)return this;if(ne(me))return this.filter(function(ot,ft){return ft.dir&&me.test(ot)});var rt=this.root+me,nt=te.call(this,rt),ct=this.clone();return ct.root=nt.name,ct},remove:function(me){me=this.root+me;var rt=this.files[me];if(rt||(me.slice(-1)!=="/"&&(me+="/"),rt=this.files[me]),rt&&!rt.dir)delete this.files[me];else for(var nt=this.filter(function(ot,ft){return ft.name.slice(0,me.length)===me}),ct=0;ct<nt.length;ct++)delete this.files[nt[ct].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(me){var rt,nt={};try{if((nt=c.extend(me||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:l.utf8encode})).type=nt.type.toLowerCase(),nt.compression=nt.compression.toUpperCase(),nt.type==="binarystring"&&(nt.type="string"),!nt.type)throw new Error("No output type specified.");c.checkSupport(nt.type),nt.platform!=="darwin"&&nt.platform!=="freebsd"&&nt.platform!=="linux"&&nt.platform!=="sunos"||(nt.platform="UNIX"),nt.platform==="win32"&&(nt.platform="DOS");var ct=nt.comment||this.comment||"";rt=y.generateWorker(this,nt,ct)}catch(ot){(rt=new u("error")).error(ot)}return new f(rt,nt.type||"string",nt.mimeType)},generateAsync:function(me,rt){return this.generateInternalStream(me).accumulate(rt)},generateNodeStream:function(me,rt){return(me=me||{}).type||(me.type="nodebuffer"),this.generateInternalStream(me).toNodejsStream(rt)}};s.exports=Ve},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,s,o){s.exports=n("stream")},{stream:void 0}],17:[function(n,s,o){var a=n("./DataReader");function l(c){a.call(this,c);for(var u=0;u<this.data.length;u++)c[u]=255&c[u]}n("../utils").inherits(l,a),l.prototype.byteAt=function(c){return this.data[this.zero+c]},l.prototype.lastIndexOfSignature=function(c){for(var u=c.charCodeAt(0),f=c.charCodeAt(1),d=c.charCodeAt(2),p=c.charCodeAt(3),g=this.length-4;0<=g;--g)if(this.data[g]===u&&this.data[g+1]===f&&this.data[g+2]===d&&this.data[g+3]===p)return g-this.zero;return-1},l.prototype.readAndCheckSignature=function(c){var u=c.charCodeAt(0),f=c.charCodeAt(1),d=c.charCodeAt(2),p=c.charCodeAt(3),g=this.readData(4);return u===g[0]&&f===g[1]&&d===g[2]&&p===g[3]},l.prototype.readData=function(c){if(this.checkOffset(c),c===0)return[];var u=this.data.slice(this.zero+this.index,this.zero+this.index+c);return this.index+=c,u},s.exports=l},{"../utils":32,"./DataReader":18}],18:[function(n,s,o){var a=n("../utils");function l(c){this.data=c,this.length=c.length,this.index=0,this.zero=0}l.prototype={checkOffset:function(c){this.checkIndex(this.index+c)},checkIndex:function(c){if(this.length<this.zero+c||c<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+c+"). Corrupted zip ?")},setIndex:function(c){this.checkIndex(c),this.index=c},skip:function(c){this.setIndex(this.index+c)},byteAt:function(){},readInt:function(c){var u,f=0;for(this.checkOffset(c),u=this.index+c-1;u>=this.index;u--)f=(f<<8)+this.byteAt(u);return this.index+=c,f},readString:function(c){return a.transformTo("string",this.readData(c))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var c=this.readInt(4);return new Date(Date.UTC(1980+(c>>25&127),(c>>21&15)-1,c>>16&31,c>>11&31,c>>5&63,(31&c)<<1))}},s.exports=l},{"../utils":32}],19:[function(n,s,o){var a=n("./Uint8ArrayReader");function l(c){a.call(this,c)}n("../utils").inherits(l,a),l.prototype.readData=function(c){this.checkOffset(c);var u=this.data.slice(this.zero+this.index,this.zero+this.index+c);return this.index+=c,u},s.exports=l},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,s,o){var a=n("./DataReader");function l(c){a.call(this,c)}n("../utils").inherits(l,a),l.prototype.byteAt=function(c){return this.data.charCodeAt(this.zero+c)},l.prototype.lastIndexOfSignature=function(c){return this.data.lastIndexOf(c)-this.zero},l.prototype.readAndCheckSignature=function(c){return c===this.readData(4)},l.prototype.readData=function(c){this.checkOffset(c);var u=this.data.slice(this.zero+this.index,this.zero+this.index+c);return this.index+=c,u},s.exports=l},{"../utils":32,"./DataReader":18}],21:[function(n,s,o){var a=n("./ArrayReader");function l(c){a.call(this,c)}n("../utils").inherits(l,a),l.prototype.readData=function(c){if(this.checkOffset(c),c===0)return new Uint8Array(0);var u=this.data.subarray(this.zero+this.index,this.zero+this.index+c);return this.index+=c,u},s.exports=l},{"../utils":32,"./ArrayReader":17}],22:[function(n,s,o){var a=n("../utils"),l=n("../support"),c=n("./ArrayReader"),u=n("./StringReader"),f=n("./NodeBufferReader"),d=n("./Uint8ArrayReader");s.exports=function(p){var g=a.getTypeOf(p);return a.checkSupport(g),g!=="string"||l.uint8array?g==="nodebuffer"?new f(p):l.uint8array?new d(a.transformTo("uint8array",p)):new c(a.transformTo("array",p)):new u(p)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,s,o){o.LOCAL_FILE_HEADER="PK",o.CENTRAL_FILE_HEADER="PK",o.CENTRAL_DIRECTORY_END="PK",o.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",o.ZIP64_CENTRAL_DIRECTORY_END="PK",o.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,s,o){var a=n("./GenericWorker"),l=n("../utils");function c(u){a.call(this,"ConvertWorker to "+u),this.destType=u}l.inherits(c,a),c.prototype.processChunk=function(u){this.push({data:l.transformTo(this.destType,u.data),meta:u.meta})},s.exports=c},{"../utils":32,"./GenericWorker":28}],25:[function(n,s,o){var a=n("./GenericWorker"),l=n("../crc32");function c(){a.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(c,a),c.prototype.processChunk=function(u){this.streamInfo.crc32=l(u.data,this.streamInfo.crc32||0),this.push(u)},s.exports=c},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,s,o){var a=n("../utils"),l=n("./GenericWorker");function c(u){l.call(this,"DataLengthProbe for "+u),this.propName=u,this.withStreamInfo(u,0)}a.inherits(c,l),c.prototype.processChunk=function(u){if(u){var f=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=f+u.data.length}l.prototype.processChunk.call(this,u)},s.exports=c},{"../utils":32,"./GenericWorker":28}],27:[function(n,s,o){var a=n("../utils"),l=n("./GenericWorker");function c(u){l.call(this,"DataWorker");var f=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,u.then(function(d){f.dataIsReady=!0,f.data=d,f.max=d&&d.length||0,f.type=a.getTypeOf(d),f.isPaused||f._tickAndRepeat()},function(d){f.error(d)})}a.inherits(c,l),c.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this.data=null},c.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,a.delay(this._tickAndRepeat,[],this)),!0)},c.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(a.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},c.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var u=null,f=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":u=this.data.substring(this.index,f);break;case"uint8array":u=this.data.subarray(this.index,f);break;case"array":case"nodebuffer":u=this.data.slice(this.index,f)}return this.index=f,this.push({data:u,meta:{percent:this.max?this.index/this.max*100:0}})},s.exports=c},{"../utils":32,"./GenericWorker":28}],28:[function(n,s,o){function a(l){this.name=l||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}a.prototype={push:function(l){this.emit("data",l)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(l){this.emit("error",l)}return!0},error:function(l){return!this.isFinished&&(this.isPaused?this.generatedError=l:(this.isFinished=!0,this.emit("error",l),this.previous&&this.previous.error(l),this.cleanUp()),!0)},on:function(l,c){return this._listeners[l].push(c),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(l,c){if(this._listeners[l])for(var u=0;u<this._listeners[l].length;u++)this._listeners[l][u].call(this,c)},pipe:function(l){return l.registerPrevious(this)},registerPrevious:function(l){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=l.streamInfo,this.mergeStreamInfo(),this.previous=l;var c=this;return l.on("data",function(u){c.processChunk(u)}),l.on("end",function(){c.end()}),l.on("error",function(u){c.error(u)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var l=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),l=!0),this.previous&&this.previous.resume(),!l},flush:function(){},processChunk:function(l){this.push(l)},withStreamInfo:function(l,c){return this.extraStreamInfo[l]=c,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var l in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,l)&&(this.streamInfo[l]=this.extraStreamInfo[l])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var l="Worker "+this.name;return this.previous?this.previous+" -> "+l:l}},s.exports=a},{}],29:[function(n,s,o){var a=n("../utils"),l=n("./ConvertWorker"),c=n("./GenericWorker"),u=n("../base64"),f=n("../support"),d=n("../external"),p=null;if(f.nodestream)try{p=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function g(x,E){return new d.Promise(function(Y,Z){var te=[],ne=x._internalType,Ve=x._outputType,me=x._mimeType;x.on("data",function(rt,nt){te.push(rt),E&&E(nt)}).on("error",function(rt){te=[],Z(rt)}).on("end",function(){try{var rt=function(nt,ct,ot){switch(nt){case"blob":return a.newBlob(a.transformTo("arraybuffer",ct),ot);case"base64":return u.encode(ct);default:return a.transformTo(nt,ct)}}(Ve,function(nt,ct){var ot,ft=0,mt=null,Ye=0;for(ot=0;ot<ct.length;ot++)Ye+=ct[ot].length;switch(nt){case"string":return ct.join("");case"array":return Array.prototype.concat.apply([],ct);case"uint8array":for(mt=new Uint8Array(Ye),ot=0;ot<ct.length;ot++)mt.set(ct[ot],ft),ft+=ct[ot].length;return mt;case"nodebuffer":return Buffer.concat(ct);default:throw new Error("concat : unsupported type '"+nt+"'")}}(ne,te),me);Y(rt)}catch(nt){Z(nt)}te=[]}).resume()})}function y(x,E,Y){var Z=E;switch(E){case"blob":case"arraybuffer":Z="uint8array";break;case"base64":Z="string"}try{this._internalType=Z,this._outputType=E,this._mimeType=Y,a.checkSupport(Z),this._worker=x.pipe(new l(Z)),x.lock()}catch(te){this._worker=new c("error"),this._worker.error(te)}}y.prototype={accumulate:function(x){return g(this,x)},on:function(x,E){var Y=this;return x==="data"?this._worker.on(x,function(Z){E.call(Y,Z.data,Z.meta)}):this._worker.on(x,function(){a.delay(E,arguments,Y)}),this},resume:function(){return a.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(x){if(a.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new p(this,{objectMode:this._outputType!=="nodebuffer"},x)}},s.exports=y},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,s,o){if(o.base64=!0,o.array=!0,o.string=!0,o.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",o.nodebuffer=typeof Buffer<"u",o.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")o.blob=!1;else{var a=new ArrayBuffer(0);try{o.blob=new Blob([a],{type:"application/zip"}).size===0}catch{try{var l=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);l.append(a),o.blob=l.getBlob("application/zip").size===0}catch{o.blob=!1}}}try{o.nodestream=!!n("readable-stream").Readable}catch{o.nodestream=!1}},{"readable-stream":16}],31:[function(n,s,o){for(var a=n("./utils"),l=n("./support"),c=n("./nodejsUtils"),u=n("./stream/GenericWorker"),f=new Array(256),d=0;d<256;d++)f[d]=252<=d?6:248<=d?5:240<=d?4:224<=d?3:192<=d?2:1;f[254]=f[254]=1;function p(){u.call(this,"utf-8 decode"),this.leftOver=null}function g(){u.call(this,"utf-8 encode")}o.utf8encode=function(y){return l.nodebuffer?c.newBufferFrom(y,"utf-8"):function(x){var E,Y,Z,te,ne,Ve=x.length,me=0;for(te=0;te<Ve;te++)(64512&(Y=x.charCodeAt(te)))==55296&&te+1<Ve&&(64512&(Z=x.charCodeAt(te+1)))==56320&&(Y=65536+(Y-55296<<10)+(Z-56320),te++),me+=Y<128?1:Y<2048?2:Y<65536?3:4;for(E=l.uint8array?new Uint8Array(me):new Array(me),te=ne=0;ne<me;te++)(64512&(Y=x.charCodeAt(te)))==55296&&te+1<Ve&&(64512&(Z=x.charCodeAt(te+1)))==56320&&(Y=65536+(Y-55296<<10)+(Z-56320),te++),Y<128?E[ne++]=Y:(Y<2048?E[ne++]=192|Y>>>6:(Y<65536?E[ne++]=224|Y>>>12:(E[ne++]=240|Y>>>18,E[ne++]=128|Y>>>12&63),E[ne++]=128|Y>>>6&63),E[ne++]=128|63&Y);return E}(y)},o.utf8decode=function(y){return l.nodebuffer?a.transformTo("nodebuffer",y).toString("utf-8"):function(x){var E,Y,Z,te,ne=x.length,Ve=new Array(2*ne);for(E=Y=0;E<ne;)if((Z=x[E++])<128)Ve[Y++]=Z;else if(4<(te=f[Z]))Ve[Y++]=65533,E+=te-1;else{for(Z&=te===2?31:te===3?15:7;1<te&&E<ne;)Z=Z<<6|63&x[E++],te--;1<te?Ve[Y++]=65533:Z<65536?Ve[Y++]=Z:(Z-=65536,Ve[Y++]=55296|Z>>10&1023,Ve[Y++]=56320|1023&Z)}return Ve.length!==Y&&(Ve.subarray?Ve=Ve.subarray(0,Y):Ve.length=Y),a.applyFromCharCode(Ve)}(y=a.transformTo(l.uint8array?"uint8array":"array",y))},a.inherits(p,u),p.prototype.processChunk=function(y){var x=a.transformTo(l.uint8array?"uint8array":"array",y.data);if(this.leftOver&&this.leftOver.length){if(l.uint8array){var E=x;(x=new Uint8Array(E.length+this.leftOver.length)).set(this.leftOver,0),x.set(E,this.leftOver.length)}else x=this.leftOver.concat(x);this.leftOver=null}var Y=function(te,ne){var Ve;for((ne=ne||te.length)>te.length&&(ne=te.length),Ve=ne-1;0<=Ve&&(192&te[Ve])==128;)Ve--;return Ve<0||Ve===0?ne:Ve+f[te[Ve]]>ne?Ve:ne}(x),Z=x;Y!==x.length&&(l.uint8array?(Z=x.subarray(0,Y),this.leftOver=x.subarray(Y,x.length)):(Z=x.slice(0,Y),this.leftOver=x.slice(Y,x.length))),this.push({data:o.utf8decode(Z),meta:y.meta})},p.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:o.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},o.Utf8DecodeWorker=p,a.inherits(g,u),g.prototype.processChunk=function(y){this.push({data:o.utf8encode(y.data),meta:y.meta})},o.Utf8EncodeWorker=g},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,s,o){var a=n("./support"),l=n("./base64"),c=n("./nodejsUtils"),u=n("./external");function f(E){return E}function d(E,Y){for(var Z=0;Z<E.length;++Z)Y[Z]=255&E.charCodeAt(Z);return Y}n("setimmediate"),o.newBlob=function(E,Y){o.checkSupport("blob");try{return new Blob([E],{type:Y})}catch{try{var Z=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return Z.append(E),Z.getBlob(Y)}catch{throw new Error("Bug : can't construct the Blob.")}}};var p={stringifyByChunk:function(E,Y,Z){var te=[],ne=0,Ve=E.length;if(Ve<=Z)return String.fromCharCode.apply(null,E);for(;ne<Ve;)Y==="array"||Y==="nodebuffer"?te.push(String.fromCharCode.apply(null,E.slice(ne,Math.min(ne+Z,Ve)))):te.push(String.fromCharCode.apply(null,E.subarray(ne,Math.min(ne+Z,Ve)))),ne+=Z;return te.join("")},stringifyByChar:function(E){for(var Y="",Z=0;Z<E.length;Z++)Y+=String.fromCharCode(E[Z]);return Y},applyCanBeUsed:{uint8array:function(){try{return a.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return a.nodebuffer&&String.fromCharCode.apply(null,c.allocBuffer(1)).length===1}catch{return!1}}()}};function g(E){var Y=65536,Z=o.getTypeOf(E),te=!0;if(Z==="uint8array"?te=p.applyCanBeUsed.uint8array:Z==="nodebuffer"&&(te=p.applyCanBeUsed.nodebuffer),te)for(;1<Y;)try{return p.stringifyByChunk(E,Z,Y)}catch{Y=Math.floor(Y/2)}return p.stringifyByChar(E)}function y(E,Y){for(var Z=0;Z<E.length;Z++)Y[Z]=E[Z];return Y}o.applyFromCharCode=g;var x={};x.string={string:f,array:function(E){return d(E,new Array(E.length))},arraybuffer:function(E){return x.string.uint8array(E).buffer},uint8array:function(E){return d(E,new Uint8Array(E.length))},nodebuffer:function(E){return d(E,c.allocBuffer(E.length))}},x.array={string:g,array:f,arraybuffer:function(E){return new Uint8Array(E).buffer},uint8array:function(E){return new Uint8Array(E)},nodebuffer:function(E){return c.newBufferFrom(E)}},x.arraybuffer={string:function(E){return g(new Uint8Array(E))},array:function(E){return y(new Uint8Array(E),new Array(E.byteLength))},arraybuffer:f,uint8array:function(E){return new Uint8Array(E)},nodebuffer:function(E){return c.newBufferFrom(new Uint8Array(E))}},x.uint8array={string:g,array:function(E){return y(E,new Array(E.length))},arraybuffer:function(E){return E.buffer},uint8array:f,nodebuffer:function(E){return c.newBufferFrom(E)}},x.nodebuffer={string:g,array:function(E){return y(E,new Array(E.length))},arraybuffer:function(E){return x.nodebuffer.uint8array(E).buffer},uint8array:function(E){return y(E,new Uint8Array(E.length))},nodebuffer:f},o.transformTo=function(E,Y){if(Y=Y||"",!E)return Y;o.checkSupport(E);var Z=o.getTypeOf(Y);return x[Z][E](Y)},o.resolve=function(E){for(var Y=E.split("/"),Z=[],te=0;te<Y.length;te++){var ne=Y[te];ne==="."||ne===""&&te!==0&&te!==Y.length-1||(ne===".."?Z.pop():Z.push(ne))}return Z.join("/")},o.getTypeOf=function(E){return typeof E=="string"?"string":Object.prototype.toString.call(E)==="[object Array]"?"array":a.nodebuffer&&c.isBuffer(E)?"nodebuffer":a.uint8array&&E instanceof Uint8Array?"uint8array":a.arraybuffer&&E instanceof ArrayBuffer?"arraybuffer":void 0},o.checkSupport=function(E){if(!a[E.toLowerCase()])throw new Error(E+" is not supported by this platform")},o.MAX_VALUE_16BITS=65535,o.MAX_VALUE_32BITS=-1,o.pretty=function(E){var Y,Z,te="";for(Z=0;Z<(E||"").length;Z++)te+="\\x"+((Y=E.charCodeAt(Z))<16?"0":"")+Y.toString(16).toUpperCase();return te},o.delay=function(E,Y,Z){setImmediate(function(){E.apply(Z||null,Y||[])})},o.inherits=function(E,Y){function Z(){}Z.prototype=Y.prototype,E.prototype=new Z},o.extend=function(){var E,Y,Z={};for(E=0;E<arguments.length;E++)for(Y in arguments[E])Object.prototype.hasOwnProperty.call(arguments[E],Y)&&Z[Y]===void 0&&(Z[Y]=arguments[E][Y]);return Z},o.prepareContent=function(E,Y,Z,te,ne){return u.Promise.resolve(Y).then(function(Ve){return a.blob&&(Ve instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(Ve))!==-1)&&typeof FileReader<"u"?new u.Promise(function(me,rt){var nt=new FileReader;nt.onload=function(ct){me(ct.target.result)},nt.onerror=function(ct){rt(ct.target.error)},nt.readAsArrayBuffer(Ve)}):Ve}).then(function(Ve){var me=o.getTypeOf(Ve);return me?(me==="arraybuffer"?Ve=o.transformTo("uint8array",Ve):me==="string"&&(ne?Ve=l.decode(Ve):Z&&te!==!0&&(Ve=function(rt){return d(rt,a.uint8array?new Uint8Array(rt.length):new Array(rt.length))}(Ve))),Ve):u.Promise.reject(new Error("Can't read the data of '"+E+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,s,o){var a=n("./reader/readerFor"),l=n("./utils"),c=n("./signature"),u=n("./zipEntry"),f=n("./support");function d(p){this.files=[],this.loadOptions=p}d.prototype={checkSignature:function(p){if(!this.reader.readAndCheckSignature(p)){this.reader.index-=4;var g=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+l.pretty(g)+", expected "+l.pretty(p)+")")}},isSignature:function(p,g){var y=this.reader.index;this.reader.setIndex(p);var x=this.reader.readString(4)===g;return this.reader.setIndex(y),x},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var p=this.reader.readData(this.zipCommentLength),g=f.uint8array?"uint8array":"array",y=l.transformTo(g,p);this.zipComment=this.loadOptions.decodeFileName(y)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var p,g,y,x=this.zip64EndOfCentralSize-44;0<x;)p=this.reader.readInt(2),g=this.reader.readInt(4),y=this.reader.readData(g),this.zip64ExtensibleData[p]={id:p,length:g,value:y}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var p,g;for(p=0;p<this.files.length;p++)g=this.files[p],this.reader.setIndex(g.localHeaderOffset),this.checkSignature(c.LOCAL_FILE_HEADER),g.readLocalPart(this.reader),g.handleUTF8(),g.processAttributes()},readCentralDir:function(){var p;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(c.CENTRAL_FILE_HEADER);)(p=new u({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(p);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var p=this.reader.lastIndexOfSignature(c.CENTRAL_DIRECTORY_END);if(p<0)throw this.isSignature(0,c.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(p);var g=p;if(this.checkSignature(c.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===l.MAX_VALUE_16BITS||this.diskWithCentralDirStart===l.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===l.MAX_VALUE_16BITS||this.centralDirRecords===l.MAX_VALUE_16BITS||this.centralDirSize===l.MAX_VALUE_32BITS||this.centralDirOffset===l.MAX_VALUE_32BITS){if(this.zip64=!0,(p=this.reader.lastIndexOfSignature(c.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(p),this.checkSignature(c.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,c.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(c.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(c.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var y=this.centralDirOffset+this.centralDirSize;this.zip64&&(y+=20,y+=12+this.zip64EndOfCentralSize);var x=g-y;if(0<x)this.isSignature(g,c.CENTRAL_FILE_HEADER)||(this.reader.zero=x);else if(x<0)throw new Error("Corrupted zip: missing "+Math.abs(x)+" bytes.")},prepareReader:function(p){this.reader=a(p)},load:function(p){this.prepareReader(p),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},s.exports=d},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,s,o){var a=n("./reader/readerFor"),l=n("./utils"),c=n("./compressedObject"),u=n("./crc32"),f=n("./utf8"),d=n("./compressions"),p=n("./support");function g(y,x){this.options=y,this.loadOptions=x}g.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(y){var x,E;if(y.skip(22),this.fileNameLength=y.readInt(2),E=y.readInt(2),this.fileName=y.readData(this.fileNameLength),y.skip(E),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((x=function(Y){for(var Z in d)if(Object.prototype.hasOwnProperty.call(d,Z)&&d[Z].magic===Y)return d[Z];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+l.pretty(this.compressionMethod)+" unknown (inner file : "+l.transformTo("string",this.fileName)+")");this.decompressed=new c(this.compressedSize,this.uncompressedSize,this.crc32,x,y.readData(this.compressedSize))},readCentralPart:function(y){this.versionMadeBy=y.readInt(2),y.skip(2),this.bitFlag=y.readInt(2),this.compressionMethod=y.readString(2),this.date=y.readDate(),this.crc32=y.readInt(4),this.compressedSize=y.readInt(4),this.uncompressedSize=y.readInt(4);var x=y.readInt(2);if(this.extraFieldsLength=y.readInt(2),this.fileCommentLength=y.readInt(2),this.diskNumberStart=y.readInt(2),this.internalFileAttributes=y.readInt(2),this.externalFileAttributes=y.readInt(4),this.localHeaderOffset=y.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");y.skip(x),this.readExtraFields(y),this.parseZIP64ExtraField(y),this.fileComment=y.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var y=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),y==0&&(this.dosPermissions=63&this.externalFileAttributes),y==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var y=a(this.extraFields[1].value);this.uncompressedSize===l.MAX_VALUE_32BITS&&(this.uncompressedSize=y.readInt(8)),this.compressedSize===l.MAX_VALUE_32BITS&&(this.compressedSize=y.readInt(8)),this.localHeaderOffset===l.MAX_VALUE_32BITS&&(this.localHeaderOffset=y.readInt(8)),this.diskNumberStart===l.MAX_VALUE_32BITS&&(this.diskNumberStart=y.readInt(4))}},readExtraFields:function(y){var x,E,Y,Z=y.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});y.index+4<Z;)x=y.readInt(2),E=y.readInt(2),Y=y.readData(E),this.extraFields[x]={id:x,length:E,value:Y};y.setIndex(Z)},handleUTF8:function(){var y=p.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=f.utf8decode(this.fileName),this.fileCommentStr=f.utf8decode(this.fileComment);else{var x=this.findExtraFieldUnicodePath();if(x!==null)this.fileNameStr=x;else{var E=l.transformTo(y,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(E)}var Y=this.findExtraFieldUnicodeComment();if(Y!==null)this.fileCommentStr=Y;else{var Z=l.transformTo(y,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(Z)}}},findExtraFieldUnicodePath:function(){var y=this.extraFields[28789];if(y){var x=a(y.value);return x.readInt(1)!==1||u(this.fileName)!==x.readInt(4)?null:f.utf8decode(x.readData(y.length-5))}return null},findExtraFieldUnicodeComment:function(){var y=this.extraFields[25461];if(y){var x=a(y.value);return x.readInt(1)!==1||u(this.fileComment)!==x.readInt(4)?null:f.utf8decode(x.readData(y.length-5))}return null}},s.exports=g},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,s,o){function a(x,E,Y){this.name=x,this.dir=Y.dir,this.date=Y.date,this.comment=Y.comment,this.unixPermissions=Y.unixPermissions,this.dosPermissions=Y.dosPermissions,this._data=E,this._dataBinary=Y.binary,this.options={compression:Y.compression,compressionOptions:Y.compressionOptions}}var l=n("./stream/StreamHelper"),c=n("./stream/DataWorker"),u=n("./utf8"),f=n("./compressedObject"),d=n("./stream/GenericWorker");a.prototype={internalStream:function(x){var E=null,Y="string";try{if(!x)throw new Error("No output type specified.");var Z=(Y=x.toLowerCase())==="string"||Y==="text";Y!=="binarystring"&&Y!=="text"||(Y="string"),E=this._decompressWorker();var te=!this._dataBinary;te&&!Z&&(E=E.pipe(new u.Utf8EncodeWorker)),!te&&Z&&(E=E.pipe(new u.Utf8DecodeWorker))}catch(ne){(E=new d("error")).error(ne)}return new l(E,Y,"")},async:function(x,E){return this.internalStream(x).accumulate(E)},nodeStream:function(x,E){return this.internalStream(x||"nodebuffer").toNodejsStream(E)},_compressWorker:function(x,E){if(this._data instanceof f&&this._data.compression.magic===x.magic)return this._data.getCompressedWorker();var Y=this._decompressWorker();return this._dataBinary||(Y=Y.pipe(new u.Utf8EncodeWorker)),f.createWorkerFrom(Y,x,E)},_decompressWorker:function(){return this._data instanceof f?this._data.getContentWorker():this._data instanceof d?this._data:new c(this._data)}};for(var p=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],g=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},y=0;y<p.length;y++)a.prototype[p[y]]=g;s.exports=a},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,s,o){(function(a){var l,c,u=a.MutationObserver||a.WebKitMutationObserver;if(u){var f=0,d=new u(x),p=a.document.createTextNode("");d.observe(p,{characterData:!0}),l=function(){p.data=f=++f%2}}else if(a.setImmediate||a.MessageChannel===void 0)l="document"in a&&"onreadystatechange"in a.document.createElement("script")?function(){var E=a.document.createElement("script");E.onreadystatechange=function(){x(),E.onreadystatechange=null,E.parentNode.removeChild(E),E=null},a.document.documentElement.appendChild(E)}:function(){setTimeout(x,0)};else{var g=new a.MessageChannel;g.port1.onmessage=x,l=function(){g.port2.postMessage(0)}}var y=[];function x(){var E,Y;c=!0;for(var Z=y.length;Z;){for(Y=y,y=[],E=-1;++E<Z;)Y[E]();Z=y.length}c=!1}s.exports=function(E){y.push(E)!==1||c||l()}}).call(this,typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,s,o){var a=n("immediate");function l(){}var c={},u=["REJECTED"],f=["FULFILLED"],d=["PENDING"];function p(Z){if(typeof Z!="function")throw new TypeError("resolver must be a function");this.state=d,this.queue=[],this.outcome=void 0,Z!==l&&E(this,Z)}function g(Z,te,ne){this.promise=Z,typeof te=="function"&&(this.onFulfilled=te,this.callFulfilled=this.otherCallFulfilled),typeof ne=="function"&&(this.onRejected=ne,this.callRejected=this.otherCallRejected)}function y(Z,te,ne){a(function(){var Ve;try{Ve=te(ne)}catch(me){return c.reject(Z,me)}Ve===Z?c.reject(Z,new TypeError("Cannot resolve promise with itself")):c.resolve(Z,Ve)})}function x(Z){var te=Z&&Z.then;if(Z&&(typeof Z=="object"||typeof Z=="function")&&typeof te=="function")return function(){te.apply(Z,arguments)}}function E(Z,te){var ne=!1;function Ve(nt){ne||(ne=!0,c.reject(Z,nt))}function me(nt){ne||(ne=!0,c.resolve(Z,nt))}var rt=Y(function(){te(me,Ve)});rt.status==="error"&&Ve(rt.value)}function Y(Z,te){var ne={};try{ne.value=Z(te),ne.status="success"}catch(Ve){ne.status="error",ne.value=Ve}return ne}(s.exports=p).prototype.finally=function(Z){if(typeof Z!="function")return this;var te=this.constructor;return this.then(function(ne){return te.resolve(Z()).then(function(){return ne})},function(ne){return te.resolve(Z()).then(function(){throw ne})})},p.prototype.catch=function(Z){return this.then(null,Z)},p.prototype.then=function(Z,te){if(typeof Z!="function"&&this.state===f||typeof te!="function"&&this.state===u)return this;var ne=new this.constructor(l);return this.state!==d?y(ne,this.state===f?Z:te,this.outcome):this.queue.push(new g(ne,Z,te)),ne},g.prototype.callFulfilled=function(Z){c.resolve(this.promise,Z)},g.prototype.otherCallFulfilled=function(Z){y(this.promise,this.onFulfilled,Z)},g.prototype.callRejected=function(Z){c.reject(this.promise,Z)},g.prototype.otherCallRejected=function(Z){y(this.promise,this.onRejected,Z)},c.resolve=function(Z,te){var ne=Y(x,te);if(ne.status==="error")return c.reject(Z,ne.value);var Ve=ne.value;if(Ve)E(Z,Ve);else{Z.state=f,Z.outcome=te;for(var me=-1,rt=Z.queue.length;++me<rt;)Z.queue[me].callFulfilled(te)}return Z},c.reject=function(Z,te){Z.state=u,Z.outcome=te;for(var ne=-1,Ve=Z.queue.length;++ne<Ve;)Z.queue[ne].callRejected(te);return Z},p.resolve=function(Z){return Z instanceof this?Z:c.resolve(new this(l),Z)},p.reject=function(Z){var te=new this(l);return c.reject(te,Z)},p.all=function(Z){var te=this;if(Object.prototype.toString.call(Z)!=="[object Array]")return this.reject(new TypeError("must be an array"));var ne=Z.length,Ve=!1;if(!ne)return this.resolve([]);for(var me=new Array(ne),rt=0,nt=-1,ct=new this(l);++nt<ne;)ot(Z[nt],nt);return ct;function ot(ft,mt){te.resolve(ft).then(function(Ye){me[mt]=Ye,++rt!==ne||Ve||(Ve=!0,c.resolve(ct,me))},function(Ye){Ve||(Ve=!0,c.reject(ct,Ye))})}},p.race=function(Z){var te=this;if(Object.prototype.toString.call(Z)!=="[object Array]")return this.reject(new TypeError("must be an array"));var ne=Z.length,Ve=!1;if(!ne)return this.resolve([]);for(var me=-1,rt=new this(l);++me<ne;)nt=Z[me],te.resolve(nt).then(function(ct){Ve||(Ve=!0,c.resolve(rt,ct))},function(ct){Ve||(Ve=!0,c.reject(rt,ct))});var nt;return rt}},{immediate:36}],38:[function(n,s,o){var a={};(0,n("./lib/utils/common").assign)(a,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),s.exports=a},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,s,o){var a=n("./zlib/deflate"),l=n("./utils/common"),c=n("./utils/strings"),u=n("./zlib/messages"),f=n("./zlib/zstream"),d=Object.prototype.toString,p=0,g=-1,y=0,x=8;function E(Z){if(!(this instanceof E))return new E(Z);this.options=l.assign({level:g,method:x,chunkSize:16384,windowBits:15,memLevel:8,strategy:y,to:""},Z||{});var te=this.options;te.raw&&0<te.windowBits?te.windowBits=-te.windowBits:te.gzip&&0<te.windowBits&&te.windowBits<16&&(te.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var ne=a.deflateInit2(this.strm,te.level,te.method,te.windowBits,te.memLevel,te.strategy);if(ne!==p)throw new Error(u[ne]);if(te.header&&a.deflateSetHeader(this.strm,te.header),te.dictionary){var Ve;if(Ve=typeof te.dictionary=="string"?c.string2buf(te.dictionary):d.call(te.dictionary)==="[object ArrayBuffer]"?new Uint8Array(te.dictionary):te.dictionary,(ne=a.deflateSetDictionary(this.strm,Ve))!==p)throw new Error(u[ne]);this._dict_set=!0}}function Y(Z,te){var ne=new E(te);if(ne.push(Z,!0),ne.err)throw ne.msg||u[ne.err];return ne.result}E.prototype.push=function(Z,te){var ne,Ve,me=this.strm,rt=this.options.chunkSize;if(this.ended)return!1;Ve=te===~~te?te:te===!0?4:0,typeof Z=="string"?me.input=c.string2buf(Z):d.call(Z)==="[object ArrayBuffer]"?me.input=new Uint8Array(Z):me.input=Z,me.next_in=0,me.avail_in=me.input.length;do{if(me.avail_out===0&&(me.output=new l.Buf8(rt),me.next_out=0,me.avail_out=rt),(ne=a.deflate(me,Ve))!==1&&ne!==p)return this.onEnd(ne),!(this.ended=!0);me.avail_out!==0&&(me.avail_in!==0||Ve!==4&&Ve!==2)||(this.options.to==="string"?this.onData(c.buf2binstring(l.shrinkBuf(me.output,me.next_out))):this.onData(l.shrinkBuf(me.output,me.next_out)))}while((0<me.avail_in||me.avail_out===0)&&ne!==1);return Ve===4?(ne=a.deflateEnd(this.strm),this.onEnd(ne),this.ended=!0,ne===p):Ve!==2||(this.onEnd(p),!(me.avail_out=0))},E.prototype.onData=function(Z){this.chunks.push(Z)},E.prototype.onEnd=function(Z){Z===p&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=Z,this.msg=this.strm.msg},o.Deflate=E,o.deflate=Y,o.deflateRaw=function(Z,te){return(te=te||{}).raw=!0,Y(Z,te)},o.gzip=function(Z,te){return(te=te||{}).gzip=!0,Y(Z,te)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,s,o){var a=n("./zlib/inflate"),l=n("./utils/common"),c=n("./utils/strings"),u=n("./zlib/constants"),f=n("./zlib/messages"),d=n("./zlib/zstream"),p=n("./zlib/gzheader"),g=Object.prototype.toString;function y(E){if(!(this instanceof y))return new y(E);this.options=l.assign({chunkSize:16384,windowBits:0,to:""},E||{});var Y=this.options;Y.raw&&0<=Y.windowBits&&Y.windowBits<16&&(Y.windowBits=-Y.windowBits,Y.windowBits===0&&(Y.windowBits=-15)),!(0<=Y.windowBits&&Y.windowBits<16)||E&&E.windowBits||(Y.windowBits+=32),15<Y.windowBits&&Y.windowBits<48&&(15&Y.windowBits)==0&&(Y.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var Z=a.inflateInit2(this.strm,Y.windowBits);if(Z!==u.Z_OK)throw new Error(f[Z]);this.header=new p,a.inflateGetHeader(this.strm,this.header)}function x(E,Y){var Z=new y(Y);if(Z.push(E,!0),Z.err)throw Z.msg||f[Z.err];return Z.result}y.prototype.push=function(E,Y){var Z,te,ne,Ve,me,rt,nt=this.strm,ct=this.options.chunkSize,ot=this.options.dictionary,ft=!1;if(this.ended)return!1;te=Y===~~Y?Y:Y===!0?u.Z_FINISH:u.Z_NO_FLUSH,typeof E=="string"?nt.input=c.binstring2buf(E):g.call(E)==="[object ArrayBuffer]"?nt.input=new Uint8Array(E):nt.input=E,nt.next_in=0,nt.avail_in=nt.input.length;do{if(nt.avail_out===0&&(nt.output=new l.Buf8(ct),nt.next_out=0,nt.avail_out=ct),(Z=a.inflate(nt,u.Z_NO_FLUSH))===u.Z_NEED_DICT&&ot&&(rt=typeof ot=="string"?c.string2buf(ot):g.call(ot)==="[object ArrayBuffer]"?new Uint8Array(ot):ot,Z=a.inflateSetDictionary(this.strm,rt)),Z===u.Z_BUF_ERROR&&ft===!0&&(Z=u.Z_OK,ft=!1),Z!==u.Z_STREAM_END&&Z!==u.Z_OK)return this.onEnd(Z),!(this.ended=!0);nt.next_out&&(nt.avail_out!==0&&Z!==u.Z_STREAM_END&&(nt.avail_in!==0||te!==u.Z_FINISH&&te!==u.Z_SYNC_FLUSH)||(this.options.to==="string"?(ne=c.utf8border(nt.output,nt.next_out),Ve=nt.next_out-ne,me=c.buf2string(nt.output,ne),nt.next_out=Ve,nt.avail_out=ct-Ve,Ve&&l.arraySet(nt.output,nt.output,ne,Ve,0),this.onData(me)):this.onData(l.shrinkBuf(nt.output,nt.next_out)))),nt.avail_in===0&&nt.avail_out===0&&(ft=!0)}while((0<nt.avail_in||nt.avail_out===0)&&Z!==u.Z_STREAM_END);return Z===u.Z_STREAM_END&&(te=u.Z_FINISH),te===u.Z_FINISH?(Z=a.inflateEnd(this.strm),this.onEnd(Z),this.ended=!0,Z===u.Z_OK):te!==u.Z_SYNC_FLUSH||(this.onEnd(u.Z_OK),!(nt.avail_out=0))},y.prototype.onData=function(E){this.chunks.push(E)},y.prototype.onEnd=function(E){E===u.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=E,this.msg=this.strm.msg},o.Inflate=y,o.inflate=x,o.inflateRaw=function(E,Y){return(Y=Y||{}).raw=!0,x(E,Y)},o.ungzip=x},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,s,o){var a=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";o.assign=function(u){for(var f=Array.prototype.slice.call(arguments,1);f.length;){var d=f.shift();if(d){if(typeof d!="object")throw new TypeError(d+"must be non-object");for(var p in d)d.hasOwnProperty(p)&&(u[p]=d[p])}}return u},o.shrinkBuf=function(u,f){return u.length===f?u:u.subarray?u.subarray(0,f):(u.length=f,u)};var l={arraySet:function(u,f,d,p,g){if(f.subarray&&u.subarray)u.set(f.subarray(d,d+p),g);else for(var y=0;y<p;y++)u[g+y]=f[d+y]},flattenChunks:function(u){var f,d,p,g,y,x;for(f=p=0,d=u.length;f<d;f++)p+=u[f].length;for(x=new Uint8Array(p),f=g=0,d=u.length;f<d;f++)y=u[f],x.set(y,g),g+=y.length;return x}},c={arraySet:function(u,f,d,p,g){for(var y=0;y<p;y++)u[g+y]=f[d+y]},flattenChunks:function(u){return[].concat.apply([],u)}};o.setTyped=function(u){u?(o.Buf8=Uint8Array,o.Buf16=Uint16Array,o.Buf32=Int32Array,o.assign(o,l)):(o.Buf8=Array,o.Buf16=Array,o.Buf32=Array,o.assign(o,c))},o.setTyped(a)},{}],42:[function(n,s,o){var a=n("./common"),l=!0,c=!0;try{String.fromCharCode.apply(null,[0])}catch{l=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{c=!1}for(var u=new a.Buf8(256),f=0;f<256;f++)u[f]=252<=f?6:248<=f?5:240<=f?4:224<=f?3:192<=f?2:1;function d(p,g){if(g<65537&&(p.subarray&&c||!p.subarray&&l))return String.fromCharCode.apply(null,a.shrinkBuf(p,g));for(var y="",x=0;x<g;x++)y+=String.fromCharCode(p[x]);return y}u[254]=u[254]=1,o.string2buf=function(p){var g,y,x,E,Y,Z=p.length,te=0;for(E=0;E<Z;E++)(64512&(y=p.charCodeAt(E)))==55296&&E+1<Z&&(64512&(x=p.charCodeAt(E+1)))==56320&&(y=65536+(y-55296<<10)+(x-56320),E++),te+=y<128?1:y<2048?2:y<65536?3:4;for(g=new a.Buf8(te),E=Y=0;Y<te;E++)(64512&(y=p.charCodeAt(E)))==55296&&E+1<Z&&(64512&(x=p.charCodeAt(E+1)))==56320&&(y=65536+(y-55296<<10)+(x-56320),E++),y<128?g[Y++]=y:(y<2048?g[Y++]=192|y>>>6:(y<65536?g[Y++]=224|y>>>12:(g[Y++]=240|y>>>18,g[Y++]=128|y>>>12&63),g[Y++]=128|y>>>6&63),g[Y++]=128|63&y);return g},o.buf2binstring=function(p){return d(p,p.length)},o.binstring2buf=function(p){for(var g=new a.Buf8(p.length),y=0,x=g.length;y<x;y++)g[y]=p.charCodeAt(y);return g},o.buf2string=function(p,g){var y,x,E,Y,Z=g||p.length,te=new Array(2*Z);for(y=x=0;y<Z;)if((E=p[y++])<128)te[x++]=E;else if(4<(Y=u[E]))te[x++]=65533,y+=Y-1;else{for(E&=Y===2?31:Y===3?15:7;1<Y&&y<Z;)E=E<<6|63&p[y++],Y--;1<Y?te[x++]=65533:E<65536?te[x++]=E:(E-=65536,te[x++]=55296|E>>10&1023,te[x++]=56320|1023&E)}return d(te,x)},o.utf8border=function(p,g){var y;for((g=g||p.length)>p.length&&(g=p.length),y=g-1;0<=y&&(192&p[y])==128;)y--;return y<0||y===0?g:y+u[p[y]]>g?y:g}},{"./common":41}],43:[function(n,s,o){s.exports=function(a,l,c,u){for(var f=65535&a|0,d=a>>>16&65535|0,p=0;c!==0;){for(c-=p=2e3<c?2e3:c;d=d+(f=f+l[u++]|0)|0,--p;);f%=65521,d%=65521}return f|d<<16|0}},{}],44:[function(n,s,o){s.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,s,o){var a=function(){for(var l,c=[],u=0;u<256;u++){l=u;for(var f=0;f<8;f++)l=1&l?3988292384^l>>>1:l>>>1;c[u]=l}return c}();s.exports=function(l,c,u,f){var d=a,p=f+u;l^=-1;for(var g=f;g<p;g++)l=l>>>8^d[255&(l^c[g])];return-1^l}},{}],46:[function(n,s,o){var a,l=n("../utils/common"),c=n("./trees"),u=n("./adler32"),f=n("./crc32"),d=n("./messages"),p=0,g=4,y=0,x=-2,E=-1,Y=4,Z=2,te=8,ne=9,Ve=286,me=30,rt=19,nt=2*Ve+1,ct=15,ot=3,ft=258,mt=ft+ot+1,Ye=42,ht=113,ee=1,pt=2,Ot=3,vt=4;function Rt(G,gt){return G.msg=d[gt],gt}function bt(G){return(G<<1)-(4<G?9:0)}function Mt(G){for(var gt=G.length;0<=--gt;)G[gt]=0}function at(G){var gt=G.state,dt=gt.pending;dt>G.avail_out&&(dt=G.avail_out),dt!==0&&(l.arraySet(G.output,gt.pending_buf,gt.pending_out,dt,G.next_out),G.next_out+=dt,gt.pending_out+=dt,G.total_out+=dt,G.avail_out-=dt,gt.pending-=dt,gt.pending===0&&(gt.pending_out=0))}function lt(G,gt){c._tr_flush_block(G,0<=G.block_start?G.block_start:-1,G.strstart-G.block_start,gt),G.block_start=G.strstart,at(G.strm)}function _t(G,gt){G.pending_buf[G.pending++]=gt}function At(G,gt){G.pending_buf[G.pending++]=gt>>>8&255,G.pending_buf[G.pending++]=255&gt}function wt(G,gt){var dt,tt,et=G.max_chain_length,st=G.strstart,yt=G.prev_length,St=G.nice_match,ut=G.strstart>G.w_size-mt?G.strstart-(G.w_size-mt):0,kt=G.window,Et=G.w_mask,xt=G.prev,Pt=G.strstart+ft,Bt=kt[st+yt-1],It=kt[st+yt];G.prev_length>=G.good_match&&(et>>=2),St>G.lookahead&&(St=G.lookahead);do if(kt[(dt=gt)+yt]===It&&kt[dt+yt-1]===Bt&&kt[dt]===kt[st]&&kt[++dt]===kt[st+1]){st+=2,dt++;do;while(kt[++st]===kt[++dt]&&kt[++st]===kt[++dt]&&kt[++st]===kt[++dt]&&kt[++st]===kt[++dt]&&kt[++st]===kt[++dt]&&kt[++st]===kt[++dt]&&kt[++st]===kt[++dt]&&kt[++st]===kt[++dt]&&st<Pt);if(tt=ft-(Pt-st),st=Pt-ft,yt<tt){if(G.match_start=gt,St<=(yt=tt))break;Bt=kt[st+yt-1],It=kt[st+yt]}}while((gt=xt[gt&Et])>ut&&--et!=0);return yt<=G.lookahead?yt:G.lookahead}function Nt(G){var gt,dt,tt,et,st,yt,St,ut,kt,Et,xt=G.w_size;do{if(et=G.window_size-G.lookahead-G.strstart,G.strstart>=xt+(xt-mt)){for(l.arraySet(G.window,G.window,xt,xt,0),G.match_start-=xt,G.strstart-=xt,G.block_start-=xt,gt=dt=G.hash_size;tt=G.head[--gt],G.head[gt]=xt<=tt?tt-xt:0,--dt;);for(gt=dt=xt;tt=G.prev[--gt],G.prev[gt]=xt<=tt?tt-xt:0,--dt;);et+=xt}if(G.strm.avail_in===0)break;if(yt=G.strm,St=G.window,ut=G.strstart+G.lookahead,kt=et,Et=void 0,Et=yt.avail_in,kt<Et&&(Et=kt),dt=Et===0?0:(yt.avail_in-=Et,l.arraySet(St,yt.input,yt.next_in,Et,ut),yt.state.wrap===1?yt.adler=u(yt.adler,St,Et,ut):yt.state.wrap===2&&(yt.adler=f(yt.adler,St,Et,ut)),yt.next_in+=Et,yt.total_in+=Et,Et),G.lookahead+=dt,G.lookahead+G.insert>=ot)for(st=G.strstart-G.insert,G.ins_h=G.window[st],G.ins_h=(G.ins_h<<G.hash_shift^G.window[st+1])&G.hash_mask;G.insert&&(G.ins_h=(G.ins_h<<G.hash_shift^G.window[st+ot-1])&G.hash_mask,G.prev[st&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=st,st++,G.insert--,!(G.lookahead+G.insert<ot)););}while(G.lookahead<mt&&G.strm.avail_in!==0)}function Vt(G,gt){for(var dt,tt;;){if(G.lookahead<mt){if(Nt(G),G.lookahead<mt&&gt===p)return ee;if(G.lookahead===0)break}if(dt=0,G.lookahead>=ot&&(G.ins_h=(G.ins_h<<G.hash_shift^G.window[G.strstart+ot-1])&G.hash_mask,dt=G.prev[G.strstart&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=G.strstart),dt!==0&&G.strstart-dt<=G.w_size-mt&&(G.match_length=wt(G,dt)),G.match_length>=ot)if(tt=c._tr_tally(G,G.strstart-G.match_start,G.match_length-ot),G.lookahead-=G.match_length,G.match_length<=G.max_lazy_match&&G.lookahead>=ot){for(G.match_length--;G.strstart++,G.ins_h=(G.ins_h<<G.hash_shift^G.window[G.strstart+ot-1])&G.hash_mask,dt=G.prev[G.strstart&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=G.strstart,--G.match_length!=0;);G.strstart++}else G.strstart+=G.match_length,G.match_length=0,G.ins_h=G.window[G.strstart],G.ins_h=(G.ins_h<<G.hash_shift^G.window[G.strstart+1])&G.hash_mask;else tt=c._tr_tally(G,0,G.window[G.strstart]),G.lookahead--,G.strstart++;if(tt&&(lt(G,!1),G.strm.avail_out===0))return ee}return G.insert=G.strstart<ot-1?G.strstart:ot-1,gt===g?(lt(G,!0),G.strm.avail_out===0?Ot:vt):G.last_lit&&(lt(G,!1),G.strm.avail_out===0)?ee:pt}function $t(G,gt){for(var dt,tt,et;;){if(G.lookahead<mt){if(Nt(G),G.lookahead<mt&&gt===p)return ee;if(G.lookahead===0)break}if(dt=0,G.lookahead>=ot&&(G.ins_h=(G.ins_h<<G.hash_shift^G.window[G.strstart+ot-1])&G.hash_mask,dt=G.prev[G.strstart&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=G.strstart),G.prev_length=G.match_length,G.prev_match=G.match_start,G.match_length=ot-1,dt!==0&&G.prev_length<G.max_lazy_match&&G.strstart-dt<=G.w_size-mt&&(G.match_length=wt(G,dt),G.match_length<=5&&(G.strategy===1||G.match_length===ot&&4096<G.strstart-G.match_start)&&(G.match_length=ot-1)),G.prev_length>=ot&&G.match_length<=G.prev_length){for(et=G.strstart+G.lookahead-ot,tt=c._tr_tally(G,G.strstart-1-G.prev_match,G.prev_length-ot),G.lookahead-=G.prev_length-1,G.prev_length-=2;++G.strstart<=et&&(G.ins_h=(G.ins_h<<G.hash_shift^G.window[G.strstart+ot-1])&G.hash_mask,dt=G.prev[G.strstart&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=G.strstart),--G.prev_length!=0;);if(G.match_available=0,G.match_length=ot-1,G.strstart++,tt&&(lt(G,!1),G.strm.avail_out===0))return ee}else if(G.match_available){if((tt=c._tr_tally(G,0,G.window[G.strstart-1]))&&lt(G,!1),G.strstart++,G.lookahead--,G.strm.avail_out===0)return ee}else G.match_available=1,G.strstart++,G.lookahead--}return G.match_available&&(tt=c._tr_tally(G,0,G.window[G.strstart-1]),G.match_available=0),G.insert=G.strstart<ot-1?G.strstart:ot-1,gt===g?(lt(G,!0),G.strm.avail_out===0?Ot:vt):G.last_lit&&(lt(G,!1),G.strm.avail_out===0)?ee:pt}function Lt(G,gt,dt,tt,et){this.good_length=G,this.max_lazy=gt,this.nice_length=dt,this.max_chain=tt,this.func=et}function Ht(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=te,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new l.Buf16(2*nt),this.dyn_dtree=new l.Buf16(2*(2*me+1)),this.bl_tree=new l.Buf16(2*(2*rt+1)),Mt(this.dyn_ltree),Mt(this.dyn_dtree),Mt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new l.Buf16(ct+1),this.heap=new l.Buf16(2*Ve+1),Mt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new l.Buf16(2*Ve+1),Mt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function zt(G){var gt;return G&&G.state?(G.total_in=G.total_out=0,G.data_type=Z,(gt=G.state).pending=0,gt.pending_out=0,gt.wrap<0&&(gt.wrap=-gt.wrap),gt.status=gt.wrap?Ye:ht,G.adler=gt.wrap===2?0:1,gt.last_flush=p,c._tr_init(gt),y):Rt(G,x)}function jt(G){var gt=zt(G);return gt===y&&function(dt){dt.window_size=2*dt.w_size,Mt(dt.head),dt.max_lazy_match=a[dt.level].max_lazy,dt.good_match=a[dt.level].good_length,dt.nice_match=a[dt.level].nice_length,dt.max_chain_length=a[dt.level].max_chain,dt.strstart=0,dt.block_start=0,dt.lookahead=0,dt.insert=0,dt.match_length=dt.prev_length=ot-1,dt.match_available=0,dt.ins_h=0}(G.state),gt}function Gt(G,gt,dt,tt,et,st){if(!G)return x;var yt=1;if(gt===E&&(gt=6),tt<0?(yt=0,tt=-tt):15<tt&&(yt=2,tt-=16),et<1||ne<et||dt!==te||tt<8||15<tt||gt<0||9<gt||st<0||Y<st)return Rt(G,x);tt===8&&(tt=9);var St=new Ht;return(G.state=St).strm=G,St.wrap=yt,St.gzhead=null,St.w_bits=tt,St.w_size=1<<St.w_bits,St.w_mask=St.w_size-1,St.hash_bits=et+7,St.hash_size=1<<St.hash_bits,St.hash_mask=St.hash_size-1,St.hash_shift=~~((St.hash_bits+ot-1)/ot),St.window=new l.Buf8(2*St.w_size),St.head=new l.Buf16(St.hash_size),St.prev=new l.Buf16(St.w_size),St.lit_bufsize=1<<et+6,St.pending_buf_size=4*St.lit_bufsize,St.pending_buf=new l.Buf8(St.pending_buf_size),St.d_buf=1*St.lit_bufsize,St.l_buf=3*St.lit_bufsize,St.level=gt,St.strategy=st,St.method=dt,jt(G)}a=[new Lt(0,0,0,0,function(G,gt){var dt=65535;for(dt>G.pending_buf_size-5&&(dt=G.pending_buf_size-5);;){if(G.lookahead<=1){if(Nt(G),G.lookahead===0&&gt===p)return ee;if(G.lookahead===0)break}G.strstart+=G.lookahead,G.lookahead=0;var tt=G.block_start+dt;if((G.strstart===0||G.strstart>=tt)&&(G.lookahead=G.strstart-tt,G.strstart=tt,lt(G,!1),G.strm.avail_out===0)||G.strstart-G.block_start>=G.w_size-mt&&(lt(G,!1),G.strm.avail_out===0))return ee}return G.insert=0,gt===g?(lt(G,!0),G.strm.avail_out===0?Ot:vt):(G.strstart>G.block_start&&(lt(G,!1),G.strm.avail_out),ee)}),new Lt(4,4,8,4,Vt),new Lt(4,5,16,8,Vt),new Lt(4,6,32,32,Vt),new Lt(4,4,16,16,$t),new Lt(8,16,32,32,$t),new Lt(8,16,128,128,$t),new Lt(8,32,128,256,$t),new Lt(32,128,258,1024,$t),new Lt(32,258,258,4096,$t)],o.deflateInit=function(G,gt){return Gt(G,gt,te,15,8,0)},o.deflateInit2=Gt,o.deflateReset=jt,o.deflateResetKeep=zt,o.deflateSetHeader=function(G,gt){return G&&G.state?G.state.wrap!==2?x:(G.state.gzhead=gt,y):x},o.deflate=function(G,gt){var dt,tt,et,st;if(!G||!G.state||5<gt||gt<0)return G?Rt(G,x):x;if(tt=G.state,!G.output||!G.input&&G.avail_in!==0||tt.status===666&&gt!==g)return Rt(G,G.avail_out===0?-5:x);if(tt.strm=G,dt=tt.last_flush,tt.last_flush=gt,tt.status===Ye)if(tt.wrap===2)G.adler=0,_t(tt,31),_t(tt,139),_t(tt,8),tt.gzhead?(_t(tt,(tt.gzhead.text?1:0)+(tt.gzhead.hcrc?2:0)+(tt.gzhead.extra?4:0)+(tt.gzhead.name?8:0)+(tt.gzhead.comment?16:0)),_t(tt,255&tt.gzhead.time),_t(tt,tt.gzhead.time>>8&255),_t(tt,tt.gzhead.time>>16&255),_t(tt,tt.gzhead.time>>24&255),_t(tt,tt.level===9?2:2<=tt.strategy||tt.level<2?4:0),_t(tt,255&tt.gzhead.os),tt.gzhead.extra&&tt.gzhead.extra.length&&(_t(tt,255&tt.gzhead.extra.length),_t(tt,tt.gzhead.extra.length>>8&255)),tt.gzhead.hcrc&&(G.adler=f(G.adler,tt.pending_buf,tt.pending,0)),tt.gzindex=0,tt.status=69):(_t(tt,0),_t(tt,0),_t(tt,0),_t(tt,0),_t(tt,0),_t(tt,tt.level===9?2:2<=tt.strategy||tt.level<2?4:0),_t(tt,3),tt.status=ht);else{var yt=te+(tt.w_bits-8<<4)<<8;yt|=(2<=tt.strategy||tt.level<2?0:tt.level<6?1:tt.level===6?2:3)<<6,tt.strstart!==0&&(yt|=32),yt+=31-yt%31,tt.status=ht,At(tt,yt),tt.strstart!==0&&(At(tt,G.adler>>>16),At(tt,65535&G.adler)),G.adler=1}if(tt.status===69)if(tt.gzhead.extra){for(et=tt.pending;tt.gzindex<(65535&tt.gzhead.extra.length)&&(tt.pending!==tt.pending_buf_size||(tt.gzhead.hcrc&&tt.pending>et&&(G.adler=f(G.adler,tt.pending_buf,tt.pending-et,et)),at(G),et=tt.pending,tt.pending!==tt.pending_buf_size));)_t(tt,255&tt.gzhead.extra[tt.gzindex]),tt.gzindex++;tt.gzhead.hcrc&&tt.pending>et&&(G.adler=f(G.adler,tt.pending_buf,tt.pending-et,et)),tt.gzindex===tt.gzhead.extra.length&&(tt.gzindex=0,tt.status=73)}else tt.status=73;if(tt.status===73)if(tt.gzhead.name){et=tt.pending;do{if(tt.pending===tt.pending_buf_size&&(tt.gzhead.hcrc&&tt.pending>et&&(G.adler=f(G.adler,tt.pending_buf,tt.pending-et,et)),at(G),et=tt.pending,tt.pending===tt.pending_buf_size)){st=1;break}st=tt.gzindex<tt.gzhead.name.length?255&tt.gzhead.name.charCodeAt(tt.gzindex++):0,_t(tt,st)}while(st!==0);tt.gzhead.hcrc&&tt.pending>et&&(G.adler=f(G.adler,tt.pending_buf,tt.pending-et,et)),st===0&&(tt.gzindex=0,tt.status=91)}else tt.status=91;if(tt.status===91)if(tt.gzhead.comment){et=tt.pending;do{if(tt.pending===tt.pending_buf_size&&(tt.gzhead.hcrc&&tt.pending>et&&(G.adler=f(G.adler,tt.pending_buf,tt.pending-et,et)),at(G),et=tt.pending,tt.pending===tt.pending_buf_size)){st=1;break}st=tt.gzindex<tt.gzhead.comment.length?255&tt.gzhead.comment.charCodeAt(tt.gzindex++):0,_t(tt,st)}while(st!==0);tt.gzhead.hcrc&&tt.pending>et&&(G.adler=f(G.adler,tt.pending_buf,tt.pending-et,et)),st===0&&(tt.status=103)}else tt.status=103;if(tt.status===103&&(tt.gzhead.hcrc?(tt.pending+2>tt.pending_buf_size&&at(G),tt.pending+2<=tt.pending_buf_size&&(_t(tt,255&G.adler),_t(tt,G.adler>>8&255),G.adler=0,tt.status=ht)):tt.status=ht),tt.pending!==0){if(at(G),G.avail_out===0)return tt.last_flush=-1,y}else if(G.avail_in===0&&bt(gt)<=bt(dt)&&gt!==g)return Rt(G,-5);if(tt.status===666&&G.avail_in!==0)return Rt(G,-5);if(G.avail_in!==0||tt.lookahead!==0||gt!==p&&tt.status!==666){var St=tt.strategy===2?function(ut,kt){for(var Et;;){if(ut.lookahead===0&&(Nt(ut),ut.lookahead===0)){if(kt===p)return ee;break}if(ut.match_length=0,Et=c._tr_tally(ut,0,ut.window[ut.strstart]),ut.lookahead--,ut.strstart++,Et&&(lt(ut,!1),ut.strm.avail_out===0))return ee}return ut.insert=0,kt===g?(lt(ut,!0),ut.strm.avail_out===0?Ot:vt):ut.last_lit&&(lt(ut,!1),ut.strm.avail_out===0)?ee:pt}(tt,gt):tt.strategy===3?function(ut,kt){for(var Et,xt,Pt,Bt,It=ut.window;;){if(ut.lookahead<=ft){if(Nt(ut),ut.lookahead<=ft&&kt===p)return ee;if(ut.lookahead===0)break}if(ut.match_length=0,ut.lookahead>=ot&&0<ut.strstart&&(xt=It[Pt=ut.strstart-1])===It[++Pt]&&xt===It[++Pt]&&xt===It[++Pt]){Bt=ut.strstart+ft;do;while(xt===It[++Pt]&&xt===It[++Pt]&&xt===It[++Pt]&&xt===It[++Pt]&&xt===It[++Pt]&&xt===It[++Pt]&&xt===It[++Pt]&&xt===It[++Pt]&&Pt<Bt);ut.match_length=ft-(Bt-Pt),ut.match_length>ut.lookahead&&(ut.match_length=ut.lookahead)}if(ut.match_length>=ot?(Et=c._tr_tally(ut,1,ut.match_length-ot),ut.lookahead-=ut.match_length,ut.strstart+=ut.match_length,ut.match_length=0):(Et=c._tr_tally(ut,0,ut.window[ut.strstart]),ut.lookahead--,ut.strstart++),Et&&(lt(ut,!1),ut.strm.avail_out===0))return ee}return ut.insert=0,kt===g?(lt(ut,!0),ut.strm.avail_out===0?Ot:vt):ut.last_lit&&(lt(ut,!1),ut.strm.avail_out===0)?ee:pt}(tt,gt):a[tt.level].func(tt,gt);if(St!==Ot&&St!==vt||(tt.status=666),St===ee||St===Ot)return G.avail_out===0&&(tt.last_flush=-1),y;if(St===pt&&(gt===1?c._tr_align(tt):gt!==5&&(c._tr_stored_block(tt,0,0,!1),gt===3&&(Mt(tt.head),tt.lookahead===0&&(tt.strstart=0,tt.block_start=0,tt.insert=0))),at(G),G.avail_out===0))return tt.last_flush=-1,y}return gt!==g?y:tt.wrap<=0?1:(tt.wrap===2?(_t(tt,255&G.adler),_t(tt,G.adler>>8&255),_t(tt,G.adler>>16&255),_t(tt,G.adler>>24&255),_t(tt,255&G.total_in),_t(tt,G.total_in>>8&255),_t(tt,G.total_in>>16&255),_t(tt,G.total_in>>24&255)):(At(tt,G.adler>>>16),At(tt,65535&G.adler)),at(G),0<tt.wrap&&(tt.wrap=-tt.wrap),tt.pending!==0?y:1)},o.deflateEnd=function(G){var gt;return G&&G.state?(gt=G.state.status)!==Ye&&gt!==69&&gt!==73&&gt!==91&&gt!==103&&gt!==ht&&gt!==666?Rt(G,x):(G.state=null,gt===ht?Rt(G,-3):y):x},o.deflateSetDictionary=function(G,gt){var dt,tt,et,st,yt,St,ut,kt,Et=gt.length;if(!G||!G.state||(st=(dt=G.state).wrap)===2||st===1&&dt.status!==Ye||dt.lookahead)return x;for(st===1&&(G.adler=u(G.adler,gt,Et,0)),dt.wrap=0,Et>=dt.w_size&&(st===0&&(Mt(dt.head),dt.strstart=0,dt.block_start=0,dt.insert=0),kt=new l.Buf8(dt.w_size),l.arraySet(kt,gt,Et-dt.w_size,dt.w_size,0),gt=kt,Et=dt.w_size),yt=G.avail_in,St=G.next_in,ut=G.input,G.avail_in=Et,G.next_in=0,G.input=gt,Nt(dt);dt.lookahead>=ot;){for(tt=dt.strstart,et=dt.lookahead-(ot-1);dt.ins_h=(dt.ins_h<<dt.hash_shift^dt.window[tt+ot-1])&dt.hash_mask,dt.prev[tt&dt.w_mask]=dt.head[dt.ins_h],dt.head[dt.ins_h]=tt,tt++,--et;);dt.strstart=tt,dt.lookahead=ot-1,Nt(dt)}return dt.strstart+=dt.lookahead,dt.block_start=dt.strstart,dt.insert=dt.lookahead,dt.lookahead=0,dt.match_length=dt.prev_length=ot-1,dt.match_available=0,G.next_in=St,G.input=ut,G.avail_in=yt,dt.wrap=st,y},o.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,s,o){s.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,s,o){s.exports=function(a,l){var c,u,f,d,p,g,y,x,E,Y,Z,te,ne,Ve,me,rt,nt,ct,ot,ft,mt,Ye,ht,ee,pt;c=a.state,u=a.next_in,ee=a.input,f=u+(a.avail_in-5),d=a.next_out,pt=a.output,p=d-(l-a.avail_out),g=d+(a.avail_out-257),y=c.dmax,x=c.wsize,E=c.whave,Y=c.wnext,Z=c.window,te=c.hold,ne=c.bits,Ve=c.lencode,me=c.distcode,rt=(1<<c.lenbits)-1,nt=(1<<c.distbits)-1;e:do{ne<15&&(te+=ee[u++]<<ne,ne+=8,te+=ee[u++]<<ne,ne+=8),ct=Ve[te&rt];t:for(;;){if(te>>>=ot=ct>>>24,ne-=ot,(ot=ct>>>16&255)===0)pt[d++]=65535&ct;else{if(!(16&ot)){if((64&ot)==0){ct=Ve[(65535&ct)+(te&(1<<ot)-1)];continue t}if(32&ot){c.mode=12;break e}a.msg="invalid literal/length code",c.mode=30;break e}ft=65535&ct,(ot&=15)&&(ne<ot&&(te+=ee[u++]<<ne,ne+=8),ft+=te&(1<<ot)-1,te>>>=ot,ne-=ot),ne<15&&(te+=ee[u++]<<ne,ne+=8,te+=ee[u++]<<ne,ne+=8),ct=me[te&nt];n:for(;;){if(te>>>=ot=ct>>>24,ne-=ot,!(16&(ot=ct>>>16&255))){if((64&ot)==0){ct=me[(65535&ct)+(te&(1<<ot)-1)];continue n}a.msg="invalid distance code",c.mode=30;break e}if(mt=65535&ct,ne<(ot&=15)&&(te+=ee[u++]<<ne,(ne+=8)<ot&&(te+=ee[u++]<<ne,ne+=8)),y<(mt+=te&(1<<ot)-1)){a.msg="invalid distance too far back",c.mode=30;break e}if(te>>>=ot,ne-=ot,(ot=d-p)<mt){if(E<(ot=mt-ot)&&c.sane){a.msg="invalid distance too far back",c.mode=30;break e}if(ht=Z,(Ye=0)===Y){if(Ye+=x-ot,ot<ft){for(ft-=ot;pt[d++]=Z[Ye++],--ot;);Ye=d-mt,ht=pt}}else if(Y<ot){if(Ye+=x+Y-ot,(ot-=Y)<ft){for(ft-=ot;pt[d++]=Z[Ye++],--ot;);if(Ye=0,Y<ft){for(ft-=ot=Y;pt[d++]=Z[Ye++],--ot;);Ye=d-mt,ht=pt}}}else if(Ye+=Y-ot,ot<ft){for(ft-=ot;pt[d++]=Z[Ye++],--ot;);Ye=d-mt,ht=pt}for(;2<ft;)pt[d++]=ht[Ye++],pt[d++]=ht[Ye++],pt[d++]=ht[Ye++],ft-=3;ft&&(pt[d++]=ht[Ye++],1<ft&&(pt[d++]=ht[Ye++]))}else{for(Ye=d-mt;pt[d++]=pt[Ye++],pt[d++]=pt[Ye++],pt[d++]=pt[Ye++],2<(ft-=3););ft&&(pt[d++]=pt[Ye++],1<ft&&(pt[d++]=pt[Ye++]))}break}}break}}while(u<f&&d<g);u-=ft=ne>>3,te&=(1<<(ne-=ft<<3))-1,a.next_in=u,a.next_out=d,a.avail_in=u<f?f-u+5:5-(u-f),a.avail_out=d<g?g-d+257:257-(d-g),c.hold=te,c.bits=ne}},{}],49:[function(n,s,o){var a=n("../utils/common"),l=n("./adler32"),c=n("./crc32"),u=n("./inffast"),f=n("./inftrees"),d=1,p=2,g=0,y=-2,x=1,E=852,Y=592;function Z(Ye){return(Ye>>>24&255)+(Ye>>>8&65280)+((65280&Ye)<<8)+((255&Ye)<<24)}function te(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new a.Buf16(320),this.work=new a.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function ne(Ye){var ht;return Ye&&Ye.state?(ht=Ye.state,Ye.total_in=Ye.total_out=ht.total=0,Ye.msg="",ht.wrap&&(Ye.adler=1&ht.wrap),ht.mode=x,ht.last=0,ht.havedict=0,ht.dmax=32768,ht.head=null,ht.hold=0,ht.bits=0,ht.lencode=ht.lendyn=new a.Buf32(E),ht.distcode=ht.distdyn=new a.Buf32(Y),ht.sane=1,ht.back=-1,g):y}function Ve(Ye){var ht;return Ye&&Ye.state?((ht=Ye.state).wsize=0,ht.whave=0,ht.wnext=0,ne(Ye)):y}function me(Ye,ht){var ee,pt;return Ye&&Ye.state?(pt=Ye.state,ht<0?(ee=0,ht=-ht):(ee=1+(ht>>4),ht<48&&(ht&=15)),ht&&(ht<8||15<ht)?y:(pt.window!==null&&pt.wbits!==ht&&(pt.window=null),pt.wrap=ee,pt.wbits=ht,Ve(Ye))):y}function rt(Ye,ht){var ee,pt;return Ye?(pt=new te,(Ye.state=pt).window=null,(ee=me(Ye,ht))!==g&&(Ye.state=null),ee):y}var nt,ct,ot=!0;function ft(Ye){if(ot){var ht;for(nt=new a.Buf32(512),ct=new a.Buf32(32),ht=0;ht<144;)Ye.lens[ht++]=8;for(;ht<256;)Ye.lens[ht++]=9;for(;ht<280;)Ye.lens[ht++]=7;for(;ht<288;)Ye.lens[ht++]=8;for(f(d,Ye.lens,0,288,nt,0,Ye.work,{bits:9}),ht=0;ht<32;)Ye.lens[ht++]=5;f(p,Ye.lens,0,32,ct,0,Ye.work,{bits:5}),ot=!1}Ye.lencode=nt,Ye.lenbits=9,Ye.distcode=ct,Ye.distbits=5}function mt(Ye,ht,ee,pt){var Ot,vt=Ye.state;return vt.window===null&&(vt.wsize=1<<vt.wbits,vt.wnext=0,vt.whave=0,vt.window=new a.Buf8(vt.wsize)),pt>=vt.wsize?(a.arraySet(vt.window,ht,ee-vt.wsize,vt.wsize,0),vt.wnext=0,vt.whave=vt.wsize):(pt<(Ot=vt.wsize-vt.wnext)&&(Ot=pt),a.arraySet(vt.window,ht,ee-pt,Ot,vt.wnext),(pt-=Ot)?(a.arraySet(vt.window,ht,ee-pt,pt,0),vt.wnext=pt,vt.whave=vt.wsize):(vt.wnext+=Ot,vt.wnext===vt.wsize&&(vt.wnext=0),vt.whave<vt.wsize&&(vt.whave+=Ot))),0}o.inflateReset=Ve,o.inflateReset2=me,o.inflateResetKeep=ne,o.inflateInit=function(Ye){return rt(Ye,15)},o.inflateInit2=rt,o.inflate=function(Ye,ht){var ee,pt,Ot,vt,Rt,bt,Mt,at,lt,_t,At,wt,Nt,Vt,$t,Lt,Ht,zt,jt,Gt,G,gt,dt,tt,et=0,st=new a.Buf8(4),yt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!Ye||!Ye.state||!Ye.output||!Ye.input&&Ye.avail_in!==0)return y;(ee=Ye.state).mode===12&&(ee.mode=13),Rt=Ye.next_out,Ot=Ye.output,Mt=Ye.avail_out,vt=Ye.next_in,pt=Ye.input,bt=Ye.avail_in,at=ee.hold,lt=ee.bits,_t=bt,At=Mt,gt=g;e:for(;;)switch(ee.mode){case x:if(ee.wrap===0){ee.mode=13;break}for(;lt<16;){if(bt===0)break e;bt--,at+=pt[vt++]<<lt,lt+=8}if(2&ee.wrap&&at===35615){st[ee.check=0]=255&at,st[1]=at>>>8&255,ee.check=c(ee.check,st,2,0),lt=at=0,ee.mode=2;break}if(ee.flags=0,ee.head&&(ee.head.done=!1),!(1&ee.wrap)||(((255&at)<<8)+(at>>8))%31){Ye.msg="incorrect header check",ee.mode=30;break}if((15&at)!=8){Ye.msg="unknown compression method",ee.mode=30;break}if(lt-=4,G=8+(15&(at>>>=4)),ee.wbits===0)ee.wbits=G;else if(G>ee.wbits){Ye.msg="invalid window size",ee.mode=30;break}ee.dmax=1<<G,Ye.adler=ee.check=1,ee.mode=512&at?10:12,lt=at=0;break;case 2:for(;lt<16;){if(bt===0)break e;bt--,at+=pt[vt++]<<lt,lt+=8}if(ee.flags=at,(255&ee.flags)!=8){Ye.msg="unknown compression method",ee.mode=30;break}if(57344&ee.flags){Ye.msg="unknown header flags set",ee.mode=30;break}ee.head&&(ee.head.text=at>>8&1),512&ee.flags&&(st[0]=255&at,st[1]=at>>>8&255,ee.check=c(ee.check,st,2,0)),lt=at=0,ee.mode=3;case 3:for(;lt<32;){if(bt===0)break e;bt--,at+=pt[vt++]<<lt,lt+=8}ee.head&&(ee.head.time=at),512&ee.flags&&(st[0]=255&at,st[1]=at>>>8&255,st[2]=at>>>16&255,st[3]=at>>>24&255,ee.check=c(ee.check,st,4,0)),lt=at=0,ee.mode=4;case 4:for(;lt<16;){if(bt===0)break e;bt--,at+=pt[vt++]<<lt,lt+=8}ee.head&&(ee.head.xflags=255&at,ee.head.os=at>>8),512&ee.flags&&(st[0]=255&at,st[1]=at>>>8&255,ee.check=c(ee.check,st,2,0)),lt=at=0,ee.mode=5;case 5:if(1024&ee.flags){for(;lt<16;){if(bt===0)break e;bt--,at+=pt[vt++]<<lt,lt+=8}ee.length=at,ee.head&&(ee.head.extra_len=at),512&ee.flags&&(st[0]=255&at,st[1]=at>>>8&255,ee.check=c(ee.check,st,2,0)),lt=at=0}else ee.head&&(ee.head.extra=null);ee.mode=6;case 6:if(1024&ee.flags&&(bt<(wt=ee.length)&&(wt=bt),wt&&(ee.head&&(G=ee.head.extra_len-ee.length,ee.head.extra||(ee.head.extra=new Array(ee.head.extra_len)),a.arraySet(ee.head.extra,pt,vt,wt,G)),512&ee.flags&&(ee.check=c(ee.check,pt,wt,vt)),bt-=wt,vt+=wt,ee.length-=wt),ee.length))break e;ee.length=0,ee.mode=7;case 7:if(2048&ee.flags){if(bt===0)break e;for(wt=0;G=pt[vt+wt++],ee.head&&G&&ee.length<65536&&(ee.head.name+=String.fromCharCode(G)),G&&wt<bt;);if(512&ee.flags&&(ee.check=c(ee.check,pt,wt,vt)),bt-=wt,vt+=wt,G)break e}else ee.head&&(ee.head.name=null);ee.length=0,ee.mode=8;case 8:if(4096&ee.flags){if(bt===0)break e;for(wt=0;G=pt[vt+wt++],ee.head&&G&&ee.length<65536&&(ee.head.comment+=String.fromCharCode(G)),G&&wt<bt;);if(512&ee.flags&&(ee.check=c(ee.check,pt,wt,vt)),bt-=wt,vt+=wt,G)break e}else ee.head&&(ee.head.comment=null);ee.mode=9;case 9:if(512&ee.flags){for(;lt<16;){if(bt===0)break e;bt--,at+=pt[vt++]<<lt,lt+=8}if(at!==(65535&ee.check)){Ye.msg="header crc mismatch",ee.mode=30;break}lt=at=0}ee.head&&(ee.head.hcrc=ee.flags>>9&1,ee.head.done=!0),Ye.adler=ee.check=0,ee.mode=12;break;case 10:for(;lt<32;){if(bt===0)break e;bt--,at+=pt[vt++]<<lt,lt+=8}Ye.adler=ee.check=Z(at),lt=at=0,ee.mode=11;case 11:if(ee.havedict===0)return Ye.next_out=Rt,Ye.avail_out=Mt,Ye.next_in=vt,Ye.avail_in=bt,ee.hold=at,ee.bits=lt,2;Ye.adler=ee.check=1,ee.mode=12;case 12:if(ht===5||ht===6)break e;case 13:if(ee.last){at>>>=7&lt,lt-=7&lt,ee.mode=27;break}for(;lt<3;){if(bt===0)break e;bt--,at+=pt[vt++]<<lt,lt+=8}switch(ee.last=1&at,lt-=1,3&(at>>>=1)){case 0:ee.mode=14;break;case 1:if(ft(ee),ee.mode=20,ht!==6)break;at>>>=2,lt-=2;break e;case 2:ee.mode=17;break;case 3:Ye.msg="invalid block type",ee.mode=30}at>>>=2,lt-=2;break;case 14:for(at>>>=7&lt,lt-=7&lt;lt<32;){if(bt===0)break e;bt--,at+=pt[vt++]<<lt,lt+=8}if((65535&at)!=(at>>>16^65535)){Ye.msg="invalid stored block lengths",ee.mode=30;break}if(ee.length=65535&at,lt=at=0,ee.mode=15,ht===6)break e;case 15:ee.mode=16;case 16:if(wt=ee.length){if(bt<wt&&(wt=bt),Mt<wt&&(wt=Mt),wt===0)break e;a.arraySet(Ot,pt,vt,wt,Rt),bt-=wt,vt+=wt,Mt-=wt,Rt+=wt,ee.length-=wt;break}ee.mode=12;break;case 17:for(;lt<14;){if(bt===0)break e;bt--,at+=pt[vt++]<<lt,lt+=8}if(ee.nlen=257+(31&at),at>>>=5,lt-=5,ee.ndist=1+(31&at),at>>>=5,lt-=5,ee.ncode=4+(15&at),at>>>=4,lt-=4,286<ee.nlen||30<ee.ndist){Ye.msg="too many length or distance symbols",ee.mode=30;break}ee.have=0,ee.mode=18;case 18:for(;ee.have<ee.ncode;){for(;lt<3;){if(bt===0)break e;bt--,at+=pt[vt++]<<lt,lt+=8}ee.lens[yt[ee.have++]]=7&at,at>>>=3,lt-=3}for(;ee.have<19;)ee.lens[yt[ee.have++]]=0;if(ee.lencode=ee.lendyn,ee.lenbits=7,dt={bits:ee.lenbits},gt=f(0,ee.lens,0,19,ee.lencode,0,ee.work,dt),ee.lenbits=dt.bits,gt){Ye.msg="invalid code lengths set",ee.mode=30;break}ee.have=0,ee.mode=19;case 19:for(;ee.have<ee.nlen+ee.ndist;){for(;Lt=(et=ee.lencode[at&(1<<ee.lenbits)-1])>>>16&255,Ht=65535&et,!(($t=et>>>24)<=lt);){if(bt===0)break e;bt--,at+=pt[vt++]<<lt,lt+=8}if(Ht<16)at>>>=$t,lt-=$t,ee.lens[ee.have++]=Ht;else{if(Ht===16){for(tt=$t+2;lt<tt;){if(bt===0)break e;bt--,at+=pt[vt++]<<lt,lt+=8}if(at>>>=$t,lt-=$t,ee.have===0){Ye.msg="invalid bit length repeat",ee.mode=30;break}G=ee.lens[ee.have-1],wt=3+(3&at),at>>>=2,lt-=2}else if(Ht===17){for(tt=$t+3;lt<tt;){if(bt===0)break e;bt--,at+=pt[vt++]<<lt,lt+=8}lt-=$t,G=0,wt=3+(7&(at>>>=$t)),at>>>=3,lt-=3}else{for(tt=$t+7;lt<tt;){if(bt===0)break e;bt--,at+=pt[vt++]<<lt,lt+=8}lt-=$t,G=0,wt=11+(127&(at>>>=$t)),at>>>=7,lt-=7}if(ee.have+wt>ee.nlen+ee.ndist){Ye.msg="invalid bit length repeat",ee.mode=30;break}for(;wt--;)ee.lens[ee.have++]=G}}if(ee.mode===30)break;if(ee.lens[256]===0){Ye.msg="invalid code -- missing end-of-block",ee.mode=30;break}if(ee.lenbits=9,dt={bits:ee.lenbits},gt=f(d,ee.lens,0,ee.nlen,ee.lencode,0,ee.work,dt),ee.lenbits=dt.bits,gt){Ye.msg="invalid literal/lengths set",ee.mode=30;break}if(ee.distbits=6,ee.distcode=ee.distdyn,dt={bits:ee.distbits},gt=f(p,ee.lens,ee.nlen,ee.ndist,ee.distcode,0,ee.work,dt),ee.distbits=dt.bits,gt){Ye.msg="invalid distances set",ee.mode=30;break}if(ee.mode=20,ht===6)break e;case 20:ee.mode=21;case 21:if(6<=bt&&258<=Mt){Ye.next_out=Rt,Ye.avail_out=Mt,Ye.next_in=vt,Ye.avail_in=bt,ee.hold=at,ee.bits=lt,u(Ye,At),Rt=Ye.next_out,Ot=Ye.output,Mt=Ye.avail_out,vt=Ye.next_in,pt=Ye.input,bt=Ye.avail_in,at=ee.hold,lt=ee.bits,ee.mode===12&&(ee.back=-1);break}for(ee.back=0;Lt=(et=ee.lencode[at&(1<<ee.lenbits)-1])>>>16&255,Ht=65535&et,!(($t=et>>>24)<=lt);){if(bt===0)break e;bt--,at+=pt[vt++]<<lt,lt+=8}if(Lt&&(240&Lt)==0){for(zt=$t,jt=Lt,Gt=Ht;Lt=(et=ee.lencode[Gt+((at&(1<<zt+jt)-1)>>zt)])>>>16&255,Ht=65535&et,!(zt+($t=et>>>24)<=lt);){if(bt===0)break e;bt--,at+=pt[vt++]<<lt,lt+=8}at>>>=zt,lt-=zt,ee.back+=zt}if(at>>>=$t,lt-=$t,ee.back+=$t,ee.length=Ht,Lt===0){ee.mode=26;break}if(32&Lt){ee.back=-1,ee.mode=12;break}if(64&Lt){Ye.msg="invalid literal/length code",ee.mode=30;break}ee.extra=15&Lt,ee.mode=22;case 22:if(ee.extra){for(tt=ee.extra;lt<tt;){if(bt===0)break e;bt--,at+=pt[vt++]<<lt,lt+=8}ee.length+=at&(1<<ee.extra)-1,at>>>=ee.extra,lt-=ee.extra,ee.back+=ee.extra}ee.was=ee.length,ee.mode=23;case 23:for(;Lt=(et=ee.distcode[at&(1<<ee.distbits)-1])>>>16&255,Ht=65535&et,!(($t=et>>>24)<=lt);){if(bt===0)break e;bt--,at+=pt[vt++]<<lt,lt+=8}if((240&Lt)==0){for(zt=$t,jt=Lt,Gt=Ht;Lt=(et=ee.distcode[Gt+((at&(1<<zt+jt)-1)>>zt)])>>>16&255,Ht=65535&et,!(zt+($t=et>>>24)<=lt);){if(bt===0)break e;bt--,at+=pt[vt++]<<lt,lt+=8}at>>>=zt,lt-=zt,ee.back+=zt}if(at>>>=$t,lt-=$t,ee.back+=$t,64&Lt){Ye.msg="invalid distance code",ee.mode=30;break}ee.offset=Ht,ee.extra=15&Lt,ee.mode=24;case 24:if(ee.extra){for(tt=ee.extra;lt<tt;){if(bt===0)break e;bt--,at+=pt[vt++]<<lt,lt+=8}ee.offset+=at&(1<<ee.extra)-1,at>>>=ee.extra,lt-=ee.extra,ee.back+=ee.extra}if(ee.offset>ee.dmax){Ye.msg="invalid distance too far back",ee.mode=30;break}ee.mode=25;case 25:if(Mt===0)break e;if(wt=At-Mt,ee.offset>wt){if((wt=ee.offset-wt)>ee.whave&&ee.sane){Ye.msg="invalid distance too far back",ee.mode=30;break}Nt=wt>ee.wnext?(wt-=ee.wnext,ee.wsize-wt):ee.wnext-wt,wt>ee.length&&(wt=ee.length),Vt=ee.window}else Vt=Ot,Nt=Rt-ee.offset,wt=ee.length;for(Mt<wt&&(wt=Mt),Mt-=wt,ee.length-=wt;Ot[Rt++]=Vt[Nt++],--wt;);ee.length===0&&(ee.mode=21);break;case 26:if(Mt===0)break e;Ot[Rt++]=ee.length,Mt--,ee.mode=21;break;case 27:if(ee.wrap){for(;lt<32;){if(bt===0)break e;bt--,at|=pt[vt++]<<lt,lt+=8}if(At-=Mt,Ye.total_out+=At,ee.total+=At,At&&(Ye.adler=ee.check=ee.flags?c(ee.check,Ot,At,Rt-At):l(ee.check,Ot,At,Rt-At)),At=Mt,(ee.flags?at:Z(at))!==ee.check){Ye.msg="incorrect data check",ee.mode=30;break}lt=at=0}ee.mode=28;case 28:if(ee.wrap&&ee.flags){for(;lt<32;){if(bt===0)break e;bt--,at+=pt[vt++]<<lt,lt+=8}if(at!==(4294967295&ee.total)){Ye.msg="incorrect length check",ee.mode=30;break}lt=at=0}ee.mode=29;case 29:gt=1;break e;case 30:gt=-3;break e;case 31:return-4;case 32:default:return y}return Ye.next_out=Rt,Ye.avail_out=Mt,Ye.next_in=vt,Ye.avail_in=bt,ee.hold=at,ee.bits=lt,(ee.wsize||At!==Ye.avail_out&&ee.mode<30&&(ee.mode<27||ht!==4))&&mt(Ye,Ye.output,Ye.next_out,At-Ye.avail_out)?(ee.mode=31,-4):(_t-=Ye.avail_in,At-=Ye.avail_out,Ye.total_in+=_t,Ye.total_out+=At,ee.total+=At,ee.wrap&&At&&(Ye.adler=ee.check=ee.flags?c(ee.check,Ot,At,Ye.next_out-At):l(ee.check,Ot,At,Ye.next_out-At)),Ye.data_type=ee.bits+(ee.last?64:0)+(ee.mode===12?128:0)+(ee.mode===20||ee.mode===15?256:0),(_t==0&&At===0||ht===4)&&gt===g&&(gt=-5),gt)},o.inflateEnd=function(Ye){if(!Ye||!Ye.state)return y;var ht=Ye.state;return ht.window&&(ht.window=null),Ye.state=null,g},o.inflateGetHeader=function(Ye,ht){var ee;return Ye&&Ye.state?(2&(ee=Ye.state).wrap)==0?y:((ee.head=ht).done=!1,g):y},o.inflateSetDictionary=function(Ye,ht){var ee,pt=ht.length;return Ye&&Ye.state?(ee=Ye.state).wrap!==0&&ee.mode!==11?y:ee.mode===11&&l(1,ht,pt,0)!==ee.check?-3:mt(Ye,ht,pt,pt)?(ee.mode=31,-4):(ee.havedict=1,g):y},o.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,s,o){var a=n("../utils/common"),l=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],c=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],u=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],f=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];s.exports=function(d,p,g,y,x,E,Y,Z){var te,ne,Ve,me,rt,nt,ct,ot,ft,mt=Z.bits,Ye=0,ht=0,ee=0,pt=0,Ot=0,vt=0,Rt=0,bt=0,Mt=0,at=0,lt=null,_t=0,At=new a.Buf16(16),wt=new a.Buf16(16),Nt=null,Vt=0;for(Ye=0;Ye<=15;Ye++)At[Ye]=0;for(ht=0;ht<y;ht++)At[p[g+ht]]++;for(Ot=mt,pt=15;1<=pt&&At[pt]===0;pt--);if(pt<Ot&&(Ot=pt),pt===0)return x[E++]=20971520,x[E++]=20971520,Z.bits=1,0;for(ee=1;ee<pt&&At[ee]===0;ee++);for(Ot<ee&&(Ot=ee),Ye=bt=1;Ye<=15;Ye++)if(bt<<=1,(bt-=At[Ye])<0)return-1;if(0<bt&&(d===0||pt!==1))return-1;for(wt[1]=0,Ye=1;Ye<15;Ye++)wt[Ye+1]=wt[Ye]+At[Ye];for(ht=0;ht<y;ht++)p[g+ht]!==0&&(Y[wt[p[g+ht]]++]=ht);if(nt=d===0?(lt=Nt=Y,19):d===1?(lt=l,_t-=257,Nt=c,Vt-=257,256):(lt=u,Nt=f,-1),Ye=ee,rt=E,Rt=ht=at=0,Ve=-1,me=(Mt=1<<(vt=Ot))-1,d===1&&852<Mt||d===2&&592<Mt)return 1;for(;;){for(ct=Ye-Rt,ft=Y[ht]<nt?(ot=0,Y[ht]):Y[ht]>nt?(ot=Nt[Vt+Y[ht]],lt[_t+Y[ht]]):(ot=96,0),te=1<<Ye-Rt,ee=ne=1<<vt;x[rt+(at>>Rt)+(ne-=te)]=ct<<24|ot<<16|ft|0,ne!==0;);for(te=1<<Ye-1;at&te;)te>>=1;if(te!==0?(at&=te-1,at+=te):at=0,ht++,--At[Ye]==0){if(Ye===pt)break;Ye=p[g+Y[ht]]}if(Ot<Ye&&(at&me)!==Ve){for(Rt===0&&(Rt=Ot),rt+=ee,bt=1<<(vt=Ye-Rt);vt+Rt<pt&&!((bt-=At[vt+Rt])<=0);)vt++,bt<<=1;if(Mt+=1<<vt,d===1&&852<Mt||d===2&&592<Mt)return 1;x[Ve=at&me]=Ot<<24|vt<<16|rt-E|0}}return at!==0&&(x[rt+at]=Ye-Rt<<24|64<<16|0),Z.bits=Ot,0}},{"../utils/common":41}],51:[function(n,s,o){s.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,s,o){var a=n("../utils/common"),l=0,c=1;function u(et){for(var st=et.length;0<=--st;)et[st]=0}var f=0,d=29,p=256,g=p+1+d,y=30,x=19,E=2*g+1,Y=15,Z=16,te=7,ne=256,Ve=16,me=17,rt=18,nt=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],ct=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],ot=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],ft=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],mt=new Array(2*(g+2));u(mt);var Ye=new Array(2*y);u(Ye);var ht=new Array(512);u(ht);var ee=new Array(256);u(ee);var pt=new Array(d);u(pt);var Ot,vt,Rt,bt=new Array(y);function Mt(et,st,yt,St,ut){this.static_tree=et,this.extra_bits=st,this.extra_base=yt,this.elems=St,this.max_length=ut,this.has_stree=et&&et.length}function at(et,st){this.dyn_tree=et,this.max_code=0,this.stat_desc=st}function lt(et){return et<256?ht[et]:ht[256+(et>>>7)]}function _t(et,st){et.pending_buf[et.pending++]=255&st,et.pending_buf[et.pending++]=st>>>8&255}function At(et,st,yt){et.bi_valid>Z-yt?(et.bi_buf|=st<<et.bi_valid&65535,_t(et,et.bi_buf),et.bi_buf=st>>Z-et.bi_valid,et.bi_valid+=yt-Z):(et.bi_buf|=st<<et.bi_valid&65535,et.bi_valid+=yt)}function wt(et,st,yt){At(et,yt[2*st],yt[2*st+1])}function Nt(et,st){for(var yt=0;yt|=1&et,et>>>=1,yt<<=1,0<--st;);return yt>>>1}function Vt(et,st,yt){var St,ut,kt=new Array(Y+1),Et=0;for(St=1;St<=Y;St++)kt[St]=Et=Et+yt[St-1]<<1;for(ut=0;ut<=st;ut++){var xt=et[2*ut+1];xt!==0&&(et[2*ut]=Nt(kt[xt]++,xt))}}function $t(et){var st;for(st=0;st<g;st++)et.dyn_ltree[2*st]=0;for(st=0;st<y;st++)et.dyn_dtree[2*st]=0;for(st=0;st<x;st++)et.bl_tree[2*st]=0;et.dyn_ltree[2*ne]=1,et.opt_len=et.static_len=0,et.last_lit=et.matches=0}function Lt(et){8<et.bi_valid?_t(et,et.bi_buf):0<et.bi_valid&&(et.pending_buf[et.pending++]=et.bi_buf),et.bi_buf=0,et.bi_valid=0}function Ht(et,st,yt,St){var ut=2*st,kt=2*yt;return et[ut]<et[kt]||et[ut]===et[kt]&&St[st]<=St[yt]}function zt(et,st,yt){for(var St=et.heap[yt],ut=yt<<1;ut<=et.heap_len&&(ut<et.heap_len&&Ht(st,et.heap[ut+1],et.heap[ut],et.depth)&&ut++,!Ht(st,St,et.heap[ut],et.depth));)et.heap[yt]=et.heap[ut],yt=ut,ut<<=1;et.heap[yt]=St}function jt(et,st,yt){var St,ut,kt,Et,xt=0;if(et.last_lit!==0)for(;St=et.pending_buf[et.d_buf+2*xt]<<8|et.pending_buf[et.d_buf+2*xt+1],ut=et.pending_buf[et.l_buf+xt],xt++,St===0?wt(et,ut,st):(wt(et,(kt=ee[ut])+p+1,st),(Et=nt[kt])!==0&&At(et,ut-=pt[kt],Et),wt(et,kt=lt(--St),yt),(Et=ct[kt])!==0&&At(et,St-=bt[kt],Et)),xt<et.last_lit;);wt(et,ne,st)}function Gt(et,st){var yt,St,ut,kt=st.dyn_tree,Et=st.stat_desc.static_tree,xt=st.stat_desc.has_stree,Pt=st.stat_desc.elems,Bt=-1;for(et.heap_len=0,et.heap_max=E,yt=0;yt<Pt;yt++)kt[2*yt]!==0?(et.heap[++et.heap_len]=Bt=yt,et.depth[yt]=0):kt[2*yt+1]=0;for(;et.heap_len<2;)kt[2*(ut=et.heap[++et.heap_len]=Bt<2?++Bt:0)]=1,et.depth[ut]=0,et.opt_len--,xt&&(et.static_len-=Et[2*ut+1]);for(st.max_code=Bt,yt=et.heap_len>>1;1<=yt;yt--)zt(et,kt,yt);for(ut=Pt;yt=et.heap[1],et.heap[1]=et.heap[et.heap_len--],zt(et,kt,1),St=et.heap[1],et.heap[--et.heap_max]=yt,et.heap[--et.heap_max]=St,kt[2*ut]=kt[2*yt]+kt[2*St],et.depth[ut]=(et.depth[yt]>=et.depth[St]?et.depth[yt]:et.depth[St])+1,kt[2*yt+1]=kt[2*St+1]=ut,et.heap[1]=ut++,zt(et,kt,1),2<=et.heap_len;);et.heap[--et.heap_max]=et.heap[1],function(It,Yt){var on,Qt,nn,Ft,Xt,rn,en=Yt.dyn_tree,cn=Yt.max_code,yn=Yt.stat_desc.static_tree,hn=Yt.stat_desc.has_stree,un=Yt.stat_desc.extra_bits,mn=Yt.stat_desc.extra_base,tn=Yt.stat_desc.max_length,fn=0;for(Ft=0;Ft<=Y;Ft++)It.bl_count[Ft]=0;for(en[2*It.heap[It.heap_max]+1]=0,on=It.heap_max+1;on<E;on++)tn<(Ft=en[2*en[2*(Qt=It.heap[on])+1]+1]+1)&&(Ft=tn,fn++),en[2*Qt+1]=Ft,cn<Qt||(It.bl_count[Ft]++,Xt=0,mn<=Qt&&(Xt=un[Qt-mn]),rn=en[2*Qt],It.opt_len+=rn*(Ft+Xt),hn&&(It.static_len+=rn*(yn[2*Qt+1]+Xt)));if(fn!==0){do{for(Ft=tn-1;It.bl_count[Ft]===0;)Ft--;It.bl_count[Ft]--,It.bl_count[Ft+1]+=2,It.bl_count[tn]--,fn-=2}while(0<fn);for(Ft=tn;Ft!==0;Ft--)for(Qt=It.bl_count[Ft];Qt!==0;)cn<(nn=It.heap[--on])||(en[2*nn+1]!==Ft&&(It.opt_len+=(Ft-en[2*nn+1])*en[2*nn],en[2*nn+1]=Ft),Qt--)}}(et,st),Vt(kt,Bt,et.bl_count)}function G(et,st,yt){var St,ut,kt=-1,Et=st[1],xt=0,Pt=7,Bt=4;for(Et===0&&(Pt=138,Bt=3),st[2*(yt+1)+1]=65535,St=0;St<=yt;St++)ut=Et,Et=st[2*(St+1)+1],++xt<Pt&&ut===Et||(xt<Bt?et.bl_tree[2*ut]+=xt:ut!==0?(ut!==kt&&et.bl_tree[2*ut]++,et.bl_tree[2*Ve]++):xt<=10?et.bl_tree[2*me]++:et.bl_tree[2*rt]++,kt=ut,Bt=(xt=0)===Et?(Pt=138,3):ut===Et?(Pt=6,3):(Pt=7,4))}function gt(et,st,yt){var St,ut,kt=-1,Et=st[1],xt=0,Pt=7,Bt=4;for(Et===0&&(Pt=138,Bt=3),St=0;St<=yt;St++)if(ut=Et,Et=st[2*(St+1)+1],!(++xt<Pt&&ut===Et)){if(xt<Bt)for(;wt(et,ut,et.bl_tree),--xt!=0;);else ut!==0?(ut!==kt&&(wt(et,ut,et.bl_tree),xt--),wt(et,Ve,et.bl_tree),At(et,xt-3,2)):xt<=10?(wt(et,me,et.bl_tree),At(et,xt-3,3)):(wt(et,rt,et.bl_tree),At(et,xt-11,7));kt=ut,Bt=(xt=0)===Et?(Pt=138,3):ut===Et?(Pt=6,3):(Pt=7,4)}}u(bt);var dt=!1;function tt(et,st,yt,St){At(et,(f<<1)+(St?1:0),3),function(ut,kt,Et,xt){Lt(ut),_t(ut,Et),_t(ut,~Et),a.arraySet(ut.pending_buf,ut.window,kt,Et,ut.pending),ut.pending+=Et}(et,st,yt)}o._tr_init=function(et){dt||(function(){var st,yt,St,ut,kt,Et=new Array(Y+1);for(ut=St=0;ut<d-1;ut++)for(pt[ut]=St,st=0;st<1<<nt[ut];st++)ee[St++]=ut;for(ee[St-1]=ut,ut=kt=0;ut<16;ut++)for(bt[ut]=kt,st=0;st<1<<ct[ut];st++)ht[kt++]=ut;for(kt>>=7;ut<y;ut++)for(bt[ut]=kt<<7,st=0;st<1<<ct[ut]-7;st++)ht[256+kt++]=ut;for(yt=0;yt<=Y;yt++)Et[yt]=0;for(st=0;st<=143;)mt[2*st+1]=8,st++,Et[8]++;for(;st<=255;)mt[2*st+1]=9,st++,Et[9]++;for(;st<=279;)mt[2*st+1]=7,st++,Et[7]++;for(;st<=287;)mt[2*st+1]=8,st++,Et[8]++;for(Vt(mt,g+1,Et),st=0;st<y;st++)Ye[2*st+1]=5,Ye[2*st]=Nt(st,5);Ot=new Mt(mt,nt,p+1,g,Y),vt=new Mt(Ye,ct,0,y,Y),Rt=new Mt(new Array(0),ot,0,x,te)}(),dt=!0),et.l_desc=new at(et.dyn_ltree,Ot),et.d_desc=new at(et.dyn_dtree,vt),et.bl_desc=new at(et.bl_tree,Rt),et.bi_buf=0,et.bi_valid=0,$t(et)},o._tr_stored_block=tt,o._tr_flush_block=function(et,st,yt,St){var ut,kt,Et=0;0<et.level?(et.strm.data_type===2&&(et.strm.data_type=function(xt){var Pt,Bt=4093624447;for(Pt=0;Pt<=31;Pt++,Bt>>>=1)if(1&Bt&&xt.dyn_ltree[2*Pt]!==0)return l;if(xt.dyn_ltree[18]!==0||xt.dyn_ltree[20]!==0||xt.dyn_ltree[26]!==0)return c;for(Pt=32;Pt<p;Pt++)if(xt.dyn_ltree[2*Pt]!==0)return c;return l}(et)),Gt(et,et.l_desc),Gt(et,et.d_desc),Et=function(xt){var Pt;for(G(xt,xt.dyn_ltree,xt.l_desc.max_code),G(xt,xt.dyn_dtree,xt.d_desc.max_code),Gt(xt,xt.bl_desc),Pt=x-1;3<=Pt&&xt.bl_tree[2*ft[Pt]+1]===0;Pt--);return xt.opt_len+=3*(Pt+1)+5+5+4,Pt}(et),ut=et.opt_len+3+7>>>3,(kt=et.static_len+3+7>>>3)<=ut&&(ut=kt)):ut=kt=yt+5,yt+4<=ut&&st!==-1?tt(et,st,yt,St):et.strategy===4||kt===ut?(At(et,2+(St?1:0),3),jt(et,mt,Ye)):(At(et,4+(St?1:0),3),function(xt,Pt,Bt,It){var Yt;for(At(xt,Pt-257,5),At(xt,Bt-1,5),At(xt,It-4,4),Yt=0;Yt<It;Yt++)At(xt,xt.bl_tree[2*ft[Yt]+1],3);gt(xt,xt.dyn_ltree,Pt-1),gt(xt,xt.dyn_dtree,Bt-1)}(et,et.l_desc.max_code+1,et.d_desc.max_code+1,Et+1),jt(et,et.dyn_ltree,et.dyn_dtree)),$t(et),St&&Lt(et)},o._tr_tally=function(et,st,yt){return et.pending_buf[et.d_buf+2*et.last_lit]=st>>>8&255,et.pending_buf[et.d_buf+2*et.last_lit+1]=255&st,et.pending_buf[et.l_buf+et.last_lit]=255&yt,et.last_lit++,st===0?et.dyn_ltree[2*yt]++:(et.matches++,st--,et.dyn_ltree[2*(ee[yt]+p+1)]++,et.dyn_dtree[2*lt(st)]++),et.last_lit===et.lit_bufsize-1},o._tr_align=function(et){At(et,2,3),wt(et,ne,mt),function(st){st.bi_valid===16?(_t(st,st.bi_buf),st.bi_buf=0,st.bi_valid=0):8<=st.bi_valid&&(st.pending_buf[st.pending++]=255&st.bi_buf,st.bi_buf>>=8,st.bi_valid-=8)}(et)}},{"../utils/common":41}],53:[function(n,s,o){s.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,s,o){(function(a){(function(l,c){if(!l.setImmediate){var u,f,d,p,g=1,y={},x=!1,E=l.document,Y=Object.getPrototypeOf&&Object.getPrototypeOf(l);Y=Y&&Y.setTimeout?Y:l,u={}.toString.call(l.process)==="[object process]"?function(Ve){process.nextTick(function(){te(Ve)})}:function(){if(l.postMessage&&!l.importScripts){var Ve=!0,me=l.onmessage;return l.onmessage=function(){Ve=!1},l.postMessage("","*"),l.onmessage=me,Ve}}()?(p="setImmediate$"+Math.random()+"$",l.addEventListener?l.addEventListener("message",ne,!1):l.attachEvent("onmessage",ne),function(Ve){l.postMessage(p+Ve,"*")}):l.MessageChannel?((d=new MessageChannel).port1.onmessage=function(Ve){te(Ve.data)},function(Ve){d.port2.postMessage(Ve)}):E&&"onreadystatechange"in E.createElement("script")?(f=E.documentElement,function(Ve){var me=E.createElement("script");me.onreadystatechange=function(){te(Ve),me.onreadystatechange=null,f.removeChild(me),me=null},f.appendChild(me)}):function(Ve){setTimeout(te,0,Ve)},Y.setImmediate=function(Ve){typeof Ve!="function"&&(Ve=new Function(""+Ve));for(var me=new Array(arguments.length-1),rt=0;rt<me.length;rt++)me[rt]=arguments[rt+1];var nt={callback:Ve,args:me};return y[g]=nt,u(g),g++},Y.clearImmediate=Z}function Z(Ve){delete y[Ve]}function te(Ve){if(x)setTimeout(te,0,Ve);else{var me=y[Ve];if(me){x=!0;try{(function(rt){var nt=rt.callback,ct=rt.args;switch(ct.length){case 0:nt();break;case 1:nt(ct[0]);break;case 2:nt(ct[0],ct[1]);break;case 3:nt(ct[0],ct[1],ct[2]);break;default:nt.apply(c,ct)}})(me)}finally{Z(Ve),x=!1}}}}function ne(Ve){Ve.source===l&&typeof Ve.data=="string"&&Ve.data.indexOf(p)===0&&te(+Ve.data.slice(p.length))}})(typeof self>"u"?a===void 0?this:a:self)}).call(this,typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}(jszip_min)),jszip_min.exports}var jszip_minExports=requireJszip_min();const JSZip=getDefaultExportFromCjs(jszip_minExports);var _tmpl$$a=template("<svg stroke-width=0>");function IconTemplate(r,e){const n=mergeProps(r.a,e),[s,o]=splitProps(n,["src"]),[a,l]=createSignal(""),c=createMemo(()=>e.title?`${r.c}<title>${e.title}</title>`:r.c);return createEffect(()=>l(c())),onCleanup(()=>{l("")}),(()=>{var u=_tmpl$$a();return spread(u,mergeProps({get stroke(){return r.a?.stroke},get color(){return e.color||"currentColor"},get fill(){return e.color||"currentColor"},get style(){return{...e.style,overflow:"visible"}}},o,{get height(){return e.size||"1em"},get width(){return e.size||"1em"},xmlns:"http://www.w3.org/2000/svg",get innerHTML(){return a()}}),!0,!0),insert$1(u,()=>isServer),u})()}function TbFileZip(r){return IconTemplate({a:{xmlns:"http://www.w3.org/2000/svg",class:"icon icon-tabler icon-tabler-file-zip",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},c:'<path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 20.735a2 2 0 0 1 -1 -1.735v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2h-1"/><path d="M11 17a2 2 0 0 1 2 2v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1v-2a2 2 0 0 1 2 -2z"/><path d="M11 5l-1 0"/><path d="M13 7l-1 0"/><path d="M11 9l-1 0"/><path d="M13 11l-1 0"/><path d="M11 13l-1 0"/><path d="M13 15l-1 0"/>'},r)}function TbPlus(r){return IconTemplate({a:{xmlns:"http://www.w3.org/2000/svg",class:"icon icon-tabler icon-tabler-plus",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},c:'<path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 5l0 14"/><path d="M5 12l14 0"/>'},r)}function TbTrash(r){return IconTemplate({a:{xmlns:"http://www.w3.org/2000/svg",class:"icon icon-tabler icon-tabler-trash",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},c:'<path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 7l16 0"/><path d="M10 11l0 6"/><path d="M14 11l0 6"/><path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12"/><path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3"/>'},r)}function TbUpload(r){return IconTemplate({a:{xmlns:"http://www.w3.org/2000/svg",class:"icon icon-tabler icon-tabler-upload",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},c:'<path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2"/><path d="M7 9l5 -5l5 5"/><path d="M12 4l0 12"/>'},r)}var _tmpl$$9=template("<select><optgroup>"),_tmpl$2$6=template("<option>"),_tmpl$3$5=template('<button class="btn-danger btn-small">'),_tmpl$4$2=template('<div class=e-hd><div class=e-hd-left><input type=text class="e-hd-left-input is-mono"placeholder="Filename including extension..."></div><div class=e-hd-right>');const Select=r=>{const[e,n]=splitProps(r,["groupName","options","value","onChange"]);return(()=>{var s=_tmpl$$9(),o=s.firstChild;return spread(s,mergeProps(n,{get value(){return e.value},onChange:a=>e.onChange(a.currentTarget.value)}),!1,!0),insert$1(o,createComponent(For,{get each(){return e.options},children:a=>(()=>{var l=_tmpl$2$6();return insert$1(l,()=>a.label),createRenderEffect(()=>l.selected=a.value===e.value),createRenderEffect(()=>l.value=a.value),l})()})),createRenderEffect(()=>setAttribute(o,"label",e.groupName)),s})()},indentModeOptions=[{value:"space",label:"Space"},{value:"tab",label:"Tab"}],indentSizeOptions=[{value:"2",label:"2"},{value:"4",label:"4"},{value:"8",label:"8"}],wrapModeOptions=[{value:"wrap",label:"Wrap"},{value:"no-wrap",label:"No wrap"}],EditorHeader=r=>(()=>{var e=_tmpl$4$2(),n=e.firstChild,s=n.firstChild,o=n.nextSibling;return s.addEventListener("change",a=>r.onChange({filename:a.currentTarget.value})),insert$1(n,createComponent(Show,{get when(){return r.onDelete},get children(){var a=_tmpl$3$5();return addEventListener(a,"click",r.onDelete,!0),insert$1(a,createComponent(TbTrash,{})),a}}),null),insert$1(o,createComponent(Select,{groupName:"Indent Mode",options:indentModeOptions,get value(){return r.opts.indentMode},onChange:a=>r.onChange({indentMode:a})}),null),insert$1(o,createComponent(Select,{groupName:"Indent Size",options:indentSizeOptions,get value(){return""+r.opts.indentSize},onChange:a=>r.onChange({indentSize:parseInt(a)})}),null),insert$1(o,createComponent(Select,{groupName:"Wrap Mode",options:wrapModeOptions,get value(){return r.opts.wrapMode?"wrap":"no-wrap"},onChange:a=>r.onChange({wrapMode:a==="wrap"})}),null),createRenderEffect(()=>s.value=r.opts.filename),e})();delegateEvents(["click"]);let rangeFrom=[],rangeTo=[];(()=>{let r="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(e=>e?parseInt(e,36):1);for(let e=0,n=0;e<r.length;e++)(e%2?rangeTo:rangeFrom).push(n=n+r[e])})();function isExtendingChar(r){if(r<768)return!1;for(let e=0,n=rangeFrom.length;;){let s=e+n>>1;if(r<rangeFrom[s])n=s;else if(r>=rangeTo[s])e=s+1;else return!0;if(e==n)return!1}}function isRegionalIndicator(r){return r>=127462&&r<=127487}const ZWJ=8205;function findClusterBreak$1(r,e,n=!0,s=!0){return(n?nextClusterBreak:prevClusterBreak)(r,e,s)}function nextClusterBreak(r,e,n){if(e==r.length)return e;e&&surrogateLow$1(r.charCodeAt(e))&&surrogateHigh$1(r.charCodeAt(e-1))&&e--;let s=codePointAt$1(r,e);for(e+=codePointSize$1(s);e<r.length;){let o=codePointAt$1(r,e);if(s==ZWJ||o==ZWJ||n&&isExtendingChar(o))e+=codePointSize$1(o),s=o;else if(isRegionalIndicator(o)){let a=0,l=e-2;for(;l>=0&&isRegionalIndicator(codePointAt$1(r,l));)a++,l-=2;if(a%2==0)break;e+=2}else break}return e}function prevClusterBreak(r,e,n){for(;e>0;){let s=nextClusterBreak(r,e-2,n);if(s<e)return s;e--}return 0}function codePointAt$1(r,e){let n=r.charCodeAt(e);if(!surrogateHigh$1(n)||e+1==r.length)return n;let s=r.charCodeAt(e+1);return surrogateLow$1(s)?(n-55296<<10)+(s-56320)+65536:n}function surrogateLow$1(r){return r>=56320&&r<57344}function surrogateHigh$1(r){return r>=55296&&r<56320}function codePointSize$1(r){return r<65536?1:2}class Text{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,n,s){[e,n]=clip(this,e,n);let o=[];return this.decompose(0,e,o,2),s.length&&s.decompose(0,s.length,o,3),this.decompose(n,this.length,o,1),TextNode.from(o,this.length-(n-e)+s.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,n=this.length){[e,n]=clip(this,e,n);let s=[];return this.decompose(e,n,s,0),TextNode.from(s,n-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let n=this.scanIdentical(e,1),s=this.length-this.scanIdentical(e,-1),o=new RawTextCursor(this),a=new RawTextCursor(e);for(let l=n,c=n;;){if(o.next(l),a.next(l),l=0,o.lineBreak!=a.lineBreak||o.done!=a.done||o.value!=a.value)return!1;if(c+=o.value.length,o.done||c>=s)return!0}}iter(e=1){return new RawTextCursor(this,e)}iterRange(e,n=this.length){return new PartialTextCursor(this,e,n)}iterLines(e,n){let s;if(e==null)s=this.iter();else{n==null&&(n=this.lines+1);let o=this.line(e).from;s=this.iterRange(o,Math.max(o,n==this.lines+1?this.length:n<=1?0:this.line(n-1).to))}return new LineCursor(s)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?Text.empty:e.length<=32?new TextLeaf(e):TextNode.from(TextLeaf.split(e,[]))}}class TextLeaf extends Text{constructor(e,n=textLength(e)){super(),this.text=e,this.length=n}get lines(){return this.text.length}get children(){return null}lineInner(e,n,s,o){for(let a=0;;a++){let l=this.text[a],c=o+l.length;if((n?s:c)>=e)return new Line(o,c,s,l);o=c+1,s++}}decompose(e,n,s,o){let a=e<=0&&n>=this.length?this:new TextLeaf(sliceText(this.text,e,n),Math.min(n,this.length)-Math.max(0,e));if(o&1){let l=s.pop(),c=appendText(a.text,l.text.slice(),0,a.length);if(c.length<=32)s.push(new TextLeaf(c,l.length+a.length));else{let u=c.length>>1;s.push(new TextLeaf(c.slice(0,u)),new TextLeaf(c.slice(u)))}}else s.push(a)}replace(e,n,s){if(!(s instanceof TextLeaf))return super.replace(e,n,s);[e,n]=clip(this,e,n);let o=appendText(this.text,appendText(s.text,sliceText(this.text,0,e)),n),a=this.length+s.length-(n-e);return o.length<=32?new TextLeaf(o,a):TextNode.from(TextLeaf.split(o,[]),a)}sliceString(e,n=this.length,s=`
`){[e,n]=clip(this,e,n);let o="";for(let a=0,l=0;a<=n&&l<this.text.length;l++){let c=this.text[l],u=a+c.length;a>e&&l&&(o+=s),e<u&&n>a&&(o+=c.slice(Math.max(0,e-a),n-a)),a=u+1}return o}flatten(e){for(let n of this.text)e.push(n)}scanIdentical(){return 0}static split(e,n){let s=[],o=-1;for(let a of e)s.push(a),o+=a.length+1,s.length==32&&(n.push(new TextLeaf(s,o)),s=[],o=-1);return o>-1&&n.push(new TextLeaf(s,o)),n}}class TextNode extends Text{constructor(e,n){super(),this.children=e,this.length=n,this.lines=0;for(let s of e)this.lines+=s.lines}lineInner(e,n,s,o){for(let a=0;;a++){let l=this.children[a],c=o+l.length,u=s+l.lines-1;if((n?u:c)>=e)return l.lineInner(e,n,s,o);o=c+1,s=u+1}}decompose(e,n,s,o){for(let a=0,l=0;l<=n&&a<this.children.length;a++){let c=this.children[a],u=l+c.length;if(e<=u&&n>=l){let f=o&((l<=e?1:0)|(u>=n?2:0));l>=e&&u<=n&&!f?s.push(c):c.decompose(e-l,n-l,s,f)}l=u+1}}replace(e,n,s){if([e,n]=clip(this,e,n),s.lines<this.lines)for(let o=0,a=0;o<this.children.length;o++){let l=this.children[o],c=a+l.length;if(e>=a&&n<=c){let u=l.replace(e-a,n-a,s),f=this.lines-l.lines+u.lines;if(u.lines<f>>4&&u.lines>f>>6){let d=this.children.slice();return d[o]=u,new TextNode(d,this.length-(n-e)+s.length)}return super.replace(a,c,u)}a=c+1}return super.replace(e,n,s)}sliceString(e,n=this.length,s=`
`){[e,n]=clip(this,e,n);let o="";for(let a=0,l=0;a<this.children.length&&l<=n;a++){let c=this.children[a],u=l+c.length;l>e&&a&&(o+=s),e<u&&n>l&&(o+=c.sliceString(e-l,n-l,s)),l=u+1}return o}flatten(e){for(let n of this.children)n.flatten(e)}scanIdentical(e,n){if(!(e instanceof TextNode))return 0;let s=0,[o,a,l,c]=n>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;o+=n,a+=n){if(o==l||a==c)return s;let u=this.children[o],f=e.children[a];if(u!=f)return s+u.scanIdentical(f,n);s+=u.length+1}}static from(e,n=e.reduce((s,o)=>s+o.length+1,-1)){let s=0;for(let y of e)s+=y.lines;if(s<32){let y=[];for(let x of e)x.flatten(y);return new TextLeaf(y,n)}let o=Math.max(32,s>>5),a=o<<1,l=o>>1,c=[],u=0,f=-1,d=[];function p(y){let x;if(y.lines>a&&y instanceof TextNode)for(let E of y.children)p(E);else y.lines>l&&(u>l||!u)?(g(),c.push(y)):y instanceof TextLeaf&&u&&(x=d[d.length-1])instanceof TextLeaf&&y.lines+x.lines<=32?(u+=y.lines,f+=y.length+1,d[d.length-1]=new TextLeaf(x.text.concat(y.text),x.length+1+y.length)):(u+y.lines>o&&g(),u+=y.lines,f+=y.length+1,d.push(y))}function g(){u!=0&&(c.push(d.length==1?d[0]:TextNode.from(d,f)),f=-1,u=d.length=0)}for(let y of e)p(y);return g(),c.length==1?c[0]:new TextNode(c,n)}}Text.empty=new TextLeaf([""],0);function textLength(r){let e=-1;for(let n of r)e+=n.length+1;return e}function appendText(r,e,n=0,s=1e9){for(let o=0,a=0,l=!0;a<r.length&&o<=s;a++){let c=r[a],u=o+c.length;u>=n&&(u>s&&(c=c.slice(0,s-o)),o<n&&(c=c.slice(n-o)),l?(e[e.length-1]+=c,l=!1):e.push(c)),o=u+1}return e}function sliceText(r,e,n){return appendText(r,[""],e,n)}class RawTextCursor{constructor(e,n=1){this.dir=n,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[n>0?1:(e instanceof TextLeaf?e.text.length:e.children.length)<<1]}nextInner(e,n){for(this.done=this.lineBreak=!1;;){let s=this.nodes.length-1,o=this.nodes[s],a=this.offsets[s],l=a>>1,c=o instanceof TextLeaf?o.text.length:o.children.length;if(l==(n>0?c:0)){if(s==0)return this.done=!0,this.value="",this;n>0&&this.offsets[s-1]++,this.nodes.pop(),this.offsets.pop()}else if((a&1)==(n>0?0:1)){if(this.offsets[s]+=n,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(o instanceof TextLeaf){let u=o.text[l+(n<0?-1:0)];if(this.offsets[s]+=n,u.length>Math.max(0,e))return this.value=e==0?u:n>0?u.slice(e):u.slice(0,u.length-e),this;e-=u.length}else{let u=o.children[l+(n<0?-1:0)];e>u.length?(e-=u.length,this.offsets[s]+=n):(n<0&&this.offsets[s]--,this.nodes.push(u),this.offsets.push(n>0?1:(u instanceof TextLeaf?u.text.length:u.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class PartialTextCursor{constructor(e,n,s){this.value="",this.done=!1,this.cursor=new RawTextCursor(e,n>s?-1:1),this.pos=n>s?e.length:0,this.from=Math.min(n,s),this.to=Math.max(n,s)}nextInner(e,n){if(n<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,n<0?this.pos-this.to:this.from-this.pos);let s=n<0?this.pos-this.from:this.to-this.pos;e>s&&(e=s),s-=e;let{value:o}=this.cursor.next(e);return this.pos+=(o.length+e)*n,this.value=o.length<=s?o:n<0?o.slice(o.length-s):o.slice(0,s),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class LineCursor{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:n,lineBreak:s,value:o}=this.inner.next(e);return n&&this.afterBreak?(this.value="",this.afterBreak=!1):n?(this.done=!0,this.value=""):s?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=o,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(Text.prototype[Symbol.iterator]=function(){return this.iter()},RawTextCursor.prototype[Symbol.iterator]=PartialTextCursor.prototype[Symbol.iterator]=LineCursor.prototype[Symbol.iterator]=function(){return this});class Line{constructor(e,n,s,o){this.from=e,this.to=n,this.number=s,this.text=o}get length(){return this.to-this.from}}function clip(r,e,n){return e=Math.max(0,Math.min(r.length,e)),[e,Math.max(e,Math.min(r.length,n))]}function findClusterBreak(r,e,n=!0,s=!0){return findClusterBreak$1(r,e,n,s)}function surrogateLow(r){return r>=56320&&r<57344}function surrogateHigh(r){return r>=55296&&r<56320}function codePointAt(r,e){let n=r.charCodeAt(e);if(!surrogateHigh(n)||e+1==r.length)return n;let s=r.charCodeAt(e+1);return surrogateLow(s)?(n-55296<<10)+(s-56320)+65536:n}function fromCodePoint(r){return r<=65535?String.fromCharCode(r):(r-=65536,String.fromCharCode((r>>10)+55296,(r&1023)+56320))}function codePointSize(r){return r<65536?1:2}const DefaultSplit=/\r\n?|\n/;var MapMode=function(r){return r[r.Simple=0]="Simple",r[r.TrackDel=1]="TrackDel",r[r.TrackBefore=2]="TrackBefore",r[r.TrackAfter=3]="TrackAfter",r}(MapMode||(MapMode={}));class ChangeDesc{constructor(e){this.sections=e}get length(){let e=0;for(let n=0;n<this.sections.length;n+=2)e+=this.sections[n];return e}get newLength(){let e=0;for(let n=0;n<this.sections.length;n+=2){let s=this.sections[n+1];e+=s<0?this.sections[n]:s}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let n=0,s=0,o=0;n<this.sections.length;){let a=this.sections[n++],l=this.sections[n++];l<0?(e(s,o,a),o+=a):o+=l,s+=a}}iterChangedRanges(e,n=!1){iterChanges(this,e,n)}get invertedDesc(){let e=[];for(let n=0;n<this.sections.length;){let s=this.sections[n++],o=this.sections[n++];o<0?e.push(s,o):e.push(o,s)}return new ChangeDesc(e)}composeDesc(e){return this.empty?e:e.empty?this:composeSets(this,e)}mapDesc(e,n=!1){return e.empty?this:mapSet(this,e,n)}mapPos(e,n=-1,s=MapMode.Simple){let o=0,a=0;for(let l=0;l<this.sections.length;){let c=this.sections[l++],u=this.sections[l++],f=o+c;if(u<0){if(f>e)return a+(e-o);a+=c}else{if(s!=MapMode.Simple&&f>=e&&(s==MapMode.TrackDel&&o<e&&f>e||s==MapMode.TrackBefore&&o<e||s==MapMode.TrackAfter&&f>e))return null;if(f>e||f==e&&n<0&&!c)return e==o||n<0?a:a+u;a+=u}o=f}if(e>o)throw new RangeError(`Position ${e} is out of range for changeset of length ${o}`);return a}touchesRange(e,n=e){for(let s=0,o=0;s<this.sections.length&&o<=n;){let a=this.sections[s++],l=this.sections[s++],c=o+a;if(l>=0&&o<=n&&c>=e)return o<e&&c>n?"cover":!0;o=c}return!1}toString(){let e="";for(let n=0;n<this.sections.length;){let s=this.sections[n++],o=this.sections[n++];e+=(e?" ":"")+s+(o>=0?":"+o:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(n=>typeof n!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new ChangeDesc(e)}static create(e){return new ChangeDesc(e)}}class ChangeSet extends ChangeDesc{constructor(e,n){super(e),this.inserted=n}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return iterChanges(this,(n,s,o,a,l)=>e=e.replace(o,o+(s-n),l),!1),e}mapDesc(e,n=!1){return mapSet(this,e,n,!0)}invert(e){let n=this.sections.slice(),s=[];for(let o=0,a=0;o<n.length;o+=2){let l=n[o],c=n[o+1];if(c>=0){n[o]=c,n[o+1]=l;let u=o>>1;for(;s.length<u;)s.push(Text.empty);s.push(l?e.slice(a,a+l):Text.empty)}a+=l}return new ChangeSet(n,s)}compose(e){return this.empty?e:e.empty?this:composeSets(this,e,!0)}map(e,n=!1){return e.empty?this:mapSet(this,e,n,!0)}iterChanges(e,n=!1){iterChanges(this,e,n)}get desc(){return ChangeDesc.create(this.sections)}filter(e){let n=[],s=[],o=[],a=new SectionIter(this);e:for(let l=0,c=0;;){let u=l==e.length?1e9:e[l++];for(;c<u||c==u&&a.len==0;){if(a.done)break e;let d=Math.min(a.len,u-c);addSection(o,d,-1);let p=a.ins==-1?-1:a.off==0?a.ins:0;addSection(n,d,p),p>0&&addInsert(s,n,a.text),a.forward(d),c+=d}let f=e[l++];for(;c<f;){if(a.done)break e;let d=Math.min(a.len,f-c);addSection(n,d,-1),addSection(o,d,a.ins==-1?-1:a.off==0?a.ins:0),a.forward(d),c+=d}}return{changes:new ChangeSet(n,s),filtered:ChangeDesc.create(o)}}toJSON(){let e=[];for(let n=0;n<this.sections.length;n+=2){let s=this.sections[n],o=this.sections[n+1];o<0?e.push(s):o==0?e.push([s]):e.push([s].concat(this.inserted[n>>1].toJSON()))}return e}static of(e,n,s){let o=[],a=[],l=0,c=null;function u(d=!1){if(!d&&!o.length)return;l<n&&addSection(o,n-l,-1);let p=new ChangeSet(o,a);c=c?c.compose(p.map(c)):p,o=[],a=[],l=0}function f(d){if(Array.isArray(d))for(let p of d)f(p);else if(d instanceof ChangeSet){if(d.length!=n)throw new RangeError(`Mismatched change set length (got ${d.length}, expected ${n})`);u(),c=c?c.compose(d.map(c)):d}else{let{from:p,to:g=p,insert:y}=d;if(p>g||p<0||g>n)throw new RangeError(`Invalid change range ${p} to ${g} (in doc of length ${n})`);let x=y?typeof y=="string"?Text.of(y.split(s||DefaultSplit)):y:Text.empty,E=x.length;if(p==g&&E==0)return;p<l&&u(),p>l&&addSection(o,p-l,-1),addSection(o,g-p,E),addInsert(a,o,x),l=g}}return f(e),u(!c),c}static empty(e){return new ChangeSet(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let n=[],s=[];for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")n.push(a,-1);else{if(!Array.isArray(a)||typeof a[0]!="number"||a.some((l,c)=>c&&typeof l!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(a.length==1)n.push(a[0],0);else{for(;s.length<o;)s.push(Text.empty);s[o]=Text.of(a.slice(1)),n.push(a[0],s[o].length)}}}return new ChangeSet(n,s)}static createSet(e,n){return new ChangeSet(e,n)}}function addSection(r,e,n,s=!1){if(e==0&&n<=0)return;let o=r.length-2;o>=0&&n<=0&&n==r[o+1]?r[o]+=e:o>=0&&e==0&&r[o]==0?r[o+1]+=n:s?(r[o]+=e,r[o+1]+=n):r.push(e,n)}function addInsert(r,e,n){if(n.length==0)return;let s=e.length-2>>1;if(s<r.length)r[r.length-1]=r[r.length-1].append(n);else{for(;r.length<s;)r.push(Text.empty);r.push(n)}}function iterChanges(r,e,n){let s=r.inserted;for(let o=0,a=0,l=0;l<r.sections.length;){let c=r.sections[l++],u=r.sections[l++];if(u<0)o+=c,a+=c;else{let f=o,d=a,p=Text.empty;for(;f+=c,d+=u,u&&s&&(p=p.append(s[l-2>>1])),!(n||l==r.sections.length||r.sections[l+1]<0);)c=r.sections[l++],u=r.sections[l++];e(o,f,a,d,p),o=f,a=d}}}function mapSet(r,e,n,s=!1){let o=[],a=s?[]:null,l=new SectionIter(r),c=new SectionIter(e);for(let u=-1;;){if(l.done&&c.len||c.done&&l.len)throw new Error("Mismatched change set lengths");if(l.ins==-1&&c.ins==-1){let f=Math.min(l.len,c.len);addSection(o,f,-1),l.forward(f),c.forward(f)}else if(c.ins>=0&&(l.ins<0||u==l.i||l.off==0&&(c.len<l.len||c.len==l.len&&!n))){let f=c.len;for(addSection(o,c.ins,-1);f;){let d=Math.min(l.len,f);l.ins>=0&&u<l.i&&l.len<=d&&(addSection(o,0,l.ins),a&&addInsert(a,o,l.text),u=l.i),l.forward(d),f-=d}c.next()}else if(l.ins>=0){let f=0,d=l.len;for(;d;)if(c.ins==-1){let p=Math.min(d,c.len);f+=p,d-=p,c.forward(p)}else if(c.ins==0&&c.len<d)d-=c.len,c.next();else break;addSection(o,f,u<l.i?l.ins:0),a&&u<l.i&&addInsert(a,o,l.text),u=l.i,l.forward(l.len-d)}else{if(l.done&&c.done)return a?ChangeSet.createSet(o,a):ChangeDesc.create(o);throw new Error("Mismatched change set lengths")}}}function composeSets(r,e,n=!1){let s=[],o=n?[]:null,a=new SectionIter(r),l=new SectionIter(e);for(let c=!1;;){if(a.done&&l.done)return o?ChangeSet.createSet(s,o):ChangeDesc.create(s);if(a.ins==0)addSection(s,a.len,0,c),a.next();else if(l.len==0&&!l.done)addSection(s,0,l.ins,c),o&&addInsert(o,s,l.text),l.next();else{if(a.done||l.done)throw new Error("Mismatched change set lengths");{let u=Math.min(a.len2,l.len),f=s.length;if(a.ins==-1){let d=l.ins==-1?-1:l.off?0:l.ins;addSection(s,u,d,c),o&&d&&addInsert(o,s,l.text)}else l.ins==-1?(addSection(s,a.off?0:a.len,u,c),o&&addInsert(o,s,a.textBit(u))):(addSection(s,a.off?0:a.len,l.off?0:l.ins,c),o&&!l.off&&addInsert(o,s,l.text));c=(a.ins>u||l.ins>=0&&l.len>u)&&(c||s.length>f),a.forward2(u),l.forward(u)}}}}class SectionIter{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,n=this.i-2>>1;return n>=e.length?Text.empty:e[n]}textBit(e){let{inserted:n}=this.set,s=this.i-2>>1;return s>=n.length&&!e?Text.empty:n[s].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class SelectionRange{constructor(e,n,s){this.from=e,this.to=n,this.flags=s}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,n=-1){let s,o;return this.empty?s=o=e.mapPos(this.from,n):(s=e.mapPos(this.from,1),o=e.mapPos(this.to,-1)),s==this.from&&o==this.to?this:new SelectionRange(s,o,this.flags)}extend(e,n=e){if(e<=this.anchor&&n>=this.anchor)return EditorSelection.range(e,n);let s=Math.abs(e-this.anchor)>Math.abs(n-this.anchor)?e:n;return EditorSelection.range(this.anchor,s)}eq(e,n=!1){return this.anchor==e.anchor&&this.head==e.head&&(!n||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return EditorSelection.range(e.anchor,e.head)}static create(e,n,s){return new SelectionRange(e,n,s)}}class EditorSelection{constructor(e,n){this.ranges=e,this.mainIndex=n}map(e,n=-1){return e.empty?this:EditorSelection.create(this.ranges.map(s=>s.map(e,n)),this.mainIndex)}eq(e,n=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let s=0;s<this.ranges.length;s++)if(!this.ranges[s].eq(e.ranges[s],n))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new EditorSelection([this.main],0)}addRange(e,n=!0){return EditorSelection.create([e].concat(this.ranges),n?0:this.mainIndex+1)}replaceRange(e,n=this.mainIndex){let s=this.ranges.slice();return s[n]=e,EditorSelection.create(s,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new EditorSelection(e.ranges.map(n=>SelectionRange.fromJSON(n)),e.main)}static single(e,n=e){return new EditorSelection([EditorSelection.range(e,n)],0)}static create(e,n=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let s=0,o=0;o<e.length;o++){let a=e[o];if(a.empty?a.from<=s:a.from<s)return EditorSelection.normalized(e.slice(),n);s=a.to}return new EditorSelection(e,n)}static cursor(e,n=0,s,o){return SelectionRange.create(e,e,(n==0?0:n<0?8:16)|(s==null?7:Math.min(6,s))|(o??16777215)<<6)}static range(e,n,s,o){let a=(s??16777215)<<6|(o==null?7:Math.min(6,o));return n<e?SelectionRange.create(n,e,48|a):SelectionRange.create(e,n,(n>e?8:0)|a)}static normalized(e,n=0){let s=e[n];e.sort((o,a)=>o.from-a.from),n=e.indexOf(s);for(let o=1;o<e.length;o++){let a=e[o],l=e[o-1];if(a.empty?a.from<=l.to:a.from<l.to){let c=l.from,u=Math.max(a.to,l.to);o<=n&&n--,e.splice(--o,2,a.anchor>a.head?EditorSelection.range(u,c):EditorSelection.range(c,u))}}return new EditorSelection(e,n)}}function checkSelection(r,e){for(let n of r.ranges)if(n.to>e)throw new RangeError("Selection points outside of document")}let nextID=0;class Facet{constructor(e,n,s,o,a){this.combine=e,this.compareInput=n,this.compare=s,this.isStatic=o,this.id=nextID++,this.default=e([]),this.extensions=typeof a=="function"?a(this):a}get reader(){return this}static define(e={}){return new Facet(e.combine||(n=>n),e.compareInput||((n,s)=>n===s),e.compare||(e.combine?(n,s)=>n===s:sameArray$1),!!e.static,e.enables)}of(e){return new FacetProvider([],this,0,e)}compute(e,n){if(this.isStatic)throw new Error("Can't compute a static facet");return new FacetProvider(e,this,1,n)}computeN(e,n){if(this.isStatic)throw new Error("Can't compute a static facet");return new FacetProvider(e,this,2,n)}from(e,n){return n||(n=s=>s),this.compute([e],s=>n(s.field(e)))}}function sameArray$1(r,e){return r==e||r.length==e.length&&r.every((n,s)=>n===e[s])}class FacetProvider{constructor(e,n,s,o){this.dependencies=e,this.facet=n,this.type=s,this.value=o,this.id=nextID++}dynamicSlot(e){var n;let s=this.value,o=this.facet.compareInput,a=this.id,l=e[a]>>1,c=this.type==2,u=!1,f=!1,d=[];for(let p of this.dependencies)p=="doc"?u=!0:p=="selection"?f=!0:(((n=e[p.id])!==null&&n!==void 0?n:1)&1)==0&&d.push(e[p.id]);return{create(p){return p.values[l]=s(p),1},update(p,g){if(u&&g.docChanged||f&&(g.docChanged||g.selection)||ensureAll(p,d)){let y=s(p);if(c?!compareArray(y,p.values[l],o):!o(y,p.values[l]))return p.values[l]=y,1}return 0},reconfigure:(p,g)=>{let y,x=g.config.address[a];if(x!=null){let E=getAddr(g,x);if(this.dependencies.every(Y=>Y instanceof Facet?g.facet(Y)===p.facet(Y):Y instanceof StateField?g.field(Y,!1)==p.field(Y,!1):!0)||(c?compareArray(y=s(p),E,o):o(y=s(p),E)))return p.values[l]=E,0}else y=s(p);return p.values[l]=y,1}}}}function compareArray(r,e,n){if(r.length!=e.length)return!1;for(let s=0;s<r.length;s++)if(!n(r[s],e[s]))return!1;return!0}function ensureAll(r,e){let n=!1;for(let s of e)ensureAddr(r,s)&1&&(n=!0);return n}function dynamicFacetSlot(r,e,n){let s=n.map(u=>r[u.id]),o=n.map(u=>u.type),a=s.filter(u=>!(u&1)),l=r[e.id]>>1;function c(u){let f=[];for(let d=0;d<s.length;d++){let p=getAddr(u,s[d]);if(o[d]==2)for(let g of p)f.push(g);else f.push(p)}return e.combine(f)}return{create(u){for(let f of s)ensureAddr(u,f);return u.values[l]=c(u),1},update(u,f){if(!ensureAll(u,a))return 0;let d=c(u);return e.compare(d,u.values[l])?0:(u.values[l]=d,1)},reconfigure(u,f){let d=ensureAll(u,s),p=f.config.facets[e.id],g=f.facet(e);if(p&&!d&&sameArray$1(n,p))return u.values[l]=g,0;let y=c(u);return e.compare(y,g)?(u.values[l]=g,0):(u.values[l]=y,1)}}}const initField=Facet.define({static:!0});class StateField{constructor(e,n,s,o,a){this.id=e,this.createF=n,this.updateF=s,this.compareF=o,this.spec=a,this.provides=void 0}static define(e){let n=new StateField(nextID++,e.create,e.update,e.compare||((s,o)=>s===o),e);return e.provide&&(n.provides=e.provide(n)),n}create(e){let n=e.facet(initField).find(s=>s.field==this);return(n?.create||this.createF)(e)}slot(e){let n=e[this.id]>>1;return{create:s=>(s.values[n]=this.create(s),1),update:(s,o)=>{let a=s.values[n],l=this.updateF(a,o);return this.compareF(a,l)?0:(s.values[n]=l,1)},reconfigure:(s,o)=>{let a=s.facet(initField),l=o.facet(initField),c;return(c=a.find(u=>u.field==this))&&c!=l.find(u=>u.field==this)?(s.values[n]=c.create(s),1):o.config.address[this.id]!=null?(s.values[n]=o.field(this),0):(s.values[n]=this.create(s),1)}}}init(e){return[this,initField.of({field:this,create:e})]}get extension(){return this}}const Prec_={lowest:4,low:3,default:2,high:1,highest:0};function prec(r){return e=>new PrecExtension(e,r)}const Prec={highest:prec(Prec_.highest),high:prec(Prec_.high),default:prec(Prec_.default),low:prec(Prec_.low),lowest:prec(Prec_.lowest)};class PrecExtension{constructor(e,n){this.inner=e,this.prec=n}}class Compartment{of(e){return new CompartmentInstance(this,e)}reconfigure(e){return Compartment.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class CompartmentInstance{constructor(e,n){this.compartment=e,this.inner=n}}class Configuration{constructor(e,n,s,o,a,l){for(this.base=e,this.compartments=n,this.dynamicSlots=s,this.address=o,this.staticValues=a,this.facets=l,this.statusTemplate=[];this.statusTemplate.length<s.length;)this.statusTemplate.push(0)}staticFacet(e){let n=this.address[e.id];return n==null?e.default:this.staticValues[n>>1]}static resolve(e,n,s){let o=[],a=Object.create(null),l=new Map;for(let g of flatten(e,n,l))g instanceof StateField?o.push(g):(a[g.facet.id]||(a[g.facet.id]=[])).push(g);let c=Object.create(null),u=[],f=[];for(let g of o)c[g.id]=f.length<<1,f.push(y=>g.slot(y));let d=s?.config.facets;for(let g in a){let y=a[g],x=y[0].facet,E=d&&d[g]||[];if(y.every(Y=>Y.type==0))if(c[x.id]=u.length<<1|1,sameArray$1(E,y))u.push(s.facet(x));else{let Y=x.combine(y.map(Z=>Z.value));u.push(s&&x.compare(Y,s.facet(x))?s.facet(x):Y)}else{for(let Y of y)Y.type==0?(c[Y.id]=u.length<<1|1,u.push(Y.value)):(c[Y.id]=f.length<<1,f.push(Z=>Y.dynamicSlot(Z)));c[x.id]=f.length<<1,f.push(Y=>dynamicFacetSlot(Y,x,y))}}let p=f.map(g=>g(c));return new Configuration(e,l,p,c,u,a)}}function flatten(r,e,n){let s=[[],[],[],[],[]],o=new Map;function a(l,c){let u=o.get(l);if(u!=null){if(u<=c)return;let f=s[u].indexOf(l);f>-1&&s[u].splice(f,1),l instanceof CompartmentInstance&&n.delete(l.compartment)}if(o.set(l,c),Array.isArray(l))for(let f of l)a(f,c);else if(l instanceof CompartmentInstance){if(n.has(l.compartment))throw new RangeError("Duplicate use of compartment in extensions");let f=e.get(l.compartment)||l.inner;n.set(l.compartment,f),a(f,c)}else if(l instanceof PrecExtension)a(l.inner,l.prec);else if(l instanceof StateField)s[c].push(l),l.provides&&a(l.provides,c);else if(l instanceof FacetProvider)s[c].push(l),l.facet.extensions&&a(l.facet.extensions,Prec_.default);else{let f=l.extension;if(!f)throw new Error(`Unrecognized extension value in extension set (${l}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);a(f,c)}}return a(r,Prec_.default),s.reduce((l,c)=>l.concat(c))}function ensureAddr(r,e){if(e&1)return 2;let n=e>>1,s=r.status[n];if(s==4)throw new Error("Cyclic dependency between fields and/or facets");if(s&2)return s;r.status[n]=4;let o=r.computeSlot(r,r.config.dynamicSlots[n]);return r.status[n]=2|o}function getAddr(r,e){return e&1?r.config.staticValues[e>>1]:r.values[e>>1]}const languageData=Facet.define(),allowMultipleSelections=Facet.define({combine:r=>r.some(e=>e),static:!0}),lineSeparator=Facet.define({combine:r=>r.length?r[0]:void 0,static:!0}),changeFilter=Facet.define(),transactionFilter=Facet.define(),transactionExtender=Facet.define(),readOnly=Facet.define({combine:r=>r.length?r[0]:!1});class Annotation{constructor(e,n){this.type=e,this.value=n}static define(){return new AnnotationType}}class AnnotationType{of(e){return new Annotation(this,e)}}class StateEffectType{constructor(e){this.map=e}of(e){return new StateEffect(this,e)}}class StateEffect{constructor(e,n){this.type=e,this.value=n}map(e){let n=this.type.map(this.value,e);return n===void 0?void 0:n==this.value?this:new StateEffect(this.type,n)}is(e){return this.type==e}static define(e={}){return new StateEffectType(e.map||(n=>n))}static mapEffects(e,n){if(!e.length)return e;let s=[];for(let o of e){let a=o.map(n);a&&s.push(a)}return s}}StateEffect.reconfigure=StateEffect.define();StateEffect.appendConfig=StateEffect.define();class Transaction{constructor(e,n,s,o,a,l){this.startState=e,this.changes=n,this.selection=s,this.effects=o,this.annotations=a,this.scrollIntoView=l,this._doc=null,this._state=null,s&&checkSelection(s,n.newLength),a.some(c=>c.type==Transaction.time)||(this.annotations=a.concat(Transaction.time.of(Date.now())))}static create(e,n,s,o,a,l){return new Transaction(e,n,s,o,a,l)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let n of this.annotations)if(n.type==e)return n.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let n=this.annotation(Transaction.userEvent);return!!(n&&(n==e||n.length>e.length&&n.slice(0,e.length)==e&&n[e.length]=="."))}}Transaction.time=Annotation.define();Transaction.userEvent=Annotation.define();Transaction.addToHistory=Annotation.define();Transaction.remote=Annotation.define();function joinRanges(r,e){let n=[];for(let s=0,o=0;;){let a,l;if(s<r.length&&(o==e.length||e[o]>=r[s]))a=r[s++],l=r[s++];else if(o<e.length)a=e[o++],l=e[o++];else return n;!n.length||n[n.length-1]<a?n.push(a,l):n[n.length-1]<l&&(n[n.length-1]=l)}}function mergeTransaction(r,e,n){var s;let o,a,l;return n?(o=e.changes,a=ChangeSet.empty(e.changes.length),l=r.changes.compose(e.changes)):(o=e.changes.map(r.changes),a=r.changes.mapDesc(e.changes,!0),l=r.changes.compose(o)),{changes:l,selection:e.selection?e.selection.map(a):(s=r.selection)===null||s===void 0?void 0:s.map(o),effects:StateEffect.mapEffects(r.effects,o).concat(StateEffect.mapEffects(e.effects,a)),annotations:r.annotations.length?r.annotations.concat(e.annotations):e.annotations,scrollIntoView:r.scrollIntoView||e.scrollIntoView}}function resolveTransactionInner(r,e,n){let s=e.selection,o=asArray$1(e.annotations);return e.userEvent&&(o=o.concat(Transaction.userEvent.of(e.userEvent))),{changes:e.changes instanceof ChangeSet?e.changes:ChangeSet.of(e.changes||[],n,r.facet(lineSeparator)),selection:s&&(s instanceof EditorSelection?s:EditorSelection.single(s.anchor,s.head)),effects:asArray$1(e.effects),annotations:o,scrollIntoView:!!e.scrollIntoView}}function resolveTransaction(r,e,n){let s=resolveTransactionInner(r,e.length?e[0]:{},r.doc.length);e.length&&e[0].filter===!1&&(n=!1);for(let a=1;a<e.length;a++){e[a].filter===!1&&(n=!1);let l=!!e[a].sequential;s=mergeTransaction(s,resolveTransactionInner(r,e[a],l?s.changes.newLength:r.doc.length),l)}let o=Transaction.create(r,s.changes,s.selection,s.effects,s.annotations,s.scrollIntoView);return extendTransaction(n?filterTransaction(o):o)}function filterTransaction(r){let e=r.startState,n=!0;for(let o of e.facet(changeFilter)){let a=o(r);if(a===!1){n=!1;break}Array.isArray(a)&&(n=n===!0?a:joinRanges(n,a))}if(n!==!0){let o,a;if(n===!1)a=r.changes.invertedDesc,o=ChangeSet.empty(e.doc.length);else{let l=r.changes.filter(n);o=l.changes,a=l.filtered.mapDesc(l.changes).invertedDesc}r=Transaction.create(e,o,r.selection&&r.selection.map(a),StateEffect.mapEffects(r.effects,a),r.annotations,r.scrollIntoView)}let s=e.facet(transactionFilter);for(let o=s.length-1;o>=0;o--){let a=s[o](r);a instanceof Transaction?r=a:Array.isArray(a)&&a.length==1&&a[0]instanceof Transaction?r=a[0]:r=resolveTransaction(e,asArray$1(a),!1)}return r}function extendTransaction(r){let e=r.startState,n=e.facet(transactionExtender),s=r;for(let o=n.length-1;o>=0;o--){let a=n[o](r);a&&Object.keys(a).length&&(s=mergeTransaction(s,resolveTransactionInner(e,a,r.changes.newLength),!0))}return s==r?r:Transaction.create(e,r.changes,r.selection,s.effects,s.annotations,s.scrollIntoView)}const none$2=[];function asArray$1(r){return r==null?none$2:Array.isArray(r)?r:[r]}var CharCategory=function(r){return r[r.Word=0]="Word",r[r.Space=1]="Space",r[r.Other=2]="Other",r}(CharCategory||(CharCategory={}));const nonASCIISingleCaseWordChar=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let wordChar;try{wordChar=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function hasWordChar(r){if(wordChar)return wordChar.test(r);for(let e=0;e<r.length;e++){let n=r[e];if(/\w/.test(n)||n>""&&(n.toUpperCase()!=n.toLowerCase()||nonASCIISingleCaseWordChar.test(n)))return!0}return!1}function makeCategorizer(r){return e=>{if(!/\S/.test(e))return CharCategory.Space;if(hasWordChar(e))return CharCategory.Word;for(let n=0;n<r.length;n++)if(e.indexOf(r[n])>-1)return CharCategory.Word;return CharCategory.Other}}class EditorState{constructor(e,n,s,o,a,l){this.config=e,this.doc=n,this.selection=s,this.values=o,this.status=e.statusTemplate.slice(),this.computeSlot=a,l&&(l._state=this);for(let c=0;c<this.config.dynamicSlots.length;c++)ensureAddr(this,c<<1);this.computeSlot=null}field(e,n=!0){let s=this.config.address[e.id];if(s==null){if(n)throw new RangeError("Field is not present in this state");return}return ensureAddr(this,s),getAddr(this,s)}update(...e){return resolveTransaction(this,e,!0)}applyTransaction(e){let n=this.config,{base:s,compartments:o}=n;for(let c of e.effects)c.is(Compartment.reconfigure)?(n&&(o=new Map,n.compartments.forEach((u,f)=>o.set(f,u)),n=null),o.set(c.value.compartment,c.value.extension)):c.is(StateEffect.reconfigure)?(n=null,s=c.value):c.is(StateEffect.appendConfig)&&(n=null,s=asArray$1(s).concat(c.value));let a;n?a=e.startState.values.slice():(n=Configuration.resolve(s,o,this),a=new EditorState(n,this.doc,this.selection,n.dynamicSlots.map(()=>null),(u,f)=>f.reconfigure(u,this),null).values);let l=e.startState.facet(allowMultipleSelections)?e.newSelection:e.newSelection.asSingle();new EditorState(n,e.newDoc,l,a,(c,u)=>u.update(c,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(n=>({changes:{from:n.from,to:n.to,insert:e},range:EditorSelection.cursor(n.from+e.length)}))}changeByRange(e){let n=this.selection,s=e(n.ranges[0]),o=this.changes(s.changes),a=[s.range],l=asArray$1(s.effects);for(let c=1;c<n.ranges.length;c++){let u=e(n.ranges[c]),f=this.changes(u.changes),d=f.map(o);for(let g=0;g<c;g++)a[g]=a[g].map(d);let p=o.mapDesc(f,!0);a.push(u.range.map(p)),o=o.compose(d),l=StateEffect.mapEffects(l,d).concat(StateEffect.mapEffects(asArray$1(u.effects),p))}return{changes:o,selection:EditorSelection.create(a,n.mainIndex),effects:l}}changes(e=[]){return e instanceof ChangeSet?e:ChangeSet.of(e,this.doc.length,this.facet(EditorState.lineSeparator))}toText(e){return Text.of(e.split(this.facet(EditorState.lineSeparator)||DefaultSplit))}sliceDoc(e=0,n=this.doc.length){return this.doc.sliceString(e,n,this.lineBreak)}facet(e){let n=this.config.address[e.id];return n==null?e.default:(ensureAddr(this,n),getAddr(this,n))}toJSON(e){let n={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let s in e){let o=e[s];o instanceof StateField&&this.config.address[o.id]!=null&&(n[s]=o.spec.toJSON(this.field(e[s]),this))}return n}static fromJSON(e,n={},s){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let o=[];if(s){for(let a in s)if(Object.prototype.hasOwnProperty.call(e,a)){let l=s[a],c=e[a];o.push(l.init(u=>l.spec.fromJSON(c,u)))}}return EditorState.create({doc:e.doc,selection:EditorSelection.fromJSON(e.selection),extensions:n.extensions?o.concat([n.extensions]):o})}static create(e={}){let n=Configuration.resolve(e.extensions||[],new Map),s=e.doc instanceof Text?e.doc:Text.of((e.doc||"").split(n.staticFacet(EditorState.lineSeparator)||DefaultSplit)),o=e.selection?e.selection instanceof EditorSelection?e.selection:EditorSelection.single(e.selection.anchor,e.selection.head):EditorSelection.single(0);return checkSelection(o,s.length),n.staticFacet(allowMultipleSelections)||(o=o.asSingle()),new EditorState(n,s,o,n.dynamicSlots.map(()=>null),(a,l)=>l.create(a),null)}get tabSize(){return this.facet(EditorState.tabSize)}get lineBreak(){return this.facet(EditorState.lineSeparator)||`
`}get readOnly(){return this.facet(readOnly)}phrase(e,...n){for(let s of this.facet(EditorState.phrases))if(Object.prototype.hasOwnProperty.call(s,e)){e=s[e];break}return n.length&&(e=e.replace(/\$(\$|\d*)/g,(s,o)=>{if(o=="$")return"$";let a=+(o||1);return!a||a>n.length?s:n[a-1]})),e}languageDataAt(e,n,s=-1){let o=[];for(let a of this.facet(languageData))for(let l of a(this,n,s))Object.prototype.hasOwnProperty.call(l,e)&&o.push(l[e]);return o}charCategorizer(e){return makeCategorizer(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:n,from:s,length:o}=this.doc.lineAt(e),a=this.charCategorizer(e),l=e-s,c=e-s;for(;l>0;){let u=findClusterBreak(n,l,!1);if(a(n.slice(u,l))!=CharCategory.Word)break;l=u}for(;c<o;){let u=findClusterBreak(n,c);if(a(n.slice(c,u))!=CharCategory.Word)break;c=u}return l==c?null:EditorSelection.range(l+s,c+s)}}EditorState.allowMultipleSelections=allowMultipleSelections;EditorState.tabSize=Facet.define({combine:r=>r.length?r[0]:4});EditorState.lineSeparator=lineSeparator;EditorState.readOnly=readOnly;EditorState.phrases=Facet.define({compare(r,e){let n=Object.keys(r),s=Object.keys(e);return n.length==s.length&&n.every(o=>r[o]==e[o])}});EditorState.languageData=languageData;EditorState.changeFilter=changeFilter;EditorState.transactionFilter=transactionFilter;EditorState.transactionExtender=transactionExtender;Compartment.reconfigure=StateEffect.define();function combineConfig(r,e,n={}){let s={};for(let o of r)for(let a of Object.keys(o)){let l=o[a],c=s[a];if(c===void 0)s[a]=l;else if(!(c===l||l===void 0))if(Object.hasOwnProperty.call(n,a))s[a]=n[a](c,l);else throw new Error("Config merge conflict for field "+a)}for(let o in e)s[o]===void 0&&(s[o]=e[o]);return s}class RangeValue{eq(e){return this==e}range(e,n=e){return Range$1.create(e,n,this)}}RangeValue.prototype.startSide=RangeValue.prototype.endSide=0;RangeValue.prototype.point=!1;RangeValue.prototype.mapMode=MapMode.TrackDel;let Range$1=class In{constructor(e,n,s){this.from=e,this.to=n,this.value=s}static create(e,n,s){return new In(e,n,s)}};function cmpRange(r,e){return r.from-e.from||r.value.startSide-e.value.startSide}class Chunk{constructor(e,n,s,o){this.from=e,this.to=n,this.value=s,this.maxPoint=o}get length(){return this.to[this.to.length-1]}findIndex(e,n,s,o=0){let a=s?this.to:this.from;for(let l=o,c=a.length;;){if(l==c)return l;let u=l+c>>1,f=a[u]-e||(s?this.value[u].endSide:this.value[u].startSide)-n;if(u==l)return f>=0?l:c;f>=0?c=u:l=u+1}}between(e,n,s,o){for(let a=this.findIndex(n,-1e9,!0),l=this.findIndex(s,1e9,!1,a);a<l;a++)if(o(this.from[a]+e,this.to[a]+e,this.value[a])===!1)return!1}map(e,n){let s=[],o=[],a=[],l=-1,c=-1;for(let u=0;u<this.value.length;u++){let f=this.value[u],d=this.from[u]+e,p=this.to[u]+e,g,y;if(d==p){let x=n.mapPos(d,f.startSide,f.mapMode);if(x==null||(g=y=x,f.startSide!=f.endSide&&(y=n.mapPos(d,f.endSide),y<g)))continue}else if(g=n.mapPos(d,f.startSide),y=n.mapPos(p,f.endSide),g>y||g==y&&f.startSide>0&&f.endSide<=0)continue;(y-g||f.endSide-f.startSide)<0||(l<0&&(l=g),f.point&&(c=Math.max(c,y-g)),s.push(f),o.push(g-l),a.push(y-l))}return{mapped:s.length?new Chunk(o,a,s,c):null,pos:l}}}class RangeSet{constructor(e,n,s,o){this.chunkPos=e,this.chunk=n,this.nextLayer=s,this.maxPoint=o}static create(e,n,s,o){return new RangeSet(e,n,s,o)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let n of this.chunk)e+=n.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:n=[],sort:s=!1,filterFrom:o=0,filterTo:a=this.length}=e,l=e.filter;if(n.length==0&&!l)return this;if(s&&(n=n.slice().sort(cmpRange)),this.isEmpty)return n.length?RangeSet.of(n):this;let c=new LayerCursor(this,null,-1).goto(0),u=0,f=[],d=new RangeSetBuilder;for(;c.value||u<n.length;)if(u<n.length&&(c.from-n[u].from||c.startSide-n[u].value.startSide)>=0){let p=n[u++];d.addInner(p.from,p.to,p.value)||f.push(p)}else c.rangeIndex==1&&c.chunkIndex<this.chunk.length&&(u==n.length||this.chunkEnd(c.chunkIndex)<n[u].from)&&(!l||o>this.chunkEnd(c.chunkIndex)||a<this.chunkPos[c.chunkIndex])&&d.addChunk(this.chunkPos[c.chunkIndex],this.chunk[c.chunkIndex])?c.nextChunk():((!l||o>c.to||a<c.from||l(c.from,c.to,c.value))&&(d.addInner(c.from,c.to,c.value)||f.push(Range$1.create(c.from,c.to,c.value))),c.next());return d.finishInner(this.nextLayer.isEmpty&&!f.length?RangeSet.empty:this.nextLayer.update({add:f,filter:l,filterFrom:o,filterTo:a}))}map(e){if(e.empty||this.isEmpty)return this;let n=[],s=[],o=-1;for(let l=0;l<this.chunk.length;l++){let c=this.chunkPos[l],u=this.chunk[l],f=e.touchesRange(c,c+u.length);if(f===!1)o=Math.max(o,u.maxPoint),n.push(u),s.push(e.mapPos(c));else if(f===!0){let{mapped:d,pos:p}=u.map(c,e);d&&(o=Math.max(o,d.maxPoint),n.push(d),s.push(p))}}let a=this.nextLayer.map(e);return n.length==0?a:new RangeSet(s,n,a||RangeSet.empty,o)}between(e,n,s){if(!this.isEmpty){for(let o=0;o<this.chunk.length;o++){let a=this.chunkPos[o],l=this.chunk[o];if(n>=a&&e<=a+l.length&&l.between(a,e-a,n-a,s)===!1)return}this.nextLayer.between(e,n,s)}}iter(e=0){return HeapCursor.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,n=0){return HeapCursor.from(e).goto(n)}static compare(e,n,s,o,a=-1){let l=e.filter(p=>p.maxPoint>0||!p.isEmpty&&p.maxPoint>=a),c=n.filter(p=>p.maxPoint>0||!p.isEmpty&&p.maxPoint>=a),u=findSharedChunks(l,c,s),f=new SpanCursor(l,u,a),d=new SpanCursor(c,u,a);s.iterGaps((p,g,y)=>compare(f,p,d,g,y,o)),s.empty&&s.length==0&&compare(f,0,d,0,0,o)}static eq(e,n,s=0,o){o==null&&(o=999999999);let a=e.filter(d=>!d.isEmpty&&n.indexOf(d)<0),l=n.filter(d=>!d.isEmpty&&e.indexOf(d)<0);if(a.length!=l.length)return!1;if(!a.length)return!0;let c=findSharedChunks(a,l),u=new SpanCursor(a,c,0).goto(s),f=new SpanCursor(l,c,0).goto(s);for(;;){if(u.to!=f.to||!sameValues(u.active,f.active)||u.point&&(!f.point||!u.point.eq(f.point)))return!1;if(u.to>o)return!0;u.next(),f.next()}}static spans(e,n,s,o,a=-1){let l=new SpanCursor(e,null,a).goto(n),c=n,u=l.openStart;for(;;){let f=Math.min(l.to,s);if(l.point){let d=l.activeForPoint(l.to),p=l.pointFrom<n?d.length+1:l.point.startSide<0?d.length:Math.min(d.length,u);o.point(c,f,l.point,d,p,l.pointRank),u=Math.min(l.openEnd(f),d.length)}else f>c&&(o.span(c,f,l.active,u),u=l.openEnd(f));if(l.to>s)return u+(l.point&&l.to>s?1:0);c=l.to,l.next()}}static of(e,n=!1){let s=new RangeSetBuilder;for(let o of e instanceof Range$1?[e]:n?lazySort(e):e)s.add(o.from,o.to,o.value);return s.finish()}static join(e){if(!e.length)return RangeSet.empty;let n=e[e.length-1];for(let s=e.length-2;s>=0;s--)for(let o=e[s];o!=RangeSet.empty;o=o.nextLayer)n=new RangeSet(o.chunkPos,o.chunk,n,Math.max(o.maxPoint,n.maxPoint));return n}}RangeSet.empty=new RangeSet([],[],null,-1);function lazySort(r){if(r.length>1)for(let e=r[0],n=1;n<r.length;n++){let s=r[n];if(cmpRange(e,s)>0)return r.slice().sort(cmpRange);e=s}return r}RangeSet.empty.nextLayer=RangeSet.empty;class RangeSetBuilder{finishChunk(e){this.chunks.push(new Chunk(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,n,s){this.addInner(e,n,s)||(this.nextLayer||(this.nextLayer=new RangeSetBuilder)).add(e,n,s)}addInner(e,n,s){let o=e-this.lastTo||s.startSide-this.last.endSide;if(o<=0&&(e-this.lastFrom||s.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return o<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(n-this.chunkStart),this.last=s,this.lastFrom=e,this.lastTo=n,this.value.push(s),s.point&&(this.maxPoint=Math.max(this.maxPoint,n-e)),!0)}addChunk(e,n){if((e-this.lastTo||n.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,n.maxPoint),this.chunks.push(n),this.chunkPos.push(e);let s=n.value.length-1;return this.last=n.value[s],this.lastFrom=n.from[s]+e,this.lastTo=n.to[s]+e,!0}finish(){return this.finishInner(RangeSet.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let n=RangeSet.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,n}}function findSharedChunks(r,e,n){let s=new Map;for(let a of r)for(let l=0;l<a.chunk.length;l++)a.chunk[l].maxPoint<=0&&s.set(a.chunk[l],a.chunkPos[l]);let o=new Set;for(let a of e)for(let l=0;l<a.chunk.length;l++){let c=s.get(a.chunk[l]);c!=null&&(n?n.mapPos(c):c)==a.chunkPos[l]&&!n?.touchesRange(c,c+a.chunk[l].length)&&o.add(a.chunk[l])}return o}class LayerCursor{constructor(e,n,s,o=0){this.layer=e,this.skip=n,this.minPoint=s,this.rank=o}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,n=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,n,!1),this}gotoInner(e,n,s){for(;this.chunkIndex<this.layer.chunk.length;){let o=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(o)||this.layer.chunkEnd(this.chunkIndex)<e||o.maxPoint<this.minPoint))break;this.chunkIndex++,s=!1}if(this.chunkIndex<this.layer.chunk.length){let o=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],n,!0);(!s||this.rangeIndex<o)&&this.setRangeIndex(o)}this.next()}forward(e,n){(this.to-e||this.endSide-n)<0&&this.gotoInner(e,n,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],n=this.layer.chunk[this.chunkIndex],s=e+n.from[this.rangeIndex];if(this.from=s,this.to=e+n.to[this.rangeIndex],this.value=n.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class HeapCursor{constructor(e){this.heap=e}static from(e,n=null,s=-1){let o=[];for(let a=0;a<e.length;a++)for(let l=e[a];!l.isEmpty;l=l.nextLayer)l.maxPoint>=s&&o.push(new LayerCursor(l,n,s,a));return o.length==1?o[0]:new HeapCursor(o)}get startSide(){return this.value?this.value.startSide:0}goto(e,n=-1e9){for(let s of this.heap)s.goto(e,n);for(let s=this.heap.length>>1;s>=0;s--)heapBubble(this.heap,s);return this.next(),this}forward(e,n){for(let s of this.heap)s.forward(e,n);for(let s=this.heap.length>>1;s>=0;s--)heapBubble(this.heap,s);(this.to-e||this.value.endSide-n)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),heapBubble(this.heap,0)}}}function heapBubble(r,e){for(let n=r[e];;){let s=(e<<1)+1;if(s>=r.length)break;let o=r[s];if(s+1<r.length&&o.compare(r[s+1])>=0&&(o=r[s+1],s++),n.compare(o)<0)break;r[s]=n,r[e]=o,e=s}}class SpanCursor{constructor(e,n,s){this.minPoint=s,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=HeapCursor.from(e,n,s)}goto(e,n=-1e9){return this.cursor.goto(e,n),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=n,this.openStart=-1,this.next(),this}forward(e,n){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-n)<0;)this.removeActive(this.minActive);this.cursor.forward(e,n)}removeActive(e){remove(this.active,e),remove(this.activeTo,e),remove(this.activeRank,e),this.minActive=findMinIndex(this.active,this.activeTo)}addActive(e){let n=0,{value:s,to:o,rank:a}=this.cursor;for(;n<this.activeRank.length&&(a-this.activeRank[n]||o-this.activeTo[n])>0;)n++;insert(this.active,n,s),insert(this.activeTo,n,o),insert(this.activeRank,n,a),e&&insert(e,n,this.cursor.from),this.minActive=findMinIndex(this.active,this.activeTo)}next(){let e=this.to,n=this.point;this.point=null;let s=this.openStart<0?[]:null;for(;;){let o=this.minActive;if(o>-1&&(this.activeTo[o]-this.cursor.from||this.active[o].endSide-this.cursor.startSide)<0){if(this.activeTo[o]>e){this.to=this.activeTo[o],this.endSide=this.active[o].endSide;break}this.removeActive(o),s&&remove(s,o)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let a=this.cursor.value;if(!a.point)this.addActive(s),this.cursor.next();else if(n&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=a,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=a.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(s){this.openStart=0;for(let o=s.length-1;o>=0&&s[o]<e;o--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let n=[];for(let s=this.active.length-1;s>=0&&!(this.activeRank[s]<this.pointRank);s--)(this.activeTo[s]>e||this.activeTo[s]==e&&this.active[s].endSide>=this.point.endSide)&&n.push(this.active[s]);return n.reverse()}openEnd(e){let n=0;for(let s=this.activeTo.length-1;s>=0&&this.activeTo[s]>e;s--)n++;return n}}function compare(r,e,n,s,o,a){r.goto(e),n.goto(s);let l=s+o,c=s,u=s-e;for(;;){let f=r.to+u-n.to,d=f||r.endSide-n.endSide,p=d<0?r.to+u:n.to,g=Math.min(p,l);if(r.point||n.point?r.point&&n.point&&(r.point==n.point||r.point.eq(n.point))&&sameValues(r.activeForPoint(r.to),n.activeForPoint(n.to))||a.comparePoint(c,g,r.point,n.point):g>c&&!sameValues(r.active,n.active)&&a.compareRange(c,g,r.active,n.active),p>l)break;(f||r.openEnd!=n.openEnd)&&a.boundChange&&a.boundChange(p),c=p,d<=0&&r.next(),d>=0&&n.next()}}function sameValues(r,e){if(r.length!=e.length)return!1;for(let n=0;n<r.length;n++)if(r[n]!=e[n]&&!r[n].eq(e[n]))return!1;return!0}function remove(r,e){for(let n=e,s=r.length-1;n<s;n++)r[n]=r[n+1];r.pop()}function insert(r,e,n){for(let s=r.length-1;s>=e;s--)r[s+1]=r[s];r[e]=n}function findMinIndex(r,e){let n=-1,s=1e9;for(let o=0;o<e.length;o++)(e[o]-s||r[o].endSide-r[n].endSide)<0&&(n=o,s=e[o]);return n}function countColumn(r,e,n=r.length){let s=0;for(let o=0;o<n&&o<r.length;)r.charCodeAt(o)==9?(s+=e-s%e,o++):(s++,o=findClusterBreak(r,o));return s}function findColumn(r,e,n,s){for(let o=0,a=0;;){if(a>=e)return o;if(o==r.length)break;a+=r.charCodeAt(o)==9?n-a%n:1,o=findClusterBreak(r,o)}return r.length}const C$1="",COUNT=typeof Symbol>"u"?"__"+C$1:Symbol.for(C$1),SET=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),top=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class StyleModule{constructor(e,n){this.rules=[];let{finish:s}=n||{};function o(l){return/^@/.test(l)?[l]:l.split(/,\s*/)}function a(l,c,u,f){let d=[],p=/^@(\w+)\b/.exec(l[0]),g=p&&p[1]=="keyframes";if(p&&c==null)return u.push(l[0]+";");for(let y in c){let x=c[y];if(/&/.test(y))a(y.split(/,\s*/).map(E=>l.map(Y=>E.replace(/&/,Y))).reduce((E,Y)=>E.concat(Y)),x,u);else if(x&&typeof x=="object"){if(!p)throw new RangeError("The value of a property ("+y+") should be a primitive value.");a(o(y),x,d,g)}else x!=null&&d.push(y.replace(/_.*/,"").replace(/[A-Z]/g,E=>"-"+E.toLowerCase())+": "+x+";")}(d.length||g)&&u.push((s&&!p&&!f?l.map(s):l).join(", ")+" {"+d.join(" ")+"}")}for(let l in e)a(o(l),e[l],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=top[COUNT]||1;return top[COUNT]=e+1,C$1+e.toString(36)}static mount(e,n,s){let o=e[SET],a=s&&s.nonce;o?a&&o.setNonce(a):o=new StyleSet(e,a),o.mount(Array.isArray(n)?n:[n],e)}}let adoptedSet=new Map;class StyleSet{constructor(e,n){let s=e.ownerDocument||e,o=s.defaultView;if(!e.head&&e.adoptedStyleSheets&&o.CSSStyleSheet){let a=adoptedSet.get(s);if(a)return e[SET]=a;this.sheet=new o.CSSStyleSheet,adoptedSet.set(s,this)}else this.styleTag=s.createElement("style"),n&&this.styleTag.setAttribute("nonce",n);this.modules=[],e[SET]=this}mount(e,n){let s=this.sheet,o=0,a=0;for(let l=0;l<e.length;l++){let c=e[l],u=this.modules.indexOf(c);if(u<a&&u>-1&&(this.modules.splice(u,1),a--,u=-1),u==-1){if(this.modules.splice(a++,0,c),s)for(let f=0;f<c.rules.length;f++)s.insertRule(c.rules[f],o++)}else{for(;a<u;)o+=this.modules[a++].rules.length;o+=c.rules.length,a++}}if(s)n.adoptedStyleSheets.indexOf(this.sheet)<0&&(n.adoptedStyleSheets=[this.sheet,...n.adoptedStyleSheets]);else{let l="";for(let u=0;u<this.modules.length;u++)l+=this.modules[u].getRules()+`
`;this.styleTag.textContent=l;let c=n.head||n;this.styleTag.parentNode!=c&&c.insertBefore(this.styleTag,c.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}var base={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},shift={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},mac=typeof navigator<"u"&&/Mac/.test(navigator.platform),ie$2=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var i=0;i<10;i++)base[48+i]=base[96+i]=String(i);for(var i=1;i<=24;i++)base[i+111]="F"+i;for(var i=65;i<=90;i++)base[i]=String.fromCharCode(i+32),shift[i]=String.fromCharCode(i);for(var code in base)shift.hasOwnProperty(code)||(shift[code]=base[code]);function keyName(r){var e=mac&&r.metaKey&&r.shiftKey&&!r.ctrlKey&&!r.altKey||ie$2&&r.shiftKey&&r.key&&r.key.length==1||r.key=="Unidentified",n=!e&&r.key||(r.shiftKey?shift:base)[r.keyCode]||r.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}function crelt(){var r=arguments[0];typeof r=="string"&&(r=document.createElement(r));var e=1,n=arguments[1];if(n&&typeof n=="object"&&n.nodeType==null&&!Array.isArray(n)){for(var s in n)if(Object.prototype.hasOwnProperty.call(n,s)){var o=n[s];typeof o=="string"?r.setAttribute(s,o):o!=null&&(r[s]=o)}e++}for(;e<arguments.length;e++)add(r,arguments[e]);return r}function add(r,e){if(typeof e=="string")r.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)r.appendChild(e);else if(Array.isArray(e))for(var n=0;n<e.length;n++)add(r,e[n]);else throw new RangeError("Unsupported child node: "+e)}function getSelection(r){let e;return r.nodeType==11?e=r.getSelection?r:r.ownerDocument:e=r,e.getSelection()}function contains(r,e){return e?r==e||r.contains(e.nodeType!=1?e.parentNode:e):!1}function hasSelection(r,e){if(!e.anchorNode)return!1;try{return contains(r,e.anchorNode)}catch{return!1}}function clientRectsFor(r){return r.nodeType==3?textRange(r,0,r.nodeValue.length).getClientRects():r.nodeType==1?r.getClientRects():[]}function isEquivalentPosition(r,e,n,s){return n?scanFor(r,e,n,s,-1)||scanFor(r,e,n,s,1):!1}function domIndex(r){for(var e=0;;e++)if(r=r.previousSibling,!r)return e}function isBlockElement(r){return r.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(r.nodeName)}function scanFor(r,e,n,s,o){for(;;){if(r==n&&e==s)return!0;if(e==(o<0?0:maxOffset(r))){if(r.nodeName=="DIV")return!1;let a=r.parentNode;if(!a||a.nodeType!=1)return!1;e=domIndex(r)+(o<0?0:1),r=a}else if(r.nodeType==1){if(r=r.childNodes[e+(o<0?-1:0)],r.nodeType==1&&r.contentEditable=="false")return!1;e=o<0?maxOffset(r):0}else return!1}}function maxOffset(r){return r.nodeType==3?r.nodeValue.length:r.childNodes.length}function flattenRect(r,e){let n=e?r.left:r.right;return{left:n,right:n,top:r.top,bottom:r.bottom}}function windowRect(r){let e=r.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:r.innerWidth,top:0,bottom:r.innerHeight}}function getScale(r,e){let n=e.width/r.offsetWidth,s=e.height/r.offsetHeight;return(n>.995&&n<1.005||!isFinite(n)||Math.abs(e.width-r.offsetWidth)<1)&&(n=1),(s>.995&&s<1.005||!isFinite(s)||Math.abs(e.height-r.offsetHeight)<1)&&(s=1),{scaleX:n,scaleY:s}}function scrollRectIntoView(r,e,n,s,o,a,l,c){let u=r.ownerDocument,f=u.defaultView||window;for(let d=r,p=!1;d&&!p;)if(d.nodeType==1){let g,y=d==u.body,x=1,E=1;if(y)g=windowRect(f);else{if(/^(fixed|sticky)$/.test(getComputedStyle(d).position)&&(p=!0),d.scrollHeight<=d.clientHeight&&d.scrollWidth<=d.clientWidth){d=d.assignedSlot||d.parentNode;continue}let te=d.getBoundingClientRect();({scaleX:x,scaleY:E}=getScale(d,te)),g={left:te.left,right:te.left+d.clientWidth*x,top:te.top,bottom:te.top+d.clientHeight*E}}let Y=0,Z=0;if(o=="nearest")e.top<g.top?(Z=e.top-(g.top+l),n>0&&e.bottom>g.bottom+Z&&(Z=e.bottom-g.bottom+l)):e.bottom>g.bottom&&(Z=e.bottom-g.bottom+l,n<0&&e.top-Z<g.top&&(Z=e.top-(g.top+l)));else{let te=e.bottom-e.top,ne=g.bottom-g.top;Z=(o=="center"&&te<=ne?e.top+te/2-ne/2:o=="start"||o=="center"&&n<0?e.top-l:e.bottom-ne+l)-g.top}if(s=="nearest"?e.left<g.left?(Y=e.left-(g.left+a),n>0&&e.right>g.right+Y&&(Y=e.right-g.right+a)):e.right>g.right&&(Y=e.right-g.right+a,n<0&&e.left<g.left+Y&&(Y=e.left-(g.left+a))):Y=(s=="center"?e.left+(e.right-e.left)/2-(g.right-g.left)/2:s=="start"==c?e.left-a:e.right-(g.right-g.left)+a)-g.left,Y||Z)if(y)f.scrollBy(Y,Z);else{let te=0,ne=0;if(Z){let Ve=d.scrollTop;d.scrollTop+=Z/E,ne=(d.scrollTop-Ve)*E}if(Y){let Ve=d.scrollLeft;d.scrollLeft+=Y/x,te=(d.scrollLeft-Ve)*x}e={left:e.left-te,top:e.top-ne,right:e.right-te,bottom:e.bottom-ne},te&&Math.abs(te-Y)<1&&(s="nearest"),ne&&Math.abs(ne-Z)<1&&(o="nearest")}if(y)break;(e.top<g.top||e.bottom>g.bottom||e.left<g.left||e.right>g.right)&&(e={left:Math.max(e.left,g.left),right:Math.min(e.right,g.right),top:Math.max(e.top,g.top),bottom:Math.min(e.bottom,g.bottom)}),d=d.assignedSlot||d.parentNode}else if(d.nodeType==11)d=d.host;else break}function scrollableParents(r){let e=r.ownerDocument,n,s;for(let o=r.parentNode;o&&!(o==e.body||n&&s);)if(o.nodeType==1)!s&&o.scrollHeight>o.clientHeight&&(s=o),!n&&o.scrollWidth>o.clientWidth&&(n=o),o=o.assignedSlot||o.parentNode;else if(o.nodeType==11)o=o.host;else break;return{x:n,y:s}}class DOMSelectionState{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:n,focusNode:s}=e;this.set(n,Math.min(e.anchorOffset,n?maxOffset(n):0),s,Math.min(e.focusOffset,s?maxOffset(s):0))}set(e,n,s,o){this.anchorNode=e,this.anchorOffset=n,this.focusNode=s,this.focusOffset=o}}let preventScrollSupported=null;function focusPreventScroll(r){if(r.setActive)return r.setActive();if(preventScrollSupported)return r.focus(preventScrollSupported);let e=[];for(let n=r;n&&(e.push(n,n.scrollTop,n.scrollLeft),n!=n.ownerDocument);n=n.parentNode);if(r.focus(preventScrollSupported==null?{get preventScroll(){return preventScrollSupported={preventScroll:!0},!0}}:void 0),!preventScrollSupported){preventScrollSupported=!1;for(let n=0;n<e.length;){let s=e[n++],o=e[n++],a=e[n++];s.scrollTop!=o&&(s.scrollTop=o),s.scrollLeft!=a&&(s.scrollLeft=a)}}}let scratchRange;function textRange(r,e,n=e){let s=scratchRange||(scratchRange=document.createRange());return s.setEnd(r,n),s.setStart(r,e),s}function dispatchKey(r,e,n,s){let o={key:e,code:e,keyCode:n,which:n,cancelable:!0};s&&({altKey:o.altKey,ctrlKey:o.ctrlKey,shiftKey:o.shiftKey,metaKey:o.metaKey}=s);let a=new KeyboardEvent("keydown",o);a.synthetic=!0,r.dispatchEvent(a);let l=new KeyboardEvent("keyup",o);return l.synthetic=!0,r.dispatchEvent(l),a.defaultPrevented||l.defaultPrevented}function getRoot(r){for(;r;){if(r&&(r.nodeType==9||r.nodeType==11&&r.host))return r;r=r.assignedSlot||r.parentNode}return null}function clearAttributes(r){for(;r.attributes.length;)r.removeAttributeNode(r.attributes[0])}function atElementStart(r,e){let n=e.focusNode,s=e.focusOffset;if(!n||e.anchorNode!=n||e.anchorOffset!=s)return!1;for(s=Math.min(s,maxOffset(n));;)if(s){if(n.nodeType!=1)return!1;let o=n.childNodes[s-1];o.contentEditable=="false"?s--:(n=o,s=maxOffset(n))}else{if(n==r)return!0;s=domIndex(n),n=n.parentNode}}function isScrolledToBottom(r){return r.scrollTop>Math.max(1,r.scrollHeight-r.clientHeight-4)}function textNodeBefore(r,e){for(let n=r,s=e;;){if(n.nodeType==3&&s>0)return{node:n,offset:s};if(n.nodeType==1&&s>0){if(n.contentEditable=="false")return null;n=n.childNodes[s-1],s=maxOffset(n)}else if(n.parentNode&&!isBlockElement(n))s=domIndex(n),n=n.parentNode;else return null}}function textNodeAfter(r,e){for(let n=r,s=e;;){if(n.nodeType==3&&s<n.nodeValue.length)return{node:n,offset:s};if(n.nodeType==1&&s<n.childNodes.length){if(n.contentEditable=="false")return null;n=n.childNodes[s],s=0}else if(n.parentNode&&!isBlockElement(n))s=domIndex(n)+1,n=n.parentNode;else return null}}class DOMPos{constructor(e,n,s=!0){this.node=e,this.offset=n,this.precise=s}static before(e,n){return new DOMPos(e.parentNode,domIndex(e),n)}static after(e,n){return new DOMPos(e.parentNode,domIndex(e)+1,n)}}const noChildren=[];class ContentView{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let n=this.posAtStart;for(let s of this.children){if(s==e)return n;n+=s.length+s.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,n){if(this.flags&2){let s=this.dom,o=null,a;for(let l of this.children){if(l.flags&7){if(!l.dom&&(a=o?o.nextSibling:s.firstChild)){let c=ContentView.get(a);(!c||!c.parent&&c.canReuseDOM(l))&&l.reuseDOM(a)}l.sync(e,n),l.flags&=-8}if(a=o?o.nextSibling:s.firstChild,n&&!n.written&&n.node==s&&a!=l.dom&&(n.written=!0),l.dom.parentNode==s)for(;a&&a!=l.dom;)a=rm$1(a);else s.insertBefore(l.dom,a);o=l.dom}for(a=o?o.nextSibling:s.firstChild,a&&n&&n.node==s&&(n.written=!0);a;)a=rm$1(a)}else if(this.flags&1)for(let s of this.children)s.flags&7&&(s.sync(e,n),s.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,n){let s;if(e==this.dom)s=this.dom.childNodes[n];else{let o=maxOffset(e)==0?0:n==0?-1:1;for(;;){let a=e.parentNode;if(a==this.dom)break;o==0&&a.firstChild!=a.lastChild&&(e==a.firstChild?o=-1:o=1),e=a}o<0?s=e:s=e.nextSibling}if(s==this.dom.firstChild)return 0;for(;s&&!ContentView.get(s);)s=s.nextSibling;if(!s)return this.length;for(let o=0,a=0;;o++){let l=this.children[o];if(l.dom==s)return a;a+=l.length+l.breakAfter}}domBoundsAround(e,n,s=0){let o=-1,a=-1,l=-1,c=-1;for(let u=0,f=s,d=s;u<this.children.length;u++){let p=this.children[u],g=f+p.length;if(f<e&&g>n)return p.domBoundsAround(e,n,f);if(g>=e&&o==-1&&(o=u,a=f),f>n&&p.dom.parentNode==this.dom){l=u,c=d;break}d=g,f=g+p.breakAfter}return{from:a,to:c<0?s+this.length:c,startDOM:(o?this.children[o-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:l<this.children.length&&l>=0?this.children[l].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let n=this.parent;n;n=n.parent){if(e&&(n.flags|=2),n.flags&1)return;n.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.flags&7&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let n=e.parent;if(!n)return e;e=n}}replaceChildren(e,n,s=noChildren){this.markDirty();for(let o=e;o<n;o++){let a=this.children[o];a.parent==this&&s.indexOf(a)<0&&a.destroy()}s.length<250?this.children.splice(e,n-e,...s):this.children=[].concat(this.children.slice(0,e),s,this.children.slice(n));for(let o=0;o<s.length;o++)s[o].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new ChildCursor(this.children,e,this.children.length)}childPos(e,n=1){return this.childCursor().findPos(e,n)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,n,s,o,a,l){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}}ContentView.prototype.breakAfter=0;function rm$1(r){let e=r.nextSibling;return r.parentNode.removeChild(r),e}class ChildCursor{constructor(e,n,s){this.children=e,this.pos=n,this.i=s,this.off=0}findPos(e,n=1){for(;;){if(e>this.pos||e==this.pos&&(n>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let s=this.children[--this.i];this.pos-=s.length+s.breakAfter}}}function replaceRange(r,e,n,s,o,a,l,c,u){let{children:f}=r,d=f.length?f[e]:null,p=a.length?a[a.length-1]:null,g=p?p.breakAfter:l;if(!(e==s&&d&&!l&&!g&&a.length<2&&d.merge(n,o,a.length?p:null,n==0,c,u))){if(s<f.length){let y=f[s];y&&(o<y.length||y.breakAfter&&p?.breakAfter)?(e==s&&(y=y.split(o),o=0),!g&&p&&y.merge(0,o,p,!0,0,u)?a[a.length-1]=y:((o||y.children.length&&!y.children[0].length)&&y.merge(0,o,null,!1,0,u),a.push(y))):y?.breakAfter&&(p?p.breakAfter=1:l=1),s++}for(d&&(d.breakAfter=l,n>0&&(!l&&a.length&&d.merge(n,d.length,a[0],!1,c,0)?d.breakAfter=a.shift().breakAfter:(n<d.length||d.children.length&&d.children[d.children.length-1].length==0)&&d.merge(n,d.length,null,!1,c,0),e++));e<s&&a.length;)if(f[s-1].become(a[a.length-1]))s--,a.pop(),u=a.length?0:c;else if(f[e].become(a[0]))e++,a.shift(),c=a.length?0:u;else break;!a.length&&e&&s<f.length&&!f[e-1].breakAfter&&f[s].merge(0,0,f[e-1],!1,c,u)&&e--,(e<s||a.length)&&r.replaceChildren(e,s,a)}}function mergeChildrenInto(r,e,n,s,o,a){let l=r.childCursor(),{i:c,off:u}=l.findPos(n,1),{i:f,off:d}=l.findPos(e,-1),p=e-n;for(let g of s)p+=g.length;r.length+=p,replaceRange(r,f,d,c,u,s,0,o,a)}let nav=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},doc=typeof document<"u"?document:{documentElement:{style:{}}};const ie_edge=/Edge\/(\d+)/.exec(nav.userAgent),ie_upto10=/MSIE \d/.test(nav.userAgent),ie_11up=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(nav.userAgent),ie$1=!!(ie_upto10||ie_11up||ie_edge),gecko=!ie$1&&/gecko\/(\d+)/i.test(nav.userAgent),chrome=!ie$1&&/Chrome\/(\d+)/.exec(nav.userAgent),webkit="webkitFontSmoothing"in doc.documentElement.style,safari=!ie$1&&/Apple Computer/.test(nav.vendor),ios=safari&&(/Mobile\/\w+/.test(nav.userAgent)||nav.maxTouchPoints>2);var browser={mac:ios||/Mac/.test(nav.platform),windows:/Win/.test(nav.platform),linux:/Linux|X11/.test(nav.platform),ie:ie$1,ie_version:ie_upto10?doc.documentMode||6:ie_11up?+ie_11up[1]:ie_edge?+ie_edge[1]:0,gecko,gecko_version:gecko?+(/Firefox\/(\d+)/.exec(nav.userAgent)||[0,0])[1]:0,chrome:!!chrome,chrome_version:chrome?+chrome[1]:0,ios,android:/Android\b/.test(nav.userAgent),safari,webkit_version:webkit?+(/\bAppleWebKit\/(\d+)/.exec(nav.userAgent)||[0,0])[1]:0,tabSize:doc.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const MaxJoinLen=256;class TextView extends ContentView{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,n){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(n&&n.node==this.dom&&(n.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,n,s){return this.flags&8||s&&(!(s instanceof TextView)||this.length-(n-e)+s.length>MaxJoinLen||s.flags&8)?!1:(this.text=this.text.slice(0,e)+(s?s.text:"")+this.text.slice(n),this.markDirty(),!0)}split(e){let n=new TextView(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),n.flags|=this.flags&8,n}localPosFromDOM(e,n){return e==this.dom?n:n?this.text.length:0}domAtPos(e){return new DOMPos(this.dom,e)}domBoundsAround(e,n,s){return{from:s,to:s+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,n){return textCoords(this.dom,e,n)}}class MarkView extends ContentView{constructor(e,n=[],s=0){super(),this.mark=e,this.children=n,this.length=s;for(let o of n)o.setParent(this)}setAttrs(e){if(clearAttributes(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let n in this.mark.attrs)e.setAttribute(n,this.mark.attrs[n]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,n){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,n)}merge(e,n,s,o,a,l){return s&&(!(s instanceof MarkView&&s.mark.eq(this.mark))||e&&a<=0||n<this.length&&l<=0)?!1:(mergeChildrenInto(this,e,n,s?s.children.slice():[],a-1,l-1),this.markDirty(),!0)}split(e){let n=[],s=0,o=-1,a=0;for(let c of this.children){let u=s+c.length;u>e&&n.push(s<e?c.split(e-s):c),o<0&&s>=e&&(o=a),s=u,a++}let l=this.length-e;return this.length=e,o>-1&&(this.children.length=o,this.markDirty()),new MarkView(this.mark,n,l)}domAtPos(e){return inlineDOMAtPos(this,e)}coordsAt(e,n){return coordsInChildren(this,e,n)}}function textCoords(r,e,n){let s=r.nodeValue.length;e>s&&(e=s);let o=e,a=e,l=0;e==0&&n<0||e==s&&n>=0?browser.chrome||browser.gecko||(e?(o--,l=1):a<s&&(a++,l=-1)):n<0?o--:a<s&&a++;let c=textRange(r,o,a).getClientRects();if(!c.length)return null;let u=c[(l?l<0:n>=0)?0:c.length-1];return browser.safari&&!l&&u.width==0&&(u=Array.prototype.find.call(c,f=>f.width)||u),l?flattenRect(u,l<0):u||null}class WidgetView extends ContentView{static create(e,n,s){return new WidgetView(e,n,s)}constructor(e,n,s){super(),this.widget=e,this.length=n,this.side=s,this.prevWidget=null}split(e){let n=WidgetView.create(this.widget,this.length-e,this.side);return this.length-=e,n}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(e,n,s,o,a,l){return s&&(!(s instanceof WidgetView)||!this.widget.compare(s.widget)||e>0&&a<=0||n<this.length&&l<=0)?!1:(this.length=e+(s?s.length:0)+(this.length-n),!0)}become(e){return e instanceof WidgetView&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return Text.empty;let e=this;for(;e.parent;)e=e.parent;let{view:n}=e,s=n&&n.state.doc,o=this.posAtStart;return s?s.slice(o,o+this.length):Text.empty}domAtPos(e){return(this.length?e==0:this.side>0)?DOMPos.before(this.dom):DOMPos.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,n){let s=this.widget.coordsAt(this.dom,e,n);if(s)return s;let o=this.dom.getClientRects(),a=null;if(!o.length)return null;let l=this.side?this.side<0:e>0;for(let c=l?o.length-1:0;a=o[c],!(e>0?c==0:c==o.length-1||a.top<a.bottom);c+=l?-1:1);return flattenRect(a,!l)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class WidgetBufferView extends ContentView{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof WidgetBufferView&&e.side==this.side}split(){return new WidgetBufferView(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?DOMPos.before(this.dom):DOMPos.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return Text.empty}get isHidden(){return!0}}TextView.prototype.children=WidgetView.prototype.children=WidgetBufferView.prototype.children=noChildren;function inlineDOMAtPos(r,e){let n=r.dom,{children:s}=r,o=0;for(let a=0;o<s.length;o++){let l=s[o],c=a+l.length;if(!(c==a&&l.getSide()<=0)){if(e>a&&e<c&&l.dom.parentNode==n)return l.domAtPos(e-a);if(e<=a)break;a=c}}for(let a=o;a>0;a--){let l=s[a-1];if(l.dom.parentNode==n)return l.domAtPos(l.length)}for(let a=o;a<s.length;a++){let l=s[a];if(l.dom.parentNode==n)return l.domAtPos(0)}return new DOMPos(n,0)}function joinInlineInto(r,e,n){let s,{children:o}=r;n>0&&e instanceof MarkView&&o.length&&(s=o[o.length-1])instanceof MarkView&&s.mark.eq(e.mark)?joinInlineInto(s,e.children[0],n-1):(o.push(e),e.setParent(r)),r.length+=e.length}function coordsInChildren(r,e,n){let s=null,o=-1,a=null,l=-1;function c(f,d){for(let p=0,g=0;p<f.children.length&&g<=d;p++){let y=f.children[p],x=g+y.length;x>=d&&(y.children.length?c(y,d-g):(!a||a.isHidden&&(n>0||onSameLine(a,y)))&&(x>d||g==x&&y.getSide()>0)?(a=y,l=d-g):(g<d||g==x&&y.getSide()<0&&!y.isHidden)&&(s=y,o=d-g)),g=x}}c(r,e);let u=(n<0?s:a)||s||a;return u?u.coordsAt(Math.max(0,u==s?o:l),n):fallbackRect(r)}function fallbackRect(r){let e=r.dom.lastChild;if(!e)return r.dom.getBoundingClientRect();let n=clientRectsFor(e);return n[n.length-1]||null}function onSameLine(r,e){let n=r.coordsAt(0,1),s=e.coordsAt(0,1);return n&&s&&s.top<n.bottom}function combineAttrs(r,e){for(let n in r)n=="class"&&e.class?e.class+=" "+r.class:n=="style"&&e.style?e.style+=";"+r.style:e[n]=r[n];return e}const noAttrs$1=Object.create(null);function attrsEq(r,e,n){if(r==e)return!0;r||(r=noAttrs$1),e||(e=noAttrs$1);let s=Object.keys(r),o=Object.keys(e);if(s.length-(n&&s.indexOf(n)>-1?1:0)!=o.length-(n&&o.indexOf(n)>-1?1:0))return!1;for(let a of s)if(a!=n&&(o.indexOf(a)==-1||r[a]!==e[a]))return!1;return!0}function updateAttrs(r,e,n){let s=!1;if(e)for(let o in e)n&&o in n||(s=!0,o=="style"?r.style.cssText="":r.removeAttribute(o));if(n)for(let o in n)e&&e[o]==n[o]||(s=!0,o=="style"?r.style.cssText=n[o]:r.setAttribute(o,n[o]));return s}function getAttrs(r){let e=Object.create(null);for(let n=0;n<r.attributes.length;n++){let s=r.attributes[n];e[s.name]=s.value}return e}class WidgetType{eq(e){return!1}updateDOM(e,n){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,n,s){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var BlockType=function(r){return r[r.Text=0]="Text",r[r.WidgetBefore=1]="WidgetBefore",r[r.WidgetAfter=2]="WidgetAfter",r[r.WidgetRange=3]="WidgetRange",r}(BlockType||(BlockType={}));class Decoration extends RangeValue{constructor(e,n,s,o){super(),this.startSide=e,this.endSide=n,this.widget=s,this.spec=o}get heightRelevant(){return!1}static mark(e){return new MarkDecoration(e)}static widget(e){let n=Math.max(-1e4,Math.min(1e4,e.side||0)),s=!!e.block;return n+=s&&!e.inlineOrder?n>0?3e8:-4e8:n>0?1e8:-1e8,new PointDecoration(e,n,n,s,e.widget||null,!1)}static replace(e){let n=!!e.block,s,o;if(e.isBlockGap)s=-5e8,o=4e8;else{let{start:a,end:l}=getInclusive(e,n);s=(a?n?-3e8:-1:5e8)-1,o=(l?n?2e8:1:-6e8)+1}return new PointDecoration(e,s,o,n,e.widget||null,!0)}static line(e){return new LineDecoration(e)}static set(e,n=!1){return RangeSet.of(e,n)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}Decoration.none=RangeSet.empty;class MarkDecoration extends Decoration{constructor(e){let{start:n,end:s}=getInclusive(e);super(n?-1:5e8,s?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var n,s;return this==e||e instanceof MarkDecoration&&this.tagName==e.tagName&&(this.class||((n=this.attrs)===null||n===void 0?void 0:n.class))==(e.class||((s=e.attrs)===null||s===void 0?void 0:s.class))&&attrsEq(this.attrs,e.attrs,"class")}range(e,n=e){if(e>=n)throw new RangeError("Mark decorations may not be empty");return super.range(e,n)}}MarkDecoration.prototype.point=!1;class LineDecoration extends Decoration{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof LineDecoration&&this.spec.class==e.spec.class&&attrsEq(this.spec.attributes,e.spec.attributes)}range(e,n=e){if(n!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,n)}}LineDecoration.prototype.mapMode=MapMode.TrackBefore;LineDecoration.prototype.point=!0;class PointDecoration extends Decoration{constructor(e,n,s,o,a,l){super(n,s,a,e),this.block=o,this.isReplace=l,this.mapMode=o?n<=0?MapMode.TrackBefore:MapMode.TrackAfter:MapMode.TrackDel}get type(){return this.startSide!=this.endSide?BlockType.WidgetRange:this.startSide<=0?BlockType.WidgetBefore:BlockType.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof PointDecoration&&widgetsEq(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,n=e){if(this.isReplace&&(e>n||e==n&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&n!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,n)}}PointDecoration.prototype.point=!0;function getInclusive(r,e=!1){let{inclusiveStart:n,inclusiveEnd:s}=r;return n==null&&(n=r.inclusive),s==null&&(s=r.inclusive),{start:n??e,end:s??e}}function widgetsEq(r,e){return r==e||!!(r&&e&&r.compare(e))}function addRange(r,e,n,s=0){let o=n.length-1;o>=0&&n[o]+s>=r?n[o]=Math.max(n[o],e):n.push(r,e)}class LineView extends ContentView{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,n,s,o,a,l){if(s){if(!(s instanceof LineView))return!1;this.dom||s.transferDOM(this)}return o&&this.setDeco(s?s.attrs:null),mergeChildrenInto(this,e,n,s?s.children.slice():[],a,l),!0}split(e){let n=new LineView;if(n.breakAfter=this.breakAfter,this.length==0)return n;let{i:s,off:o}=this.childPos(e);o&&(n.append(this.children[s].split(o),0),this.children[s].merge(o,this.children[s].length,null,!1,0,0),s++);for(let a=s;a<this.children.length;a++)n.append(this.children[a],0);for(;s>0&&this.children[s-1].length==0;)this.children[--s].destroy();return this.children.length=s,this.markDirty(),this.length=e,n}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){attrsEq(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,n){joinInlineInto(this,e,n)}addLineDeco(e){let n=e.spec.attributes,s=e.spec.class;n&&(this.attrs=combineAttrs(n,this.attrs||{})),s&&(this.attrs=combineAttrs({class:s},this.attrs||{}))}domAtPos(e){return inlineDOMAtPos(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.flags|=6)}sync(e,n){var s;this.dom?this.flags&4&&(clearAttributes(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(updateAttrs(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,n);let o=this.dom.lastChild;for(;o&&ContentView.get(o)instanceof MarkView;)o=o.lastChild;if(!o||!this.length||o.nodeName!="BR"&&((s=ContentView.get(o))===null||s===void 0?void 0:s.isEditable)==!1&&(!browser.ios||!this.children.some(a=>a instanceof TextView))){let a=document.createElement("BR");a.cmIgnore=!0,this.dom.appendChild(a)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,n;for(let s of this.children){if(!(s instanceof TextView)||/[^ -~]/.test(s.text))return null;let o=clientRectsFor(s.dom);if(o.length!=1)return null;e+=o[0].width,n=o[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:n}:null}coordsAt(e,n){let s=coordsInChildren(this,e,n);if(!this.children.length&&s&&this.parent){let{heightOracle:o}=this.parent.view.viewState,a=s.bottom-s.top;if(Math.abs(a-o.lineHeight)<2&&o.textHeight<a){let l=(a-o.textHeight)/2;return{top:s.top+l,bottom:s.bottom-l,left:s.left,right:s.left}}}return s}become(e){return e instanceof LineView&&this.children.length==0&&e.children.length==0&&attrsEq(this.attrs,e.attrs)&&this.breakAfter==e.breakAfter}covers(){return!0}static find(e,n){for(let s=0,o=0;s<e.children.length;s++){let a=e.children[s],l=o+a.length;if(l>=n){if(a instanceof LineView)return a;if(l>n)break}o=l+a.breakAfter}return null}}class BlockWidgetView extends ContentView{constructor(e,n,s){super(),this.widget=e,this.length=n,this.deco=s,this.breakAfter=0,this.prevWidget=null}merge(e,n,s,o,a,l){return s&&(!(s instanceof BlockWidgetView)||!this.widget.compare(s.widget)||e>0&&a<=0||n<this.length&&l<=0)?!1:(this.length=e+(s?s.length:0)+(this.length-n),!0)}domAtPos(e){return e==0?DOMPos.before(this.dom):DOMPos.after(this.dom,e==this.length)}split(e){let n=this.length-e;this.length=e;let s=new BlockWidgetView(this.widget,n,this.deco);return s.breakAfter=this.breakAfter,s}get children(){return noChildren}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):Text.empty}domBoundsAround(){return null}become(e){return e instanceof BlockWidgetView&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,n){let s=this.widget.coordsAt(this.dom,e,n);return s||(this.widget instanceof BlockGapWidget?null:flattenRect(this.dom.getBoundingClientRect(),this.length?e==0:n<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:n,endSide:s}=this.deco;return n==s?!1:e<0?n<0:s>0}}class BlockGapWidget extends WidgetType{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class ContentBuilder{constructor(e,n,s,o){this.doc=e,this.pos=n,this.end=s,this.disallowBlockEffectsFor=o,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=n}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof BlockWidgetView&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new LineView),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(wrapMarks(new WidgetBufferView(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(e&&this.content.length&&this.content[this.content.length-1]instanceof BlockWidgetView)&&this.getLine()}buildText(e,n,s){for(;e>0;){if(this.textOff==this.text.length){let{value:a,lineBreak:l,done:c}=this.cursor.next(this.skip);if(this.skip=0,c)throw new Error("Ran out of text content when drawing inline views");if(l){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=a,this.textOff=0}let o=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(n.slice(n.length-s)),this.getLine().append(wrapMarks(new TextView(this.text.slice(this.textOff,this.textOff+o)),n),s),this.atCursorPos=!0,this.textOff+=o,e-=o,s=0}}span(e,n,s,o){this.buildText(n-e,s,o),this.pos=n,this.openStart<0&&(this.openStart=o)}point(e,n,s,o,a,l){if(this.disallowBlockEffectsFor[l]&&s instanceof PointDecoration){if(s.block)throw new RangeError("Block decorations may not be specified via plugins");if(n>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let c=n-e;if(s instanceof PointDecoration)if(s.block)s.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new BlockWidgetView(s.widget||NullWidget.block,c,s));else{let u=WidgetView.create(s.widget||NullWidget.inline,c,c?0:s.startSide),f=this.atCursorPos&&!u.isEditable&&a<=o.length&&(e<n||s.startSide>0),d=!u.isEditable&&(e<n||a>o.length||s.startSide<=0),p=this.getLine();this.pendingBuffer==2&&!f&&!u.isEditable&&(this.pendingBuffer=0),this.flushBuffer(o),f&&(p.append(wrapMarks(new WidgetBufferView(1),o),a),a=o.length+Math.max(0,a-o.length)),p.append(wrapMarks(u,o),a),this.atCursorPos=d,this.pendingBuffer=d?e<n||a>o.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=o.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(s);c&&(this.textOff+c<=this.text.length?this.textOff+=c:(this.skip+=c-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=n),this.openStart<0&&(this.openStart=a)}static build(e,n,s,o,a){let l=new ContentBuilder(e,n,s,a);return l.openEnd=RangeSet.spans(o,n,s,l),l.openStart<0&&(l.openStart=l.openEnd),l.finish(l.openEnd),l}}function wrapMarks(r,e){for(let n of e)r=new MarkView(n,[r],r.length);return r}class NullWidget extends WidgetType{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}NullWidget.inline=new NullWidget("span");NullWidget.block=new NullWidget("div");var Direction=function(r){return r[r.LTR=0]="LTR",r[r.RTL=1]="RTL",r}(Direction||(Direction={}));const LTR=Direction.LTR,RTL=Direction.RTL;function dec(r){let e=[];for(let n=0;n<r.length;n++)e.push(1<<+r[n]);return e}const LowTypes=dec("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),ArabicTypes=dec("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Brackets=Object.create(null),BracketStack=[];for(let r of["()","[]","{}"]){let e=r.charCodeAt(0),n=r.charCodeAt(1);Brackets[e]=n,Brackets[n]=-e}function charType(r){return r<=247?LowTypes[r]:1424<=r&&r<=1524?2:1536<=r&&r<=1785?ArabicTypes[r-1536]:1774<=r&&r<=2220?4:8192<=r&&r<=8204?256:64336<=r&&r<=65023?4:1}const BidiRE=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class BidiSpan{get dir(){return this.level%2?RTL:LTR}constructor(e,n,s){this.from=e,this.to=n,this.level=s}side(e,n){return this.dir==n==e?this.to:this.from}forward(e,n){return e==(this.dir==n)}static find(e,n,s,o){let a=-1;for(let l=0;l<e.length;l++){let c=e[l];if(c.from<=n&&c.to>=n){if(c.level==s)return l;(a<0||(o!=0?o<0?c.from<n:c.to>n:e[a].level>c.level))&&(a=l)}}if(a<0)throw new RangeError("Index out of range");return a}}function isolatesEq(r,e){if(r.length!=e.length)return!1;for(let n=0;n<r.length;n++){let s=r[n],o=e[n];if(s.from!=o.from||s.to!=o.to||s.direction!=o.direction||!isolatesEq(s.inner,o.inner))return!1}return!0}const types=[];function computeCharTypes(r,e,n,s,o){for(let a=0;a<=s.length;a++){let l=a?s[a-1].to:e,c=a<s.length?s[a].from:n,u=a?256:o;for(let f=l,d=u,p=u;f<c;f++){let g=charType(r.charCodeAt(f));g==512?g=d:g==8&&p==4&&(g=16),types[f]=g==4?2:g,g&7&&(p=g),d=g}for(let f=l,d=u,p=u;f<c;f++){let g=types[f];if(g==128)f<c-1&&d==types[f+1]&&d&24?g=types[f]=d:types[f]=256;else if(g==64){let y=f+1;for(;y<c&&types[y]==64;)y++;let x=f&&d==8||y<n&&types[y]==8?p==1?1:8:256;for(let E=f;E<y;E++)types[E]=x;f=y-1}else g==8&&p==1&&(types[f]=1);d=g,g&7&&(p=g)}}}function processBracketPairs(r,e,n,s,o){let a=o==1?2:1;for(let l=0,c=0,u=0;l<=s.length;l++){let f=l?s[l-1].to:e,d=l<s.length?s[l].from:n;for(let p=f,g,y,x;p<d;p++)if(y=Brackets[g=r.charCodeAt(p)])if(y<0){for(let E=c-3;E>=0;E-=3)if(BracketStack[E+1]==-y){let Y=BracketStack[E+2],Z=Y&2?o:Y&4?Y&1?a:o:0;Z&&(types[p]=types[BracketStack[E]]=Z),c=E;break}}else{if(BracketStack.length==189)break;BracketStack[c++]=p,BracketStack[c++]=g,BracketStack[c++]=u}else if((x=types[p])==2||x==1){let E=x==o;u=E?0:1;for(let Y=c-3;Y>=0;Y-=3){let Z=BracketStack[Y+2];if(Z&2)break;if(E)BracketStack[Y+2]|=2;else{if(Z&4)break;BracketStack[Y+2]|=4}}}}}function processNeutrals(r,e,n,s){for(let o=0,a=s;o<=n.length;o++){let l=o?n[o-1].to:r,c=o<n.length?n[o].from:e;for(let u=l;u<c;){let f=types[u];if(f==256){let d=u+1;for(;;)if(d==c){if(o==n.length)break;d=n[o++].to,c=o<n.length?n[o].from:e}else if(types[d]==256)d++;else break;let p=a==1,g=(d<e?types[d]:s)==1,y=p==g?p?1:2:s;for(let x=d,E=o,Y=E?n[E-1].to:r;x>u;)x==Y&&(x=n[--E].from,Y=E?n[E-1].to:r),types[--x]=y;u=d}else a=f,u++}}}function emitSpans(r,e,n,s,o,a,l){let c=s%2?2:1;if(s%2==o%2)for(let u=e,f=0;u<n;){let d=!0,p=!1;if(f==a.length||u<a[f].from){let E=types[u];E!=c&&(d=!1,p=E==16)}let g=!d&&c==1?[]:null,y=d?s:s+1,x=u;e:for(;;)if(f<a.length&&x==a[f].from){if(p)break e;let E=a[f];if(!d)for(let Y=E.to,Z=f+1;;){if(Y==n)break e;if(Z<a.length&&a[Z].from==Y)Y=a[Z++].to;else{if(types[Y]==c)break e;break}}if(f++,g)g.push(E);else{E.from>u&&l.push(new BidiSpan(u,E.from,y));let Y=E.direction==LTR!=!(y%2);computeSectionOrder(r,Y?s+1:s,o,E.inner,E.from,E.to,l),u=E.to}x=E.to}else{if(x==n||(d?types[x]!=c:types[x]==c))break;x++}g?emitSpans(r,u,x,s+1,o,g,l):u<x&&l.push(new BidiSpan(u,x,y)),u=x}else for(let u=n,f=a.length;u>e;){let d=!0,p=!1;if(!f||u>a[f-1].to){let E=types[u-1];E!=c&&(d=!1,p=E==16)}let g=!d&&c==1?[]:null,y=d?s:s+1,x=u;e:for(;;)if(f&&x==a[f-1].to){if(p)break e;let E=a[--f];if(!d)for(let Y=E.from,Z=f;;){if(Y==e)break e;if(Z&&a[Z-1].to==Y)Y=a[--Z].from;else{if(types[Y-1]==c)break e;break}}if(g)g.push(E);else{E.to<u&&l.push(new BidiSpan(E.to,u,y));let Y=E.direction==LTR!=!(y%2);computeSectionOrder(r,Y?s+1:s,o,E.inner,E.from,E.to,l),u=E.from}x=E.from}else{if(x==e||(d?types[x-1]!=c:types[x-1]==c))break;x--}g?emitSpans(r,x,u,s+1,o,g,l):x<u&&l.push(new BidiSpan(x,u,y)),u=x}}function computeSectionOrder(r,e,n,s,o,a,l){let c=e%2?2:1;computeCharTypes(r,o,a,s,c),processBracketPairs(r,o,a,s,c),processNeutrals(o,a,s,c),emitSpans(r,o,a,e,n,s,l)}function computeOrder(r,e,n){if(!r)return[new BidiSpan(0,0,e==RTL?1:0)];if(e==LTR&&!n.length&&!BidiRE.test(r))return trivialOrder(r.length);if(n.length)for(;r.length>types.length;)types[types.length]=256;let s=[],o=e==LTR?0:1;return computeSectionOrder(r,o,o,n,0,r.length,s),s}function trivialOrder(r){return[new BidiSpan(0,r,0)]}let movedOver="";function moveVisually(r,e,n,s,o){var a;let l=s.head-r.from,c=BidiSpan.find(e,l,(a=s.bidiLevel)!==null&&a!==void 0?a:-1,s.assoc),u=e[c],f=u.side(o,n);if(l==f){let g=c+=o?1:-1;if(g<0||g>=e.length)return null;u=e[c=g],l=u.side(!o,n),f=u.side(o,n)}let d=findClusterBreak(r.text,l,u.forward(o,n));(d<u.from||d>u.to)&&(d=f),movedOver=r.text.slice(Math.min(l,d),Math.max(l,d));let p=c==(o?e.length-1:0)?null:e[c+(o?1:-1)];return p&&d==f&&p.level+(o?0:1)<u.level?EditorSelection.cursor(p.side(!o,n)+r.from,p.forward(o,n)?1:-1,p.level):EditorSelection.cursor(d+r.from,u.forward(o,n)?-1:1,u.level)}function autoDirection(r,e,n){for(let s=e;s<n;s++){let o=charType(r.charCodeAt(s));if(o==1)return LTR;if(o==2||o==4)return RTL}return LTR}const clickAddsSelectionRange=Facet.define(),dragMovesSelection$1=Facet.define(),mouseSelectionStyle=Facet.define(),exceptionSink=Facet.define(),updateListener=Facet.define(),inputHandler$1=Facet.define(),focusChangeEffect=Facet.define(),clipboardInputFilter=Facet.define(),clipboardOutputFilter=Facet.define(),perLineTextDirection=Facet.define({combine:r=>r.some(e=>e)}),nativeSelectionHidden=Facet.define({combine:r=>r.some(e=>e)}),scrollHandler=Facet.define();class ScrollTarget{constructor(e,n="nearest",s="nearest",o=5,a=5,l=!1){this.range=e,this.y=n,this.x=s,this.yMargin=o,this.xMargin=a,this.isSnapshot=l}map(e){return e.empty?this:new ScrollTarget(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new ScrollTarget(EditorSelection.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const scrollIntoView$1=StateEffect.define({map:(r,e)=>r.map(e)}),setEditContextFormatting=StateEffect.define();function logException(r,e,n){let s=r.facet(exceptionSink);s.length?s[0](e):window.onerror&&window.onerror(String(e),n,void 0,void 0,e)||(n?console.error(n+":",e):console.error(e))}const editable=Facet.define({combine:r=>r.length?r[0]:!0});let nextPluginID=0;const viewPlugin=Facet.define({combine(r){return r.filter((e,n)=>{for(let s=0;s<n;s++)if(r[s].plugin==e.plugin)return!1;return!0})}});class ViewPlugin{constructor(e,n,s,o,a){this.id=e,this.create=n,this.domEventHandlers=s,this.domEventObservers=o,this.baseExtensions=a(this),this.extension=this.baseExtensions.concat(viewPlugin.of({plugin:this,arg:void 0}))}of(e){return this.baseExtensions.concat(viewPlugin.of({plugin:this,arg:e}))}static define(e,n){const{eventHandlers:s,eventObservers:o,provide:a,decorations:l}=n||{};return new ViewPlugin(nextPluginID++,e,s,o,c=>{let u=[];return l&&u.push(decorations.of(f=>{let d=f.plugin(c);return d?l(d):Decoration.none})),a&&u.push(a(c)),u})}static fromClass(e,n){return ViewPlugin.define((s,o)=>new e(s,o),n)}}class PluginInstance{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}get plugin(){return this.spec&&this.spec.plugin}update(e){if(this.value){if(this.mustUpdate){let n=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(n)}catch(s){if(logException(n.state,s,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.plugin.create(e,this.spec.arg)}catch(n){logException(e.state,n,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var n;if(!((n=this.value)===null||n===void 0)&&n.destroy)try{this.value.destroy()}catch(s){logException(e.state,s,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const editorAttributes=Facet.define(),contentAttributes=Facet.define(),decorations=Facet.define(),outerDecorations=Facet.define(),atomicRanges=Facet.define(),bidiIsolatedRanges=Facet.define();function getIsolatedRanges(r,e){let n=r.state.facet(bidiIsolatedRanges);if(!n.length)return n;let s=n.map(a=>a instanceof Function?a(r):a),o=[];return RangeSet.spans(s,e.from,e.to,{point(){},span(a,l,c,u){let f=a-e.from,d=l-e.from,p=o;for(let g=c.length-1;g>=0;g--,u--){let y=c[g].spec.bidiIsolate,x;if(y==null&&(y=autoDirection(e.text,f,d)),u>0&&p.length&&(x=p[p.length-1]).to==f&&x.direction==y)x.to=d,p=x.inner;else{let E={from:f,to:d,direction:y,inner:[]};p.push(E),p=E.inner}}}}),o}const scrollMargins=Facet.define();function getScrollMargins(r){let e=0,n=0,s=0,o=0;for(let a of r.state.facet(scrollMargins)){let l=a(r);l&&(l.left!=null&&(e=Math.max(e,l.left)),l.right!=null&&(n=Math.max(n,l.right)),l.top!=null&&(s=Math.max(s,l.top)),l.bottom!=null&&(o=Math.max(o,l.bottom)))}return{left:e,right:n,top:s,bottom:o}}const styleModule=Facet.define();class ChangedRange{constructor(e,n,s,o){this.fromA=e,this.toA=n,this.fromB=s,this.toB=o}join(e){return new ChangedRange(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let n=e.length,s=this;for(;n>0;n--){let o=e[n-1];if(!(o.fromA>s.toA)){if(o.toA<s.fromA)break;s=s.join(o),e.splice(n-1,1)}}return e.splice(n,0,s),e}static extendWithRanges(e,n){if(n.length==0)return e;let s=[];for(let o=0,a=0,l=0,c=0;;o++){let u=o==e.length?null:e[o],f=l-c,d=u?u.fromB:1e9;for(;a<n.length&&n[a]<d;){let p=n[a],g=n[a+1],y=Math.max(c,p),x=Math.min(d,g);if(y<=x&&new ChangedRange(y+f,x+f,y,x).addToSet(s),g>d)break;a+=2}if(!u)return s;new ChangedRange(u.fromA,u.toA,u.fromB,u.toB).addToSet(s),l=u.toA,c=u.toB}}}class ViewUpdate{constructor(e,n,s){this.view=e,this.state=n,this.transactions=s,this.flags=0,this.startState=e.state,this.changes=ChangeSet.empty(this.startState.doc.length);for(let a of s)this.changes=this.changes.compose(a.changes);let o=[];this.changes.iterChangedRanges((a,l,c,u)=>o.push(new ChangedRange(a,l,c,u))),this.changedRanges=o}static create(e,n,s){return new ViewUpdate(e,n,s)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class DocView extends ContentView{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=Decoration.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new LineView],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new ChangedRange(0,0,0,e.state.doc.length)],0,null)}update(e){var n;let s=e.changedRanges;this.minWidth>0&&s.length&&(s.every(({fromA:f,toA:d})=>d<this.minWidthFrom||f>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let o=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((n=this.domChanged)===null||n===void 0)&&n.newSel?o=this.domChanged.newSel.head:!touchesComposition(e.changes,this.hasComposition)&&!e.selectionSet&&(o=e.state.selection.main.head));let a=o>-1?findCompositionRange(this.view,e.changes,o):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:f,to:d}=this.hasComposition;s=new ChangedRange(f,d,e.changes.mapPos(f,-1),e.changes.mapPos(d,1)).addToSet(s.slice())}this.hasComposition=a?{from:a.range.fromB,to:a.range.toB}:null,(browser.ie||browser.chrome)&&!a&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let l=this.decorations,c=this.updateDeco(),u=findChangedDeco(l,c,e.changes);return s=ChangedRange.extendWithRanges(s,u),!(this.flags&7)&&s.length==0?!1:(this.updateInner(s,e.startState.doc.length,a),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,n,s){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,n,s);let{observer:o}=this.view;o.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let l=browser.chrome||browser.ios?{node:o.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,l),this.flags&=-8,l&&(l.written||o.selectionRange.focusNode!=l.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(l=>l.flags&=-9);let a=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let l of this.children)l instanceof BlockWidgetView&&l.widget instanceof BlockGapWidget&&a.push(l.dom);o.updateGaps(a)}updateChildren(e,n,s){let o=s?s.range.addToSet(e.slice()):e,a=this.childCursor(n);for(let l=o.length-1;;l--){let c=l>=0?o[l]:null;if(!c)break;let{fromA:u,toA:f,fromB:d,toB:p}=c,g,y,x,E;if(s&&s.range.fromB<p&&s.range.toB>d){let Ve=ContentBuilder.build(this.view.state.doc,d,s.range.fromB,this.decorations,this.dynamicDecorationMap),me=ContentBuilder.build(this.view.state.doc,s.range.toB,p,this.decorations,this.dynamicDecorationMap);y=Ve.breakAtStart,x=Ve.openStart,E=me.openEnd;let rt=this.compositionView(s);me.breakAtStart?rt.breakAfter=1:me.content.length&&rt.merge(rt.length,rt.length,me.content[0],!1,me.openStart,0)&&(rt.breakAfter=me.content[0].breakAfter,me.content.shift()),Ve.content.length&&rt.merge(0,0,Ve.content[Ve.content.length-1],!0,0,Ve.openEnd)&&Ve.content.pop(),g=Ve.content.concat(rt).concat(me.content)}else({content:g,breakAtStart:y,openStart:x,openEnd:E}=ContentBuilder.build(this.view.state.doc,d,p,this.decorations,this.dynamicDecorationMap));let{i:Y,off:Z}=a.findPos(f,1),{i:te,off:ne}=a.findPos(u,-1);replaceRange(this,te,ne,Y,Z,g,y,x,E)}s&&this.fixCompositionDOM(s)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let n of e.transactions)for(let s of n.effects)s.is(setEditContextFormatting)&&(this.editContextFormatting=s.value)}compositionView(e){let n=new TextView(e.text.nodeValue);n.flags|=8;for(let{deco:o}of e.marks)n=new MarkView(o,[n],n.length);let s=new LineView;return s.append(n,0),s}fixCompositionDOM(e){let n=(a,l)=>{l.flags|=8|(l.children.some(u=>u.flags&7)?1:0),this.markedForComposition.add(l);let c=ContentView.get(a);c&&c!=l&&(c.dom=null),l.setDOM(a)},s=this.childPos(e.range.fromB,1),o=this.children[s.i];n(e.line,o);for(let a=e.marks.length-1;a>=-1;a--)s=o.childPos(s.off,1),o=o.children[s.i],n(a>=0?e.marks[a].node:e.text,o)}updateSelection(e=!1,n=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let s=this.view.root.activeElement,o=s==this.dom,a=!o&&!(this.view.state.facet(editable)||this.dom.tabIndex>-1)&&hasSelection(this.dom,this.view.observer.selectionRange)&&!(s&&this.dom.contains(s));if(!(o||n||a))return;let l=this.forceSelection;this.forceSelection=!1;let c=this.view.state.selection.main,u=this.moveToLine(this.domAtPos(c.anchor)),f=c.empty?u:this.moveToLine(this.domAtPos(c.head));if(browser.gecko&&c.empty&&!this.hasComposition&&betweenUneditable(u)){let p=document.createTextNode("");this.view.observer.ignore(()=>u.node.insertBefore(p,u.node.childNodes[u.offset]||null)),u=f=new DOMPos(p,0),l=!0}let d=this.view.observer.selectionRange;(l||!d.focusNode||(!isEquivalentPosition(u.node,u.offset,d.anchorNode,d.anchorOffset)||!isEquivalentPosition(f.node,f.offset,d.focusNode,d.focusOffset))&&!this.suppressWidgetCursorChange(d,c))&&(this.view.observer.ignore(()=>{browser.android&&browser.chrome&&this.dom.contains(d.focusNode)&&inUneditable(d.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let p=getSelection(this.view.root);if(p)if(c.empty){if(browser.gecko){let g=nextToUneditable(u.node,u.offset);if(g&&g!=3){let y=(g==1?textNodeBefore:textNodeAfter)(u.node,u.offset);y&&(u=new DOMPos(y.node,y.offset))}}p.collapse(u.node,u.offset),c.bidiLevel!=null&&p.caretBidiLevel!==void 0&&(p.caretBidiLevel=c.bidiLevel)}else if(p.extend){p.collapse(u.node,u.offset);try{p.extend(f.node,f.offset)}catch{}}else{let g=document.createRange();c.anchor>c.head&&([u,f]=[f,u]),g.setEnd(f.node,f.offset),g.setStart(u.node,u.offset),p.removeAllRanges(),p.addRange(g)}a&&this.view.root.activeElement==this.dom&&(this.dom.blur(),s&&s.focus())}),this.view.observer.setSelectionRange(u,f)),this.impreciseAnchor=u.precise?null:new DOMPos(d.anchorNode,d.anchorOffset),this.impreciseHead=f.precise?null:new DOMPos(d.focusNode,d.focusOffset)}suppressWidgetCursorChange(e,n){return this.hasComposition&&n.empty&&isEquivalentPosition(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==n.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,n=e.state.selection.main,s=getSelection(e.root),{anchorNode:o,anchorOffset:a}=e.observer.selectionRange;if(!s||!n.empty||!n.assoc||!s.modify)return;let l=LineView.find(this,n.head);if(!l)return;let c=l.posAtStart;if(n.head==c||n.head==c+l.length)return;let u=this.coordsAt(n.head,-1),f=this.coordsAt(n.head,1);if(!u||!f||u.bottom>f.top)return;let d=this.domAtPos(n.head+n.assoc);s.collapse(d.node,d.offset),s.modify("move",n.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let p=e.observer.selectionRange;e.docView.posFromDOM(p.anchorNode,p.anchorOffset)!=n.from&&s.collapse(o,a)}moveToLine(e){let n=this.dom,s;if(e.node!=n)return e;for(let o=e.offset;!s&&o<n.childNodes.length;o++){let a=ContentView.get(n.childNodes[o]);a instanceof LineView&&(s=a.domAtPos(0))}for(let o=e.offset-1;!s&&o>=0;o--){let a=ContentView.get(n.childNodes[o]);a instanceof LineView&&(s=a.domAtPos(a.length))}return s?new DOMPos(s.node,s.offset,!0):e}nearest(e){for(let n=e;n;){let s=ContentView.get(n);if(s&&s.rootView==this)return s;n=n.parentNode}return null}posFromDOM(e,n){let s=this.nearest(e);if(!s)throw new RangeError("Trying to find position for a DOM position outside of the document");return s.localPosFromDOM(e,n)+s.posAtStart}domAtPos(e){let{i:n,off:s}=this.childCursor().findPos(e,-1);for(;n<this.children.length-1;){let o=this.children[n];if(s<o.length||o instanceof LineView)break;n++,s=0}return this.children[n].domAtPos(s)}coordsAt(e,n){let s=null,o=0;for(let a=this.length,l=this.children.length-1;l>=0;l--){let c=this.children[l],u=a-c.breakAfter,f=u-c.length;if(u<e)break;if(f<=e&&(f<e||c.covers(-1))&&(u>e||c.covers(1))&&(!s||c instanceof LineView&&!(s instanceof LineView&&n>=0)))s=c,o=f;else if(s&&f==e&&u==e&&c instanceof BlockWidgetView&&Math.abs(n)<2){if(c.deco.startSide<0)break;l&&(s=null)}a=f}return s?s.coordsAt(e-o,n):null}coordsForChar(e){let{i:n,off:s}=this.childPos(e,1),o=this.children[n];if(!(o instanceof LineView))return null;for(;o.children.length;){let{i:c,off:u}=o.childPos(s,1);for(;;c++){if(c==o.children.length)return null;if((o=o.children[c]).length)break}s=u}if(!(o instanceof TextView))return null;let a=findClusterBreak(o.text,s);if(a==s)return null;let l=textRange(o.dom,s,a).getClientRects();for(let c=0;c<l.length;c++){let u=l[c];if(c==l.length-1||u.top<u.bottom&&u.left<u.right)return u}return null}measureVisibleLineHeights(e){let n=[],{from:s,to:o}=e,a=this.view.contentDOM.clientWidth,l=a>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,c=-1,u=this.view.textDirection==Direction.LTR;for(let f=0,d=0;d<this.children.length;d++){let p=this.children[d],g=f+p.length;if(g>o)break;if(f>=s){let y=p.dom.getBoundingClientRect();if(n.push(y.height),l){let x=p.dom.lastChild,E=x?clientRectsFor(x):[];if(E.length){let Y=E[E.length-1],Z=u?Y.right-y.left:y.right-Y.left;Z>c&&(c=Z,this.minWidth=a,this.minWidthFrom=f,this.minWidthTo=g)}}}f=g+p.breakAfter}return n}textDirectionAt(e){let{i:n}=this.childPos(e,1);return getComputedStyle(this.children[n].dom).direction=="rtl"?Direction.RTL:Direction.LTR}measureTextSize(){for(let a of this.children)if(a instanceof LineView){let l=a.measureTextSize();if(l)return l}let e=document.createElement("div"),n,s,o;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let a=clientRectsFor(e.firstChild)[0];n=e.getBoundingClientRect().height,s=a?a.width/27:7,o=a?a.height:n,e.remove()}),{lineHeight:n,charWidth:s,textHeight:o}}childCursor(e=this.length){let n=this.children.length;return n&&(e-=this.children[--n].length),new ChildCursor(this.children,e,n)}computeBlockGapDeco(){let e=[],n=this.view.viewState;for(let s=0,o=0;;o++){let a=o==n.viewports.length?null:n.viewports[o],l=a?a.from-1:this.length;if(l>s){let c=(n.lineBlockAt(l).bottom-n.lineBlockAt(s).top)/this.view.scaleY;e.push(Decoration.replace({widget:new BlockGapWidget(c),block:!0,inclusive:!0,isBlockGap:!0}).range(s,l))}if(!a)break;s=a.to+1}return Decoration.set(e)}updateDeco(){let e=1,n=this.view.state.facet(decorations).map(a=>(this.dynamicDecorationMap[e++]=typeof a=="function")?a(this.view):a),s=!1,o=this.view.state.facet(outerDecorations).map((a,l)=>{let c=typeof a=="function";return c&&(s=!0),c?a(this.view):a});for(o.length&&(this.dynamicDecorationMap[e++]=s,n.push(RangeSet.join(o))),this.decorations=[this.editContextFormatting,...n,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;return this.decorations}scrollIntoView(e){if(e.isSnapshot){let f=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=f.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let f of this.view.state.facet(scrollHandler))try{if(f(this.view,e.range,e))return!0}catch(d){logException(this.view.state,d,"scroll handler")}let{range:n}=e,s=this.coordsAt(n.head,n.empty?n.assoc:n.head>n.anchor?-1:1),o;if(!s)return;!n.empty&&(o=this.coordsAt(n.anchor,n.anchor>n.head?-1:1))&&(s={left:Math.min(s.left,o.left),top:Math.min(s.top,o.top),right:Math.max(s.right,o.right),bottom:Math.max(s.bottom,o.bottom)});let a=getScrollMargins(this.view),l={left:s.left-a.left,top:s.top-a.top,right:s.right+a.right,bottom:s.bottom+a.bottom},{offsetWidth:c,offsetHeight:u}=this.view.scrollDOM;scrollRectIntoView(this.view.scrollDOM,l,n.head<n.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,c),-c),Math.max(Math.min(e.yMargin,u),-u),this.view.textDirection==Direction.LTR)}}function betweenUneditable(r){return r.node.nodeType==1&&r.node.firstChild&&(r.offset==0||r.node.childNodes[r.offset-1].contentEditable=="false")&&(r.offset==r.node.childNodes.length||r.node.childNodes[r.offset].contentEditable=="false")}function findCompositionNode(r,e){let n=r.observer.selectionRange;if(!n.focusNode)return null;let s=textNodeBefore(n.focusNode,n.focusOffset),o=textNodeAfter(n.focusNode,n.focusOffset),a=s||o;if(o&&s&&o.node!=s.node){let c=ContentView.get(o.node);if(!c||c instanceof TextView&&c.text!=o.node.nodeValue)a=o;else if(r.docView.lastCompositionAfterCursor){let u=ContentView.get(s.node);!u||u instanceof TextView&&u.text!=s.node.nodeValue||(a=o)}}if(r.docView.lastCompositionAfterCursor=a!=s,!a)return null;let l=e-a.offset;return{from:l,to:l+a.node.nodeValue.length,node:a.node}}function findCompositionRange(r,e,n){let s=findCompositionNode(r,n);if(!s)return null;let{node:o,from:a,to:l}=s,c=o.nodeValue;if(/[\n\r]/.test(c)||r.state.doc.sliceString(s.from,s.to)!=c)return null;let u=e.invertedDesc,f=new ChangedRange(u.mapPos(a),u.mapPos(l),a,l),d=[];for(let p=o.parentNode;;p=p.parentNode){let g=ContentView.get(p);if(g instanceof MarkView)d.push({node:p,deco:g.mark});else{if(g instanceof LineView||p.nodeName=="DIV"&&p.parentNode==r.contentDOM)return{range:f,text:o,marks:d,line:p};if(p!=r.contentDOM)d.push({node:p,deco:new MarkDecoration({inclusive:!0,attributes:getAttrs(p),tagName:p.tagName.toLowerCase()})});else return null}}}function nextToUneditable(r,e){return r.nodeType!=1?0:(e&&r.childNodes[e-1].contentEditable=="false"?1:0)|(e<r.childNodes.length&&r.childNodes[e].contentEditable=="false"?2:0)}let DecorationComparator$1=class{constructor(){this.changes=[]}compareRange(e,n){addRange(e,n,this.changes)}comparePoint(e,n){addRange(e,n,this.changes)}boundChange(e){addRange(e,e,this.changes)}};function findChangedDeco(r,e,n){let s=new DecorationComparator$1;return RangeSet.compare(r,e,n,s),s.changes}function inUneditable(r,e){for(let n=r;n&&n!=e;n=n.assignedSlot||n.parentNode)if(n.nodeType==1&&n.contentEditable=="false")return!0;return!1}function touchesComposition(r,e){let n=!1;return e&&r.iterChangedRanges((s,o)=>{s<e.to&&o>e.from&&(n=!0)}),n}function groupAt(r,e,n=1){let s=r.charCategorizer(e),o=r.doc.lineAt(e),a=e-o.from;if(o.length==0)return EditorSelection.cursor(e);a==0?n=1:a==o.length&&(n=-1);let l=a,c=a;n<0?l=findClusterBreak(o.text,a,!1):c=findClusterBreak(o.text,a);let u=s(o.text.slice(l,c));for(;l>0;){let f=findClusterBreak(o.text,l,!1);if(s(o.text.slice(f,l))!=u)break;l=f}for(;c<o.length;){let f=findClusterBreak(o.text,c);if(s(o.text.slice(c,f))!=u)break;c=f}return EditorSelection.range(l+o.from,c+o.from)}function getdx(r,e){return e.left>r?e.left-r:Math.max(0,r-e.right)}function getdy(r,e){return e.top>r?e.top-r:Math.max(0,r-e.bottom)}function yOverlap(r,e){return r.top<e.bottom-1&&r.bottom>e.top+1}function upTop(r,e){return e<r.top?{top:e,left:r.left,right:r.right,bottom:r.bottom}:r}function upBot(r,e){return e>r.bottom?{top:r.top,left:r.left,right:r.right,bottom:e}:r}function domPosAtCoords(r,e,n){let s,o,a,l,c=!1,u,f,d,p;for(let x=r.firstChild;x;x=x.nextSibling){let E=clientRectsFor(x);for(let Y=0;Y<E.length;Y++){let Z=E[Y];o&&yOverlap(o,Z)&&(Z=upTop(upBot(Z,o.bottom),o.top));let te=getdx(e,Z),ne=getdy(n,Z);if(te==0&&ne==0)return x.nodeType==3?domPosInText(x,e,n):domPosAtCoords(x,e,n);(!s||l>ne||l==ne&&a>te)&&(s=x,o=Z,a=te,l=ne,c=te?e<Z.left?Y>0:Y<E.length-1:!0),te==0?n>Z.bottom&&(!d||d.bottom<Z.bottom)?(u=x,d=Z):n<Z.top&&(!p||p.top>Z.top)&&(f=x,p=Z):d&&yOverlap(d,Z)?d=upBot(d,Z.bottom):p&&yOverlap(p,Z)&&(p=upTop(p,Z.top))}}if(d&&d.bottom>=n?(s=u,o=d):p&&p.top<=n&&(s=f,o=p),!s)return{node:r,offset:0};let g=Math.max(o.left,Math.min(o.right,e));if(s.nodeType==3)return domPosInText(s,g,n);if(c&&s.contentEditable!="false")return domPosAtCoords(s,g,n);let y=Array.prototype.indexOf.call(r.childNodes,s)+(e>=(o.left+o.right)/2?1:0);return{node:r,offset:y}}function domPosInText(r,e,n){let s=r.nodeValue.length,o=-1,a=1e9,l=0;for(let c=0;c<s;c++){let u=textRange(r,c,c+1).getClientRects();for(let f=0;f<u.length;f++){let d=u[f];if(d.top==d.bottom)continue;l||(l=e-d.left);let p=(d.top>n?d.top-n:n-d.bottom)-1;if(d.left-1<=e&&d.right+1>=e&&p<a){let g=e>=(d.left+d.right)/2,y=g;if((browser.chrome||browser.gecko)&&textRange(r,c).getBoundingClientRect().left==d.right&&(y=!g),p<=0)return{node:r,offset:c+(y?1:0)};o=c+(y?1:0),a=p}}}return{node:r,offset:o>-1?o:l>0?r.nodeValue.length:0}}function posAtCoords(r,e,n,s=-1){var o,a;let l=r.contentDOM.getBoundingClientRect(),c=l.top+r.viewState.paddingTop,u,{docHeight:f}=r.viewState,{x:d,y:p}=e,g=p-c;if(g<0)return 0;if(g>f)return r.state.doc.length;for(let Ve=r.viewState.heightOracle.textHeight/2,me=!1;u=r.elementAtHeight(g),u.type!=BlockType.Text;)for(;g=s>0?u.bottom+Ve:u.top-Ve,!(g>=0&&g<=f);){if(me)return n?null:0;me=!0,s=-s}p=c+g;let y=u.from;if(y<r.viewport.from)return r.viewport.from==0?0:n?null:posAtCoordsImprecise(r,l,u,d,p);if(y>r.viewport.to)return r.viewport.to==r.state.doc.length?r.state.doc.length:n?null:posAtCoordsImprecise(r,l,u,d,p);let x=r.dom.ownerDocument,E=r.root.elementFromPoint?r.root:x,Y=E.elementFromPoint(d,p);Y&&!r.contentDOM.contains(Y)&&(Y=null),Y||(d=Math.max(l.left+1,Math.min(l.right-1,d)),Y=E.elementFromPoint(d,p),Y&&!r.contentDOM.contains(Y)&&(Y=null));let Z,te=-1;if(Y&&((o=r.docView.nearest(Y))===null||o===void 0?void 0:o.isEditable)!=!1){if(x.caretPositionFromPoint){let Ve=x.caretPositionFromPoint(d,p);Ve&&({offsetNode:Z,offset:te}=Ve)}else if(x.caretRangeFromPoint){let Ve=x.caretRangeFromPoint(d,p);Ve&&({startContainer:Z,startOffset:te}=Ve,(!r.contentDOM.contains(Z)||browser.safari&&isSuspiciousSafariCaretResult(Z,te,d)||browser.chrome&&isSuspiciousChromeCaretResult(Z,te,d))&&(Z=void 0))}Z&&(te=Math.min(maxOffset(Z),te))}if(!Z||!r.docView.dom.contains(Z)){let Ve=LineView.find(r.docView,y);if(!Ve)return g>u.top+u.height/2?u.to:u.from;({node:Z,offset:te}=domPosAtCoords(Ve.dom,d,p))}let ne=r.docView.nearest(Z);if(!ne)return null;if(ne.isWidget&&((a=ne.dom)===null||a===void 0?void 0:a.nodeType)==1){let Ve=ne.dom.getBoundingClientRect();return e.y<Ve.top||e.y<=Ve.bottom&&e.x<=(Ve.left+Ve.right)/2?ne.posAtStart:ne.posAtEnd}else return ne.localPosFromDOM(Z,te)+ne.posAtStart}function posAtCoordsImprecise(r,e,n,s,o){let a=Math.round((s-e.left)*r.defaultCharacterWidth);if(r.lineWrapping&&n.height>r.defaultLineHeight*1.5){let c=r.viewState.heightOracle.textHeight,u=Math.floor((o-n.top-(r.defaultLineHeight-c)*.5)/c);a+=u*r.viewState.heightOracle.lineLength}let l=r.state.sliceDoc(n.from,n.to);return n.from+findColumn(l,a,r.state.tabSize)}function isSuspiciousSafariCaretResult(r,e,n){let s,o=r;if(r.nodeType!=3||e!=(s=r.nodeValue.length))return!1;for(;;){let a=o.nextSibling;if(a){if(a.nodeName=="BR")break;return!1}else{let l=o.parentNode;if(!l||l.nodeName=="DIV")break;o=l}}return textRange(r,s-1,s).getBoundingClientRect().right>n}function isSuspiciousChromeCaretResult(r,e,n){if(e!=0)return!1;for(let o=r;;){let a=o.parentNode;if(!a||a.nodeType!=1||a.firstChild!=o)return!1;if(a.classList.contains("cm-line"))break;o=a}let s=r.nodeType==1?r.getBoundingClientRect():textRange(r,0,Math.max(r.nodeValue.length,1)).getBoundingClientRect();return n-s.left>5}function blockAt(r,e,n){let s=r.lineBlockAt(e);if(Array.isArray(s.type)){let o;for(let a of s.type){if(a.from>e)break;if(!(a.to<e)){if(a.from<e&&a.to>e)return a;(!o||a.type==BlockType.Text&&(o.type!=a.type||(n<0?a.from<e:a.to>e)))&&(o=a)}}return o||s}return s}function moveToLineBoundary(r,e,n,s){let o=blockAt(r,e.head,e.assoc||-1),a=!s||o.type!=BlockType.Text||!(r.lineWrapping||o.widgetLineBreaks)?null:r.coordsAtPos(e.assoc<0&&e.head>o.from?e.head-1:e.head);if(a){let l=r.dom.getBoundingClientRect(),c=r.textDirectionAt(o.from),u=r.posAtCoords({x:n==(c==Direction.LTR)?l.right-1:l.left+1,y:(a.top+a.bottom)/2});if(u!=null)return EditorSelection.cursor(u,n?-1:1)}return EditorSelection.cursor(n?o.to:o.from,n?-1:1)}function moveByChar(r,e,n,s){let o=r.state.doc.lineAt(e.head),a=r.bidiSpans(o),l=r.textDirectionAt(o.from);for(let c=e,u=null;;){let f=moveVisually(o,a,l,c,n),d=movedOver;if(!f){if(o.number==(n?r.state.doc.lines:1))return c;d=`
`,o=r.state.doc.line(o.number+(n?1:-1)),a=r.bidiSpans(o),f=r.visualLineSide(o,!n)}if(u){if(!u(d))return c}else{if(!s)return f;u=s(d)}c=f}}function byGroup(r,e,n){let s=r.state.charCategorizer(e),o=s(n);return a=>{let l=s(a);return o==CharCategory.Space&&(o=l),o==l}}function moveVertically(r,e,n,s){let o=e.head,a=n?1:-1;if(o==(n?r.state.doc.length:0))return EditorSelection.cursor(o,e.assoc);let l=e.goalColumn,c,u=r.contentDOM.getBoundingClientRect(),f=r.coordsAtPos(o,e.assoc||-1),d=r.documentTop;if(f)l==null&&(l=f.left-u.left),c=a<0?f.top:f.bottom;else{let y=r.viewState.lineBlockAt(o);l==null&&(l=Math.min(u.right-u.left,r.defaultCharacterWidth*(o-y.from))),c=(a<0?y.top:y.bottom)+d}let p=u.left+l,g=s??r.viewState.heightOracle.textHeight>>1;for(let y=0;;y+=10){let x=c+(g+y)*a,E=posAtCoords(r,{x:p,y:x},!1,a);if(x<u.top||x>u.bottom||(a<0?E<o:E>o)){let Y=r.docView.coordsForChar(E),Z=!Y||x<Y.top?-1:1;return EditorSelection.cursor(E,Z,void 0,l)}}}function skipAtomicRanges(r,e,n){for(;;){let s=0;for(let o of r)o.between(e-1,e+1,(a,l,c)=>{if(e>a&&e<l){let u=s||n||(e-a<l-e?-1:1);e=u<0?a:l,s=u}});if(!s)return e}}function skipAtoms(r,e,n){let s=skipAtomicRanges(r.state.facet(atomicRanges).map(o=>o(r)),n.from,e.head>n.from?-1:1);return s==n.from?n:EditorSelection.cursor(s,s<n.from?1:-1)}const LineBreakPlaceholder="";class DOMReader{constructor(e,n){this.points=e,this.text="",this.lineSeparator=n.facet(EditorState.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=LineBreakPlaceholder}readRange(e,n){if(!e)return this;let s=e.parentNode;for(let o=e;;){this.findPointBefore(s,o);let a=this.text.length;this.readNode(o);let l=o.nextSibling;if(l==n)break;let c=ContentView.get(o),u=ContentView.get(l);(c&&u?c.breakAfter:(c?c.breakAfter:isBlockElement(o))||isBlockElement(l)&&(o.nodeName!="BR"||o.cmIgnore)&&this.text.length>a)&&this.lineBreak(),o=l}return this.findPointBefore(s,n),this}readTextNode(e){let n=e.nodeValue;for(let s of this.points)s.node==e&&(s.pos=this.text.length+Math.min(s.offset,n.length));for(let s=0,o=this.lineSeparator?null:/\r\n?|\n/g;;){let a=-1,l=1,c;if(this.lineSeparator?(a=n.indexOf(this.lineSeparator,s),l=this.lineSeparator.length):(c=o.exec(n))&&(a=c.index,l=c[0].length),this.append(n.slice(s,a<0?n.length:a)),a<0)break;if(this.lineBreak(),l>1)for(let u of this.points)u.node==e&&u.pos>this.text.length&&(u.pos-=l-1);s=a+l}}readNode(e){if(e.cmIgnore)return;let n=ContentView.get(e),s=n&&n.overrideDOMText;if(s!=null){this.findPointInside(e,s.length);for(let o=s.iter();!o.next().done;)o.lineBreak?this.lineBreak():this.append(o.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,n){for(let s of this.points)s.node==e&&e.childNodes[s.offset]==n&&(s.pos=this.text.length)}findPointInside(e,n){for(let s of this.points)(e.nodeType==3?s.node==e:e.contains(s.node))&&(s.pos=this.text.length+(isAtEnd(e,s.node,s.offset)?n:0))}}function isAtEnd(r,e,n){for(;;){if(!e||n<maxOffset(e))return!1;if(e==r)return!0;n=domIndex(e)+1,e=e.parentNode}}class DOMPoint{constructor(e,n){this.node=e,this.offset=n,this.pos=-1}}class DOMChange{constructor(e,n,s,o){this.typeOver=o,this.bounds=null,this.text="",this.domChanged=n>-1;let{impreciseHead:a,impreciseAnchor:l}=e.docView;if(e.state.readOnly&&n>-1)this.newSel=null;else if(n>-1&&(this.bounds=e.docView.domBoundsAround(n,s,0))){let c=a||l?[]:selectionPoints(e),u=new DOMReader(c,e.state);u.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=u.text,this.newSel=selectionFromPoints(c,this.bounds.from)}else{let c=e.observer.selectionRange,u=a&&a.node==c.focusNode&&a.offset==c.focusOffset||!contains(e.contentDOM,c.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(c.focusNode,c.focusOffset),f=l&&l.node==c.anchorNode&&l.offset==c.anchorOffset||!contains(e.contentDOM,c.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(c.anchorNode,c.anchorOffset),d=e.viewport;if((browser.ios||browser.chrome)&&e.state.selection.main.empty&&u!=f&&(d.from>0||d.to<e.state.doc.length)){let p=Math.min(u,f),g=Math.max(u,f),y=d.from-p,x=d.to-g;(y==0||y==1||p==0)&&(x==0||x==-1||g==e.state.doc.length)&&(u=0,f=e.state.doc.length)}this.newSel=EditorSelection.single(f,u)}}}function applyDOMChange(r,e){let n,{newSel:s}=e,o=r.state.selection.main,a=r.inputState.lastKeyTime>Date.now()-100?r.inputState.lastKeyCode:-1;if(e.bounds){let{from:l,to:c}=e.bounds,u=o.from,f=null;(a===8||browser.android&&e.text.length<c-l)&&(u=o.to,f="end");let d=findDiff(r.state.doc.sliceString(l,c,LineBreakPlaceholder),e.text,u-l,f);d&&(browser.chrome&&a==13&&d.toB==d.from+2&&e.text.slice(d.from,d.toB)==LineBreakPlaceholder+LineBreakPlaceholder&&d.toB--,n={from:l+d.from,to:l+d.toA,insert:Text.of(e.text.slice(d.from,d.toB).split(LineBreakPlaceholder))})}else s&&(!r.hasFocus&&r.state.facet(editable)||s.main.eq(o))&&(s=null);if(!n&&!s)return!1;if(!n&&e.typeOver&&!o.empty&&s&&s.main.empty?n={from:o.from,to:o.to,insert:r.state.doc.slice(o.from,o.to)}:(browser.mac||browser.android)&&n&&n.from==n.to&&n.from==o.head-1&&/^\. ?$/.test(n.insert.toString())&&r.contentDOM.getAttribute("autocorrect")=="off"?(s&&n.insert.length==2&&(s=EditorSelection.single(s.main.anchor-1,s.main.head-1)),n={from:n.from,to:n.to,insert:Text.of([n.insert.toString().replace("."," ")])}):n&&n.from>=o.from&&n.to<=o.to&&(n.from!=o.from||n.to!=o.to)&&o.to-o.from-(n.to-n.from)<=4?n={from:o.from,to:o.to,insert:r.state.doc.slice(o.from,n.from).append(n.insert).append(r.state.doc.slice(n.to,o.to))}:browser.chrome&&n&&n.from==n.to&&n.from==o.head&&n.insert.toString()==`
 `&&r.lineWrapping&&(s&&(s=EditorSelection.single(s.main.anchor-1,s.main.head-1)),n={from:o.from,to:o.to,insert:Text.of([" "])}),n)return applyDOMChangeInner(r,n,s,a);if(s&&!s.main.eq(o)){let l=!1,c="select";return r.inputState.lastSelectionTime>Date.now()-50&&(r.inputState.lastSelectionOrigin=="select"&&(l=!0),c=r.inputState.lastSelectionOrigin),r.dispatch({selection:s,scrollIntoView:l,userEvent:c}),!0}else return!1}function applyDOMChangeInner(r,e,n,s=-1){if(browser.ios&&r.inputState.flushIOSKey(e))return!0;let o=r.state.selection.main;if(browser.android&&(e.to==o.to&&(e.from==o.from||e.from==o.from-1&&r.state.sliceDoc(e.from,o.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&dispatchKey(r.contentDOM,"Enter",13)||(e.from==o.from-1&&e.to==o.to&&e.insert.length==0||s==8&&e.insert.length<e.to-e.from&&e.to>o.head)&&dispatchKey(r.contentDOM,"Backspace",8)||e.from==o.from&&e.to==o.to+1&&e.insert.length==0&&dispatchKey(r.contentDOM,"Delete",46)))return!0;let a=e.insert.toString();r.inputState.composing>=0&&r.inputState.composing++;let l,c=()=>l||(l=applyDefaultInsert(r,e,n));return r.state.facet(inputHandler$1).some(u=>u(r,e.from,e.to,a,c))||r.dispatch(c()),!0}function applyDefaultInsert(r,e,n){let s,o=r.state,a=o.selection.main;if(e.from>=a.from&&e.to<=a.to&&e.to-e.from>=(a.to-a.from)/3&&(!n||n.main.empty&&n.main.from==e.from+e.insert.length)&&r.inputState.composing<0){let c=a.from<e.from?o.sliceDoc(a.from,e.from):"",u=a.to>e.to?o.sliceDoc(e.to,a.to):"";s=o.replaceSelection(r.state.toText(c+e.insert.sliceString(0,void 0,r.state.lineBreak)+u))}else{let c=o.changes(e),u=n&&n.main.to<=c.newLength?n.main:void 0;if(o.selection.ranges.length>1&&r.inputState.composing>=0&&e.to<=a.to&&e.to>=a.to-10){let f=r.state.sliceDoc(e.from,e.to),d,p=n&&findCompositionNode(r,n.main.head);if(p){let x=e.insert.length-(e.to-e.from);d={from:p.from,to:p.to-x}}else d=r.state.doc.lineAt(a.head);let g=a.to-e.to,y=a.to-a.from;s=o.changeByRange(x=>{if(x.from==a.from&&x.to==a.to)return{changes:c,range:u||x.map(c)};let E=x.to-g,Y=E-f.length;if(x.to-x.from!=y||r.state.sliceDoc(Y,E)!=f||x.to>=d.from&&x.from<=d.to)return{range:x};let Z=o.changes({from:Y,to:E,insert:e.insert}),te=x.to-a.to;return{changes:Z,range:u?EditorSelection.range(Math.max(0,u.anchor+te),Math.max(0,u.head+te)):x.map(Z)}})}else s={changes:c,selection:u&&o.selection.replaceRange(u)}}let l="input.type";return(r.composing||r.inputState.compositionPendingChange&&r.inputState.compositionEndedAt>Date.now()-50)&&(r.inputState.compositionPendingChange=!1,l+=".compose",r.inputState.compositionFirstChange&&(l+=".start",r.inputState.compositionFirstChange=!1)),o.update(s,{userEvent:l,scrollIntoView:!0})}function findDiff(r,e,n,s){let o=Math.min(r.length,e.length),a=0;for(;a<o&&r.charCodeAt(a)==e.charCodeAt(a);)a++;if(a==o&&r.length==e.length)return null;let l=r.length,c=e.length;for(;l>0&&c>0&&r.charCodeAt(l-1)==e.charCodeAt(c-1);)l--,c--;if(s=="end"){let u=Math.max(0,a-Math.min(l,c));n-=l+u-a}if(l<a&&r.length<e.length){let u=n<=a&&n>=l?a-n:0;a-=u,c=a+(c-l),l=a}else if(c<a){let u=n<=a&&n>=c?a-n:0;a-=u,l=a+(l-c),c=a}return{from:a,toA:l,toB:c}}function selectionPoints(r){let e=[];if(r.root.activeElement!=r.contentDOM)return e;let{anchorNode:n,anchorOffset:s,focusNode:o,focusOffset:a}=r.observer.selectionRange;return n&&(e.push(new DOMPoint(n,s)),(o!=n||a!=s)&&e.push(new DOMPoint(o,a))),e}function selectionFromPoints(r,e){if(r.length==0)return null;let n=r[0].pos,s=r.length==2?r[1].pos:n;return n>-1&&s>-1?EditorSelection.single(n+e,s+e):null}class InputState{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,browser.safari&&e.contentDOM.addEventListener("input",()=>null),browser.gecko&&firefoxCopyCutHack(e.contentDOM.ownerDocument)}handleEvent(e){!eventBelongsToEditor(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||(this.view.updateState!=0?Promise.resolve().then(()=>this.runHandlers(e.type,e)):this.runHandlers(e.type,e))}runHandlers(e,n){let s=this.handlers[e];if(s){for(let o of s.observers)o(this.view,n);for(let o of s.handlers){if(n.defaultPrevented)break;if(o(this.view,n)){n.preventDefault();break}}}}ensureHandlers(e){let n=computeHandlers(e),s=this.handlers,o=this.view.contentDOM;for(let a in n)if(a!="scroll"){let l=!n[a].handlers.length,c=s[a];c&&l!=!c.handlers.length&&(o.removeEventListener(a,this.handleEvent),c=null),c||o.addEventListener(a,this.handleEvent,{passive:l})}for(let a in s)a!="scroll"&&!n[a]&&o.removeEventListener(a,this.handleEvent);this.handlers=n}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&modifierCodes.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),browser.android&&browser.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let n;return browser.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((n=PendingKeys.find(s=>s.keyCode==e.keyCode))&&!e.ctrlKey||EmacsyPendingKeys.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=n||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let n=this.pendingIOSKey;return!n||n.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,dispatchKey(this.view.contentDOM,n.key,n.keyCode,n instanceof KeyboardEvent?n:void 0))}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:browser.safari&&!browser.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function bindHandler(r,e){return(n,s)=>{try{return e.call(r,s,n)}catch(o){logException(n.state,o)}}}function computeHandlers(r){let e=Object.create(null);function n(s){return e[s]||(e[s]={observers:[],handlers:[]})}for(let s of r){let o=s.spec,a=o&&o.plugin.domEventHandlers,l=o&&o.plugin.domEventObservers;if(a)for(let c in a){let u=a[c];u&&n(c).handlers.push(bindHandler(s.value,u))}if(l)for(let c in l){let u=l[c];u&&n(c).observers.push(bindHandler(s.value,u))}}for(let s in handlers)n(s).handlers.push(handlers[s]);for(let s in observers)n(s).observers.push(observers[s]);return e}const PendingKeys=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],EmacsyPendingKeys="dthko",modifierCodes=[16,17,18,20,91,92,224,225],dragScrollMargin=6;function dragScrollSpeed(r){return Math.max(0,r)*.7+8}function dist(r,e){return Math.max(Math.abs(r.clientX-e.clientX),Math.abs(r.clientY-e.clientY))}class MouseSelection{constructor(e,n,s,o){this.view=e,this.startEvent=n,this.style=s,this.mustSelect=o,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=n,this.scrollParents=scrollableParents(e.contentDOM),this.atoms=e.state.facet(atomicRanges).map(l=>l(e));let a=e.contentDOM.ownerDocument;a.addEventListener("mousemove",this.move=this.move.bind(this)),a.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=n.shiftKey,this.multiple=e.state.facet(EditorState.allowMultipleSelections)&&addsSelectionRange(e,n),this.dragging=isInPrimarySelection(e,n)&&getClickType(n)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&dist(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let n=0,s=0,o=0,a=0,l=this.view.win.innerWidth,c=this.view.win.innerHeight;this.scrollParents.x&&({left:o,right:l}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:a,bottom:c}=this.scrollParents.y.getBoundingClientRect());let u=getScrollMargins(this.view);e.clientX-u.left<=o+dragScrollMargin?n=-dragScrollSpeed(o-e.clientX):e.clientX+u.right>=l-dragScrollMargin&&(n=dragScrollSpeed(e.clientX-l)),e.clientY-u.top<=a+dragScrollMargin?s=-dragScrollSpeed(a-e.clientY):e.clientY+u.bottom>=c-dragScrollMargin&&(s=dragScrollSpeed(e.clientY-c)),this.setScrollSpeed(n,s)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,n){this.scrollSpeed={x:e,y:n},e||n?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:n}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),n&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=n,n=0),(e||n)&&this.view.win.scrollBy(e,n),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(e){let n=null;for(let s=0;s<e.ranges.length;s++){let o=e.ranges[s],a=null;if(o.empty){let l=skipAtomicRanges(this.atoms,o.from,0);l!=o.from&&(a=EditorSelection.cursor(l,-1))}else{let l=skipAtomicRanges(this.atoms,o.from,-1),c=skipAtomicRanges(this.atoms,o.to,1);(l!=o.from||c!=o.to)&&(a=EditorSelection.range(o.from==o.anchor?l:c,o.from==o.head?l:c))}a&&(n||(n=e.ranges.slice()),n[s]=a)}return n?EditorSelection.create(n,e.mainIndex):e}select(e){let{view:n}=this,s=this.skipAtoms(this.style.get(e,this.extend,this.multiple));(this.mustSelect||!s.eq(n.state.selection,this.dragging===!1))&&this.view.dispatch({selection:s,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(n=>n.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function addsSelectionRange(r,e){let n=r.state.facet(clickAddsSelectionRange);return n.length?n[0](e):browser.mac?e.metaKey:e.ctrlKey}function dragMovesSelection(r,e){let n=r.state.facet(dragMovesSelection$1);return n.length?n[0](e):browser.mac?!e.altKey:!e.ctrlKey}function isInPrimarySelection(r,e){let{main:n}=r.state.selection;if(n.empty)return!1;let s=getSelection(r.root);if(!s||s.rangeCount==0)return!0;let o=s.getRangeAt(0).getClientRects();for(let a=0;a<o.length;a++){let l=o[a];if(l.left<=e.clientX&&l.right>=e.clientX&&l.top<=e.clientY&&l.bottom>=e.clientY)return!0}return!1}function eventBelongsToEditor(r,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target,s;n!=r.contentDOM;n=n.parentNode)if(!n||n.nodeType==11||(s=ContentView.get(n))&&s.ignoreEvent(e))return!1;return!0}const handlers=Object.create(null),observers=Object.create(null),brokenClipboardAPI=browser.ie&&browser.ie_version<15||browser.ios&&browser.webkit_version<604;function capturePaste(r){let e=r.dom.parentNode;if(!e)return;let n=e.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus(),setTimeout(()=>{r.focus(),n.remove(),doPaste(r,n.value)},50)}function textFilter(r,e,n){for(let s of r.facet(e))n=s(n,r);return n}function doPaste(r,e){e=textFilter(r.state,clipboardInputFilter,e);let{state:n}=r,s,o=1,a=n.toText(e),l=a.lines==n.selection.ranges.length;if(lastLinewiseCopy!=null&&n.selection.ranges.every(u=>u.empty)&&lastLinewiseCopy==a.toString()){let u=-1;s=n.changeByRange(f=>{let d=n.doc.lineAt(f.from);if(d.from==u)return{range:f};u=d.from;let p=n.toText((l?a.line(o++).text:e)+n.lineBreak);return{changes:{from:d.from,insert:p},range:EditorSelection.cursor(f.from+p.length)}})}else l?s=n.changeByRange(u=>{let f=a.line(o++);return{changes:{from:u.from,to:u.to,insert:f.text},range:EditorSelection.cursor(u.from+f.length)}}):s=n.replaceSelection(a);r.dispatch(s,{userEvent:"input.paste",scrollIntoView:!0})}observers.scroll=r=>{r.inputState.lastScrollTop=r.scrollDOM.scrollTop,r.inputState.lastScrollLeft=r.scrollDOM.scrollLeft};handlers.keydown=(r,e)=>(r.inputState.setSelectionOrigin("select"),e.keyCode==27&&r.inputState.tabFocusMode!=0&&(r.inputState.tabFocusMode=Date.now()+2e3),!1);observers.touchstart=(r,e)=>{r.inputState.lastTouchTime=Date.now(),r.inputState.setSelectionOrigin("select.pointer")};observers.touchmove=r=>{r.inputState.setSelectionOrigin("select.pointer")};handlers.mousedown=(r,e)=>{if(r.observer.flush(),r.inputState.lastTouchTime>Date.now()-2e3)return!1;let n=null;for(let s of r.state.facet(mouseSelectionStyle))if(n=s(r,e),n)break;if(!n&&e.button==0&&(n=basicMouseSelection(r,e)),n){let s=!r.hasFocus;r.inputState.startMouseSelection(new MouseSelection(r,e,n,s)),s&&r.observer.ignore(()=>{focusPreventScroll(r.contentDOM);let a=r.root.activeElement;a&&!a.contains(r.contentDOM)&&a.blur()});let o=r.inputState.mouseSelection;if(o)return o.start(e),o.dragging===!1}return!1};function rangeForClick(r,e,n,s){if(s==1)return EditorSelection.cursor(e,n);if(s==2)return groupAt(r.state,e,n);{let o=LineView.find(r.docView,e),a=r.state.doc.lineAt(o?o.posAtEnd:e),l=o?o.posAtStart:a.from,c=o?o.posAtEnd:a.to;return c<r.state.doc.length&&c==a.to&&c++,EditorSelection.range(l,c)}}let inside=(r,e,n)=>e>=n.top&&e<=n.bottom&&r>=n.left&&r<=n.right;function findPositionSide(r,e,n,s){let o=LineView.find(r.docView,e);if(!o)return 1;let a=e-o.posAtStart;if(a==0)return 1;if(a==o.length)return-1;let l=o.coordsAt(a,-1);if(l&&inside(n,s,l))return-1;let c=o.coordsAt(a,1);return c&&inside(n,s,c)?1:l&&l.bottom>=s?-1:1}function queryPos(r,e){let n=r.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:n,bias:findPositionSide(r,n,e.clientX,e.clientY)}}const BadMouseDetail=browser.ie&&browser.ie_version<=11;let lastMouseDown=null,lastMouseDownCount=0,lastMouseDownTime=0;function getClickType(r){if(!BadMouseDetail)return r.detail;let e=lastMouseDown,n=lastMouseDownTime;return lastMouseDown=r,lastMouseDownTime=Date.now(),lastMouseDownCount=!e||n>Date.now()-400&&Math.abs(e.clientX-r.clientX)<2&&Math.abs(e.clientY-r.clientY)<2?(lastMouseDownCount+1)%3:1}function basicMouseSelection(r,e){let n=queryPos(r,e),s=getClickType(e),o=r.state.selection;return{update(a){a.docChanged&&(n.pos=a.changes.mapPos(n.pos),o=o.map(a.changes))},get(a,l,c){let u=queryPos(r,a),f,d=rangeForClick(r,u.pos,u.bias,s);if(n.pos!=u.pos&&!l){let p=rangeForClick(r,n.pos,n.bias,s),g=Math.min(p.from,d.from),y=Math.max(p.to,d.to);d=g<d.from?EditorSelection.range(g,y):EditorSelection.range(y,g)}return l?o.replaceRange(o.main.extend(d.from,d.to)):c&&s==1&&o.ranges.length>1&&(f=removeRangeAround(o,u.pos))?f:c?o.addRange(d):EditorSelection.create([d])}}}function removeRangeAround(r,e){for(let n=0;n<r.ranges.length;n++){let{from:s,to:o}=r.ranges[n];if(s<=e&&o>=e)return EditorSelection.create(r.ranges.slice(0,n).concat(r.ranges.slice(n+1)),r.mainIndex==n?0:r.mainIndex-(r.mainIndex>n?1:0))}return null}handlers.dragstart=(r,e)=>{let{selection:{main:n}}=r.state;if(e.target.draggable){let o=r.docView.nearest(e.target);if(o&&o.isWidget){let a=o.posAtStart,l=a+o.length;(a>=n.to||l<=n.from)&&(n=EditorSelection.range(a,l))}}let{inputState:s}=r;return s.mouseSelection&&(s.mouseSelection.dragging=!0),s.draggedContent=n,e.dataTransfer&&(e.dataTransfer.setData("Text",textFilter(r.state,clipboardOutputFilter,r.state.sliceDoc(n.from,n.to))),e.dataTransfer.effectAllowed="copyMove"),!1};handlers.dragend=r=>(r.inputState.draggedContent=null,!1);function dropText(r,e,n,s){if(n=textFilter(r.state,clipboardInputFilter,n),!n)return;let o=r.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:a}=r.inputState,l=s&&a&&dragMovesSelection(r,e)?{from:a.from,to:a.to}:null,c={from:o,insert:n},u=r.state.changes(l?[l,c]:c);r.focus(),r.dispatch({changes:u,selection:{anchor:u.mapPos(o,-1),head:u.mapPos(o,1)},userEvent:l?"move.drop":"input.drop"}),r.inputState.draggedContent=null}handlers.drop=(r,e)=>{if(!e.dataTransfer)return!1;if(r.state.readOnly)return!0;let n=e.dataTransfer.files;if(n&&n.length){let s=Array(n.length),o=0,a=()=>{++o==n.length&&dropText(r,e,s.filter(l=>l!=null).join(r.state.lineBreak),!1)};for(let l=0;l<n.length;l++){let c=new FileReader;c.onerror=a,c.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(c.result)||(s[l]=c.result),a()},c.readAsText(n[l])}return!0}else{let s=e.dataTransfer.getData("Text");if(s)return dropText(r,e,s,!0),!0}return!1};handlers.paste=(r,e)=>{if(r.state.readOnly)return!0;r.observer.flush();let n=brokenClipboardAPI?null:e.clipboardData;return n?(doPaste(r,n.getData("text/plain")||n.getData("text/uri-list")),!0):(capturePaste(r),!1)};function captureCopy(r,e){let n=r.dom.parentNode;if(!n)return;let s=n.appendChild(document.createElement("textarea"));s.style.cssText="position: fixed; left: -10000px; top: 10px",s.value=e,s.focus(),s.selectionEnd=e.length,s.selectionStart=0,setTimeout(()=>{s.remove(),r.focus()},50)}function copiedRange(r){let e=[],n=[],s=!1;for(let o of r.selection.ranges)o.empty||(e.push(r.sliceDoc(o.from,o.to)),n.push(o));if(!e.length){let o=-1;for(let{from:a}of r.selection.ranges){let l=r.doc.lineAt(a);l.number>o&&(e.push(l.text),n.push({from:l.from,to:Math.min(r.doc.length,l.to+1)})),o=l.number}s=!0}return{text:textFilter(r,clipboardOutputFilter,e.join(r.lineBreak)),ranges:n,linewise:s}}let lastLinewiseCopy=null;handlers.copy=handlers.cut=(r,e)=>{let{text:n,ranges:s,linewise:o}=copiedRange(r.state);if(!n&&!o)return!1;lastLinewiseCopy=o?n:null,e.type=="cut"&&!r.state.readOnly&&r.dispatch({changes:s,scrollIntoView:!0,userEvent:"delete.cut"});let a=brokenClipboardAPI?null:e.clipboardData;return a?(a.clearData(),a.setData("text/plain",n),!0):(captureCopy(r,n),!1)};const isFocusChange=Annotation.define();function focusChangeTransaction(r,e){let n=[];for(let s of r.facet(focusChangeEffect)){let o=s(r,e);o&&n.push(o)}return n.length?r.update({effects:n,annotations:isFocusChange.of(!0)}):null}function updateForFocusChange(r){setTimeout(()=>{let e=r.hasFocus;if(e!=r.inputState.notifiedFocused){let n=focusChangeTransaction(r.state,e);n?r.dispatch(n):r.update([])}},10)}observers.focus=r=>{r.inputState.lastFocusTime=Date.now(),!r.scrollDOM.scrollTop&&(r.inputState.lastScrollTop||r.inputState.lastScrollLeft)&&(r.scrollDOM.scrollTop=r.inputState.lastScrollTop,r.scrollDOM.scrollLeft=r.inputState.lastScrollLeft),updateForFocusChange(r)};observers.blur=r=>{r.observer.clearSelectionRange(),updateForFocusChange(r)};observers.compositionstart=observers.compositionupdate=r=>{r.observer.editContext||(r.inputState.compositionFirstChange==null&&(r.inputState.compositionFirstChange=!0),r.inputState.composing<0&&(r.inputState.composing=0))};observers.compositionend=r=>{r.observer.editContext||(r.inputState.composing=-1,r.inputState.compositionEndedAt=Date.now(),r.inputState.compositionPendingKey=!0,r.inputState.compositionPendingChange=r.observer.pendingRecords().length>0,r.inputState.compositionFirstChange=null,browser.chrome&&browser.android?r.observer.flushSoon():r.inputState.compositionPendingChange?Promise.resolve().then(()=>r.observer.flush()):setTimeout(()=>{r.inputState.composing<0&&r.docView.hasComposition&&r.update([])},50))};observers.contextmenu=r=>{r.inputState.lastContextMenu=Date.now()};handlers.beforeinput=(r,e)=>{var n,s;if(e.inputType=="insertReplacementText"&&r.observer.editContext){let a=(n=e.dataTransfer)===null||n===void 0?void 0:n.getData("text/plain"),l=e.getTargetRanges();if(a&&l.length){let c=l[0],u=r.posAtDOM(c.startContainer,c.startOffset),f=r.posAtDOM(c.endContainer,c.endOffset);return applyDOMChangeInner(r,{from:u,to:f,insert:r.state.toText(a)},null),!0}}let o;if(browser.chrome&&browser.android&&(o=PendingKeys.find(a=>a.inputType==e.inputType))&&(r.observer.delayAndroidKey(o.key,o.keyCode),o.key=="Backspace"||o.key=="Delete")){let a=((s=window.visualViewport)===null||s===void 0?void 0:s.height)||0;setTimeout(()=>{var l;(((l=window.visualViewport)===null||l===void 0?void 0:l.height)||0)>a+10&&r.hasFocus&&(r.contentDOM.blur(),r.focus())},100)}return browser.ios&&e.inputType=="deleteContentForward"&&r.observer.flushSoon(),browser.safari&&e.inputType=="insertText"&&r.inputState.composing>=0&&setTimeout(()=>observers.compositionend(r,e),20),!1};const appliedFirefoxHack=new Set;function firefoxCopyCutHack(r){appliedFirefoxHack.has(r)||(appliedFirefoxHack.add(r),r.addEventListener("copy",()=>{}),r.addEventListener("cut",()=>{}))}const wrappingWhiteSpace=["pre-wrap","normal","pre-line","break-spaces"];let heightChangeFlag=!1;function clearHeightChangeFlag(){heightChangeFlag=!1}class HeightOracle{constructor(e){this.lineWrapping=e,this.doc=Text.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,n){let s=this.doc.lineAt(n).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(s+=Math.max(0,Math.ceil((n-e-s*this.lineLength*.5)/this.lineLength))),this.lineHeight*s}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return wrappingWhiteSpace.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let n=!1;for(let s=0;s<e.length;s++){let o=e[s];o<0?s++:this.heightSamples[Math.floor(o*10)]||(n=!0,this.heightSamples[Math.floor(o*10)]=!0)}return n}refresh(e,n,s,o,a,l){let c=wrappingWhiteSpace.indexOf(e)>-1,u=Math.round(n)!=Math.round(this.lineHeight)||this.lineWrapping!=c;if(this.lineWrapping=c,this.lineHeight=n,this.charWidth=s,this.textHeight=o,this.lineLength=a,u){this.heightSamples={};for(let f=0;f<l.length;f++){let d=l[f];d<0?f++:this.heightSamples[Math.floor(d*10)]=!0}}return u}}class MeasuredHeights{constructor(e,n){this.from=e,this.heights=n,this.index=0}get more(){return this.index<this.heights.length}}class BlockInfo{constructor(e,n,s,o,a){this.from=e,this.length=n,this.top=s,this.height=o,this._content=a}get type(){return typeof this._content=="number"?BlockType.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof PointDecoration?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let n=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new BlockInfo(this.from,this.length+e.length,this.top,this.height+e.height,n)}}var QueryType$1=function(r){return r[r.ByPos=0]="ByPos",r[r.ByHeight=1]="ByHeight",r[r.ByPosNoHeight=2]="ByPosNoHeight",r}(QueryType$1||(QueryType$1={}));const Epsilon=.001;class HeightMap{constructor(e,n,s=2){this.length=e,this.height=n,this.flags=s}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>Epsilon&&(heightChangeFlag=!0),this.height=e)}replace(e,n,s){return HeightMap.of(s)}decomposeLeft(e,n){n.push(this)}decomposeRight(e,n){n.push(this)}applyChanges(e,n,s,o){let a=this,l=s.doc;for(let c=o.length-1;c>=0;c--){let{fromA:u,toA:f,fromB:d,toB:p}=o[c],g=a.lineAt(u,QueryType$1.ByPosNoHeight,s.setDoc(n),0,0),y=g.to>=f?g:a.lineAt(f,QueryType$1.ByPosNoHeight,s,0,0);for(p+=y.to-f,f=y.to;c>0&&g.from<=o[c-1].toA;)u=o[c-1].fromA,d=o[c-1].fromB,c--,u<g.from&&(g=a.lineAt(u,QueryType$1.ByPosNoHeight,s,0,0));d+=g.from-u,u=g.from;let x=NodeBuilder.build(s.setDoc(l),e,d,p);a=replace(a,a.replace(u,f,x))}return a.updateHeight(s,0)}static empty(){return new HeightMapText(0,0)}static of(e){if(e.length==1)return e[0];let n=0,s=e.length,o=0,a=0;for(;;)if(n==s)if(o>a*2){let c=e[n-1];c.break?e.splice(--n,1,c.left,null,c.right):e.splice(--n,1,c.left,c.right),s+=1+c.break,o-=c.size}else if(a>o*2){let c=e[s];c.break?e.splice(s,1,c.left,null,c.right):e.splice(s,1,c.left,c.right),s+=2+c.break,a-=c.size}else break;else if(o<a){let c=e[n++];c&&(o+=c.size)}else{let c=e[--s];c&&(a+=c.size)}let l=0;return e[n-1]==null?(l=1,n--):e[n]==null&&(l=1,s++),new HeightMapBranch(HeightMap.of(e.slice(0,n)),l,HeightMap.of(e.slice(s)))}}function replace(r,e){return r==e?r:(r.constructor!=e.constructor&&(heightChangeFlag=!0),e)}HeightMap.prototype.size=1;class HeightMapBlock extends HeightMap{constructor(e,n,s){super(e,n),this.deco=s}blockAt(e,n,s,o){return new BlockInfo(o,this.length,s,this.height,this.deco||0)}lineAt(e,n,s,o,a){return this.blockAt(0,s,o,a)}forEachLine(e,n,s,o,a,l){e<=a+this.length&&n>=a&&l(this.blockAt(0,s,o,a))}updateHeight(e,n=0,s=!1,o){return o&&o.from<=n&&o.more&&this.setHeight(o.heights[o.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class HeightMapText extends HeightMapBlock{constructor(e,n){super(e,n,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,n,s,o){return new BlockInfo(o,this.length,s,this.height,this.breaks)}replace(e,n,s){let o=s[0];return s.length==1&&(o instanceof HeightMapText||o instanceof HeightMapGap&&o.flags&4)&&Math.abs(this.length-o.length)<10?(o instanceof HeightMapGap?o=new HeightMapText(o.length,this.height):o.height=this.height,this.outdated||(o.outdated=!1),o):HeightMap.of(s)}updateHeight(e,n=0,s=!1,o){return o&&o.from<=n&&o.more?this.setHeight(o.heights[o.index++]):(s||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class HeightMapGap extends HeightMap{constructor(e){super(e,0)}heightMetrics(e,n){let s=e.doc.lineAt(n).number,o=e.doc.lineAt(n+this.length).number,a=o-s+1,l,c=0;if(e.lineWrapping){let u=Math.min(this.height,e.lineHeight*a);l=u/a,this.length>a+1&&(c=(this.height-u)/(this.length-a-1))}else l=this.height/a;return{firstLine:s,lastLine:o,perLine:l,perChar:c}}blockAt(e,n,s,o){let{firstLine:a,lastLine:l,perLine:c,perChar:u}=this.heightMetrics(n,o);if(n.lineWrapping){let f=o+(e<n.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-s)/this.height))*this.length)),d=n.doc.lineAt(f),p=c+d.length*u,g=Math.max(s,e-p/2);return new BlockInfo(d.from,d.length,g,p,0)}else{let f=Math.max(0,Math.min(l-a,Math.floor((e-s)/c))),{from:d,length:p}=n.doc.line(a+f);return new BlockInfo(d,p,s+c*f,c,0)}}lineAt(e,n,s,o,a){if(n==QueryType$1.ByHeight)return this.blockAt(e,s,o,a);if(n==QueryType$1.ByPosNoHeight){let{from:y,to:x}=s.doc.lineAt(e);return new BlockInfo(y,x-y,0,0,0)}let{firstLine:l,perLine:c,perChar:u}=this.heightMetrics(s,a),f=s.doc.lineAt(e),d=c+f.length*u,p=f.number-l,g=o+c*p+u*(f.from-a-p);return new BlockInfo(f.from,f.length,Math.max(o,Math.min(g,o+this.height-d)),d,0)}forEachLine(e,n,s,o,a,l){e=Math.max(e,a),n=Math.min(n,a+this.length);let{firstLine:c,perLine:u,perChar:f}=this.heightMetrics(s,a);for(let d=e,p=o;d<=n;){let g=s.doc.lineAt(d);if(d==e){let x=g.number-c;p+=u*x+f*(e-a-x)}let y=u+f*g.length;l(new BlockInfo(g.from,g.length,p,y,0)),p+=y,d=g.to+1}}replace(e,n,s){let o=this.length-n;if(o>0){let a=s[s.length-1];a instanceof HeightMapGap?s[s.length-1]=new HeightMapGap(a.length+o):s.push(null,new HeightMapGap(o-1))}if(e>0){let a=s[0];a instanceof HeightMapGap?s[0]=new HeightMapGap(e+a.length):s.unshift(new HeightMapGap(e-1),null)}return HeightMap.of(s)}decomposeLeft(e,n){n.push(new HeightMapGap(e-1),null)}decomposeRight(e,n){n.push(null,new HeightMapGap(this.length-e-1))}updateHeight(e,n=0,s=!1,o){let a=n+this.length;if(o&&o.from<=n+this.length&&o.more){let l=[],c=Math.max(n,o.from),u=-1;for(o.from>n&&l.push(new HeightMapGap(o.from-n-1).updateHeight(e,n));c<=a&&o.more;){let d=e.doc.lineAt(c).length;l.length&&l.push(null);let p=o.heights[o.index++];u==-1?u=p:Math.abs(p-u)>=Epsilon&&(u=-2);let g=new HeightMapText(d,p);g.outdated=!1,l.push(g),c+=d+1}c<=a&&l.push(null,new HeightMapGap(a-c).updateHeight(e,c));let f=HeightMap.of(l);return(u<0||Math.abs(f.height-this.height)>=Epsilon||Math.abs(u-this.heightMetrics(e,n).perLine)>=Epsilon)&&(heightChangeFlag=!0),replace(this,f)}else(s||this.outdated)&&(this.setHeight(e.heightForGap(n,n+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class HeightMapBranch extends HeightMap{constructor(e,n,s){super(e.length+n+s.length,e.height+s.height,n|(e.outdated||s.outdated?2:0)),this.left=e,this.right=s,this.size=e.size+s.size}get break(){return this.flags&1}blockAt(e,n,s,o){let a=s+this.left.height;return e<a?this.left.blockAt(e,n,s,o):this.right.blockAt(e,n,a,o+this.left.length+this.break)}lineAt(e,n,s,o,a){let l=o+this.left.height,c=a+this.left.length+this.break,u=n==QueryType$1.ByHeight?e<l:e<c,f=u?this.left.lineAt(e,n,s,o,a):this.right.lineAt(e,n,s,l,c);if(this.break||(u?f.to<c:f.from>c))return f;let d=n==QueryType$1.ByPosNoHeight?QueryType$1.ByPosNoHeight:QueryType$1.ByPos;return u?f.join(this.right.lineAt(c,d,s,l,c)):this.left.lineAt(c,d,s,o,a).join(f)}forEachLine(e,n,s,o,a,l){let c=o+this.left.height,u=a+this.left.length+this.break;if(this.break)e<u&&this.left.forEachLine(e,n,s,o,a,l),n>=u&&this.right.forEachLine(e,n,s,c,u,l);else{let f=this.lineAt(u,QueryType$1.ByPos,s,o,a);e<f.from&&this.left.forEachLine(e,f.from-1,s,o,a,l),f.to>=e&&f.from<=n&&l(f),n>f.to&&this.right.forEachLine(f.to+1,n,s,c,u,l)}}replace(e,n,s){let o=this.left.length+this.break;if(n<o)return this.balanced(this.left.replace(e,n,s),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-o,n-o,s));let a=[];e>0&&this.decomposeLeft(e,a);let l=a.length;for(let c of s)a.push(c);if(e>0&&mergeGaps(a,l-1),n<this.length){let c=a.length;this.decomposeRight(n,a),mergeGaps(a,c)}return HeightMap.of(a)}decomposeLeft(e,n){let s=this.left.length;if(e<=s)return this.left.decomposeLeft(e,n);n.push(this.left),this.break&&(s++,e>=s&&n.push(null)),e>s&&this.right.decomposeLeft(e-s,n)}decomposeRight(e,n){let s=this.left.length,o=s+this.break;if(e>=o)return this.right.decomposeRight(e-o,n);e<s&&this.left.decomposeRight(e,n),this.break&&e<o&&n.push(null),n.push(this.right)}balanced(e,n){return e.size>2*n.size||n.size>2*e.size?HeightMap.of(this.break?[e,null,n]:[e,n]):(this.left=replace(this.left,e),this.right=replace(this.right,n),this.setHeight(e.height+n.height),this.outdated=e.outdated||n.outdated,this.size=e.size+n.size,this.length=e.length+this.break+n.length,this)}updateHeight(e,n=0,s=!1,o){let{left:a,right:l}=this,c=n+a.length+this.break,u=null;return o&&o.from<=n+a.length&&o.more?u=a=a.updateHeight(e,n,s,o):a.updateHeight(e,n,s),o&&o.from<=c+l.length&&o.more?u=l=l.updateHeight(e,c,s,o):l.updateHeight(e,c,s),u?this.balanced(a,l):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function mergeGaps(r,e){let n,s;r[e]==null&&(n=r[e-1])instanceof HeightMapGap&&(s=r[e+1])instanceof HeightMapGap&&r.splice(e-1,3,new HeightMapGap(n.length+1+s.length))}const relevantWidgetHeight=5;class NodeBuilder{constructor(e,n){this.pos=e,this.oracle=n,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,n){if(this.lineStart>-1){let s=Math.min(n,this.lineEnd),o=this.nodes[this.nodes.length-1];o instanceof HeightMapText?o.length+=s-this.pos:(s>this.pos||!this.isCovered)&&this.nodes.push(new HeightMapText(s-this.pos,-1)),this.writtenTo=s,n>s&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=n}point(e,n,s){if(e<n||s.heightRelevant){let o=s.widget?s.widget.estimatedHeight:0,a=s.widget?s.widget.lineBreaks:0;o<0&&(o=this.oracle.lineHeight);let l=n-e;s.block?this.addBlock(new HeightMapBlock(l,o,s)):(l||a||o>=relevantWidgetHeight)&&this.addLineDeco(o,a,l)}else n>e&&this.span(e,n);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:n}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=n,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new HeightMapText(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,n){let s=new HeightMapGap(n-e);return this.oracle.doc.lineAt(e).to==n&&(s.flags|=4),s}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof HeightMapText)return e;let n=new HeightMapText(0,-1);return this.nodes.push(n),n}addBlock(e){this.enterLine();let n=e.deco;n&&n.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,n&&n.endSide>0&&(this.covering=e)}addLineDeco(e,n,s){let o=this.ensureLine();o.length+=s,o.collapsed+=s,o.widgetHeight=Math.max(o.widgetHeight,e),o.breaks+=n,this.writtenTo=this.pos=this.pos+s}finish(e){let n=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(n instanceof HeightMapText)&&!this.isCovered?this.nodes.push(new HeightMapText(0,-1)):(this.writtenTo<this.pos||n==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let s=e;for(let o of this.nodes)o instanceof HeightMapText&&o.updateHeight(this.oracle,s),s+=o?o.length:1;return this.nodes}static build(e,n,s,o){let a=new NodeBuilder(s,e);return RangeSet.spans(n,s,o,a,0),a.finish(s)}}function heightRelevantDecoChanges(r,e,n){let s=new DecorationComparator;return RangeSet.compare(r,e,n,s,0),s.changes}class DecorationComparator{constructor(){this.changes=[]}compareRange(){}comparePoint(e,n,s,o){(e<n||s&&s.heightRelevant||o&&o.heightRelevant)&&addRange(e,n,this.changes,5)}}function visiblePixelRange(r,e){let n=r.getBoundingClientRect(),s=r.ownerDocument,o=s.defaultView||window,a=Math.max(0,n.left),l=Math.min(o.innerWidth,n.right),c=Math.max(0,n.top),u=Math.min(o.innerHeight,n.bottom);for(let f=r.parentNode;f&&f!=s.body;)if(f.nodeType==1){let d=f,p=window.getComputedStyle(d);if((d.scrollHeight>d.clientHeight||d.scrollWidth>d.clientWidth)&&p.overflow!="visible"){let g=d.getBoundingClientRect();a=Math.max(a,g.left),l=Math.min(l,g.right),c=Math.max(c,g.top),u=Math.min(f==r.parentNode?o.innerHeight:u,g.bottom)}f=p.position=="absolute"||p.position=="fixed"?d.offsetParent:d.parentNode}else if(f.nodeType==11)f=f.host;else break;return{left:a-n.left,right:Math.max(a,l)-n.left,top:c-(n.top+e),bottom:Math.max(c,u)-(n.top+e)}}function inWindow(r){let e=r.getBoundingClientRect(),n=r.ownerDocument.defaultView||window;return e.left<n.innerWidth&&e.right>0&&e.top<n.innerHeight&&e.bottom>0}function fullPixelRange(r,e){let n=r.getBoundingClientRect();return{left:0,right:n.right-n.left,top:e,bottom:n.bottom-(n.top+e)}}class LineGap{constructor(e,n,s,o){this.from=e,this.to=n,this.size=s,this.displaySize=o}static same(e,n){if(e.length!=n.length)return!1;for(let s=0;s<e.length;s++){let o=e[s],a=n[s];if(o.from!=a.from||o.to!=a.to||o.size!=a.size)return!1}return!0}draw(e,n){return Decoration.replace({widget:new LineGapWidget(this.displaySize*(n?e.scaleY:e.scaleX),n)}).range(this.from,this.to)}}class LineGapWidget extends WidgetType{constructor(e,n){super(),this.size=e,this.vertical=n}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class ViewState{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=IdScaler,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Direction.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let n=e.facet(contentAttributes).some(s=>typeof s!="function"&&s.class=="cm-lineWrapping");this.heightOracle=new HeightOracle(n),this.stateDeco=e.facet(decorations).filter(s=>typeof s!="function"),this.heightMap=HeightMap.empty().applyChanges(this.stateDeco,Text.empty,this.heightOracle.setDoc(e.doc),[new ChangedRange(0,0,0,e.doc.length)]);for(let s=0;s<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());s++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Decoration.set(this.lineGaps.map(s=>s.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:n}=this.state.selection;for(let s=0;s<=1;s++){let o=s?n.head:n.anchor;if(!e.some(({from:a,to:l})=>o>=a&&o<=l)){let{from:a,to:l}=this.lineBlockAt(o);e.push(new Viewport(a,l))}}return this.viewports=e.sort((s,o)=>s.from-o.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?IdScaler:new BigScaler(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(scaleBlock(e,this.scaler))})}update(e,n=null){this.state=e.state;let s=this.stateDeco;this.stateDeco=this.state.facet(decorations).filter(d=>typeof d!="function");let o=e.changedRanges,a=ChangedRange.extendWithRanges(o,heightRelevantDecoChanges(s,this.stateDeco,e?e.changes:ChangeSet.empty(this.state.doc.length))),l=this.heightMap.height,c=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);clearHeightChangeFlag(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),a),(this.heightMap.height!=l||heightChangeFlag)&&(e.flags|=2),c?(this.scrollAnchorPos=e.changes.mapPos(c.from,-1),this.scrollAnchorHeight=c.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=l);let u=a.length?this.mapViewport(this.viewport,e.changes):this.viewport;(n&&(n.range.head<u.from||n.range.head>u.to)||!this.viewportIsAppropriate(u))&&(u=this.getViewport(0,n));let f=u.from!=this.viewport.from||u.to!=this.viewport.to;this.viewport=u,e.flags|=this.updateForViewport(),(f||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(e.changes),n&&(this.scrollTarget=n),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(nativeSelectionHidden)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let n=e.contentDOM,s=window.getComputedStyle(n),o=this.heightOracle,a=s.whiteSpace;this.defaultTextDirection=s.direction=="rtl"?Direction.RTL:Direction.LTR;let l=this.heightOracle.mustRefreshForWrapping(a),c=n.getBoundingClientRect(),u=l||this.mustMeasureContent||this.contentDOMHeight!=c.height;this.contentDOMHeight=c.height,this.mustMeasureContent=!1;let f=0,d=0;if(c.width&&c.height){let{scaleX:Ve,scaleY:me}=getScale(n,c);(Ve>.005&&Math.abs(this.scaleX-Ve)>.005||me>.005&&Math.abs(this.scaleY-me)>.005)&&(this.scaleX=Ve,this.scaleY=me,f|=16,l=u=!0)}let p=(parseInt(s.paddingTop)||0)*this.scaleY,g=(parseInt(s.paddingBottom)||0)*this.scaleY;(this.paddingTop!=p||this.paddingBottom!=g)&&(this.paddingTop=p,this.paddingBottom=g,f|=18),this.editorWidth!=e.scrollDOM.clientWidth&&(o.lineWrapping&&(u=!0),this.editorWidth=e.scrollDOM.clientWidth,f|=16);let y=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=y&&(this.scrollAnchorHeight=-1,this.scrollTop=y),this.scrolledToBottom=isScrolledToBottom(e.scrollDOM);let x=(this.printing?fullPixelRange:visiblePixelRange)(n,this.paddingTop),E=x.top-this.pixelViewport.top,Y=x.bottom-this.pixelViewport.bottom;this.pixelViewport=x;let Z=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(Z!=this.inView&&(this.inView=Z,Z&&(u=!0)),!this.inView&&!this.scrollTarget&&!inWindow(e.dom))return 0;let te=c.width;if((this.contentDOMWidth!=te||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=c.width,this.editorHeight=e.scrollDOM.clientHeight,f|=16),u){let Ve=e.docView.measureVisibleLineHeights(this.viewport);if(o.mustRefreshForHeights(Ve)&&(l=!0),l||o.lineWrapping&&Math.abs(te-this.contentDOMWidth)>o.charWidth){let{lineHeight:me,charWidth:rt,textHeight:nt}=e.docView.measureTextSize();l=me>0&&o.refresh(a,me,rt,nt,te/rt,Ve),l&&(e.docView.minWidth=0,f|=16)}E>0&&Y>0?d=Math.max(E,Y):E<0&&Y<0&&(d=Math.min(E,Y)),clearHeightChangeFlag();for(let me of this.viewports){let rt=me.from==this.viewport.from?Ve:e.docView.measureVisibleLineHeights(me);this.heightMap=(l?HeightMap.empty().applyChanges(this.stateDeco,Text.empty,this.heightOracle,[new ChangedRange(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(o,0,l,new MeasuredHeights(me.from,rt))}heightChangeFlag&&(f|=2)}let ne=!this.viewportIsAppropriate(this.viewport,d)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return ne&&(f&2&&(f|=this.updateScaler()),this.viewport=this.getViewport(d,this.scrollTarget),f|=this.updateForViewport()),(f&2||ne)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(l?[]:this.lineGaps,e)),f|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),f}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,n){let s=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),o=this.heightMap,a=this.heightOracle,{visibleTop:l,visibleBottom:c}=this,u=new Viewport(o.lineAt(l-s*1e3,QueryType$1.ByHeight,a,0,0).from,o.lineAt(c+(1-s)*1e3,QueryType$1.ByHeight,a,0,0).to);if(n){let{head:f}=n.range;if(f<u.from||f>u.to){let d=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),p=o.lineAt(f,QueryType$1.ByPos,a,0,0),g;n.y=="center"?g=(p.top+p.bottom)/2-d/2:n.y=="start"||n.y=="nearest"&&f<u.from?g=p.top:g=p.bottom-d,u=new Viewport(o.lineAt(g-1e3/2,QueryType$1.ByHeight,a,0,0).from,o.lineAt(g+d+1e3/2,QueryType$1.ByHeight,a,0,0).to)}}return u}mapViewport(e,n){let s=n.mapPos(e.from,-1),o=n.mapPos(e.to,1);return new Viewport(this.heightMap.lineAt(s,QueryType$1.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(o,QueryType$1.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:n},s=0){if(!this.inView)return!0;let{top:o}=this.heightMap.lineAt(e,QueryType$1.ByPos,this.heightOracle,0,0),{bottom:a}=this.heightMap.lineAt(n,QueryType$1.ByPos,this.heightOracle,0,0),{visibleTop:l,visibleBottom:c}=this;return(e==0||o<=l-Math.max(10,Math.min(-s,250)))&&(n==this.state.doc.length||a>=c+Math.max(10,Math.min(s,250)))&&o>l-2*1e3&&a<c+2*1e3}mapLineGaps(e,n){if(!e.length||n.empty)return e;let s=[];for(let o of e)n.touchesRange(o.from,o.to)||s.push(new LineGap(n.mapPos(o.from),n.mapPos(o.to),o.size,o.displaySize));return s}ensureLineGaps(e,n){let s=this.heightOracle.lineWrapping,o=s?1e4:2e3,a=o>>1,l=o<<1;if(this.defaultTextDirection!=Direction.LTR&&!s)return[];let c=[],u=(d,p,g,y)=>{if(p-d<a)return;let x=this.state.selection.main,E=[x.from];x.empty||E.push(x.to);for(let Z of E)if(Z>d&&Z<p){u(d,Z-10,g,y),u(Z+10,p,g,y);return}let Y=find(e,Z=>Z.from>=g.from&&Z.to<=g.to&&Math.abs(Z.from-d)<a&&Math.abs(Z.to-p)<a&&!E.some(te=>Z.from<te&&Z.to>te));if(!Y){if(p<g.to&&n&&s&&n.visibleRanges.some(ne=>ne.from<=p&&ne.to>=p)){let ne=n.moveToLineBoundary(EditorSelection.cursor(p),!1,!0).head;ne>d&&(p=ne)}let Z=this.gapSize(g,d,p,y),te=s||Z<2e6?Z:2e6;Y=new LineGap(d,p,Z,te)}c.push(Y)},f=d=>{if(d.length<l||d.type!=BlockType.Text)return;let p=lineStructure(d.from,d.to,this.stateDeco);if(p.total<l)return;let g=this.scrollTarget?this.scrollTarget.range.head:null,y,x;if(s){let E=o/this.heightOracle.lineLength*this.heightOracle.lineHeight,Y,Z;if(g!=null){let te=findFraction(p,g),ne=((this.visibleBottom-this.visibleTop)/2+E)/d.height;Y=te-ne,Z=te+ne}else Y=(this.visibleTop-d.top-E)/d.height,Z=(this.visibleBottom-d.top+E)/d.height;y=findPosition(p,Y),x=findPosition(p,Z)}else{let E=p.total*this.heightOracle.charWidth,Y=o*this.heightOracle.charWidth,Z=0;if(E>2e6)for(let rt of e)rt.from>=d.from&&rt.from<d.to&&rt.size!=rt.displaySize&&rt.from*this.heightOracle.charWidth+Z<this.pixelViewport.left&&(Z=rt.size-rt.displaySize);let te=this.pixelViewport.left+Z,ne=this.pixelViewport.right+Z,Ve,me;if(g!=null){let rt=findFraction(p,g),nt=((ne-te)/2+Y)/E;Ve=rt-nt,me=rt+nt}else Ve=(te-Y)/E,me=(ne+Y)/E;y=findPosition(p,Ve),x=findPosition(p,me)}y>d.from&&u(d.from,y,d,p),x<d.to&&u(x,d.to,d,p)};for(let d of this.viewportLines)Array.isArray(d.type)?d.type.forEach(f):f(d);return c}gapSize(e,n,s,o){let a=findFraction(o,s)-findFraction(o,n);return this.heightOracle.lineWrapping?e.height*a:o.total*this.heightOracle.charWidth*a}updateLineGaps(e){LineGap.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=Decoration.set(e.map(n=>n.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(e){let n=this.stateDeco;this.lineGaps.length&&(n=n.concat(this.lineGapDeco));let s=[];RangeSet.spans(n,this.viewport.from,this.viewport.to,{span(a,l){s.push({from:a,to:l})},point(){}},20);let o=0;if(s.length!=this.visibleRanges.length)o=12;else for(let a=0;a<s.length&&!(o&8);a++){let l=this.visibleRanges[a],c=s[a];(l.from!=c.from||l.to!=c.to)&&(o|=4,e&&e.mapPos(l.from,-1)==c.from&&e.mapPos(l.to,1)==c.to||(o|=8))}return this.visibleRanges=s,o}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(n=>n.from<=e&&n.to>=e)||scaleBlock(this.heightMap.lineAt(e,QueryType$1.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(n=>n.top<=e&&n.bottom>=e)||scaleBlock(this.heightMap.lineAt(this.scaler.fromDOM(e),QueryType$1.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let n=this.lineBlockAtHeight(e+8);return n.from>=this.viewport.from||this.viewportLines[0].top-e>200?n:this.viewportLines[0]}elementAtHeight(e){return scaleBlock(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class Viewport{constructor(e,n){this.from=e,this.to=n}}function lineStructure(r,e,n){let s=[],o=r,a=0;return RangeSet.spans(n,r,e,{span(){},point(l,c){l>o&&(s.push({from:o,to:l}),a+=l-o),o=c}},20),o<e&&(s.push({from:o,to:e}),a+=e-o),{total:a,ranges:s}}function findPosition({total:r,ranges:e},n){if(n<=0)return e[0].from;if(n>=1)return e[e.length-1].to;let s=Math.floor(r*n);for(let o=0;;o++){let{from:a,to:l}=e[o],c=l-a;if(s<=c)return a+s;s-=c}}function findFraction(r,e){let n=0;for(let{from:s,to:o}of r.ranges){if(e<=o){n+=e-s;break}n+=o-s}return n/r.total}function find(r,e){for(let n of r)if(e(n))return n}const IdScaler={toDOM(r){return r},fromDOM(r){return r},scale:1,eq(r){return r==this}};class BigScaler{constructor(e,n,s){let o=0,a=0,l=0;this.viewports=s.map(({from:c,to:u})=>{let f=n.lineAt(c,QueryType$1.ByPos,e,0,0).top,d=n.lineAt(u,QueryType$1.ByPos,e,0,0).bottom;return o+=d-f,{from:c,to:u,top:f,bottom:d,domTop:0,domBottom:0}}),this.scale=(7e6-o)/(n.height-o);for(let c of this.viewports)c.domTop=l+(c.top-a)*this.scale,l=c.domBottom=c.domTop+(c.bottom-c.top),a=c.bottom}toDOM(e){for(let n=0,s=0,o=0;;n++){let a=n<this.viewports.length?this.viewports[n]:null;if(!a||e<a.top)return o+(e-s)*this.scale;if(e<=a.bottom)return a.domTop+(e-a.top);s=a.bottom,o=a.domBottom}}fromDOM(e){for(let n=0,s=0,o=0;;n++){let a=n<this.viewports.length?this.viewports[n]:null;if(!a||e<a.domTop)return s+(e-o)/this.scale;if(e<=a.domBottom)return a.top+(e-a.domTop);s=a.bottom,o=a.domBottom}}eq(e){return e instanceof BigScaler?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((n,s)=>n.from==e.viewports[s].from&&n.to==e.viewports[s].to):!1}}function scaleBlock(r,e){if(e.scale==1)return r;let n=e.toDOM(r.top),s=e.toDOM(r.bottom);return new BlockInfo(r.from,r.length,n,s-n,Array.isArray(r._content)?r._content.map(o=>scaleBlock(o,e)):r._content)}const theme=Facet.define({combine:r=>r.join(" ")}),darkTheme=Facet.define({combine:r=>r.indexOf(!0)>-1}),baseThemeID=StyleModule.newName(),baseLightID=StyleModule.newName(),baseDarkID=StyleModule.newName(),lightDarkIDs={"&light":"."+baseLightID,"&dark":"."+baseDarkID};function buildTheme(r,e,n){return new StyleModule(e,{finish(s){return/&/.test(s)?s.replace(/&\w*/,o=>{if(o=="&")return r;if(!n||!n[o])throw new RangeError(`Unsupported selector: ${o}`);return n[o]}):r+" "+s}})}const baseTheme$1$2=buildTheme("."+baseThemeID,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",zIndex:200},".cm-gutters-before":{insetInlineStart:0},".cm-gutters-after":{insetInlineEnd:0},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",border:"0px solid #ddd","&.cm-gutters-before":{borderRightWidth:"1px"},"&.cm-gutters-after":{borderLeftWidth:"1px"}},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-dialog":{padding:"2px 19px 4px 6px",position:"relative","& label":{fontSize:"80%"}},".cm-dialog-close":{position:"absolute",top:"3px",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",fontSize:"14px",padding:"0"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},lightDarkIDs),observeOptions={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},useCharData=browser.ie&&browser.ie_version<=11;class DOMObserver{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new DOMSelectionState,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(n=>{for(let s of n)this.queue.push(s);(browser.ie&&browser.ie_version<=11||browser.ios&&e.composing)&&n.some(s=>s.type=="childList"&&s.removedNodes.length||s.type=="characterData"&&s.oldValue.length>s.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&browser.android&&e.constructor.EDIT_CONTEXT!==!1&&!(browser.chrome&&browser.chrome_version<126)&&(this.editContext=new EditContextManager(e),e.state.facet(editable)&&(e.contentDOM.editContext=this.editContext.editContext)),useCharData&&(this.onCharData=n=>{this.queue.push({target:n.target,type:"characterData",oldValue:n.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var n;((n=this.view.docView)===null||n===void 0?void 0:n.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(n=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),n.length>0&&n[n.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(n=>{n.length>0&&n[n.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((n,s)=>n!=e[s]))){this.gapIntersection.disconnect();for(let n of e)this.gapIntersection.observe(n);this.gaps=e}}onSelectionChange(e){let n=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:s}=this,o=this.selectionRange;if(s.state.facet(editable)?s.root.activeElement!=this.dom:!hasSelection(this.dom,o))return;let a=o.anchorNode&&s.docView.nearest(o.anchorNode);if(a&&a.ignoreEvent(e)){n||(this.selectionChanged=!1);return}(browser.ie&&browser.ie_version<=11||browser.android&&browser.chrome)&&!s.state.selection.main.empty&&o.focusNode&&isEquivalentPosition(o.focusNode,o.focusOffset,o.anchorNode,o.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,n=getSelection(e.root);if(!n)return!1;let s=browser.safari&&e.root.nodeType==11&&e.root.activeElement==this.dom&&safariSelectionRangeHack(this.view,n)||n;if(!s||this.selectionRange.eq(s))return!1;let o=hasSelection(this.dom,s);return o&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&atElementStart(this.dom,s)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(s),o&&(this.selectionChanged=!0),!0)}setSelectionRange(e,n){this.selectionRange.set(e.node,e.offset,n.node,n.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,n=null;for(let s=this.dom;s;)if(s.nodeType==1)!n&&e<this.scrollTargets.length&&this.scrollTargets[e]==s?e++:n||(n=this.scrollTargets.slice(0,e)),n&&n.push(s),s=s.assignedSlot||s.parentNode;else if(s.nodeType==11)s=s.host;else break;if(e<this.scrollTargets.length&&!n&&(n=this.scrollTargets.slice(0,e)),n){for(let s of this.scrollTargets)s.removeEventListener("scroll",this.onScroll);for(let s of this.scrollTargets=n)s.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,observeOptions),useCharData&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),useCharData&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,n){var s;if(!this.delayedAndroidKey){let o=()=>{let a=this.delayedAndroidKey;a&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=a.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&a.force&&dispatchKey(this.dom,a.key,a.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(o)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:n,force:this.lastChange<Date.now()-50||!!(!((s=this.delayedAndroidKey)===null||s===void 0)&&s.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let n=-1,s=-1,o=!1;for(let a of e){let l=this.readMutation(a);l&&(l.typeOver&&(o=!0),n==-1?{from:n,to:s}=l:(n=Math.min(l.from,n),s=Math.max(l.to,s)))}return{from:n,to:s,typeOver:o}}readChange(){let{from:e,to:n,typeOver:s}=this.processRecords(),o=this.selectionChanged&&hasSelection(this.dom,this.selectionRange);if(e<0&&!o)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let a=new DOMChange(this.view,e,n,s);return this.view.docView.domChanged={newSel:a.newSel?a.newSel.main:null},a}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let n=this.readChange();if(!n)return this.view.requestMeasure(),!1;let s=this.view.state,o=applyDOMChange(this.view,n);return this.view.state==s&&(n.domChanged||n.newSel&&!n.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),o}readMutation(e){let n=this.view.docView.nearest(e.target);if(!n||n.ignoreMutation(e))return null;if(n.markDirty(e.type=="attributes"),e.type=="attributes"&&(n.flags|=4),e.type=="childList"){let s=findChild(n,e.previousSibling||e.target.previousSibling,-1),o=findChild(n,e.nextSibling||e.target.nextSibling,1);return{from:s?n.posAfter(s):n.posAtStart,to:o?n.posBefore(o):n.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(editable)!=e.state.facet(editable)&&(e.view.contentDOM.editContext=e.state.facet(editable)?this.editContext.editContext:null))}destroy(){var e,n,s;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(n=this.gapIntersection)===null||n===void 0||n.disconnect(),(s=this.resizeScroll)===null||s===void 0||s.disconnect();for(let o of this.scrollTargets)o.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function findChild(r,e,n){for(;e;){let s=ContentView.get(e);if(s&&s.parent==r)return s;let o=e.parentNode;e=o!=r.dom?o:n>0?e.nextSibling:e.previousSibling}return null}function buildSelectionRangeFromRange(r,e){let n=e.startContainer,s=e.startOffset,o=e.endContainer,a=e.endOffset,l=r.docView.domAtPos(r.state.selection.main.anchor);return isEquivalentPosition(l.node,l.offset,o,a)&&([n,s,o,a]=[o,a,n,s]),{anchorNode:n,anchorOffset:s,focusNode:o,focusOffset:a}}function safariSelectionRangeHack(r,e){if(e.getComposedRanges){let o=e.getComposedRanges(r.root)[0];if(o)return buildSelectionRangeFromRange(r,o)}let n=null;function s(o){o.preventDefault(),o.stopImmediatePropagation(),n=o.getTargetRanges()[0]}return r.contentDOM.addEventListener("beforeinput",s,!0),r.dom.ownerDocument.execCommand("indent"),r.contentDOM.removeEventListener("beforeinput",s,!0),n?buildSelectionRangeFromRange(r,n):null}class EditContextManager{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(e.state);let n=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=s=>{let o=e.state.selection.main,{anchor:a,head:l}=o,c=this.toEditorPos(s.updateRangeStart),u=this.toEditorPos(s.updateRangeEnd);e.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:s.updateRangeStart,editorBase:c,drifted:!1});let f={from:c,to:u,insert:Text.of(s.text.split(`
`))};if(f.from==this.from&&a<this.from?f.from=a:f.to==this.to&&a>this.to&&(f.to=a),f.from==f.to&&!f.insert.length){let d=EditorSelection.single(this.toEditorPos(s.selectionStart),this.toEditorPos(s.selectionEnd));d.main.eq(o)||e.dispatch({selection:d,userEvent:"select"});return}if((browser.mac||browser.android)&&f.from==l-1&&/^\. ?$/.test(s.text)&&e.contentDOM.getAttribute("autocorrect")=="off"&&(f={from:c,to:u,insert:Text.of([s.text.replace("."," ")])}),this.pendingContextChange=f,!e.state.readOnly){let d=this.to-this.from+(f.to-f.from+f.insert.length);applyDOMChangeInner(e,f,EditorSelection.single(this.toEditorPos(s.selectionStart,d),this.toEditorPos(s.selectionEnd,d)))}this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state))},this.handlers.characterboundsupdate=s=>{let o=[],a=null;for(let l=this.toEditorPos(s.rangeStart),c=this.toEditorPos(s.rangeEnd);l<c;l++){let u=e.coordsForChar(l);a=u&&new DOMRect(u.left,u.top,u.right-u.left,u.bottom-u.top)||a||new DOMRect,o.push(a)}n.updateCharacterBounds(s.rangeStart,o)},this.handlers.textformatupdate=s=>{let o=[];for(let a of s.getTextFormats()){let l=a.underlineStyle,c=a.underlineThickness;if(l!="None"&&c!="None"){let u=this.toEditorPos(a.rangeStart),f=this.toEditorPos(a.rangeEnd);if(u<f){let d=`text-decoration: underline ${l=="Dashed"?"dashed ":l=="Squiggle"?"wavy ":""}${c=="Thin"?1:2}px`;o.push(Decoration.mark({attributes:{style:d}}).range(u,f))}}}e.dispatch({effects:setEditContextFormatting.of(Decoration.set(o))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(e.inputState.composing=-1,e.inputState.compositionFirstChange=null,this.composing){let{drifted:s}=this.composing;this.composing=null,s&&this.reset(e.state)}};for(let s in this.handlers)n.addEventListener(s,this.handlers[s]);this.measureReq={read:s=>{this.editContext.updateControlBounds(s.contentDOM.getBoundingClientRect());let o=getSelection(s.root);o&&o.rangeCount&&this.editContext.updateSelectionBounds(o.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let n=0,s=!1,o=this.pendingContextChange;return e.changes.iterChanges((a,l,c,u,f)=>{if(s)return;let d=f.length-(l-a);if(o&&l>=o.to)if(o.from==a&&o.to==l&&o.insert.eq(f)){o=this.pendingContextChange=null,n+=d,this.to+=d;return}else o=null,this.revertPending(e.state);if(a+=n,l+=n,l<=this.from)this.from+=d,this.to+=d;else if(a<this.to){if(a<this.from||l>this.to||this.to-this.from+f.length>3e4){s=!0;return}this.editContext.updateText(this.toContextPos(a),this.toContextPos(l),f.toString()),this.to+=d}n+=d}),o&&!s&&this.revertPending(e.state),!s}update(e){let n=this.pendingContextChange,s=e.startState.selection.main;this.composing&&(this.composing.drifted||!e.changes.touchesRange(s.from,s.to)&&e.transactions.some(o=>!o.isUserEvent("input.type")&&o.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=e.changes.mapPos(this.composing.editorBase)):!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.reset(e.state)):(e.docChanged||e.selectionSet||n)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:n}=e.selection.main;this.from=Math.max(0,n-1e4),this.to=Math.min(e.doc.length,n+1e4)}reset(e){this.resetRange(e),this.editContext.updateText(0,this.editContext.text.length,e.doc.sliceString(this.from,this.to)),this.setSelection(e)}revertPending(e){let n=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(n.from),this.toContextPos(n.from+n.insert.length),e.doc.sliceString(n.from,n.to))}setSelection(e){let{main:n}=e.selection,s=this.toContextPos(Math.max(this.from,Math.min(this.to,n.anchor))),o=this.toContextPos(n.head);(this.editContext.selectionStart!=s||this.editContext.selectionEnd!=o)&&this.editContext.updateSelection(s,o)}rangeIsValid(e){let{head:n}=e.selection.main;return!(this.from>0&&n-this.from<500||this.to<e.doc.length&&this.to-n<500||this.to-this.from>1e4*3)}toEditorPos(e,n=this.to-this.from){e=Math.min(e,n);let s=this.composing;return s&&s.drifted?s.editorBase+(e-s.contextBase):e+this.from}toContextPos(e){let n=this.composing;return n&&n.drifted?n.contextBase+(e-n.editorBase):e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}class EditorView{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var n;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:s}=e;this.dispatchTransactions=e.dispatchTransactions||s&&(o=>o.forEach(a=>s(a,this)))||(o=>this.update(o)),this.dispatch=this.dispatch.bind(this),this._root=e.root||getRoot(e.parent)||document,this.viewState=new ViewState(e.state||EditorState.create(e)),e.scrollTo&&e.scrollTo.is(scrollIntoView$1)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(viewPlugin).map(o=>new PluginInstance(o));for(let o of this.plugins)o.update(this);this.observer=new DOMObserver(this),this.inputState=new InputState(this),this.inputState.ensureHandlers(this.plugins),this.docView=new DocView(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((n=document.fonts)===null||n===void 0)&&n.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...e){let n=e.length==1&&e[0]instanceof Transaction?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(n,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let n=!1,s=!1,o,a=this.state;for(let g of e){if(g.startState!=a)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");a=g.state}if(this.destroyed){this.viewState.state=a;return}let l=this.hasFocus,c=0,u=null;e.some(g=>g.annotation(isFocusChange))?(this.inputState.notifiedFocused=l,c=1):l!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=l,u=focusChangeTransaction(a,l),u||(c=1));let f=this.observer.delayedAndroidKey,d=null;if(f?(this.observer.clearDelayedAndroidKey(),d=this.observer.readChange(),(d&&!this.state.doc.eq(a.doc)||!this.state.selection.eq(a.selection))&&(d=null)):this.observer.clear(),a.facet(EditorState.phrases)!=this.state.facet(EditorState.phrases))return this.setState(a);o=ViewUpdate.create(this,a,e),o.flags|=c;let p=this.viewState.scrollTarget;try{this.updateState=2;for(let g of e){if(p&&(p=p.map(g.changes)),g.scrollIntoView){let{main:y}=g.state.selection;p=new ScrollTarget(y.empty?y:EditorSelection.cursor(y.head,y.head>y.anchor?-1:1))}for(let y of g.effects)y.is(scrollIntoView$1)&&(p=y.value.clip(this.state))}this.viewState.update(o,p),this.bidiCache=CachedOrder.update(this.bidiCache,o.changes),o.empty||(this.updatePlugins(o),this.inputState.update(o)),n=this.docView.update(o),this.state.facet(styleModule)!=this.styleModules&&this.mountStyles(),s=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(n,e.some(g=>g.isUserEvent("select.pointer")))}finally{this.updateState=0}if(o.startState.facet(theme)!=o.state.facet(theme)&&(this.viewState.mustMeasureContent=!0),(n||s||p||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),n&&this.docViewUpdate(),!o.empty)for(let g of this.state.facet(updateListener))try{g(o)}catch(y){logException(this.state,y,"update listener")}(u||d)&&Promise.resolve().then(()=>{u&&this.state==u.startState&&this.dispatch(u),d&&!applyDOMChange(this,d)&&f.force&&dispatchKey(this.contentDOM,f.key,f.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let n=this.hasFocus;try{for(let s of this.plugins)s.destroy(this);this.viewState=new ViewState(e),this.plugins=e.facet(viewPlugin).map(s=>new PluginInstance(s)),this.pluginMap.clear();for(let s of this.plugins)s.update(this);this.docView.destroy(),this.docView=new DocView(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}n&&this.focus(),this.requestMeasure()}updatePlugins(e){let n=e.startState.facet(viewPlugin),s=e.state.facet(viewPlugin);if(n!=s){let o=[];for(let a of s){let l=n.indexOf(a);if(l<0)o.push(new PluginInstance(a));else{let c=this.plugins[l];c.mustUpdate=e,o.push(c)}}for(let a of this.plugins)a.mustUpdate!=e&&a.destroy(this);this.plugins=o,this.pluginMap.clear()}else for(let o of this.plugins)o.mustUpdate=e;for(let o=0;o<this.plugins.length;o++)this.plugins[o].update(this);n!=s&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let n=e.value;if(n&&n.docViewUpdate)try{n.docViewUpdate(this)}catch(s){logException(this.state,s,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let n=null,s=this.scrollDOM,o=s.scrollTop*this.scaleY,{scrollAnchorPos:a,scrollAnchorHeight:l}=this.viewState;Math.abs(o-this.viewState.scrollTop)>1&&(l=-1),this.viewState.scrollAnchorHeight=-1;try{for(let c=0;;c++){if(l<0)if(isScrolledToBottom(s))a=-1,l=this.viewState.heightMap.height;else{let y=this.viewState.scrollAnchorAt(o);a=y.from,l=y.top}this.updateState=1;let u=this.viewState.measure(this);if(!u&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(c>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let f=[];u&4||([this.measureRequests,f]=[f,this.measureRequests]);let d=f.map(y=>{try{return y.read(this)}catch(x){return logException(this.state,x),BadMeasure}}),p=ViewUpdate.create(this,this.state,[]),g=!1;p.flags|=u,n?n.flags|=u:n=p,this.updateState=2,p.empty||(this.updatePlugins(p),this.inputState.update(p),this.updateAttrs(),g=this.docView.update(p),g&&this.docViewUpdate());for(let y=0;y<f.length;y++)if(d[y]!=BadMeasure)try{let x=f[y];x.write&&x.write(d[y],this)}catch(x){logException(this.state,x)}if(g&&this.docView.updateSelection(!0),!p.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,l=-1;continue}else{let x=(a<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(a).top)-l;if(x>1||x<-1){o=o+x,s.scrollTop=o/this.scaleY,l=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(n&&!n.empty)for(let c of this.state.facet(updateListener))c(n)}get themeClasses(){return baseThemeID+" "+(this.state.facet(darkTheme)?baseDarkID:baseLightID)+" "+this.state.facet(theme)}updateAttrs(){let e=attrsFromFacet(this,editorAttributes,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),n={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(editable)?"true":"false",class:"cm-content",style:`${browser.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(n["aria-readonly"]="true"),attrsFromFacet(this,contentAttributes,n);let s=this.observer.ignore(()=>{let o=updateAttrs(this.contentDOM,this.contentAttrs,n),a=updateAttrs(this.dom,this.editorAttrs,e);return o||a});return this.editorAttrs=e,this.contentAttrs=n,s}showAnnouncements(e){let n=!0;for(let s of e)for(let o of s.effects)if(o.is(EditorView.announce)){n&&(this.announceDOM.textContent=""),n=!1;let a=this.announceDOM.appendChild(document.createElement("div"));a.textContent=o.value}}mountStyles(){this.styleModules=this.state.facet(styleModule);let e=this.state.facet(EditorView.cspNonce);StyleModule.mount(this.root,this.styleModules.concat(baseTheme$1$2).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let n=0;n<this.measureRequests.length;n++)if(this.measureRequests[n].key===e.key){this.measureRequests[n]=e;return}}this.measureRequests.push(e)}}plugin(e){let n=this.pluginMap.get(e);return(n===void 0||n&&n.plugin!=e)&&this.pluginMap.set(e,n=this.plugins.find(s=>s.plugin==e)||null),n&&n.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,n,s){return skipAtoms(this,e,moveByChar(this,e,n,s))}moveByGroup(e,n){return skipAtoms(this,e,moveByChar(this,e,n,s=>byGroup(this,e.head,s)))}visualLineSide(e,n){let s=this.bidiSpans(e),o=this.textDirectionAt(e.from),a=s[n?s.length-1:0];return EditorSelection.cursor(a.side(n,o)+e.from,a.forward(!n,o)?1:-1)}moveToLineBoundary(e,n,s=!0){return moveToLineBoundary(this,e,n,s)}moveVertically(e,n,s){return skipAtoms(this,e,moveVertically(this,e,n,s))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,n=0){return this.docView.posFromDOM(e,n)}posAtCoords(e,n=!0){return this.readMeasured(),posAtCoords(this,e,n)}coordsAtPos(e,n=1){this.readMeasured();let s=this.docView.coordsAt(e,n);if(!s||s.left==s.right)return s;let o=this.state.doc.lineAt(e),a=this.bidiSpans(o),l=a[BidiSpan.find(a,e-o.from,-1,n)];return flattenRect(s,l.dir==Direction.LTR==n>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(perLineTextDirection)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>MaxBidiLine)return trivialOrder(e.length);let n=this.textDirectionAt(e.from),s;for(let a of this.bidiCache)if(a.from==e.from&&a.dir==n&&(a.fresh||isolatesEq(a.isolates,s=getIsolatedRanges(this,e))))return a.order;s||(s=getIsolatedRanges(this,e));let o=computeOrder(e.text,n,s);return this.bidiCache.push(new CachedOrder(e.from,e.to,n,s,!0,o)),o}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||browser.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{focusPreventScroll(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,n={}){return scrollIntoView$1.of(new ScrollTarget(typeof e=="number"?EditorSelection.cursor(e):e,n.y,n.x,n.yMargin,n.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:n}=this.scrollDOM,s=this.viewState.scrollAnchorAt(e);return scrollIntoView$1.of(new ScrollTarget(EditorSelection.cursor(s.from),"start","start",s.top-e,n,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return ViewPlugin.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return ViewPlugin.define(()=>({}),{eventObservers:e})}static theme(e,n){let s=StyleModule.newName(),o=[theme.of(s),styleModule.of(buildTheme(`.${s}`,e))];return n&&n.dark&&o.push(darkTheme.of(!0)),o}static baseTheme(e){return Prec.lowest(styleModule.of(buildTheme("."+baseThemeID,e,lightDarkIDs)))}static findFromDOM(e){var n;let s=e.querySelector(".cm-content"),o=s&&ContentView.get(s)||ContentView.get(e);return((n=o?.rootView)===null||n===void 0?void 0:n.view)||null}}EditorView.styleModule=styleModule;EditorView.inputHandler=inputHandler$1;EditorView.clipboardInputFilter=clipboardInputFilter;EditorView.clipboardOutputFilter=clipboardOutputFilter;EditorView.scrollHandler=scrollHandler;EditorView.focusChangeEffect=focusChangeEffect;EditorView.perLineTextDirection=perLineTextDirection;EditorView.exceptionSink=exceptionSink;EditorView.updateListener=updateListener;EditorView.editable=editable;EditorView.mouseSelectionStyle=mouseSelectionStyle;EditorView.dragMovesSelection=dragMovesSelection$1;EditorView.clickAddsSelectionRange=clickAddsSelectionRange;EditorView.decorations=decorations;EditorView.outerDecorations=outerDecorations;EditorView.atomicRanges=atomicRanges;EditorView.bidiIsolatedRanges=bidiIsolatedRanges;EditorView.scrollMargins=scrollMargins;EditorView.darkTheme=darkTheme;EditorView.cspNonce=Facet.define({combine:r=>r.length?r[0]:""});EditorView.contentAttributes=contentAttributes;EditorView.editorAttributes=editorAttributes;EditorView.lineWrapping=EditorView.contentAttributes.of({class:"cm-lineWrapping"});EditorView.announce=StateEffect.define();const MaxBidiLine=4096,BadMeasure={};class CachedOrder{constructor(e,n,s,o,a,l){this.from=e,this.to=n,this.dir=s,this.isolates=o,this.fresh=a,this.order=l}static update(e,n){if(n.empty&&!e.some(a=>a.fresh))return e;let s=[],o=e.length?e[e.length-1].dir:Direction.LTR;for(let a=Math.max(0,e.length-10);a<e.length;a++){let l=e[a];l.dir==o&&!n.touchesRange(l.from,l.to)&&s.push(new CachedOrder(n.mapPos(l.from,1),n.mapPos(l.to,-1),l.dir,l.isolates,!1,l.order))}return s}}function attrsFromFacet(r,e,n){for(let s=r.state.facet(e),o=s.length-1;o>=0;o--){let a=s[o],l=typeof a=="function"?a(r):a;l&&combineAttrs(l,n)}return n}const currentPlatform=browser.mac?"mac":browser.windows?"win":browser.linux?"linux":"key";function normalizeKeyName(r,e){const n=r.split(/-(?!$)/);let s=n[n.length-1];s=="Space"&&(s=" ");let o,a,l,c;for(let u=0;u<n.length-1;++u){const f=n[u];if(/^(cmd|meta|m)$/i.test(f))c=!0;else if(/^a(lt)?$/i.test(f))o=!0;else if(/^(c|ctrl|control)$/i.test(f))a=!0;else if(/^s(hift)?$/i.test(f))l=!0;else if(/^mod$/i.test(f))e=="mac"?c=!0:a=!0;else throw new Error("Unrecognized modifier name: "+f)}return o&&(s="Alt-"+s),a&&(s="Ctrl-"+s),c&&(s="Meta-"+s),l&&(s="Shift-"+s),s}function modifiers(r,e,n){return e.altKey&&(r="Alt-"+r),e.ctrlKey&&(r="Ctrl-"+r),e.metaKey&&(r="Meta-"+r),n!==!1&&e.shiftKey&&(r="Shift-"+r),r}const handleKeyEvents=Prec.default(EditorView.domEventHandlers({keydown(r,e){return runHandlers(getKeymap(e.state),r,e,"editor")}})),keymap=Facet.define({enables:handleKeyEvents}),Keymaps=new WeakMap;function getKeymap(r){let e=r.facet(keymap),n=Keymaps.get(e);return n||Keymaps.set(e,n=buildKeymap(e.reduce((s,o)=>s.concat(o),[]))),n}function runScopeHandlers(r,e,n){return runHandlers(getKeymap(r.state),e,r,n)}let storedPrefix=null;const PrefixTimeout=4e3;function buildKeymap(r,e=currentPlatform){let n=Object.create(null),s=Object.create(null),o=(l,c)=>{let u=s[l];if(u==null)s[l]=c;else if(u!=c)throw new Error("Key binding "+l+" is used both as a regular binding and as a multi-stroke prefix")},a=(l,c,u,f,d)=>{var p,g;let y=n[l]||(n[l]=Object.create(null)),x=c.split(/ (?!$)/).map(Z=>normalizeKeyName(Z,e));for(let Z=1;Z<x.length;Z++){let te=x.slice(0,Z).join(" ");o(te,!0),y[te]||(y[te]={preventDefault:!0,stopPropagation:!1,run:[ne=>{let Ve=storedPrefix={view:ne,prefix:te,scope:l};return setTimeout(()=>{storedPrefix==Ve&&(storedPrefix=null)},PrefixTimeout),!0}]})}let E=x.join(" ");o(E,!1);let Y=y[E]||(y[E]={preventDefault:!1,stopPropagation:!1,run:((g=(p=y._any)===null||p===void 0?void 0:p.run)===null||g===void 0?void 0:g.slice())||[]});u&&Y.run.push(u),f&&(Y.preventDefault=!0),d&&(Y.stopPropagation=!0)};for(let l of r){let c=l.scope?l.scope.split(" "):["editor"];if(l.any)for(let f of c){let d=n[f]||(n[f]=Object.create(null));d._any||(d._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:p}=l;for(let g in d)d[g].run.push(y=>p(y,currentKeyEvent))}let u=l[e]||l.key;if(u)for(let f of c)a(f,u,l.run,l.preventDefault,l.stopPropagation),l.shift&&a(f,"Shift-"+u,l.shift,l.preventDefault,l.stopPropagation)}return n}let currentKeyEvent=null;function runHandlers(r,e,n,s){currentKeyEvent=e;let o=keyName(e),a=codePointAt(o,0),l=codePointSize(a)==o.length&&o!=" ",c="",u=!1,f=!1,d=!1;storedPrefix&&storedPrefix.view==n&&storedPrefix.scope==s&&(c=storedPrefix.prefix+" ",modifierCodes.indexOf(e.keyCode)<0&&(f=!0,storedPrefix=null));let p=new Set,g=Y=>{if(Y){for(let Z of Y.run)if(!p.has(Z)&&(p.add(Z),Z(n)))return Y.stopPropagation&&(d=!0),!0;Y.preventDefault&&(Y.stopPropagation&&(d=!0),f=!0)}return!1},y=r[s],x,E;return y&&(g(y[c+modifiers(o,e,!l)])?u=!0:l&&(e.altKey||e.metaKey||e.ctrlKey)&&!(browser.windows&&e.ctrlKey&&e.altKey)&&(x=base[e.keyCode])&&x!=o?(g(y[c+modifiers(x,e,!0)])||e.shiftKey&&(E=shift[e.keyCode])!=o&&E!=x&&g(y[c+modifiers(E,e,!1)]))&&(u=!0):l&&e.shiftKey&&g(y[c+modifiers(o,e,!0)])&&(u=!0),!u&&g(y._any)&&(u=!0)),f&&(u=!0),u&&d&&e.stopPropagation(),currentKeyEvent=null,u}const Outside="-10000px";class TooltipViewManager{constructor(e,n,s,o){this.facet=n,this.createTooltipView=s,this.removeTooltipView=o,this.input=e.state.facet(n),this.tooltips=this.input.filter(l=>l);let a=null;this.tooltipViews=this.tooltips.map(l=>a=s(l,a))}update(e,n){var s;let o=e.state.facet(this.facet),a=o.filter(u=>u);if(o===this.input){for(let u of this.tooltipViews)u.update&&u.update(e);return!1}let l=[],c=n?[]:null;for(let u=0;u<a.length;u++){let f=a[u],d=-1;if(f){for(let p=0;p<this.tooltips.length;p++){let g=this.tooltips[p];g&&g.create==f.create&&(d=p)}if(d<0)l[u]=this.createTooltipView(f,u?l[u-1]:null),c&&(c[u]=!!f.above);else{let p=l[u]=this.tooltipViews[d];c&&(c[u]=n[d]),p.update&&p.update(e)}}}for(let u of this.tooltipViews)l.indexOf(u)<0&&(this.removeTooltipView(u),(s=u.destroy)===null||s===void 0||s.call(u));return n&&(c.forEach((u,f)=>n[f]=u),n.length=c.length),this.input=o,this.tooltips=a,this.tooltipViews=l,!0}}function windowSpace(r){let e=r.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:e.clientHeight,right:e.clientWidth}}const tooltipConfig=Facet.define({combine:r=>{var e,n,s;return{position:browser.ios?"absolute":((e=r.find(o=>o.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((n=r.find(o=>o.parent))===null||n===void 0?void 0:n.parent)||null,tooltipSpace:((s=r.find(o=>o.tooltipSpace))===null||s===void 0?void 0:s.tooltipSpace)||windowSpace}}}),knownHeight=new WeakMap,tooltipPlugin=ViewPlugin.fromClass(class{constructor(r){this.view=r,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=r.state.facet(tooltipConfig);this.position=e.position,this.parent=e.parent,this.classes=r.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new TooltipViewManager(r,showTooltip,(n,s)=>this.createTooltip(n,s),n=>{this.resizeObserver&&this.resizeObserver.unobserve(n.dom),n.dom.remove()}),this.above=this.manager.tooltips.map(n=>!!n.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(n=>{Date.now()>this.lastTransaction-50&&n.length>0&&n[n.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),r.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let r of this.manager.tooltipViews)this.intersectionObserver.observe(r.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(r){r.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(r,this.above);e&&this.observeIntersection();let n=e||r.geometryChanged,s=r.state.facet(tooltipConfig);if(s.position!=this.position&&!this.madeAbsolute){this.position=s.position;for(let o of this.manager.tooltipViews)o.dom.style.position=this.position;n=!0}if(s.parent!=this.parent){this.parent&&this.container.remove(),this.parent=s.parent,this.createContainer();for(let o of this.manager.tooltipViews)this.container.appendChild(o.dom);n=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);n&&this.maybeMeasure()}createTooltip(r,e){let n=r.create(this.view),s=e?e.dom:null;if(n.dom.classList.add("cm-tooltip"),r.arrow&&!n.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let o=document.createElement("div");o.className="cm-tooltip-arrow",n.dom.appendChild(o)}return n.dom.style.position=this.position,n.dom.style.top=Outside,n.dom.style.left="0px",this.container.insertBefore(n.dom,s),n.mount&&n.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(n.dom),n}destroy(){var r,e,n;this.view.win.removeEventListener("resize",this.measureSoon);for(let s of this.manager.tooltipViews)s.dom.remove(),(r=s.destroy)===null||r===void 0||r.call(s);this.parent&&this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(n=this.intersectionObserver)===null||n===void 0||n.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let r=1,e=1,n=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:a}=this.manager.tooltipViews[0];if(browser.gecko)n=a.offsetParent!=this.container.ownerDocument.body;else if(a.style.top==Outside&&a.style.left=="0px"){let l=a.getBoundingClientRect();n=Math.abs(l.top+1e4)>1||Math.abs(l.left)>1}}if(n||this.position=="absolute")if(this.parent){let a=this.parent.getBoundingClientRect();a.width&&a.height&&(r=a.width/this.parent.offsetWidth,e=a.height/this.parent.offsetHeight)}else({scaleX:r,scaleY:e}=this.view.viewState);let s=this.view.scrollDOM.getBoundingClientRect(),o=getScrollMargins(this.view);return{visible:{left:s.left+o.left,top:s.top+o.top,right:s.right-o.right,bottom:s.bottom-o.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((a,l)=>{let c=this.manager.tooltipViews[l];return c.getCoords?c.getCoords(a.pos):this.view.coordsAtPos(a.pos)}),size:this.manager.tooltipViews.map(({dom:a})=>a.getBoundingClientRect()),space:this.view.state.facet(tooltipConfig).tooltipSpace(this.view),scaleX:r,scaleY:e,makeAbsolute:n}}writeMeasure(r){var e;if(r.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let c of this.manager.tooltipViews)c.dom.style.position="absolute"}let{visible:n,space:s,scaleX:o,scaleY:a}=r,l=[];for(let c=0;c<this.manager.tooltips.length;c++){let u=this.manager.tooltips[c],f=this.manager.tooltipViews[c],{dom:d}=f,p=r.pos[c],g=r.size[c];if(!p||u.clip!==!1&&(p.bottom<=Math.max(n.top,s.top)||p.top>=Math.min(n.bottom,s.bottom)||p.right<Math.max(n.left,s.left)-.1||p.left>Math.min(n.right,s.right)+.1)){d.style.top=Outside;continue}let y=u.arrow?f.dom.querySelector(".cm-tooltip-arrow"):null,x=y?7:0,E=g.right-g.left,Y=(e=knownHeight.get(f))!==null&&e!==void 0?e:g.bottom-g.top,Z=f.offset||noOffset,te=this.view.textDirection==Direction.LTR,ne=g.width>s.right-s.left?te?s.left:s.right-g.width:te?Math.max(s.left,Math.min(p.left-(y?14:0)+Z.x,s.right-E)):Math.min(Math.max(s.left,p.left-E+(y?14:0)-Z.x),s.right-E),Ve=this.above[c];!u.strictSide&&(Ve?p.top-Y-x-Z.y<s.top:p.bottom+Y+x+Z.y>s.bottom)&&Ve==s.bottom-p.bottom>p.top-s.top&&(Ve=this.above[c]=!Ve);let me=(Ve?p.top-s.top:s.bottom-p.bottom)-x;if(me<Y&&f.resize!==!1){if(me<this.view.defaultLineHeight){d.style.top=Outside;continue}knownHeight.set(f,Y),d.style.height=(Y=me)/a+"px"}else d.style.height&&(d.style.height="");let rt=Ve?p.top-Y-x-Z.y:p.bottom+x+Z.y,nt=ne+E;if(f.overlap!==!0)for(let ct of l)ct.left<nt&&ct.right>ne&&ct.top<rt+Y&&ct.bottom>rt&&(rt=Ve?ct.top-Y-2-x:ct.bottom+x+2);if(this.position=="absolute"?(d.style.top=(rt-r.parent.top)/a+"px",setLeftStyle(d,(ne-r.parent.left)/o)):(d.style.top=rt/a+"px",setLeftStyle(d,ne/o)),y){let ct=p.left+(te?Z.x:-Z.x)-(ne+14-7);y.style.left=ct/o+"px"}f.overlap!==!0&&l.push({left:ne,top:rt,right:nt,bottom:rt+Y}),d.classList.toggle("cm-tooltip-above",Ve),d.classList.toggle("cm-tooltip-below",!Ve),f.positioned&&f.positioned(r.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let r of this.manager.tooltipViews)r.dom.style.top=Outside}},{eventObservers:{scroll(){this.maybeMeasure()}}});function setLeftStyle(r,e){let n=parseInt(r.style.left,10);(isNaN(n)||Math.abs(e-n)>1)&&(r.style.left=e+"px")}const baseTheme$3=EditorView.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),noOffset={x:0,y:0},showTooltip=Facet.define({enables:[tooltipPlugin,baseTheme$3]});function getTooltip(r,e){let n=r.plugin(tooltipPlugin);if(!n)return null;let s=n.manager.tooltips.indexOf(e);return s<0?null:n.manager.tooltipViews[s]}const panelConfig=Facet.define({combine(r){let e,n;for(let s of r)e=e||s.topContainer,n=n||s.bottomContainer;return{topContainer:e,bottomContainer:n}}});function getPanel(r,e){let n=r.plugin(panelPlugin),s=n?n.specs.indexOf(e):-1;return s>-1?n.panels[s]:null}const panelPlugin=ViewPlugin.fromClass(class{constructor(r){this.input=r.state.facet(showPanel),this.specs=this.input.filter(n=>n),this.panels=this.specs.map(n=>n(r));let e=r.state.facet(panelConfig);this.top=new PanelGroup(r,!0,e.topContainer),this.bottom=new PanelGroup(r,!1,e.bottomContainer),this.top.sync(this.panels.filter(n=>n.top)),this.bottom.sync(this.panels.filter(n=>!n.top));for(let n of this.panels)n.dom.classList.add("cm-panel"),n.mount&&n.mount()}update(r){let e=r.state.facet(panelConfig);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new PanelGroup(r.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new PanelGroup(r.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let n=r.state.facet(showPanel);if(n!=this.input){let s=n.filter(u=>u),o=[],a=[],l=[],c=[];for(let u of s){let f=this.specs.indexOf(u),d;f<0?(d=u(r.view),c.push(d)):(d=this.panels[f],d.update&&d.update(r)),o.push(d),(d.top?a:l).push(d)}this.specs=s,this.panels=o,this.top.sync(a),this.bottom.sync(l);for(let u of c)u.dom.classList.add("cm-panel"),u.mount&&u.mount()}else for(let s of this.panels)s.update&&s.update(r)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:r=>EditorView.scrollMargins.of(e=>{let n=e.plugin(r);return n&&{top:n.top.scrollMargin(),bottom:n.bottom.scrollMargin()}})});class PanelGroup{constructor(e,n,s){this.view=e,this.top=n,this.container=s,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let n of this.panels)n.destroy&&e.indexOf(n)<0&&n.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let n=this.container||this.view.dom;n.insertBefore(this.dom,this.top?n.firstChild:null)}let e=this.dom.firstChild;for(let n of this.panels)if(n.dom.parentNode==this.dom){for(;e!=n.dom;)e=rm(e);e=e.nextSibling}else this.dom.insertBefore(n.dom,e);for(;e;)e=rm(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function rm(r){let e=r.nextSibling;return r.remove(),e}const showPanel=Facet.define({enables:panelPlugin});class GutterMarker extends RangeValue{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}GutterMarker.prototype.elementClass="";GutterMarker.prototype.toDOM=void 0;GutterMarker.prototype.mapMode=MapMode.TrackBefore;GutterMarker.prototype.startSide=GutterMarker.prototype.endSide=-1;GutterMarker.prototype.point=!0;const gutterLineClass=Facet.define(),gutterWidgetClass=Facet.define(),activeGutters=Facet.define(),unfixGutters=Facet.define({combine:r=>r.some(e=>e)});function gutters(r){return[gutterView]}const gutterView=ViewPlugin.fromClass(class{constructor(r){this.view=r,this.domAfter=null,this.prevViewport=r.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters cm-gutters-before",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=r.state.facet(activeGutters).map(e=>new SingleGutterView(r,e)),this.fixed=!r.state.facet(unfixGutters);for(let e of this.gutters)e.config.side=="after"?this.getDOMAfter().appendChild(e.dom):this.dom.appendChild(e.dom);this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),r.scrollDOM.insertBefore(this.dom,r.contentDOM)}getDOMAfter(){return this.domAfter||(this.domAfter=document.createElement("div"),this.domAfter.className="cm-gutters cm-gutters-after",this.domAfter.setAttribute("aria-hidden","true"),this.domAfter.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.domAfter.style.position=this.fixed?"sticky":"",this.view.scrollDOM.appendChild(this.domAfter)),this.domAfter}update(r){if(this.updateGutters(r)){let e=this.prevViewport,n=r.view.viewport,s=Math.min(e.to,n.to)-Math.max(e.from,n.from);this.syncGutters(s<(n.to-n.from)*.8)}if(r.geometryChanged){let e=this.view.contentHeight/this.view.scaleY+"px";this.dom.style.minHeight=e,this.domAfter&&(this.domAfter.style.minHeight=e)}this.view.state.facet(unfixGutters)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":"",this.domAfter&&(this.domAfter.style.position=this.fixed?"sticky":"")),this.prevViewport=r.view.viewport}syncGutters(r){let e=this.dom.nextSibling;r&&(this.dom.remove(),this.domAfter&&this.domAfter.remove());let n=RangeSet.iter(this.view.state.facet(gutterLineClass),this.view.viewport.from),s=[],o=this.gutters.map(a=>new UpdateContext(a,this.view.viewport,-this.view.documentPadding.top));for(let a of this.view.viewportLineBlocks)if(s.length&&(s=[]),Array.isArray(a.type)){let l=!0;for(let c of a.type)if(c.type==BlockType.Text&&l){advanceCursor(n,s,c.from);for(let u of o)u.line(this.view,c,s);l=!1}else if(c.widget)for(let u of o)u.widget(this.view,c)}else if(a.type==BlockType.Text){advanceCursor(n,s,a.from);for(let l of o)l.line(this.view,a,s)}else if(a.widget)for(let l of o)l.widget(this.view,a);for(let a of o)a.finish();r&&(this.view.scrollDOM.insertBefore(this.dom,e),this.domAfter&&this.view.scrollDOM.appendChild(this.domAfter))}updateGutters(r){let e=r.startState.facet(activeGutters),n=r.state.facet(activeGutters),s=r.docChanged||r.heightChanged||r.viewportChanged||!RangeSet.eq(r.startState.facet(gutterLineClass),r.state.facet(gutterLineClass),r.view.viewport.from,r.view.viewport.to);if(e==n)for(let o of this.gutters)o.update(r)&&(s=!0);else{s=!0;let o=[];for(let a of n){let l=e.indexOf(a);l<0?o.push(new SingleGutterView(this.view,a)):(this.gutters[l].update(r),o.push(this.gutters[l]))}for(let a of this.gutters)a.dom.remove(),o.indexOf(a)<0&&a.destroy();for(let a of o)a.config.side=="after"?this.getDOMAfter().appendChild(a.dom):this.dom.appendChild(a.dom);this.gutters=o}return s}destroy(){for(let r of this.gutters)r.destroy();this.dom.remove(),this.domAfter&&this.domAfter.remove()}},{provide:r=>EditorView.scrollMargins.of(e=>{let n=e.plugin(r);if(!n||n.gutters.length==0||!n.fixed)return null;let s=n.dom.offsetWidth*e.scaleX,o=n.domAfter?n.domAfter.offsetWidth*e.scaleX:0;return e.textDirection==Direction.LTR?{left:s,right:o}:{right:s,left:o}})});function asArray(r){return Array.isArray(r)?r:[r]}function advanceCursor(r,e,n){for(;r.value&&r.from<=n;)r.from==n&&e.push(r.value),r.next()}class UpdateContext{constructor(e,n,s){this.gutter=e,this.height=s,this.i=0,this.cursor=RangeSet.iter(e.markers,n.from)}addElement(e,n,s){let{gutter:o}=this,a=(n.top-this.height)/e.scaleY,l=n.height/e.scaleY;if(this.i==o.elements.length){let c=new GutterElement(e,l,a,s);o.elements.push(c),o.dom.appendChild(c.dom)}else o.elements[this.i].update(e,l,a,s);this.height=n.bottom,this.i++}line(e,n,s){let o=[];advanceCursor(this.cursor,o,n.from),s.length&&(o=o.concat(s));let a=this.gutter.config.lineMarker(e,n,o);a&&o.unshift(a);let l=this.gutter;o.length==0&&!l.config.renderEmptyElements||this.addElement(e,n,o)}widget(e,n){let s=this.gutter.config.widgetMarker(e,n.widget,n),o=s?[s]:null;for(let a of e.state.facet(gutterWidgetClass)){let l=a(e,n.widget,n);l&&(o||(o=[])).push(l)}o&&this.addElement(e,n,o)}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let n=e.elements.pop();e.dom.removeChild(n.dom),n.destroy()}}}class SingleGutterView{constructor(e,n){this.view=e,this.config=n,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let s in n.domEventHandlers)this.dom.addEventListener(s,o=>{let a=o.target,l;if(a!=this.dom&&this.dom.contains(a)){for(;a.parentNode!=this.dom;)a=a.parentNode;let u=a.getBoundingClientRect();l=(u.top+u.bottom)/2}else l=o.clientY;let c=e.lineBlockAtHeight(l-e.documentTop);n.domEventHandlers[s](e,c,o)&&o.preventDefault()});this.markers=asArray(n.markers(e)),n.initialSpacer&&(this.spacer=new GutterElement(e,0,0,[n.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let n=this.markers;if(this.markers=asArray(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let o=this.config.updateSpacer(this.spacer.markers[0],e);o!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[o])}let s=e.view.viewport;return!RangeSet.eq(this.markers,n,s.from,s.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class GutterElement{constructor(e,n,s,o){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,n,s,o)}update(e,n,s,o){this.height!=n&&(this.height=n,this.dom.style.height=n+"px"),this.above!=s&&(this.dom.style.marginTop=(this.above=s)?s+"px":""),sameMarkers(this.markers,o)||this.setMarkers(e,o)}setMarkers(e,n){let s="cm-gutterElement",o=this.dom.firstChild;for(let a=0,l=0;;){let c=l,u=a<n.length?n[a++]:null,f=!1;if(u){let d=u.elementClass;d&&(s+=" "+d);for(let p=l;p<this.markers.length;p++)if(this.markers[p].compare(u)){c=p,f=!0;break}}else c=this.markers.length;for(;l<c;){let d=this.markers[l++];if(d.toDOM){d.destroy(o);let p=o.nextSibling;o.remove(),o=p}}if(!u)break;u.toDOM&&(f?o=o.nextSibling:this.dom.insertBefore(u.toDOM(e),o)),f&&l++}this.dom.className=s,this.markers=n}destroy(){this.setMarkers(null,[])}}function sameMarkers(r,e){if(r.length!=e.length)return!1;for(let n=0;n<r.length;n++)if(!r[n].compare(e[n]))return!1;return!0}const lineNumberMarkers=Facet.define(),lineNumberWidgetMarker=Facet.define(),lineNumberConfig=Facet.define({combine(r){return combineConfig(r,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,n){let s=Object.assign({},e);for(let o in n){let a=s[o],l=n[o];s[o]=a?(c,u,f)=>a(c,u,f)||l(c,u,f):l}return s}})}});class NumberMarker extends GutterMarker{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function formatNumber(r,e){return r.state.facet(lineNumberConfig).formatNumber(e,r.state)}const lineNumberGutter=activeGutters.compute([lineNumberConfig],r=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(lineNumberMarkers)},lineMarker(e,n,s){return s.some(o=>o.toDOM)?null:new NumberMarker(formatNumber(e,e.state.doc.lineAt(n.from).number))},widgetMarker:(e,n,s)=>{for(let o of e.state.facet(lineNumberWidgetMarker)){let a=o(e,n,s);if(a)return a}return null},lineMarkerChange:e=>e.startState.facet(lineNumberConfig)!=e.state.facet(lineNumberConfig),initialSpacer(e){return new NumberMarker(formatNumber(e,maxLineNumber(e.state.doc.lines)))},updateSpacer(e,n){let s=formatNumber(n.view,maxLineNumber(n.view.state.doc.lines));return s==e.number?e:new NumberMarker(s)},domEventHandlers:r.facet(lineNumberConfig).domEventHandlers,side:"before"}));function lineNumbers(r={}){return[lineNumberConfig.of(r),gutters(),lineNumberGutter]}function maxLineNumber(r){let e=9;for(;e<r;)e=e*10+9;return e}const DefaultBufferLength=1024;let nextPropID=0;class Range{constructor(e,n){this.from=e,this.to=n}}class NodeProp{constructor(e={}){this.id=nextPropID++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=NodeType.match(e)),n=>{let s=e(n);return s===void 0?null:[this,s]}}}NodeProp.closedBy=new NodeProp({deserialize:r=>r.split(" ")});NodeProp.openedBy=new NodeProp({deserialize:r=>r.split(" ")});NodeProp.group=new NodeProp({deserialize:r=>r.split(" ")});NodeProp.isolate=new NodeProp({deserialize:r=>{if(r&&r!="rtl"&&r!="ltr"&&r!="auto")throw new RangeError("Invalid value for isolate: "+r);return r||"auto"}});NodeProp.contextHash=new NodeProp({perNode:!0});NodeProp.lookAhead=new NodeProp({perNode:!0});NodeProp.mounted=new NodeProp({perNode:!0});class MountedTree{constructor(e,n,s){this.tree=e,this.overlay=n,this.parser=s}static get(e){return e&&e.props&&e.props[NodeProp.mounted.id]}}const noProps=Object.create(null);class NodeType{constructor(e,n,s,o=0){this.name=e,this.props=n,this.id=s,this.flags=o}static define(e){let n=e.props&&e.props.length?Object.create(null):noProps,s=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),o=new NodeType(e.name||"",n,e.id,s);if(e.props){for(let a of e.props)if(Array.isArray(a)||(a=a(o)),a){if(a[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");n[a[0].id]=a[1]}}return o}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let n=this.prop(NodeProp.group);return n?n.indexOf(e)>-1:!1}return this.id==e}static match(e){let n=Object.create(null);for(let s in e)for(let o of s.split(" "))n[o]=e[s];return s=>{for(let o=s.prop(NodeProp.group),a=-1;a<(o?o.length:0);a++){let l=n[a<0?s.name:o[a]];if(l)return l}}}}NodeType.none=new NodeType("",Object.create(null),0,8);class NodeSet{constructor(e){this.types=e;for(let n=0;n<e.length;n++)if(e[n].id!=n)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let n=[];for(let s of this.types){let o=null;for(let a of e){let l=a(s);l&&(o||(o=Object.assign({},s.props)),o[l[0].id]=l[1])}n.push(o?new NodeType(s.name,o,s.id,s.flags):s)}return new NodeSet(n)}}const CachedNode=new WeakMap,CachedInnerNode=new WeakMap;var IterMode;(function(r){r[r.ExcludeBuffers=1]="ExcludeBuffers",r[r.IncludeAnonymous=2]="IncludeAnonymous",r[r.IgnoreMounts=4]="IgnoreMounts",r[r.IgnoreOverlays=8]="IgnoreOverlays"})(IterMode||(IterMode={}));class Tree{constructor(e,n,s,o,a){if(this.type=e,this.children=n,this.positions=s,this.length=o,this.props=null,a&&a.length){this.props=Object.create(null);for(let[l,c]of a)this.props[typeof l=="number"?l:l.id]=c}}toString(){let e=MountedTree.get(this);if(e&&!e.overlay)return e.tree.toString();let n="";for(let s of this.children){let o=s.toString();o&&(n&&(n+=","),n+=o)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(n.length?"("+n+")":""):n}cursor(e=0){return new TreeCursor(this.topNode,e)}cursorAt(e,n=0,s=0){let o=CachedNode.get(this)||this.topNode,a=new TreeCursor(o);return a.moveTo(e,n),CachedNode.set(this,a._tree),a}get topNode(){return new TreeNode(this,0,0,null)}resolve(e,n=0){let s=resolveNode(CachedNode.get(this)||this.topNode,e,n,!1);return CachedNode.set(this,s),s}resolveInner(e,n=0){let s=resolveNode(CachedInnerNode.get(this)||this.topNode,e,n,!0);return CachedInnerNode.set(this,s),s}resolveStack(e,n=0){return stackIterator(this,e,n)}iterate(e){let{enter:n,leave:s,from:o=0,to:a=this.length}=e,l=e.mode||0,c=(l&IterMode.IncludeAnonymous)>0;for(let u=this.cursor(l|IterMode.IncludeAnonymous);;){let f=!1;if(u.from<=a&&u.to>=o&&(!c&&u.type.isAnonymous||n(u)!==!1)){if(u.firstChild())continue;f=!0}for(;f&&s&&(c||!u.type.isAnonymous)&&s(u),!u.nextSibling();){if(!u.parent())return;f=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let n in this.props)e.push([+n,this.props[n]]);return e}balance(e={}){return this.children.length<=8?this:balanceRange(NodeType.none,this.children,this.positions,0,this.children.length,0,this.length,(n,s,o)=>new Tree(this.type,n,s,o,this.propValues),e.makeTree||((n,s,o)=>new Tree(NodeType.none,n,s,o)))}static build(e){return buildTree(e)}}Tree.empty=new Tree(NodeType.none,[],[],0);class FlatBufferCursor{constructor(e,n){this.buffer=e,this.index=n}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new FlatBufferCursor(this.buffer,this.index)}}class TreeBuffer{constructor(e,n,s){this.buffer=e,this.length=n,this.set=s}get type(){return NodeType.none}toString(){let e=[];for(let n=0;n<this.buffer.length;)e.push(this.childString(n)),n=this.buffer[n+3];return e.join(",")}childString(e){let n=this.buffer[e],s=this.buffer[e+3],o=this.set.types[n],a=o.name;if(/\W/.test(a)&&!o.isError&&(a=JSON.stringify(a)),e+=4,s==e)return a;let l=[];for(;e<s;)l.push(this.childString(e)),e=this.buffer[e+3];return a+"("+l.join(",")+")"}findChild(e,n,s,o,a){let{buffer:l}=this,c=-1;for(let u=e;u!=n&&!(checkSide(a,o,l[u+1],l[u+2])&&(c=u,s>0));u=l[u+3]);return c}slice(e,n,s){let o=this.buffer,a=new Uint16Array(n-e),l=0;for(let c=e,u=0;c<n;){a[u++]=o[c++],a[u++]=o[c++]-s;let f=a[u++]=o[c++]-s;a[u++]=o[c++]-e,l=Math.max(l,f)}return new TreeBuffer(a,l,this.set)}}function checkSide(r,e,n,s){switch(r){case-2:return n<e;case-1:return s>=e&&n<e;case 0:return n<e&&s>e;case 1:return n<=e&&s>e;case 2:return s>e;case 4:return!0}}function resolveNode(r,e,n,s){for(var o;r.from==r.to||(n<1?r.from>=e:r.from>e)||(n>-1?r.to<=e:r.to<e);){let l=!s&&r instanceof TreeNode&&r.index<0?null:r.parent;if(!l)return r;r=l}let a=s?0:IterMode.IgnoreOverlays;if(s)for(let l=r,c=l.parent;c;l=c,c=l.parent)l instanceof TreeNode&&l.index<0&&((o=c.enter(e,n,a))===null||o===void 0?void 0:o.from)!=l.from&&(r=c);for(;;){let l=r.enter(e,n,a);if(!l)return r;r=l}}class BaseNode{cursor(e=0){return new TreeCursor(this,e)}getChild(e,n=null,s=null){let o=getChildren(this,e,n,s);return o.length?o[0]:null}getChildren(e,n=null,s=null){return getChildren(this,e,n,s)}resolve(e,n=0){return resolveNode(this,e,n,!1)}resolveInner(e,n=0){return resolveNode(this,e,n,!0)}matchContext(e){return matchNodeContext(this.parent,e)}enterUnfinishedNodesBefore(e){let n=this.childBefore(e),s=this;for(;n;){let o=n.lastChild;if(!o||o.to!=n.to)break;o.type.isError&&o.from==o.to?(s=n,n=o.prevSibling):n=o}return s}get node(){return this}get next(){return this.parent}}class TreeNode extends BaseNode{constructor(e,n,s,o){super(),this._tree=e,this.from=n,this.index=s,this._parent=o}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,n,s,o,a=0){for(let l=this;;){for(let{children:c,positions:u}=l._tree,f=n>0?c.length:-1;e!=f;e+=n){let d=c[e],p=u[e]+l.from;if(checkSide(o,s,p,p+d.length)){if(d instanceof TreeBuffer){if(a&IterMode.ExcludeBuffers)continue;let g=d.findChild(0,d.buffer.length,n,s-p,o);if(g>-1)return new BufferNode(new BufferContext(l,d,e,p),null,g)}else if(a&IterMode.IncludeAnonymous||!d.type.isAnonymous||hasChild(d)){let g;if(!(a&IterMode.IgnoreMounts)&&(g=MountedTree.get(d))&&!g.overlay)return new TreeNode(g.tree,p,e,l);let y=new TreeNode(d,p,e,l);return a&IterMode.IncludeAnonymous||!y.type.isAnonymous?y:y.nextChild(n<0?d.children.length-1:0,n,s,o)}}}if(a&IterMode.IncludeAnonymous||!l.type.isAnonymous||(l.index>=0?e=l.index+n:e=n<0?-1:l._parent._tree.children.length,l=l._parent,!l))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,n,s=0){let o;if(!(s&IterMode.IgnoreOverlays)&&(o=MountedTree.get(this._tree))&&o.overlay){let a=e-this.from;for(let{from:l,to:c}of o.overlay)if((n>0?l<=a:l<a)&&(n<0?c>=a:c>a))return new TreeNode(o.tree,o.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,n,s)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function getChildren(r,e,n,s){let o=r.cursor(),a=[];if(!o.firstChild())return a;if(n!=null){for(let l=!1;!l;)if(l=o.type.is(n),!o.nextSibling())return a}for(;;){if(s!=null&&o.type.is(s))return a;if(o.type.is(e)&&a.push(o.node),!o.nextSibling())return s==null?a:[]}}function matchNodeContext(r,e,n=e.length-1){for(let s=r;n>=0;s=s.parent){if(!s)return!1;if(!s.type.isAnonymous){if(e[n]&&e[n]!=s.name)return!1;n--}}return!0}class BufferContext{constructor(e,n,s,o){this.parent=e,this.buffer=n,this.index=s,this.start=o}}class BufferNode extends BaseNode{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,n,s){super(),this.context=e,this._parent=n,this.index=s,this.type=e.buffer.set.types[e.buffer.buffer[s]]}child(e,n,s){let{buffer:o}=this.context,a=o.findChild(this.index+4,o.buffer[this.index+3],e,n-this.context.start,s);return a<0?null:new BufferNode(this.context,this,a)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,n,s=0){if(s&IterMode.ExcludeBuffers)return null;let{buffer:o}=this.context,a=o.findChild(this.index+4,o.buffer[this.index+3],n>0?1:-1,e-this.context.start,n);return a<0?null:new BufferNode(this.context,this,a)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,n=e.buffer[this.index+3];return n<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new BufferNode(this.context,this._parent,n):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,n=this._parent?this._parent.index+4:0;return this.index==n?this.externalSibling(-1):new BufferNode(this.context,this._parent,e.findChild(n,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],n=[],{buffer:s}=this.context,o=this.index+4,a=s.buffer[this.index+3];if(a>o){let l=s.buffer[this.index+1];e.push(s.slice(o,a,l)),n.push(0)}return new Tree(this.type,e,n,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function iterStack(r){if(!r.length)return null;let e=0,n=r[0];for(let a=1;a<r.length;a++){let l=r[a];(l.from>n.from||l.to<n.to)&&(n=l,e=a)}let s=n instanceof TreeNode&&n.index<0?null:n.parent,o=r.slice();return s?o[e]=s:o.splice(e,1),new StackIterator(o,n)}class StackIterator{constructor(e,n){this.heads=e,this.node=n}get next(){return iterStack(this.heads)}}function stackIterator(r,e,n){let s=r.resolveInner(e,n),o=null;for(let a=s instanceof TreeNode?s:s.context.parent;a;a=a.parent)if(a.index<0){let l=a.parent;(o||(o=[s])).push(l.resolve(e,n)),a=l}else{let l=MountedTree.get(a.tree);if(l&&l.overlay&&l.overlay[0].from<=e&&l.overlay[l.overlay.length-1].to>=e){let c=new TreeNode(l.tree,l.overlay[0].from+a.from,-1,a);(o||(o=[s])).push(resolveNode(c,e,n,!1))}}return o?iterStack(o):s}class TreeCursor{get name(){return this.type.name}constructor(e,n=0){if(this.mode=n,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof TreeNode)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let s=e._parent;s;s=s._parent)this.stack.unshift(s.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,n){this.index=e;let{start:s,buffer:o}=this.buffer;return this.type=n||o.set.types[o.buffer[e]],this.from=s+o.buffer[e+1],this.to=s+o.buffer[e+2],!0}yield(e){return e?e instanceof TreeNode?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,n,s){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,n,s,this.mode));let{buffer:o}=this.buffer,a=o.findChild(this.index+4,o.buffer[this.index+3],e,n-this.buffer.start,s);return a<0?!1:(this.stack.push(this.index),this.yieldBuf(a))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,n,s=this.mode){return this.buffer?s&IterMode.ExcludeBuffers?!1:this.enterChild(1,e,n):this.yield(this._tree.enter(e,n,s))}parent(){if(!this.buffer)return this.yieldNode(this.mode&IterMode.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&IterMode.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:n}=this.buffer,s=this.stack.length-1;if(e<0){let o=s<0?0:this.stack[s]+4;if(this.index!=o)return this.yieldBuf(n.findChild(o,this.index,-1,0,4))}else{let o=n.buffer[this.index+3];if(o<(s<0?n.buffer.length:n.buffer[this.stack[s]+3]))return this.yieldBuf(o)}return s<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let n,s,{buffer:o}=this;if(o){if(e>0){if(this.index<o.buffer.buffer.length)return!1}else for(let a=0;a<this.index;a++)if(o.buffer.buffer[a+3]<this.index)return!1;({index:n,parent:s}=o)}else({index:n,_parent:s}=this._tree);for(;s;{index:n,_parent:s}=s)if(n>-1)for(let a=n+e,l=e<0?-1:s._tree.children.length;a!=l;a+=e){let c=s._tree.children[a];if(this.mode&IterMode.IncludeAnonymous||c instanceof TreeBuffer||!c.type.isAnonymous||hasChild(c))return!1}return!0}move(e,n){if(n&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,n=0){for(;(this.from==this.to||(n<1?this.from>=e:this.from>e)||(n>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,n););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,n=null,s=0;if(e&&e.context==this.buffer)e:for(let o=this.index,a=this.stack.length;a>=0;){for(let l=e;l;l=l._parent)if(l.index==o){if(o==this.index)return l;n=l,s=a+1;break e}o=this.stack[--a]}for(let o=s;o<this.stack.length;o++)n=new BufferNode(this.buffer,n,this.stack[o]);return this.bufferNode=new BufferNode(this.buffer,n,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,n){for(let s=0;;){let o=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){s++;continue}this.type.isAnonymous||(o=!0)}for(;;){if(o&&n&&n(this),o=this.type.isAnonymous,!s)return;if(this.nextSibling())break;this.parent(),s--,o=!0}}}matchContext(e){if(!this.buffer)return matchNodeContext(this.node.parent,e);let{buffer:n}=this.buffer,{types:s}=n.set;for(let o=e.length-1,a=this.stack.length-1;o>=0;a--){if(a<0)return matchNodeContext(this._tree,e,o);let l=s[n.buffer[this.stack[a]]];if(!l.isAnonymous){if(e[o]&&e[o]!=l.name)return!1;o--}}return!0}}function hasChild(r){return r.children.some(e=>e instanceof TreeBuffer||!e.type.isAnonymous||hasChild(e))}function buildTree(r){var e;let{buffer:n,nodeSet:s,maxBufferLength:o=DefaultBufferLength,reused:a=[],minRepeatType:l=s.types.length}=r,c=Array.isArray(n)?new FlatBufferCursor(n,n.length):n,u=s.types,f=0,d=0;function p(me,rt,nt,ct,ot,ft){let{id:mt,start:Ye,end:ht,size:ee}=c,pt=d,Ot=f;for(;ee<0;)if(c.next(),ee==-1){let at=a[mt];nt.push(at),ct.push(Ye-me);return}else if(ee==-3){f=mt;return}else if(ee==-4){d=mt;return}else throw new RangeError(`Unrecognized record size: ${ee}`);let vt=u[mt],Rt,bt,Mt=Ye-me;if(ht-Ye<=o&&(bt=Y(c.pos-rt,ot))){let at=new Uint16Array(bt.size-bt.skip),lt=c.pos-bt.size,_t=at.length;for(;c.pos>lt;)_t=Z(bt.start,at,_t);Rt=new TreeBuffer(at,ht-bt.start,s),Mt=bt.start-me}else{let at=c.pos-ee;c.next();let lt=[],_t=[],At=mt>=l?mt:-1,wt=0,Nt=ht;for(;c.pos>at;)At>=0&&c.id==At&&c.size>=0?(c.end<=Nt-o&&(x(lt,_t,Ye,wt,c.end,Nt,At,pt,Ot),wt=lt.length,Nt=c.end),c.next()):ft>2500?g(Ye,at,lt,_t):p(Ye,at,lt,_t,At,ft+1);if(At>=0&&wt>0&&wt<lt.length&&x(lt,_t,Ye,wt,Ye,Nt,At,pt,Ot),lt.reverse(),_t.reverse(),At>-1&&wt>0){let Vt=y(vt,Ot);Rt=balanceRange(vt,lt,_t,0,lt.length,0,ht-Ye,Vt,Vt)}else Rt=E(vt,lt,_t,ht-Ye,pt-ht,Ot)}nt.push(Rt),ct.push(Mt)}function g(me,rt,nt,ct){let ot=[],ft=0,mt=-1;for(;c.pos>rt;){let{id:Ye,start:ht,end:ee,size:pt}=c;if(pt>4)c.next();else{if(mt>-1&&ht<mt)break;mt<0&&(mt=ee-o),ot.push(Ye,ht,ee),ft++,c.next()}}if(ft){let Ye=new Uint16Array(ft*4),ht=ot[ot.length-2];for(let ee=ot.length-3,pt=0;ee>=0;ee-=3)Ye[pt++]=ot[ee],Ye[pt++]=ot[ee+1]-ht,Ye[pt++]=ot[ee+2]-ht,Ye[pt++]=pt;nt.push(new TreeBuffer(Ye,ot[2]-ht,s)),ct.push(ht-me)}}function y(me,rt){return(nt,ct,ot)=>{let ft=0,mt=nt.length-1,Ye,ht;if(mt>=0&&(Ye=nt[mt])instanceof Tree){if(!mt&&Ye.type==me&&Ye.length==ot)return Ye;(ht=Ye.prop(NodeProp.lookAhead))&&(ft=ct[mt]+Ye.length+ht)}return E(me,nt,ct,ot,ft,rt)}}function x(me,rt,nt,ct,ot,ft,mt,Ye,ht){let ee=[],pt=[];for(;me.length>ct;)ee.push(me.pop()),pt.push(rt.pop()+nt-ot);me.push(E(s.types[mt],ee,pt,ft-ot,Ye-ft,ht)),rt.push(ot-nt)}function E(me,rt,nt,ct,ot,ft,mt){if(ft){let Ye=[NodeProp.contextHash,ft];mt=mt?[Ye].concat(mt):[Ye]}if(ot>25){let Ye=[NodeProp.lookAhead,ot];mt=mt?[Ye].concat(mt):[Ye]}return new Tree(me,rt,nt,ct,mt)}function Y(me,rt){let nt=c.fork(),ct=0,ot=0,ft=0,mt=nt.end-o,Ye={size:0,start:0,skip:0};e:for(let ht=nt.pos-me;nt.pos>ht;){let ee=nt.size;if(nt.id==rt&&ee>=0){Ye.size=ct,Ye.start=ot,Ye.skip=ft,ft+=4,ct+=4,nt.next();continue}let pt=nt.pos-ee;if(ee<0||pt<ht||nt.start<mt)break;let Ot=nt.id>=l?4:0,vt=nt.start;for(nt.next();nt.pos>pt;){if(nt.size<0)if(nt.size==-3)Ot+=4;else break e;else nt.id>=l&&(Ot+=4);nt.next()}ot=vt,ct+=ee,ft+=Ot}return(rt<0||ct==me)&&(Ye.size=ct,Ye.start=ot,Ye.skip=ft),Ye.size>4?Ye:void 0}function Z(me,rt,nt){let{id:ct,start:ot,end:ft,size:mt}=c;if(c.next(),mt>=0&&ct<l){let Ye=nt;if(mt>4){let ht=c.pos-(mt-4);for(;c.pos>ht;)nt=Z(me,rt,nt)}rt[--nt]=Ye,rt[--nt]=ft-me,rt[--nt]=ot-me,rt[--nt]=ct}else mt==-3?f=ct:mt==-4&&(d=ct);return nt}let te=[],ne=[];for(;c.pos>0;)p(r.start||0,r.bufferStart||0,te,ne,-1,0);let Ve=(e=r.length)!==null&&e!==void 0?e:te.length?ne[0]+te[0].length:0;return new Tree(u[r.topID],te.reverse(),ne.reverse(),Ve)}const nodeSizeCache=new WeakMap;function nodeSize(r,e){if(!r.isAnonymous||e instanceof TreeBuffer||e.type!=r)return 1;let n=nodeSizeCache.get(e);if(n==null){n=1;for(let s of e.children){if(s.type!=r||!(s instanceof Tree)){n=1;break}n+=nodeSize(r,s)}nodeSizeCache.set(e,n)}return n}function balanceRange(r,e,n,s,o,a,l,c,u){let f=0;for(let x=s;x<o;x++)f+=nodeSize(r,e[x]);let d=Math.ceil(f*1.5/8),p=[],g=[];function y(x,E,Y,Z,te){for(let ne=Y;ne<Z;){let Ve=ne,me=E[ne],rt=nodeSize(r,x[ne]);for(ne++;ne<Z;ne++){let nt=nodeSize(r,x[ne]);if(rt+nt>=d)break;rt+=nt}if(ne==Ve+1){if(rt>d){let nt=x[Ve];y(nt.children,nt.positions,0,nt.children.length,E[Ve]+te);continue}p.push(x[Ve])}else{let nt=E[ne-1]+x[ne-1].length-me;p.push(balanceRange(r,x,E,Ve,ne,me,nt,null,u))}g.push(me+te-a)}}return y(e,n,s,o,0),(c||u)(p,g,l)}class NodeWeakMap{constructor(){this.map=new WeakMap}setBuffer(e,n,s){let o=this.map.get(e);o||this.map.set(e,o=new Map),o.set(n,s)}getBuffer(e,n){let s=this.map.get(e);return s&&s.get(n)}set(e,n){e instanceof BufferNode?this.setBuffer(e.context.buffer,e.index,n):e instanceof TreeNode&&this.map.set(e.tree,n)}get(e){return e instanceof BufferNode?this.getBuffer(e.context.buffer,e.index):e instanceof TreeNode?this.map.get(e.tree):void 0}cursorSet(e,n){e.buffer?this.setBuffer(e.buffer.buffer,e.index,n):this.map.set(e.tree,n)}cursorGet(e){return e.buffer?this.getBuffer(e.buffer.buffer,e.index):this.map.get(e.tree)}}class TreeFragment{constructor(e,n,s,o,a=!1,l=!1){this.from=e,this.to=n,this.tree=s,this.offset=o,this.open=(a?1:0)|(l?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,n=[],s=!1){let o=[new TreeFragment(0,e.length,e,0,!1,s)];for(let a of n)a.to>e.length&&o.push(a);return o}static applyChanges(e,n,s=128){if(!n.length)return e;let o=[],a=1,l=e.length?e[0]:null;for(let c=0,u=0,f=0;;c++){let d=c<n.length?n[c]:null,p=d?d.fromA:1e9;if(p-u>=s)for(;l&&l.from<p;){let g=l;if(u>=g.from||p<=g.to||f){let y=Math.max(g.from,u)-f,x=Math.min(g.to,p)-f;g=y>=x?null:new TreeFragment(y,x,g.tree,g.offset+f,c>0,!!d)}if(g&&o.push(g),l.to>p)break;l=a<e.length?e[a++]:null}if(!d)break;u=d.toA,f=d.toA-d.toB}return o}}class Parser{startParse(e,n,s){return typeof e=="string"&&(e=new StringInput(e)),s=s?s.length?s.map(o=>new Range(o.from,o.to)):[new Range(0,0)]:[new Range(0,e.length)],this.createParse(e,n||[],s)}parse(e,n,s){let o=this.startParse(e,n,s);for(;;){let a=o.advance();if(a)return a}}}class StringInput{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,n){return this.string.slice(e,n)}}function parseMixed(r){return(e,n,s,o)=>new MixedParse(e,r,n,s,o)}class InnerParse{constructor(e,n,s,o,a){this.parser=e,this.parse=n,this.overlay=s,this.target=o,this.from=a}}function checkRanges(r){if(!r.length||r.some(e=>e.from>=e.to))throw new RangeError("Invalid inner parse ranges given: "+JSON.stringify(r))}class ActiveOverlay{constructor(e,n,s,o,a,l,c){this.parser=e,this.predicate=n,this.mounts=s,this.index=o,this.start=a,this.target=l,this.prev=c,this.depth=0,this.ranges=[]}}const stoppedInner=new NodeProp({perNode:!0});class MixedParse{constructor(e,n,s,o,a){this.nest=n,this.input=s,this.fragments=o,this.ranges=a,this.inner=[],this.innerDone=0,this.baseTree=null,this.stoppedAt=null,this.baseParse=e}advance(){if(this.baseParse){let s=this.baseParse.advance();if(!s)return null;if(this.baseParse=null,this.baseTree=s,this.startInner(),this.stoppedAt!=null)for(let o of this.inner)o.parse.stopAt(this.stoppedAt)}if(this.innerDone==this.inner.length){let s=this.baseTree;return this.stoppedAt!=null&&(s=new Tree(s.type,s.children,s.positions,s.length,s.propValues.concat([[stoppedInner,this.stoppedAt]]))),s}let e=this.inner[this.innerDone],n=e.parse.advance();if(n){this.innerDone++;let s=Object.assign(Object.create(null),e.target.props);s[NodeProp.mounted.id]=new MountedTree(n,e.overlay,e.parser),e.target.props=s}return null}get parsedPos(){if(this.baseParse)return 0;let e=this.input.length;for(let n=this.innerDone;n<this.inner.length;n++)this.inner[n].from<e&&(e=Math.min(e,this.inner[n].parse.parsedPos));return e}stopAt(e){if(this.stoppedAt=e,this.baseParse)this.baseParse.stopAt(e);else for(let n=this.innerDone;n<this.inner.length;n++)this.inner[n].parse.stopAt(e)}startInner(){let e=new FragmentCursor(this.fragments),n=null,s=null,o=new TreeCursor(new TreeNode(this.baseTree,this.ranges[0].from,0,null),IterMode.IncludeAnonymous|IterMode.IgnoreMounts);e:for(let a,l;;){let c=!0,u;if(this.stoppedAt!=null&&o.from>=this.stoppedAt)c=!1;else if(e.hasNode(o)){if(n){let f=n.mounts.find(d=>d.frag.from<=o.from&&d.frag.to>=o.to&&d.mount.overlay);if(f)for(let d of f.mount.overlay){let p=d.from+f.pos,g=d.to+f.pos;p>=o.from&&g<=o.to&&!n.ranges.some(y=>y.from<g&&y.to>p)&&n.ranges.push({from:p,to:g})}}c=!1}else if(s&&(l=checkCover(s.ranges,o.from,o.to)))c=l!=2;else if(!o.type.isAnonymous&&(a=this.nest(o,this.input))&&(o.from<o.to||!a.overlay)){o.tree||materialize(o);let f=e.findMounts(o.from,a.parser);if(typeof a.overlay=="function")n=new ActiveOverlay(a.parser,a.overlay,f,this.inner.length,o.from,o.tree,n);else{let d=punchRanges(this.ranges,a.overlay||(o.from<o.to?[new Range(o.from,o.to)]:[]));d.length&&checkRanges(d),(d.length||!a.overlay)&&this.inner.push(new InnerParse(a.parser,d.length?a.parser.startParse(this.input,enterFragments(f,d),d):a.parser.startParse(""),a.overlay?a.overlay.map(p=>new Range(p.from-o.from,p.to-o.from)):null,o.tree,d.length?d[0].from:o.from)),a.overlay?d.length&&(s={ranges:d,depth:0,prev:s}):c=!1}}else if(n&&(u=n.predicate(o))&&(u===!0&&(u=new Range(o.from,o.to)),u.from<u.to)){let f=n.ranges.length-1;f>=0&&n.ranges[f].to==u.from?n.ranges[f]={from:n.ranges[f].from,to:u.to}:n.ranges.push(u)}if(c&&o.firstChild())n&&n.depth++,s&&s.depth++;else for(;!o.nextSibling();){if(!o.parent())break e;if(n&&!--n.depth){let f=punchRanges(this.ranges,n.ranges);f.length&&(checkRanges(f),this.inner.splice(n.index,0,new InnerParse(n.parser,n.parser.startParse(this.input,enterFragments(n.mounts,f),f),n.ranges.map(d=>new Range(d.from-n.start,d.to-n.start)),n.target,f[0].from))),n=n.prev}s&&!--s.depth&&(s=s.prev)}}}}function checkCover(r,e,n){for(let s of r){if(s.from>=n)break;if(s.to>e)return s.from<=e&&s.to>=n?2:1}return 0}function sliceBuf(r,e,n,s,o,a){if(e<n){let l=r.buffer[e+1];s.push(r.slice(e,n,l)),o.push(l-a)}}function materialize(r){let{node:e}=r,n=[],s=e.context.buffer;do n.push(r.index),r.parent();while(!r.tree);let o=r.tree,a=o.children.indexOf(s),l=o.children[a],c=l.buffer,u=[a];function f(d,p,g,y,x,E){let Y=n[E],Z=[],te=[];sliceBuf(l,d,Y,Z,te,y);let ne=c[Y+1],Ve=c[Y+2];u.push(Z.length);let me=E?f(Y+4,c[Y+3],l.set.types[c[Y]],ne,Ve-ne,E-1):e.toTree();return Z.push(me),te.push(ne-y),sliceBuf(l,c[Y+3],p,Z,te,y),new Tree(g,Z,te,x)}o.children[a]=f(0,c.length,NodeType.none,0,l.length,n.length-1);for(let d of u){let p=r.tree.children[d],g=r.tree.positions[d];r.yield(new TreeNode(p,g+r.from,d,r._tree))}}class StructureCursor{constructor(e,n){this.offset=n,this.done=!1,this.cursor=e.cursor(IterMode.IncludeAnonymous|IterMode.IgnoreMounts)}moveTo(e){let{cursor:n}=this,s=e-this.offset;for(;!this.done&&n.from<s;)n.to>=e&&n.enter(s,1,IterMode.IgnoreOverlays|IterMode.ExcludeBuffers)||n.next(!1)||(this.done=!0)}hasNode(e){if(this.moveTo(e.from),!this.done&&this.cursor.from+this.offset==e.from&&this.cursor.tree)for(let n=this.cursor.tree;;){if(n==e.tree)return!0;if(n.children.length&&n.positions[0]==0&&n.children[0]instanceof Tree)n=n.children[0];else break}return!1}}class FragmentCursor{constructor(e){var n;if(this.fragments=e,this.curTo=0,this.fragI=0,e.length){let s=this.curFrag=e[0];this.curTo=(n=s.tree.prop(stoppedInner))!==null&&n!==void 0?n:s.to,this.inner=new StructureCursor(s.tree,-s.offset)}else this.curFrag=this.inner=null}hasNode(e){for(;this.curFrag&&e.from>=this.curTo;)this.nextFrag();return this.curFrag&&this.curFrag.from<=e.from&&this.curTo>=e.to&&this.inner.hasNode(e)}nextFrag(){var e;if(this.fragI++,this.fragI==this.fragments.length)this.curFrag=this.inner=null;else{let n=this.curFrag=this.fragments[this.fragI];this.curTo=(e=n.tree.prop(stoppedInner))!==null&&e!==void 0?e:n.to,this.inner=new StructureCursor(n.tree,-n.offset)}}findMounts(e,n){var s;let o=[];if(this.inner){this.inner.cursor.moveTo(e,1);for(let a=this.inner.cursor.node;a;a=a.parent){let l=(s=a.tree)===null||s===void 0?void 0:s.prop(NodeProp.mounted);if(l&&l.parser==n)for(let c=this.fragI;c<this.fragments.length;c++){let u=this.fragments[c];if(u.from>=a.to)break;u.tree==this.curFrag.tree&&o.push({frag:u,pos:a.from-u.offset,mount:l})}}}return o}}function punchRanges(r,e){let n=null,s=e;for(let o=1,a=0;o<r.length;o++){let l=r[o-1].to,c=r[o].from;for(;a<s.length;a++){let u=s[a];if(u.from>=c)break;u.to<=l||(n||(s=n=e.slice()),u.from<l?(n[a]=new Range(u.from,l),u.to>c&&n.splice(a+1,0,new Range(c,u.to))):u.to>c?n[a--]=new Range(c,u.to):n.splice(a--,1))}}return s}function findCoverChanges(r,e,n,s){let o=0,a=0,l=!1,c=!1,u=-1e9,f=[];for(;;){let d=o==r.length?1e9:l?r[o].to:r[o].from,p=a==e.length?1e9:c?e[a].to:e[a].from;if(l!=c){let g=Math.max(u,n),y=Math.min(d,p,s);g<y&&f.push(new Range(g,y))}if(u=Math.min(d,p),u==1e9)break;d==u&&(l?(l=!1,o++):l=!0),p==u&&(c?(c=!1,a++):c=!0)}return f}function enterFragments(r,e){let n=[];for(let{pos:s,mount:o,frag:a}of r){let l=s+(o.overlay?o.overlay[0].from:0),c=l+o.tree.length,u=Math.max(a.from,l),f=Math.min(a.to,c);if(o.overlay){let d=o.overlay.map(g=>new Range(g.from+s,g.to+s)),p=findCoverChanges(e,d,u,f);for(let g=0,y=u;;g++){let x=g==p.length,E=x?f:p[g].from;if(E>y&&n.push(new TreeFragment(y,E,o.tree,-l,a.from>=y||a.openStart,a.to<=E||a.openEnd)),x)break;y=p[g].to}}else n.push(new TreeFragment(u,f,o.tree,-l,a.from>=l||a.openStart,a.to<=c||a.openEnd))}return n}let nextTagID=0;class Tag{constructor(e,n,s,o){this.name=e,this.set=n,this.base=s,this.modified=o,this.id=nextTagID++}toString(){let{name:e}=this;for(let n of this.modified)n.name&&(e=`${n.name}(${e})`);return e}static define(e,n){let s=typeof e=="string"?e:"?";if(e instanceof Tag&&(n=e),n?.base)throw new Error("Can not derive from a modified tag");let o=new Tag(s,[],null,[]);if(o.set.push(o),n)for(let a of n.set)o.set.push(a);return o}static defineModifier(e){let n=new Modifier(e);return s=>s.modified.indexOf(n)>-1?s:Modifier.get(s.base||s,s.modified.concat(n).sort((o,a)=>o.id-a.id))}}let nextModifierID=0;class Modifier{constructor(e){this.name=e,this.instances=[],this.id=nextModifierID++}static get(e,n){if(!n.length)return e;let s=n[0].instances.find(c=>c.base==e&&sameArray(n,c.modified));if(s)return s;let o=[],a=new Tag(e.name,o,e,n);for(let c of n)c.instances.push(a);let l=powerSet(n);for(let c of e.set)if(!c.modified.length)for(let u of l)o.push(Modifier.get(c,u));return a}}function sameArray(r,e){return r.length==e.length&&r.every((n,s)=>n==e[s])}function powerSet(r){let e=[[]];for(let n=0;n<r.length;n++)for(let s=0,o=e.length;s<o;s++)e.push(e[s].concat(r[n]));return e.sort((n,s)=>s.length-n.length)}function styleTags(r){let e=Object.create(null);for(let n in r){let s=r[n];Array.isArray(s)||(s=[s]);for(let o of n.split(" "))if(o){let a=[],l=2,c=o;for(let p=0;;){if(c=="..."&&p>0&&p+3==o.length){l=1;break}let g=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(c);if(!g)throw new RangeError("Invalid path: "+o);if(a.push(g[0]=="*"?"":g[0][0]=='"'?JSON.parse(g[0]):g[0]),p+=g[0].length,p==o.length)break;let y=o[p++];if(p==o.length&&y=="!"){l=0;break}if(y!="/")throw new RangeError("Invalid path: "+o);c=o.slice(p)}let u=a.length-1,f=a[u];if(!f)throw new RangeError("Invalid path: "+o);let d=new Rule(s,l,u>0?a.slice(0,u):null);e[f]=d.sort(e[f])}}return ruleNodeProp.add(e)}const ruleNodeProp=new NodeProp;class Rule{constructor(e,n,s,o){this.tags=e,this.mode=n,this.context=s,this.next=o}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}Rule.empty=new Rule([],2,null);function tagHighlighter(r,e){let n=Object.create(null);for(let a of r)if(!Array.isArray(a.tag))n[a.tag.id]=a.class;else for(let l of a.tag)n[l.id]=a.class;let{scope:s,all:o=null}=e||{};return{style:a=>{let l=o;for(let c of a)for(let u of c.set){let f=n[u.id];if(f){l=l?l+" "+f:f;break}}return l},scope:s}}function highlightTags(r,e){let n=null;for(let s of r){let o=s.style(e);o&&(n=n?n+" "+o:o)}return n}function highlightTree(r,e,n,s=0,o=r.length){let a=new HighlightBuilder(s,Array.isArray(e)?e:[e],n);a.highlightRange(r.cursor(),s,o,"",a.highlighters),a.flush(o)}class HighlightBuilder{constructor(e,n,s){this.at=e,this.highlighters=n,this.span=s,this.class=""}startSpan(e,n){n!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=n)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,n,s,o,a){let{type:l,from:c,to:u}=e;if(c>=s||u<=n)return;l.isTop&&(a=this.highlighters.filter(y=>!y.scope||y.scope(l)));let f=o,d=getStyleTags(e)||Rule.empty,p=highlightTags(a,d.tags);if(p&&(f&&(f+=" "),f+=p,d.mode==1&&(o+=(o?" ":"")+p)),this.startSpan(Math.max(n,c),f),d.opaque)return;let g=e.tree&&e.tree.prop(NodeProp.mounted);if(g&&g.overlay){let y=e.node.enter(g.overlay[0].from+c,1),x=this.highlighters.filter(Y=>!Y.scope||Y.scope(g.tree.type)),E=e.firstChild();for(let Y=0,Z=c;;Y++){let te=Y<g.overlay.length?g.overlay[Y]:null,ne=te?te.from+c:u,Ve=Math.max(n,Z),me=Math.min(s,ne);if(Ve<me&&E)for(;e.from<me&&(this.highlightRange(e,Ve,me,o,a),this.startSpan(Math.min(me,e.to),f),!(e.to>=ne||!e.nextSibling())););if(!te||ne>s)break;Z=te.to+c,Z>n&&(this.highlightRange(y.cursor(),Math.max(n,te.from+c),Math.min(s,Z),"",x),this.startSpan(Math.min(s,Z),f))}E&&e.parent()}else if(e.firstChild()){g&&(o="");do if(!(e.to<=n)){if(e.from>=s)break;this.highlightRange(e,n,s,o,a),this.startSpan(Math.min(s,e.to),f)}while(e.nextSibling());e.parent()}}}function getStyleTags(r){let e=r.type.prop(ruleNodeProp);for(;e&&e.context&&!r.matchContext(e.context);)e=e.next;return e||null}const t=Tag.define,comment=t(),name=t(),typeName=t(name),propertyName=t(name),literal=t(),string$2=t(literal),number$2=t(literal),content=t(),heading=t(content),keyword=t(),operator=t(),punctuation=t(),bracket=t(punctuation),meta=t(),tags={comment,lineComment:t(comment),blockComment:t(comment),docComment:t(comment),name,variableName:t(name),typeName,tagName:t(typeName),propertyName,attributeName:t(propertyName),className:t(name),labelName:t(name),namespace:t(name),macroName:t(name),literal,string:string$2,docString:t(string$2),character:t(string$2),attributeValue:t(string$2),number:number$2,integer:t(number$2),float:t(number$2),bool:t(literal),regexp:t(literal),escape:t(literal),color:t(literal),url:t(literal),keyword,self:t(keyword),null:t(keyword),atom:t(keyword),unit:t(keyword),modifier:t(keyword),operatorKeyword:t(keyword),controlKeyword:t(keyword),definitionKeyword:t(keyword),moduleKeyword:t(keyword),operator,derefOperator:t(operator),arithmeticOperator:t(operator),logicOperator:t(operator),bitwiseOperator:t(operator),compareOperator:t(operator),updateOperator:t(operator),definitionOperator:t(operator),typeOperator:t(operator),controlOperator:t(operator),punctuation,separator:t(punctuation),bracket,angleBracket:t(bracket),squareBracket:t(bracket),paren:t(bracket),brace:t(bracket),content,heading,heading1:t(heading),heading2:t(heading),heading3:t(heading),heading4:t(heading),heading5:t(heading),heading6:t(heading),contentSeparator:t(content),list:t(content),quote:t(content),emphasis:t(content),strong:t(content),link:t(content),monospace:t(content),strikethrough:t(content),inserted:t(),deleted:t(),changed:t(),invalid:t(),meta,documentMeta:t(meta),annotation:t(meta),processingInstruction:t(meta),definition:Tag.defineModifier("definition"),constant:Tag.defineModifier("constant"),function:Tag.defineModifier("function"),standard:Tag.defineModifier("standard"),local:Tag.defineModifier("local"),special:Tag.defineModifier("special")};for(let r in tags){let e=tags[r];e instanceof Tag&&(e.name=r)}tagHighlighter([{tag:tags.link,class:"tok-link"},{tag:tags.heading,class:"tok-heading"},{tag:tags.emphasis,class:"tok-emphasis"},{tag:tags.strong,class:"tok-strong"},{tag:tags.keyword,class:"tok-keyword"},{tag:tags.atom,class:"tok-atom"},{tag:tags.bool,class:"tok-bool"},{tag:tags.url,class:"tok-url"},{tag:tags.labelName,class:"tok-labelName"},{tag:tags.inserted,class:"tok-inserted"},{tag:tags.deleted,class:"tok-deleted"},{tag:tags.literal,class:"tok-literal"},{tag:tags.string,class:"tok-string"},{tag:tags.number,class:"tok-number"},{tag:[tags.regexp,tags.escape,tags.special(tags.string)],class:"tok-string2"},{tag:tags.variableName,class:"tok-variableName"},{tag:tags.local(tags.variableName),class:"tok-variableName tok-local"},{tag:tags.definition(tags.variableName),class:"tok-variableName tok-definition"},{tag:tags.special(tags.variableName),class:"tok-variableName2"},{tag:tags.definition(tags.propertyName),class:"tok-propertyName tok-definition"},{tag:tags.typeName,class:"tok-typeName"},{tag:tags.namespace,class:"tok-namespace"},{tag:tags.className,class:"tok-className"},{tag:tags.macroName,class:"tok-macroName"},{tag:tags.propertyName,class:"tok-propertyName"},{tag:tags.operator,class:"tok-operator"},{tag:tags.comment,class:"tok-comment"},{tag:tags.meta,class:"tok-meta"},{tag:tags.invalid,class:"tok-invalid"},{tag:tags.punctuation,class:"tok-punctuation"}]);var _a;const languageDataProp=new NodeProp;function defineLanguageFacet(r){return Facet.define({combine:r?e=>e.concat(r):void 0})}const sublanguageProp=new NodeProp;class Language{constructor(e,n,s=[],o=""){this.data=e,this.name=o,EditorState.prototype.hasOwnProperty("tree")||Object.defineProperty(EditorState.prototype,"tree",{get(){return syntaxTree(this)}}),this.parser=n,this.extension=[language.of(this),EditorState.languageData.of((a,l,c)=>{let u=topNodeAt(a,l,c),f=u.type.prop(languageDataProp);if(!f)return[];let d=a.facet(f),p=u.type.prop(sublanguageProp);if(p){let g=u.resolve(l-u.from,c);for(let y of p)if(y.test(g,a)){let x=a.facet(y.facet);return y.type=="replace"?x:x.concat(d)}}return d})].concat(s)}isActiveAt(e,n,s=-1){return topNodeAt(e,n,s).type.prop(languageDataProp)==this.data}findRegions(e){let n=e.facet(language);if(n?.data==this.data)return[{from:0,to:e.doc.length}];if(!n||!n.allowsNesting)return[];let s=[],o=(a,l)=>{if(a.prop(languageDataProp)==this.data){s.push({from:l,to:l+a.length});return}let c=a.prop(NodeProp.mounted);if(c){if(c.tree.prop(languageDataProp)==this.data){if(c.overlay)for(let u of c.overlay)s.push({from:u.from+l,to:u.to+l});else s.push({from:l,to:l+a.length});return}else if(c.overlay){let u=s.length;if(o(c.tree,c.overlay[0].from+l),s.length>u)return}}for(let u=0;u<a.children.length;u++){let f=a.children[u];f instanceof Tree&&o(f,a.positions[u]+l)}};return o(syntaxTree(e),0),s}get allowsNesting(){return!0}}Language.setState=StateEffect.define();function topNodeAt(r,e,n){let s=r.facet(language),o=syntaxTree(r).topNode;if(!s||s.allowsNesting)for(let a=o;a;a=a.enter(e,n,IterMode.ExcludeBuffers))a.type.isTop&&(o=a);return o}class LRLanguage extends Language{constructor(e,n,s){super(e,n,[],s),this.parser=n}static define(e){let n=defineLanguageFacet(e.languageData);return new LRLanguage(n,e.parser.configure({props:[languageDataProp.add(s=>s.isTop?n:void 0)]}),e.name)}configure(e,n){return new LRLanguage(this.data,this.parser.configure(e),n||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function syntaxTree(r){let e=r.field(Language.state,!1);return e?e.tree:Tree.empty}class DocInput{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,n){let s=this.cursorPos-this.string.length;return e<s||n>=this.cursorPos?this.doc.sliceString(e,n):this.string.slice(e-s,n-s)}}let currentContext=null;class ParseContext{constructor(e,n,s=[],o,a,l,c,u){this.parser=e,this.state=n,this.fragments=s,this.tree=o,this.treeLen=a,this.viewport=l,this.skipped=c,this.scheduleOn=u,this.parse=null,this.tempSkipped=[]}static create(e,n,s){return new ParseContext(e,n,[],Tree.empty,0,s,[],null)}startParse(){return this.parser.startParse(new DocInput(this.state.doc),this.fragments)}work(e,n){return n!=null&&n>=this.state.doc.length&&(n=void 0),this.tree!=Tree.empty&&this.isDone(n??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var s;if(typeof e=="number"){let o=Date.now()+e;e=()=>Date.now()>o}for(this.parse||(this.parse=this.startParse()),n!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>n)&&n<this.state.doc.length&&this.parse.stopAt(n);;){let o=this.parse.advance();if(o)if(this.fragments=this.withoutTempSkipped(TreeFragment.addTree(o,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(s=this.parse.stoppedAt)!==null&&s!==void 0?s:this.state.doc.length,this.tree=o,this.parse=null,this.treeLen<(n??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,n;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(n=this.parse.advance()););}),this.treeLen=e,this.tree=n,this.fragments=this.withoutTempSkipped(TreeFragment.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let n=currentContext;currentContext=this;try{return e()}finally{currentContext=n}}withoutTempSkipped(e){for(let n;n=this.tempSkipped.pop();)e=cutFragments(e,n.from,n.to);return e}changes(e,n){let{fragments:s,tree:o,treeLen:a,viewport:l,skipped:c}=this;if(this.takeTree(),!e.empty){let u=[];if(e.iterChangedRanges((f,d,p,g)=>u.push({fromA:f,toA:d,fromB:p,toB:g})),s=TreeFragment.applyChanges(s,u),o=Tree.empty,a=0,l={from:e.mapPos(l.from,-1),to:e.mapPos(l.to,1)},this.skipped.length){c=[];for(let f of this.skipped){let d=e.mapPos(f.from,1),p=e.mapPos(f.to,-1);d<p&&c.push({from:d,to:p})}}}return new ParseContext(this.parser,n,s,o,a,l,c,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let n=this.skipped.length;for(let s=0;s<this.skipped.length;s++){let{from:o,to:a}=this.skipped[s];o<e.to&&a>e.from&&(this.fragments=cutFragments(this.fragments,o,a),this.skipped.splice(s--,1))}return this.skipped.length>=n?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,n){this.skipped.push({from:e,to:n})}static getSkippingParser(e){return new class extends Parser{createParse(n,s,o){let a=o[0].from,l=o[o.length-1].to;return{parsedPos:a,advance(){let u=currentContext;if(u){for(let f of o)u.tempSkipped.push(f);e&&(u.scheduleOn=u.scheduleOn?Promise.all([u.scheduleOn,e]):e)}return this.parsedPos=l,new Tree(NodeType.none,[],[],l-a)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let n=this.fragments;return this.treeLen>=e&&n.length&&n[0].from==0&&n[0].to>=e}static get(){return currentContext}}function cutFragments(r,e,n){return TreeFragment.applyChanges(r,[{fromA:e,toA:n,fromB:e,toB:n}])}class LanguageState{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let n=this.context.changes(e.changes,e.state),s=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),n.viewport.to);return n.work(20,s)||n.takeTree(),new LanguageState(n)}static init(e){let n=Math.min(3e3,e.doc.length),s=ParseContext.create(e.facet(language).parser,e,{from:0,to:n});return s.work(20,n)||s.takeTree(),new LanguageState(s)}}Language.state=StateField.define({create:LanguageState.init,update(r,e){for(let n of e.effects)if(n.is(Language.setState))return n.value;return e.startState.facet(language)!=e.state.facet(language)?LanguageState.init(e.state):r.apply(e)}});let requestIdle=r=>{let e=setTimeout(()=>r(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(requestIdle=r=>{let e=-1,n=setTimeout(()=>{e=requestIdleCallback(r,{timeout:400})},100);return()=>e<0?clearTimeout(n):cancelIdleCallback(e)});const isInputPending=typeof navigator<"u"&&(!((_a=navigator.scheduling)===null||_a===void 0)&&_a.isInputPending)?()=>navigator.scheduling.isInputPending():null,parseWorker=ViewPlugin.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let n=this.view.state.field(Language.state).context;(n.updateViewport(e.view.viewport)||this.view.viewport.to>n.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(n)}scheduleWork(){if(this.working)return;let{state:e}=this.view,n=e.field(Language.state);(n.tree!=n.context.tree||!n.context.isDone(e.doc.length))&&(this.working=requestIdle(this.work))}work(e){this.working=null;let n=Date.now();if(this.chunkEnd<n&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=n+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:s,viewport:{to:o}}=this.view,a=s.field(Language.state);if(a.tree==a.context.tree&&a.context.isDone(o+1e5))return;let l=Date.now()+Math.min(this.chunkBudget,100,e&&!isInputPending?Math.max(25,e.timeRemaining()-5):1e9),c=a.context.treeLen<o&&s.doc.length>o+1e3,u=a.context.work(()=>isInputPending&&isInputPending()||Date.now()>l,o+(c?0:1e5));this.chunkBudget-=Date.now()-n,(u||this.chunkBudget<=0)&&(a.context.takeTree(),this.view.dispatch({effects:Language.setState.of(new LanguageState(a.context))})),this.chunkBudget>0&&!(u&&!c)&&this.scheduleWork(),this.checkAsyncSchedule(a.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(n=>logException(this.view.state,n)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),language=Facet.define({combine(r){return r.length?r[0]:null},enables:r=>[Language.state,parseWorker,EditorView.contentAttributes.compute([r],e=>{let n=e.facet(r);return n&&n.name?{"data-language":n.name}:{}})]});class LanguageSupport{constructor(e,n=[]){this.language=e,this.support=n,this.extension=[e,n]}}class LanguageDescription{constructor(e,n,s,o,a,l=void 0){this.name=e,this.alias=n,this.extensions=s,this.filename=o,this.loadFunc=a,this.support=l,this.loading=null}load(){return this.loading||(this.loading=this.loadFunc().then(e=>this.support=e,e=>{throw this.loading=null,e}))}static of(e){let{load:n,support:s}=e;if(!n){if(!s)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");n=()=>Promise.resolve(s)}return new LanguageDescription(e.name,(e.alias||[]).concat(e.name).map(o=>o.toLowerCase()),e.extensions||[],e.filename,n,s)}static matchFilename(e,n){for(let o of e)if(o.filename&&o.filename.test(n))return o;let s=/\.([^.]+)$/.exec(n);if(s){for(let o of e)if(o.extensions.indexOf(s[1])>-1)return o}return null}static matchLanguageName(e,n,s=!0){n=n.toLowerCase();for(let o of e)if(o.alias.some(a=>a==n))return o;if(s)for(let o of e)for(let a of o.alias){let l=n.indexOf(a);if(l>-1&&(a.length>2||!/\w/.test(n[l-1])&&!/\w/.test(n[l+a.length])))return o}return null}}const indentService=Facet.define(),indentUnit=Facet.define({combine:r=>{if(!r.length)return"  ";let e=r[0];if(!e||/\S/.test(e)||Array.from(e).some(n=>n!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(r[0]));return e}});function getIndentUnit(r){let e=r.facet(indentUnit);return e.charCodeAt(0)==9?r.tabSize*e.length:e.length}function indentString(r,e){let n="",s=r.tabSize,o=r.facet(indentUnit)[0];if(o=="	"){for(;e>=s;)n+="	",e-=s;o=" "}for(let a=0;a<e;a++)n+=o;return n}function getIndentation(r,e){r instanceof EditorState&&(r=new IndentContext(r));for(let s of r.state.facet(indentService)){let o=s(r,e);if(o!==void 0)return o}let n=syntaxTree(r.state);return n.length>=e?syntaxIndentation(r,n,e):null}class IndentContext{constructor(e,n={}){this.state=e,this.options=n,this.unit=getIndentUnit(e)}lineAt(e,n=1){let s=this.state.doc.lineAt(e),{simulateBreak:o,simulateDoubleBreak:a}=this.options;return o!=null&&o>=s.from&&o<=s.to?a&&o==e?{text:"",from:e}:(n<0?o<e:o<=e)?{text:s.text.slice(o-s.from),from:o}:{text:s.text.slice(0,o-s.from),from:s.from}:s}textAfterPos(e,n=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:s,from:o}=this.lineAt(e,n);return s.slice(e-o,Math.min(s.length,e+100-o))}column(e,n=1){let{text:s,from:o}=this.lineAt(e,n),a=this.countColumn(s,e-o),l=this.options.overrideIndentation?this.options.overrideIndentation(o):-1;return l>-1&&(a+=l-this.countColumn(s,s.search(/\S|$/))),a}countColumn(e,n=e.length){return countColumn(e,this.state.tabSize,n)}lineIndent(e,n=1){let{text:s,from:o}=this.lineAt(e,n),a=this.options.overrideIndentation;if(a){let l=a(o);if(l>-1)return l}return this.countColumn(s,s.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const indentNodeProp=new NodeProp;function syntaxIndentation(r,e,n){let s=e.resolveStack(n),o=e.resolveInner(n,-1).resolve(n,0).enterUnfinishedNodesBefore(n);if(o!=s.node){let a=[];for(let l=o;l&&!(l.from<s.node.from||l.to>s.node.to||l.from==s.node.from&&l.type==s.node.type);l=l.parent)a.push(l);for(let l=a.length-1;l>=0;l--)s={node:a[l],next:s}}return indentFor(s,r,n)}function indentFor(r,e,n){for(let s=r;s;s=s.next){let o=indentStrategy(s.node);if(o)return o(TreeIndentContext.create(e,n,s))}return 0}function ignoreClosed(r){return r.pos==r.options.simulateBreak&&r.options.simulateDoubleBreak}function indentStrategy(r){let e=r.type.prop(indentNodeProp);if(e)return e;let n=r.firstChild,s;if(n&&(s=n.type.prop(NodeProp.closedBy))){let o=r.lastChild,a=o&&s.indexOf(o.name)>-1;return l=>delimitedStrategy(l,!0,1,void 0,a&&!ignoreClosed(l)?o.from:void 0)}return r.parent==null?topIndent:null}function topIndent(){return 0}class TreeIndentContext extends IndentContext{constructor(e,n,s){super(e.state,e.options),this.base=e,this.pos=n,this.context=s}get node(){return this.context.node}static create(e,n,s){return new TreeIndentContext(e,n,s)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let n=this.state.doc.lineAt(e.from);for(;;){let s=e.resolve(n.from);for(;s.parent&&s.parent.from==s.from;)s=s.parent;if(isParent(s,e))break;n=this.state.doc.lineAt(s.from)}return this.lineIndent(n.from)}continue(){return indentFor(this.context.next,this.base,this.pos)}}function isParent(r,e){for(let n=e;n;n=n.parent)if(r==n)return!0;return!1}function bracketedAligned(r){let e=r.node,n=e.childAfter(e.from),s=e.lastChild;if(!n)return null;let o=r.options.simulateBreak,a=r.state.doc.lineAt(n.from),l=o==null||o<=a.from?a.to:Math.min(a.to,o);for(let c=n.to;;){let u=e.childAfter(c);if(!u||u==s)return null;if(!u.type.isSkipped){if(u.from>=l)return null;let f=/^ */.exec(a.text.slice(n.to-a.from))[0].length;return{from:n.from,to:n.to+f}}c=u.to}}function delimitedIndent({closing:r,align:e=!0,units:n=1}){return s=>delimitedStrategy(s,e,n,r)}function delimitedStrategy(r,e,n,s,o){let a=r.textAfter,l=a.match(/^\s*/)[0].length,c=s&&a.slice(l,l+s.length)==s||o==r.pos+l,u=e?bracketedAligned(r):null;return u?c?r.column(u.from):r.column(u.to):r.baseIndent+(c?0:r.unit*n)}const flatIndent=r=>r.baseIndent;function continuedIndent({except:r,units:e=1}={}){return n=>{let s=r&&r.test(n.textAfter);return n.baseIndent+(s?0:e*n.unit)}}const foldService=Facet.define(),foldNodeProp=new NodeProp;function foldInside(r){let e=r.firstChild,n=r.lastChild;return e&&e.to<n.from?{from:e.to,to:n.type.isError?r.to:n.from}:null}function syntaxFolding(r,e,n){let s=syntaxTree(r);if(s.length<n)return null;let o=s.resolveStack(n,1),a=null;for(let l=o;l;l=l.next){let c=l.node;if(c.to<=n||c.from>n)continue;if(a&&c.from<e)break;let u=c.type.prop(foldNodeProp);if(u&&(c.to<s.length-50||s.length==r.doc.length||!isUnfinished(c))){let f=u(c,r);f&&f.from<=n&&f.from>=e&&f.to>n&&(a=f)}}return a}function isUnfinished(r){let e=r.lastChild;return e&&e.to==r.to&&e.type.isError}function foldable(r,e,n){for(let s of r.facet(foldService)){let o=s(r,e,n);if(o)return o}return syntaxFolding(r,e,n)}function mapRange(r,e){let n=e.mapPos(r.from,1),s=e.mapPos(r.to,-1);return n>=s?void 0:{from:n,to:s}}const foldEffect=StateEffect.define({map:mapRange}),unfoldEffect=StateEffect.define({map:mapRange});function selectedLines(r){let e=[];for(let{head:n}of r.state.selection.ranges)e.some(s=>s.from<=n&&s.to>=n)||e.push(r.lineBlockAt(n));return e}const foldState=StateField.define({create(){return Decoration.none},update(r,e){e.isUserEvent("delete")&&e.changes.iterChangedRanges((n,s)=>r=clearTouchedFolds(r,n,s)),r=r.map(e.changes);for(let n of e.effects)if(n.is(foldEffect)&&!foldExists(r,n.value.from,n.value.to)){let{preparePlaceholder:s}=e.state.facet(foldConfig),o=s?Decoration.replace({widget:new PreparedFoldWidget(s(e.state,n.value))}):foldWidget;r=r.update({add:[o.range(n.value.from,n.value.to)]})}else n.is(unfoldEffect)&&(r=r.update({filter:(s,o)=>n.value.from!=s||n.value.to!=o,filterFrom:n.value.from,filterTo:n.value.to}));return e.selection&&(r=clearTouchedFolds(r,e.selection.main.head)),r},provide:r=>EditorView.decorations.from(r),toJSON(r,e){let n=[];return r.between(0,e.doc.length,(s,o)=>{n.push(s,o)}),n},fromJSON(r){if(!Array.isArray(r)||r.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let n=0;n<r.length;){let s=r[n++],o=r[n++];if(typeof s!="number"||typeof o!="number")throw new RangeError("Invalid JSON for fold state");e.push(foldWidget.range(s,o))}return Decoration.set(e,!0)}});function clearTouchedFolds(r,e,n=e){let s=!1;return r.between(e,n,(o,a)=>{o<n&&a>e&&(s=!0)}),s?r.update({filterFrom:e,filterTo:n,filter:(o,a)=>o>=n||a<=e}):r}function findFold(r,e,n){var s;let o=null;return(s=r.field(foldState,!1))===null||s===void 0||s.between(e,n,(a,l)=>{(!o||o.from>a)&&(o={from:a,to:l})}),o}function foldExists(r,e,n){let s=!1;return r.between(e,e,(o,a)=>{o==e&&a==n&&(s=!0)}),s}function maybeEnable(r,e){return r.field(foldState,!1)?e:e.concat(StateEffect.appendConfig.of(codeFolding()))}const foldCode=r=>{for(let e of selectedLines(r)){let n=foldable(r.state,e.from,e.to);if(n)return r.dispatch({effects:maybeEnable(r.state,[foldEffect.of(n),announceFold(r,n)])}),!0}return!1},unfoldCode=r=>{if(!r.state.field(foldState,!1))return!1;let e=[];for(let n of selectedLines(r)){let s=findFold(r.state,n.from,n.to);s&&e.push(unfoldEffect.of(s),announceFold(r,s,!1))}return e.length&&r.dispatch({effects:e}),e.length>0};function announceFold(r,e,n=!0){let s=r.state.doc.lineAt(e.from).number,o=r.state.doc.lineAt(e.to).number;return EditorView.announce.of(`${r.state.phrase(n?"Folded lines":"Unfolded lines")} ${s} ${r.state.phrase("to")} ${o}.`)}const foldAll=r=>{let{state:e}=r,n=[];for(let s=0;s<e.doc.length;){let o=r.lineBlockAt(s),a=foldable(e,o.from,o.to);a&&n.push(foldEffect.of(a)),s=(a?r.lineBlockAt(a.to):o).to+1}return n.length&&r.dispatch({effects:maybeEnable(r.state,n)}),!!n.length},unfoldAll=r=>{let e=r.state.field(foldState,!1);if(!e||!e.size)return!1;let n=[];return e.between(0,r.state.doc.length,(s,o)=>{n.push(unfoldEffect.of({from:s,to:o}))}),r.dispatch({effects:n}),!0},foldKeymap=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:foldCode},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:unfoldCode},{key:"Ctrl-Alt-[",run:foldAll},{key:"Ctrl-Alt-]",run:unfoldAll}],defaultConfig={placeholderDOM:null,preparePlaceholder:null,placeholderText:""},foldConfig=Facet.define({combine(r){return combineConfig(r,defaultConfig)}});function codeFolding(r){return[foldState,baseTheme$1$1]}function widgetToDOM(r,e){let{state:n}=r,s=n.facet(foldConfig),o=l=>{let c=r.lineBlockAt(r.posAtDOM(l.target)),u=findFold(r.state,c.from,c.to);u&&r.dispatch({effects:unfoldEffect.of(u)}),l.preventDefault()};if(s.placeholderDOM)return s.placeholderDOM(r,o,e);let a=document.createElement("span");return a.textContent=s.placeholderText,a.setAttribute("aria-label",n.phrase("folded code")),a.title=n.phrase("unfold"),a.className="cm-foldPlaceholder",a.onclick=o,a}const foldWidget=Decoration.replace({widget:new class extends WidgetType{toDOM(r){return widgetToDOM(r,null)}}});class PreparedFoldWidget extends WidgetType{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return widgetToDOM(e,this.value)}}const baseTheme$1$1=EditorView.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class HighlightStyle{constructor(e,n){this.specs=e;let s;function o(c){let u=StyleModule.newName();return(s||(s=Object.create(null)))["."+u]=c,u}const a=typeof n.all=="string"?n.all:n.all?o(n.all):void 0,l=n.scope;this.scope=l instanceof Language?c=>c.prop(languageDataProp)==l.data:l?c=>c==l:void 0,this.style=tagHighlighter(e.map(c=>({tag:c.tag,class:c.class||o(Object.assign({},c,{tag:null}))})),{all:a}).style,this.module=s?new StyleModule(s):null,this.themeType=n.themeType}static define(e,n){return new HighlightStyle(e,n||{})}}const highlighterFacet=Facet.define(),fallbackHighlighter=Facet.define({combine(r){return r.length?[r[0]]:null}});function getHighlighters(r){let e=r.facet(highlighterFacet);return e.length?e:r.facet(fallbackHighlighter)}function syntaxHighlighting(r,e){let n=[treeHighlighter],s;return r instanceof HighlightStyle&&(r.module&&n.push(EditorView.styleModule.of(r.module)),s=r.themeType),s?n.push(highlighterFacet.computeN([EditorView.darkTheme],o=>o.facet(EditorView.darkTheme)==(s=="dark")?[r]:[])):n.push(highlighterFacet.of(r)),n}class TreeHighlighter{constructor(e){this.markCache=Object.create(null),this.tree=syntaxTree(e.state),this.decorations=this.buildDeco(e,getHighlighters(e.state)),this.decoratedTo=e.viewport.to}update(e){let n=syntaxTree(e.state),s=getHighlighters(e.state),o=s!=getHighlighters(e.startState),{viewport:a}=e.view,l=e.changes.mapPos(this.decoratedTo,1);n.length<a.to&&!o&&n.type==this.tree.type&&l>=a.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=l):(n!=this.tree||e.viewportChanged||o)&&(this.tree=n,this.decorations=this.buildDeco(e.view,s),this.decoratedTo=a.to)}buildDeco(e,n){if(!n||!this.tree.length)return Decoration.none;let s=new RangeSetBuilder;for(let{from:o,to:a}of e.visibleRanges)highlightTree(this.tree,n,(l,c,u)=>{s.add(l,c,this.markCache[u]||(this.markCache[u]=Decoration.mark({class:u})))},o,a);return s.finish()}}const treeHighlighter=Prec.high(ViewPlugin.fromClass(TreeHighlighter,{decorations:r=>r.decorations})),DefaultScanDist=1e4,DefaultBrackets="()[]{}",bracketMatchingHandle=new NodeProp;function matchingNodes(r,e,n){let s=r.prop(e<0?NodeProp.openedBy:NodeProp.closedBy);if(s)return s;if(r.name.length==1){let o=n.indexOf(r.name);if(o>-1&&o%2==(e<0?1:0))return[n[o+e]]}return null}function findHandle(r){let e=r.type.prop(bracketMatchingHandle);return e?e(r.node):r}function matchBrackets(r,e,n,s={}){let o=s.maxScanDistance||DefaultScanDist,a=s.brackets||DefaultBrackets,l=syntaxTree(r),c=l.resolveInner(e,n);for(let u=c;u;u=u.parent){let f=matchingNodes(u.type,n,a);if(f&&u.from<u.to){let d=findHandle(u);if(d&&(n>0?e>=d.from&&e<d.to:e>d.from&&e<=d.to))return matchMarkedBrackets(r,e,n,u,d,f,a)}}return matchPlainBrackets(r,e,n,l,c.type,o,a)}function matchMarkedBrackets(r,e,n,s,o,a,l){let c=s.parent,u={from:o.from,to:o.to},f=0,d=c?.cursor();if(d&&(n<0?d.childBefore(s.from):d.childAfter(s.to)))do if(n<0?d.to<=s.from:d.from>=s.to){if(f==0&&a.indexOf(d.type.name)>-1&&d.from<d.to){let p=findHandle(d);return{start:u,end:p?{from:p.from,to:p.to}:void 0,matched:!0}}else if(matchingNodes(d.type,n,l))f++;else if(matchingNodes(d.type,-n,l)){if(f==0){let p=findHandle(d);return{start:u,end:p&&p.from<p.to?{from:p.from,to:p.to}:void 0,matched:!1}}f--}}while(n<0?d.prevSibling():d.nextSibling());return{start:u,matched:!1}}function matchPlainBrackets(r,e,n,s,o,a,l){let c=n<0?r.sliceDoc(e-1,e):r.sliceDoc(e,e+1),u=l.indexOf(c);if(u<0||u%2==0!=n>0)return null;let f={from:n<0?e-1:e,to:n>0?e+1:e},d=r.doc.iterRange(e,n>0?r.doc.length:0),p=0;for(let g=0;!d.next().done&&g<=a;){let y=d.value;n<0&&(g+=y.length);let x=e+g*n;for(let E=n>0?0:y.length-1,Y=n>0?y.length:-1;E!=Y;E+=n){let Z=l.indexOf(y[E]);if(!(Z<0||s.resolveInner(x+E,1).type!=o))if(Z%2==0==n>0)p++;else{if(p==1)return{start:f,end:{from:x+E,to:x+E+1},matched:Z>>1==u>>1};p--}}n>0&&(g+=y.length)}return d.done?{start:f,matched:!1}:null}function countCol(r,e,n,s=0,o=0){e==null&&(e=r.search(/[^\s\u00a0]/),e==-1&&(e=r.length));let a=o;for(let l=s;l<e;l++)r.charCodeAt(l)==9?a+=n-a%n:a++;return a}class StringStream{constructor(e,n,s,o){this.string=e,this.tabSize=n,this.indentUnit=s,this.overrideIndent=o,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(e){let n=this.string.charAt(this.pos),s;if(typeof e=="string"?s=n==e:s=n&&(e instanceof RegExp?e.test(n):e(n)),s)return++this.pos,n}eatWhile(e){let n=this.pos;for(;this.eat(e););return this.pos>n}eatSpace(){let e=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e}skipToEnd(){this.pos=this.string.length}skipTo(e){let n=this.string.indexOf(e,this.pos);if(n>-1)return this.pos=n,!0}backUp(e){this.pos-=e}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=countCol(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var e;return(e=this.overrideIndent)!==null&&e!==void 0?e:countCol(this.string,null,this.tabSize)}match(e,n,s){if(typeof e=="string"){let o=l=>s?l.toLowerCase():l,a=this.string.substr(this.pos,e.length);return o(a)==o(e)?(n!==!1&&(this.pos+=e.length),!0):null}else{let o=this.string.slice(this.pos).match(e);return o&&o.index>0?null:(o&&n!==!1&&(this.pos+=o[0].length),o)}}current(){return this.string.slice(this.start,this.pos)}}function fullParser(r){return{name:r.name||"",token:r.token,blankLine:r.blankLine||(()=>{}),startState:r.startState||(()=>!0),copyState:r.copyState||defaultCopyState,indent:r.indent||(()=>null),languageData:r.languageData||{},tokenTable:r.tokenTable||noTokens,mergeTokens:r.mergeTokens!==!1}}function defaultCopyState(r){if(typeof r!="object")return r;let e={};for(let n in r){let s=r[n];e[n]=s instanceof Array?s.slice():s}return e}const IndentedFrom=new WeakMap;class StreamLanguage extends Language{constructor(e){let n=defineLanguageFacet(e.languageData),s=fullParser(e),o,a=new class extends Parser{createParse(l,c,u){return new Parse(o,l,c,u)}};super(n,a,[],e.name),this.topNode=docID(n,this),o=this,this.streamParser=s,this.stateAfter=new NodeProp({perNode:!0}),this.tokenTable=e.tokenTable?new TokenTable(s.tokenTable):defaultTokenTable}static define(e){return new StreamLanguage(e)}getIndent(e){let n,{overrideIndentation:s}=e.options;s&&(n=IndentedFrom.get(e.state),n!=null&&n<e.pos-1e4&&(n=void 0));let o=findState(this,e.node.tree,e.node.from,e.node.from,n??e.pos),a,l;if(o?(l=o.state,a=o.pos+1):(l=this.streamParser.startState(e.unit),a=e.node.from),e.pos-a>1e4)return null;for(;a<e.pos;){let u=e.state.doc.lineAt(a),f=Math.min(e.pos,u.to);if(u.length){let d=s?s(u.from):-1,p=new StringStream(u.text,e.state.tabSize,e.unit,d<0?void 0:d);for(;p.pos<f-u.from;)readToken(this.streamParser.token,p,l)}else this.streamParser.blankLine(l,e.unit);if(f==e.pos)break;a=u.to+1}let c=e.lineAt(e.pos);return s&&n==null&&IndentedFrom.set(e.state,c.from),this.streamParser.indent(l,/^\s*(.*)/.exec(c.text)[1],e)}get allowsNesting(){return!1}}function findState(r,e,n,s,o){let a=n>=s&&n+e.length<=o&&e.prop(r.stateAfter);if(a)return{state:r.streamParser.copyState(a),pos:n+e.length};for(let l=e.children.length-1;l>=0;l--){let c=e.children[l],u=n+e.positions[l],f=c instanceof Tree&&u<o&&findState(r,c,u,s,o);if(f)return f}return null}function cutTree(r,e,n,s,o){if(o&&n<=0&&s>=e.length)return e;!o&&n==0&&e.type==r.topNode&&(o=!0);for(let a=e.children.length-1;a>=0;a--){let l=e.positions[a],c=e.children[a],u;if(l<s&&c instanceof Tree){if(!(u=cutTree(r,c,n-l,s-l,o)))break;return o?new Tree(e.type,e.children.slice(0,a).concat(u),e.positions.slice(0,a+1),l+u.length):u}}return null}function findStartInFragments(r,e,n,s,o){for(let a of e){let l=a.from+(a.openStart?25:0),c=a.to-(a.openEnd?25:0),u=l<=n&&c>n&&findState(r,a.tree,0-a.offset,n,c),f;if(u&&u.pos<=s&&(f=cutTree(r,a.tree,n+a.offset,u.pos+a.offset,!1)))return{state:u.state,tree:f}}return{state:r.streamParser.startState(o?getIndentUnit(o):4),tree:Tree.empty}}class Parse{constructor(e,n,s,o){this.lang=e,this.input=n,this.fragments=s,this.ranges=o,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=o[o.length-1].to;let a=ParseContext.get(),l=o[0].from,{state:c,tree:u}=findStartInFragments(e,s,l,this.to,a?.state);this.state=c,this.parsedPos=this.chunkStart=l+u.length;for(let f=0;f<u.children.length;f++)this.chunks.push(u.children[f]),this.chunkPos.push(u.positions[f]);a&&this.parsedPos<a.viewport.from-1e5&&o.some(f=>f.from<=a.viewport.from&&f.to>=a.viewport.from)&&(this.state=this.lang.streamParser.startState(getIndentUnit(a.state)),a.skipUntilInView(this.parsedPos,a.viewport.from),this.parsedPos=a.viewport.from),this.moveRangeIndex()}advance(){let e=ParseContext.get(),n=this.stoppedAt==null?this.to:Math.min(this.to,this.stoppedAt),s=Math.min(n,this.chunkStart+2048);for(e&&(s=Math.min(s,e.viewport.to));this.parsedPos<s;)this.parseLine(e);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=n?this.finish():e&&this.parsedPos>=e.viewport.to?(e.skipUntilInView(this.parsedPos,n),this.finish()):null}stopAt(e){this.stoppedAt=e}lineAfter(e){let n=this.input.chunk(e);if(this.input.lineChunks)n==`
`&&(n="");else{let s=n.indexOf(`
`);s>-1&&(n=n.slice(0,s))}return e+n.length<=this.to?n:n.slice(0,this.to-e)}nextLine(){let e=this.parsedPos,n=this.lineAfter(e),s=e+n.length;for(let o=this.rangeIndex;;){let a=this.ranges[o].to;if(a>=s||(n=n.slice(0,a-(s-n.length)),o++,o==this.ranges.length))break;let l=this.ranges[o].from,c=this.lineAfter(l);n+=c,s=l+c.length}return{line:n,end:s}}skipGapsTo(e,n,s){for(;;){let o=this.ranges[this.rangeIndex].to,a=e+n;if(s>0?o>a:o>=a)break;let l=this.ranges[++this.rangeIndex].from;n+=l-o}return n}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(e,n,s,o){let a=4;if(this.ranges.length>1){o=this.skipGapsTo(n,o,1),n+=o;let c=this.chunk.length;o=this.skipGapsTo(s,o,-1),s+=o,a+=this.chunk.length-c}let l=this.chunk.length-4;return this.lang.streamParser.mergeTokens&&a==4&&l>=0&&this.chunk[l]==e&&this.chunk[l+2]==n?this.chunk[l+2]=s:this.chunk.push(e,n,s,a),o}parseLine(e){let{line:n,end:s}=this.nextLine(),o=0,{streamParser:a}=this.lang,l=new StringStream(n,e?e.state.tabSize:4,e?getIndentUnit(e.state):2);if(l.eol())a.blankLine(this.state,l.indentUnit);else for(;!l.eol();){let c=readToken(a.token,l,this.state);if(c&&(o=this.emitToken(this.lang.tokenTable.resolve(c),this.parsedPos+l.start,this.parsedPos+l.pos,o)),l.start>1e4)break}this.parsedPos=s,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let e=Tree.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet,topID:0,maxBufferLength:2048,reused:this.chunkReused});e=new Tree(e.type,e.children,e.positions,e.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(e),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new Tree(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}}function readToken(r,e,n){e.start=e.pos;for(let s=0;s<10;s++){let o=r(e,n);if(e.pos>e.start)return o}throw new Error("Stream parser failed to advance stream.")}const noTokens=Object.create(null),typeArray=[NodeType.none],nodeSet=new NodeSet(typeArray),warned=[],byTag=Object.create(null),defaultTable=Object.create(null);for(let[r,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])defaultTable[r]=createTokenType(noTokens,e);class TokenTable{constructor(e){this.extra=e,this.table=Object.assign(Object.create(null),defaultTable)}resolve(e){return e?this.table[e]||(this.table[e]=createTokenType(this.extra,e)):0}}const defaultTokenTable=new TokenTable(noTokens);function warnForPart(r,e){warned.indexOf(r)>-1||(warned.push(r),console.warn(e))}function createTokenType(r,e){let n=[];for(let c of e.split(" ")){let u=[];for(let f of c.split(".")){let d=r[f]||tags[f];d?typeof d=="function"?u.length?u=u.map(d):warnForPart(f,`Modifier ${f} used at start of tag`):u.length?warnForPart(f,`Tag ${f} used as modifier`):u=Array.isArray(d)?d:[d]:warnForPart(f,`Unknown highlighting tag ${f}`)}for(let f of u)n.push(f)}if(!n.length)return 0;let s=e.replace(/ /g,"_"),o=s+" "+n.map(c=>c.id),a=byTag[o];if(a)return a.id;let l=byTag[o]=NodeType.define({id:typeArray.length,name:s,props:[styleTags({[s]:n})]});return typeArray.push(l),l.id}function docID(r,e){let n=NodeType.define({id:typeArray.length,name:"Document",props:[languageDataProp.add(()=>r),indentNodeProp.add(()=>s=>e.getIndent(s))],top:!0});return typeArray.push(n),n}Direction.RTL,Direction.LTR;const toggleComment=r=>{let{state:e}=r,n=e.doc.lineAt(e.selection.main.from),s=getConfig(r.state,n.from);return s.line?toggleLineComment(r):s.block?toggleBlockCommentByLine(r):!1};function command(r,e){return({state:n,dispatch:s})=>{if(n.readOnly)return!1;let o=r(e,n);return o?(s(n.update(o)),!0):!1}}const toggleLineComment=command(changeLineComment,0),toggleBlockComment=command(changeBlockComment,0),toggleBlockCommentByLine=command((r,e)=>changeBlockComment(r,e,selectedLineRanges(e)),0);function getConfig(r,e){let n=r.languageDataAt("commentTokens",e,1);return n.length?n[0]:{}}const SearchMargin=50;function findBlockComment(r,{open:e,close:n},s,o){let a=r.sliceDoc(s-SearchMargin,s),l=r.sliceDoc(o,o+SearchMargin),c=/\s*$/.exec(a)[0].length,u=/^\s*/.exec(l)[0].length,f=a.length-c;if(a.slice(f-e.length,f)==e&&l.slice(u,u+n.length)==n)return{open:{pos:s-c,margin:c&&1},close:{pos:o+u,margin:u&&1}};let d,p;o-s<=2*SearchMargin?d=p=r.sliceDoc(s,o):(d=r.sliceDoc(s,s+SearchMargin),p=r.sliceDoc(o-SearchMargin,o));let g=/^\s*/.exec(d)[0].length,y=/\s*$/.exec(p)[0].length,x=p.length-y-n.length;return d.slice(g,g+e.length)==e&&p.slice(x,x+n.length)==n?{open:{pos:s+g+e.length,margin:/\s/.test(d.charAt(g+e.length))?1:0},close:{pos:o-y-n.length,margin:/\s/.test(p.charAt(x-1))?1:0}}:null}function selectedLineRanges(r){let e=[];for(let n of r.selection.ranges){let s=r.doc.lineAt(n.from),o=n.to<=s.to?s:r.doc.lineAt(n.to);o.from>s.from&&o.from==n.to&&(o=n.to==s.to+1?s:r.doc.lineAt(n.to-1));let a=e.length-1;a>=0&&e[a].to>s.from?e[a].to=o.to:e.push({from:s.from+/^\s*/.exec(s.text)[0].length,to:o.to})}return e}function changeBlockComment(r,e,n=e.selection.ranges){let s=n.map(a=>getConfig(e,a.from).block);if(!s.every(a=>a))return null;let o=n.map((a,l)=>findBlockComment(e,s[l],a.from,a.to));if(r!=2&&!o.every(a=>a))return{changes:e.changes(n.map((a,l)=>o[l]?[]:[{from:a.from,insert:s[l].open+" "},{from:a.to,insert:" "+s[l].close}]))};if(r!=1&&o.some(a=>a)){let a=[];for(let l=0,c;l<o.length;l++)if(c=o[l]){let u=s[l],{open:f,close:d}=c;a.push({from:f.pos-u.open.length,to:f.pos+f.margin},{from:d.pos-d.margin,to:d.pos+u.close.length})}return{changes:a}}return null}function changeLineComment(r,e,n=e.selection.ranges){let s=[],o=-1;for(let{from:a,to:l}of n){let c=s.length,u=1e9,f=getConfig(e,a).line;if(f){for(let d=a;d<=l;){let p=e.doc.lineAt(d);if(p.from>o&&(a==l||l>p.from)){o=p.from;let g=/^\s*/.exec(p.text)[0].length,y=g==p.length,x=p.text.slice(g,g+f.length)==f?g:-1;g<p.text.length&&g<u&&(u=g),s.push({line:p,comment:x,token:f,indent:g,empty:y,single:!1})}d=p.to+1}if(u<1e9)for(let d=c;d<s.length;d++)s[d].indent<s[d].line.text.length&&(s[d].indent=u);s.length==c+1&&(s[c].single=!0)}}if(r!=2&&s.some(a=>a.comment<0&&(!a.empty||a.single))){let a=[];for(let{line:c,token:u,indent:f,empty:d,single:p}of s)(p||!d)&&a.push({from:c.from+f,insert:u+" "});let l=e.changes(a);return{changes:l,selection:e.selection.map(l,1)}}else if(r!=1&&s.some(a=>a.comment>=0)){let a=[];for(let{line:l,comment:c,token:u}of s)if(c>=0){let f=l.from+c,d=f+u.length;l.text[d-l.from]==" "&&d++,a.push({from:f,to:d})}return{changes:a}}return null}const fromHistory=Annotation.define(),isolateHistory=Annotation.define(),invertedEffects=Facet.define(),historyConfig=Facet.define({combine(r){return combineConfig(r,{minDepth:100,newGroupDelay:500,joinToEvent:(e,n)=>n},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,n)=>(s,o)=>e(s,o)||n(s,o)})}}),historyField_=StateField.define({create(){return HistoryState.empty},update(r,e){let n=e.state.facet(historyConfig),s=e.annotation(fromHistory);if(s){let u=HistEvent.fromTransaction(e,s.selection),f=s.side,d=f==0?r.undone:r.done;return u?d=updateBranch(d,d.length,n.minDepth,u):d=addSelection(d,e.startState.selection),new HistoryState(f==0?s.rest:d,f==0?d:s.rest)}let o=e.annotation(isolateHistory);if((o=="full"||o=="before")&&(r=r.isolate()),e.annotation(Transaction.addToHistory)===!1)return e.changes.empty?r:r.addMapping(e.changes.desc);let a=HistEvent.fromTransaction(e),l=e.annotation(Transaction.time),c=e.annotation(Transaction.userEvent);return a?r=r.addChanges(a,l,c,n,e):e.selection&&(r=r.addSelection(e.startState.selection,l,c,n.newGroupDelay)),(o=="full"||o=="after")&&(r=r.isolate()),r},toJSON(r){return{done:r.done.map(e=>e.toJSON()),undone:r.undone.map(e=>e.toJSON())}},fromJSON(r){return new HistoryState(r.done.map(HistEvent.fromJSON),r.undone.map(HistEvent.fromJSON))}});function history(r={}){return[historyField_,historyConfig.of(r),EditorView.domEventHandlers({beforeinput(e,n){let s=e.inputType=="historyUndo"?undo:e.inputType=="historyRedo"?redo:null;return s?(e.preventDefault(),s(n)):!1}})]}function cmd(r,e){return function({state:n,dispatch:s}){if(!e&&n.readOnly)return!1;let o=n.field(historyField_,!1);if(!o)return!1;let a=o.pop(r,n,e);return a?(s(a),!0):!1}}const undo=cmd(0,!1),redo=cmd(1,!1),undoSelection=cmd(0,!0),redoSelection=cmd(1,!0);class HistEvent{constructor(e,n,s,o,a){this.changes=e,this.effects=n,this.mapped=s,this.startSelection=o,this.selectionsAfter=a}setSelAfter(e){return new HistEvent(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,n,s;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(n=this.mapped)===null||n===void 0?void 0:n.toJSON(),startSelection:(s=this.startSelection)===null||s===void 0?void 0:s.toJSON(),selectionsAfter:this.selectionsAfter.map(o=>o.toJSON())}}static fromJSON(e){return new HistEvent(e.changes&&ChangeSet.fromJSON(e.changes),[],e.mapped&&ChangeDesc.fromJSON(e.mapped),e.startSelection&&EditorSelection.fromJSON(e.startSelection),e.selectionsAfter.map(EditorSelection.fromJSON))}static fromTransaction(e,n){let s=none$1;for(let o of e.startState.facet(invertedEffects)){let a=o(e);a.length&&(s=s.concat(a))}return!s.length&&e.changes.empty?null:new HistEvent(e.changes.invert(e.startState.doc),s,void 0,n||e.startState.selection,none$1)}static selection(e){return new HistEvent(void 0,none$1,void 0,void 0,e)}}function updateBranch(r,e,n,s){let o=e+1>n+20?e-n-1:0,a=r.slice(o,e);return a.push(s),a}function isAdjacent(r,e){let n=[],s=!1;return r.iterChangedRanges((o,a)=>n.push(o,a)),e.iterChangedRanges((o,a,l,c)=>{for(let u=0;u<n.length;){let f=n[u++],d=n[u++];c>=f&&l<=d&&(s=!0)}}),s}function eqSelectionShape(r,e){return r.ranges.length==e.ranges.length&&r.ranges.filter((n,s)=>n.empty!=e.ranges[s].empty).length===0}function conc(r,e){return r.length?e.length?r.concat(e):r:e}const none$1=[],MaxSelectionsPerEvent=200;function addSelection(r,e){if(r.length){let n=r[r.length-1],s=n.selectionsAfter.slice(Math.max(0,n.selectionsAfter.length-MaxSelectionsPerEvent));return s.length&&s[s.length-1].eq(e)?r:(s.push(e),updateBranch(r,r.length-1,1e9,n.setSelAfter(s)))}else return[HistEvent.selection([e])]}function popSelection(r){let e=r[r.length-1],n=r.slice();return n[r.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),n}function addMappingToBranch(r,e){if(!r.length)return r;let n=r.length,s=none$1;for(;n;){let o=mapEvent(r[n-1],e,s);if(o.changes&&!o.changes.empty||o.effects.length){let a=r.slice(0,n);return a[n-1]=o,a}else e=o.mapped,n--,s=o.selectionsAfter}return s.length?[HistEvent.selection(s)]:none$1}function mapEvent(r,e,n){let s=conc(r.selectionsAfter.length?r.selectionsAfter.map(c=>c.map(e)):none$1,n);if(!r.changes)return HistEvent.selection(s);let o=r.changes.map(e),a=e.mapDesc(r.changes,!0),l=r.mapped?r.mapped.composeDesc(a):a;return new HistEvent(o,StateEffect.mapEffects(r.effects,e),l,r.startSelection.map(a),s)}const joinableUserEvent=/^(input\.type|delete)($|\.)/;class HistoryState{constructor(e,n,s=0,o=void 0){this.done=e,this.undone=n,this.prevTime=s,this.prevUserEvent=o}isolate(){return this.prevTime?new HistoryState(this.done,this.undone):this}addChanges(e,n,s,o,a){let l=this.done,c=l[l.length-1];return c&&c.changes&&!c.changes.empty&&e.changes&&(!s||joinableUserEvent.test(s))&&(!c.selectionsAfter.length&&n-this.prevTime<o.newGroupDelay&&o.joinToEvent(a,isAdjacent(c.changes,e.changes))||s=="input.type.compose")?l=updateBranch(l,l.length-1,o.minDepth,new HistEvent(e.changes.compose(c.changes),conc(StateEffect.mapEffects(e.effects,c.changes),c.effects),c.mapped,c.startSelection,none$1)):l=updateBranch(l,l.length,o.minDepth,e),new HistoryState(l,none$1,n,s)}addSelection(e,n,s,o){let a=this.done.length?this.done[this.done.length-1].selectionsAfter:none$1;return a.length>0&&n-this.prevTime<o&&s==this.prevUserEvent&&s&&/^select($|\.)/.test(s)&&eqSelectionShape(a[a.length-1],e)?this:new HistoryState(addSelection(this.done,e),this.undone,n,s)}addMapping(e){return new HistoryState(addMappingToBranch(this.done,e),addMappingToBranch(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,n,s){let o=e==0?this.done:this.undone;if(o.length==0)return null;let a=o[o.length-1],l=a.selectionsAfter[0]||n.selection;if(s&&a.selectionsAfter.length)return n.update({selection:a.selectionsAfter[a.selectionsAfter.length-1],annotations:fromHistory.of({side:e,rest:popSelection(o),selection:l}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(a.changes){let c=o.length==1?none$1:o.slice(0,o.length-1);return a.mapped&&(c=addMappingToBranch(c,a.mapped)),n.update({changes:a.changes,selection:a.startSelection,effects:a.effects,annotations:fromHistory.of({side:e,rest:c,selection:l}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}HistoryState.empty=new HistoryState(none$1,none$1);const historyKeymap=[{key:"Mod-z",run:undo,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:redo,preventDefault:!0},{linux:"Ctrl-Shift-z",run:redo,preventDefault:!0},{key:"Mod-u",run:undoSelection,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:redoSelection,preventDefault:!0}];function updateSel(r,e){return EditorSelection.create(r.ranges.map(e),r.mainIndex)}function setSel(r,e){return r.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function moveSel({state:r,dispatch:e},n){let s=updateSel(r.selection,n);return s.eq(r.selection,!0)?!1:(e(setSel(r,s)),!0)}function rangeEnd(r,e){return EditorSelection.cursor(e?r.to:r.from)}function cursorByChar(r,e){return moveSel(r,n=>n.empty?r.moveByChar(n,e):rangeEnd(n,e))}function ltrAtCursor(r){return r.textDirectionAt(r.state.selection.main.head)==Direction.LTR}const cursorCharLeft=r=>cursorByChar(r,!ltrAtCursor(r)),cursorCharRight=r=>cursorByChar(r,ltrAtCursor(r));function cursorByGroup(r,e){return moveSel(r,n=>n.empty?r.moveByGroup(n,e):rangeEnd(n,e))}const cursorGroupLeft=r=>cursorByGroup(r,!ltrAtCursor(r)),cursorGroupRight=r=>cursorByGroup(r,ltrAtCursor(r));function interestingNode(r,e,n){if(e.type.prop(n))return!0;let s=e.to-e.from;return s&&(s>2||/[^\s,.;:]/.test(r.sliceDoc(e.from,e.to)))||e.firstChild}function moveBySyntax(r,e,n){let s=syntaxTree(r).resolveInner(e.head),o=n?NodeProp.closedBy:NodeProp.openedBy;for(let u=e.head;;){let f=n?s.childAfter(u):s.childBefore(u);if(!f)break;interestingNode(r,f,o)?s=f:u=n?f.to:f.from}let a=s.type.prop(o),l,c;return a&&(l=n?matchBrackets(r,s.from,1):matchBrackets(r,s.to,-1))&&l.matched?c=n?l.end.to:l.end.from:c=n?s.to:s.from,EditorSelection.cursor(c,n?-1:1)}const cursorSyntaxLeft=r=>moveSel(r,e=>moveBySyntax(r.state,e,!ltrAtCursor(r))),cursorSyntaxRight=r=>moveSel(r,e=>moveBySyntax(r.state,e,ltrAtCursor(r)));function cursorByLine(r,e){return moveSel(r,n=>{if(!n.empty)return rangeEnd(n,e);let s=r.moveVertically(n,e);return s.head!=n.head?s:r.moveToLineBoundary(n,e)})}const cursorLineUp=r=>cursorByLine(r,!1),cursorLineDown=r=>cursorByLine(r,!0);function pageInfo(r){let e=r.scrollDOM.clientHeight<r.scrollDOM.scrollHeight-2,n=0,s=0,o;if(e){for(let a of r.state.facet(EditorView.scrollMargins)){let l=a(r);l?.top&&(n=Math.max(l?.top,n)),l?.bottom&&(s=Math.max(l?.bottom,s))}o=r.scrollDOM.clientHeight-n-s}else o=(r.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:n,marginBottom:s,selfScroll:e,height:Math.max(r.defaultLineHeight,o-5)}}function cursorByPage(r,e){let n=pageInfo(r),{state:s}=r,o=updateSel(s.selection,l=>l.empty?r.moveVertically(l,e,n.height):rangeEnd(l,e));if(o.eq(s.selection))return!1;let a;if(n.selfScroll){let l=r.coordsAtPos(s.selection.main.head),c=r.scrollDOM.getBoundingClientRect(),u=c.top+n.marginTop,f=c.bottom-n.marginBottom;l&&l.top>u&&l.bottom<f&&(a=EditorView.scrollIntoView(o.main.head,{y:"start",yMargin:l.top-u}))}return r.dispatch(setSel(s,o),{effects:a}),!0}const cursorPageUp=r=>cursorByPage(r,!1),cursorPageDown=r=>cursorByPage(r,!0);function moveByLineBoundary(r,e,n){let s=r.lineBlockAt(e.head),o=r.moveToLineBoundary(e,n);if(o.head==e.head&&o.head!=(n?s.to:s.from)&&(o=r.moveToLineBoundary(e,n,!1)),!n&&o.head==s.from&&s.length){let a=/^\s*/.exec(r.state.sliceDoc(s.from,Math.min(s.from+100,s.to)))[0].length;a&&e.head!=s.from+a&&(o=EditorSelection.cursor(s.from+a))}return o}const cursorLineBoundaryForward=r=>moveSel(r,e=>moveByLineBoundary(r,e,!0)),cursorLineBoundaryBackward=r=>moveSel(r,e=>moveByLineBoundary(r,e,!1)),cursorLineBoundaryLeft=r=>moveSel(r,e=>moveByLineBoundary(r,e,!ltrAtCursor(r))),cursorLineBoundaryRight=r=>moveSel(r,e=>moveByLineBoundary(r,e,ltrAtCursor(r))),cursorLineStart=r=>moveSel(r,e=>EditorSelection.cursor(r.lineBlockAt(e.head).from,1)),cursorLineEnd=r=>moveSel(r,e=>EditorSelection.cursor(r.lineBlockAt(e.head).to,-1));function toMatchingBracket(r,e,n){let s=!1,o=updateSel(r.selection,a=>{let l=matchBrackets(r,a.head,-1)||matchBrackets(r,a.head,1)||a.head>0&&matchBrackets(r,a.head-1,1)||a.head<r.doc.length&&matchBrackets(r,a.head+1,-1);if(!l||!l.end)return a;s=!0;let c=l.start.from==a.head?l.end.to:l.end.from;return EditorSelection.cursor(c)});return s?(e(setSel(r,o)),!0):!1}const cursorMatchingBracket=({state:r,dispatch:e})=>toMatchingBracket(r,e);function extendSel(r,e){let n=updateSel(r.state.selection,s=>{let o=e(s);return EditorSelection.range(s.anchor,o.head,o.goalColumn,o.bidiLevel||void 0)});return n.eq(r.state.selection)?!1:(r.dispatch(setSel(r.state,n)),!0)}function selectByChar(r,e){return extendSel(r,n=>r.moveByChar(n,e))}const selectCharLeft=r=>selectByChar(r,!ltrAtCursor(r)),selectCharRight=r=>selectByChar(r,ltrAtCursor(r));function selectByGroup(r,e){return extendSel(r,n=>r.moveByGroup(n,e))}const selectGroupLeft=r=>selectByGroup(r,!ltrAtCursor(r)),selectGroupRight=r=>selectByGroup(r,ltrAtCursor(r)),selectSyntaxLeft=r=>extendSel(r,e=>moveBySyntax(r.state,e,!ltrAtCursor(r))),selectSyntaxRight=r=>extendSel(r,e=>moveBySyntax(r.state,e,ltrAtCursor(r)));function selectByLine(r,e){return extendSel(r,n=>r.moveVertically(n,e))}const selectLineUp=r=>selectByLine(r,!1),selectLineDown=r=>selectByLine(r,!0);function selectByPage(r,e){return extendSel(r,n=>r.moveVertically(n,e,pageInfo(r).height))}const selectPageUp=r=>selectByPage(r,!1),selectPageDown=r=>selectByPage(r,!0),selectLineBoundaryForward=r=>extendSel(r,e=>moveByLineBoundary(r,e,!0)),selectLineBoundaryBackward=r=>extendSel(r,e=>moveByLineBoundary(r,e,!1)),selectLineBoundaryLeft=r=>extendSel(r,e=>moveByLineBoundary(r,e,!ltrAtCursor(r))),selectLineBoundaryRight=r=>extendSel(r,e=>moveByLineBoundary(r,e,ltrAtCursor(r))),selectLineStart=r=>extendSel(r,e=>EditorSelection.cursor(r.lineBlockAt(e.head).from)),selectLineEnd=r=>extendSel(r,e=>EditorSelection.cursor(r.lineBlockAt(e.head).to)),cursorDocStart=({state:r,dispatch:e})=>(e(setSel(r,{anchor:0})),!0),cursorDocEnd=({state:r,dispatch:e})=>(e(setSel(r,{anchor:r.doc.length})),!0),selectDocStart=({state:r,dispatch:e})=>(e(setSel(r,{anchor:r.selection.main.anchor,head:0})),!0),selectDocEnd=({state:r,dispatch:e})=>(e(setSel(r,{anchor:r.selection.main.anchor,head:r.doc.length})),!0),selectAll=({state:r,dispatch:e})=>(e(r.update({selection:{anchor:0,head:r.doc.length},userEvent:"select"})),!0),selectLine=({state:r,dispatch:e})=>{let n=selectedLineBlocks(r).map(({from:s,to:o})=>EditorSelection.range(s,Math.min(o+1,r.doc.length)));return e(r.update({selection:EditorSelection.create(n),userEvent:"select"})),!0},selectParentSyntax=({state:r,dispatch:e})=>{let n=updateSel(r.selection,s=>{let o=syntaxTree(r),a=o.resolveStack(s.from,1);if(s.empty){let l=o.resolveStack(s.from,-1);l.node.from>=a.node.from&&l.node.to<=a.node.to&&(a=l)}for(let l=a;l;l=l.next){let{node:c}=l;if((c.from<s.from&&c.to>=s.to||c.to>s.to&&c.from<=s.from)&&l.next)return EditorSelection.range(c.to,c.from)}return s});return n.eq(r.selection)?!1:(e(setSel(r,n)),!0)},simplifySelection=({state:r,dispatch:e})=>{let n=r.selection,s=null;return n.ranges.length>1?s=EditorSelection.create([n.main]):n.main.empty||(s=EditorSelection.create([EditorSelection.cursor(n.main.head)])),s?(e(setSel(r,s)),!0):!1};function deleteBy(r,e){if(r.state.readOnly)return!1;let n="delete.selection",{state:s}=r,o=s.changeByRange(a=>{let{from:l,to:c}=a;if(l==c){let u=e(a);u<l?(n="delete.backward",u=skipAtomic(r,u,!1)):u>l&&(n="delete.forward",u=skipAtomic(r,u,!0)),l=Math.min(l,u),c=Math.max(c,u)}else l=skipAtomic(r,l,!1),c=skipAtomic(r,c,!0);return l==c?{range:a}:{changes:{from:l,to:c},range:EditorSelection.cursor(l,l<a.head?-1:1)}});return o.changes.empty?!1:(r.dispatch(s.update(o,{scrollIntoView:!0,userEvent:n,effects:n=="delete.selection"?EditorView.announce.of(s.phrase("Selection deleted")):void 0})),!0)}function skipAtomic(r,e,n){if(r instanceof EditorView)for(let s of r.state.facet(EditorView.atomicRanges).map(o=>o(r)))s.between(e,e,(o,a)=>{o<e&&a>e&&(e=n?a:o)});return e}const deleteByChar=(r,e,n)=>deleteBy(r,s=>{let o=s.from,{state:a}=r,l=a.doc.lineAt(o),c,u;if(n&&!e&&o>l.from&&o<l.from+200&&!/[^ \t]/.test(c=l.text.slice(0,o-l.from))){if(c[c.length-1]=="	")return o-1;let f=countColumn(c,a.tabSize),d=f%getIndentUnit(a)||getIndentUnit(a);for(let p=0;p<d&&c[c.length-1-p]==" ";p++)o--;u=o}else u=findClusterBreak(l.text,o-l.from,e,e)+l.from,u==o&&l.number!=(e?a.doc.lines:1)?u+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(l.text.slice(u-l.from,o-l.from))&&(u=findClusterBreak(l.text,u-l.from,!1,!1)+l.from);return u}),deleteCharBackward=r=>deleteByChar(r,!1,!0),deleteCharForward=r=>deleteByChar(r,!0,!1),deleteByGroup=(r,e)=>deleteBy(r,n=>{let s=n.head,{state:o}=r,a=o.doc.lineAt(s),l=o.charCategorizer(s);for(let c=null;;){if(s==(e?a.to:a.from)){s==n.head&&a.number!=(e?o.doc.lines:1)&&(s+=e?1:-1);break}let u=findClusterBreak(a.text,s-a.from,e)+a.from,f=a.text.slice(Math.min(s,u)-a.from,Math.max(s,u)-a.from),d=l(f);if(c!=null&&d!=c)break;(f!=" "||s!=n.head)&&(c=d),s=u}return s}),deleteGroupBackward=r=>deleteByGroup(r,!1),deleteGroupForward=r=>deleteByGroup(r,!0),deleteToLineEnd=r=>deleteBy(r,e=>{let n=r.lineBlockAt(e.head).to;return e.head<n?n:Math.min(r.state.doc.length,e.head+1)}),deleteLineBoundaryBackward=r=>deleteBy(r,e=>{let n=r.moveToLineBoundary(e,!1).head;return e.head>n?n:Math.max(0,e.head-1)}),deleteLineBoundaryForward=r=>deleteBy(r,e=>{let n=r.moveToLineBoundary(e,!0).head;return e.head<n?n:Math.min(r.state.doc.length,e.head+1)}),splitLine=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let n=r.changeByRange(s=>({changes:{from:s.from,to:s.to,insert:Text.of(["",""])},range:EditorSelection.cursor(s.from)}));return e(r.update(n,{scrollIntoView:!0,userEvent:"input"})),!0},transposeChars=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let n=r.changeByRange(s=>{if(!s.empty||s.from==0||s.from==r.doc.length)return{range:s};let o=s.from,a=r.doc.lineAt(o),l=o==a.from?o-1:findClusterBreak(a.text,o-a.from,!1)+a.from,c=o==a.to?o+1:findClusterBreak(a.text,o-a.from,!0)+a.from;return{changes:{from:l,to:c,insert:r.doc.slice(o,c).append(r.doc.slice(l,o))},range:EditorSelection.cursor(c)}});return n.changes.empty?!1:(e(r.update(n,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function selectedLineBlocks(r){let e=[],n=-1;for(let s of r.selection.ranges){let o=r.doc.lineAt(s.from),a=r.doc.lineAt(s.to);if(!s.empty&&s.to==a.from&&(a=r.doc.lineAt(s.to-1)),n>=o.number){let l=e[e.length-1];l.to=a.to,l.ranges.push(s)}else e.push({from:o.from,to:a.to,ranges:[s]});n=a.number+1}return e}function moveLine(r,e,n){if(r.readOnly)return!1;let s=[],o=[];for(let a of selectedLineBlocks(r)){if(n?a.to==r.doc.length:a.from==0)continue;let l=r.doc.lineAt(n?a.to+1:a.from-1),c=l.length+1;if(n){s.push({from:a.to,to:l.to},{from:a.from,insert:l.text+r.lineBreak});for(let u of a.ranges)o.push(EditorSelection.range(Math.min(r.doc.length,u.anchor+c),Math.min(r.doc.length,u.head+c)))}else{s.push({from:l.from,to:a.from},{from:a.to,insert:r.lineBreak+l.text});for(let u of a.ranges)o.push(EditorSelection.range(u.anchor-c,u.head-c))}}return s.length?(e(r.update({changes:s,scrollIntoView:!0,selection:EditorSelection.create(o,r.selection.mainIndex),userEvent:"move.line"})),!0):!1}const moveLineUp=({state:r,dispatch:e})=>moveLine(r,e,!1),moveLineDown=({state:r,dispatch:e})=>moveLine(r,e,!0);function copyLine(r,e,n){if(r.readOnly)return!1;let s=[];for(let o of selectedLineBlocks(r))n?s.push({from:o.from,insert:r.doc.slice(o.from,o.to)+r.lineBreak}):s.push({from:o.to,insert:r.lineBreak+r.doc.slice(o.from,o.to)});return e(r.update({changes:s,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const copyLineUp=({state:r,dispatch:e})=>copyLine(r,e,!1),copyLineDown=({state:r,dispatch:e})=>copyLine(r,e,!0),deleteLine=r=>{if(r.state.readOnly)return!1;let{state:e}=r,n=e.changes(selectedLineBlocks(e).map(({from:o,to:a})=>(o>0?o--:a<e.doc.length&&a++,{from:o,to:a}))),s=updateSel(e.selection,o=>{let a;if(r.lineWrapping){let l=r.lineBlockAt(o.head),c=r.coordsAtPos(o.head,o.assoc||1);c&&(a=l.bottom+r.documentTop-c.bottom+r.defaultLineHeight/2)}return r.moveVertically(o,!0,a)}).map(n);return r.dispatch({changes:n,selection:s,scrollIntoView:!0,userEvent:"delete.line"}),!0};function isBetweenBrackets(r,e){if(/\(\)|\[\]|\{\}/.test(r.sliceDoc(e-1,e+1)))return{from:e,to:e};let n=syntaxTree(r).resolveInner(e),s=n.childBefore(e),o=n.childAfter(e),a;return s&&o&&s.to<=e&&o.from>=e&&(a=s.type.prop(NodeProp.closedBy))&&a.indexOf(o.name)>-1&&r.doc.lineAt(s.to).from==r.doc.lineAt(o.from).from&&!/\S/.test(r.sliceDoc(s.to,o.from))?{from:s.to,to:o.from}:null}const insertNewlineAndIndent=newlineAndIndent(!1),insertBlankLine=newlineAndIndent(!0);function newlineAndIndent(r){return({state:e,dispatch:n})=>{if(e.readOnly)return!1;let s=e.changeByRange(o=>{let{from:a,to:l}=o,c=e.doc.lineAt(a),u=!r&&a==l&&isBetweenBrackets(e,a);r&&(a=l=(l<=c.to?c:e.doc.lineAt(l)).to);let f=new IndentContext(e,{simulateBreak:a,simulateDoubleBreak:!!u}),d=getIndentation(f,a);for(d==null&&(d=countColumn(/^\s*/.exec(e.doc.lineAt(a).text)[0],e.tabSize));l<c.to&&/\s/.test(c.text[l-c.from]);)l++;u?{from:a,to:l}=u:a>c.from&&a<c.from+100&&!/\S/.test(c.text.slice(0,a))&&(a=c.from);let p=["",indentString(e,d)];return u&&p.push(indentString(e,f.lineIndent(c.from,-1))),{changes:{from:a,to:l,insert:Text.of(p)},range:EditorSelection.cursor(a+1+p[1].length)}});return n(e.update(s,{scrollIntoView:!0,userEvent:"input"})),!0}}function changeBySelectedLine(r,e){let n=-1;return r.changeByRange(s=>{let o=[];for(let l=s.from;l<=s.to;){let c=r.doc.lineAt(l);c.number>n&&(s.empty||s.to>c.from)&&(e(c,o,s),n=c.number),l=c.to+1}let a=r.changes(o);return{changes:o,range:EditorSelection.range(a.mapPos(s.anchor,1),a.mapPos(s.head,1))}})}const indentSelection=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let n=Object.create(null),s=new IndentContext(r,{overrideIndentation:a=>{let l=n[a];return l??-1}}),o=changeBySelectedLine(r,(a,l,c)=>{let u=getIndentation(s,a.from);if(u==null)return;/\S/.test(a.text)||(u=0);let f=/^\s*/.exec(a.text)[0],d=indentString(r,u);(f!=d||c.from<a.from+f.length)&&(n[a.from]=u,l.push({from:a.from,to:a.from+f.length,insert:d}))});return o.changes.empty||e(r.update(o,{userEvent:"indent"})),!0},indentMore=({state:r,dispatch:e})=>r.readOnly?!1:(e(r.update(changeBySelectedLine(r,(n,s)=>{s.push({from:n.from,insert:r.facet(indentUnit)})}),{userEvent:"input.indent"})),!0),indentLess=({state:r,dispatch:e})=>r.readOnly?!1:(e(r.update(changeBySelectedLine(r,(n,s)=>{let o=/^\s*/.exec(n.text)[0];if(!o)return;let a=countColumn(o,r.tabSize),l=0,c=indentString(r,Math.max(0,a-getIndentUnit(r)));for(;l<o.length&&l<c.length&&o.charCodeAt(l)==c.charCodeAt(l);)l++;s.push({from:n.from+l,to:n.from+o.length,insert:c.slice(l)})}),{userEvent:"delete.dedent"})),!0),toggleTabFocusMode=r=>(r.setTabFocusMode(),!0),emacsStyleKeymap=[{key:"Ctrl-b",run:cursorCharLeft,shift:selectCharLeft,preventDefault:!0},{key:"Ctrl-f",run:cursorCharRight,shift:selectCharRight},{key:"Ctrl-p",run:cursorLineUp,shift:selectLineUp},{key:"Ctrl-n",run:cursorLineDown,shift:selectLineDown},{key:"Ctrl-a",run:cursorLineStart,shift:selectLineStart},{key:"Ctrl-e",run:cursorLineEnd,shift:selectLineEnd},{key:"Ctrl-d",run:deleteCharForward},{key:"Ctrl-h",run:deleteCharBackward},{key:"Ctrl-k",run:deleteToLineEnd},{key:"Ctrl-Alt-h",run:deleteGroupBackward},{key:"Ctrl-o",run:splitLine},{key:"Ctrl-t",run:transposeChars},{key:"Ctrl-v",run:cursorPageDown}],standardKeymap=[{key:"ArrowLeft",run:cursorCharLeft,shift:selectCharLeft,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:cursorGroupLeft,shift:selectGroupLeft,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:cursorLineBoundaryLeft,shift:selectLineBoundaryLeft,preventDefault:!0},{key:"ArrowRight",run:cursorCharRight,shift:selectCharRight,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:cursorGroupRight,shift:selectGroupRight,preventDefault:!0},{mac:"Cmd-ArrowRight",run:cursorLineBoundaryRight,shift:selectLineBoundaryRight,preventDefault:!0},{key:"ArrowUp",run:cursorLineUp,shift:selectLineUp,preventDefault:!0},{mac:"Cmd-ArrowUp",run:cursorDocStart,shift:selectDocStart},{mac:"Ctrl-ArrowUp",run:cursorPageUp,shift:selectPageUp},{key:"ArrowDown",run:cursorLineDown,shift:selectLineDown,preventDefault:!0},{mac:"Cmd-ArrowDown",run:cursorDocEnd,shift:selectDocEnd},{mac:"Ctrl-ArrowDown",run:cursorPageDown,shift:selectPageDown},{key:"PageUp",run:cursorPageUp,shift:selectPageUp},{key:"PageDown",run:cursorPageDown,shift:selectPageDown},{key:"Home",run:cursorLineBoundaryBackward,shift:selectLineBoundaryBackward,preventDefault:!0},{key:"Mod-Home",run:cursorDocStart,shift:selectDocStart},{key:"End",run:cursorLineBoundaryForward,shift:selectLineBoundaryForward,preventDefault:!0},{key:"Mod-End",run:cursorDocEnd,shift:selectDocEnd},{key:"Enter",run:insertNewlineAndIndent,shift:insertNewlineAndIndent},{key:"Mod-a",run:selectAll},{key:"Backspace",run:deleteCharBackward,shift:deleteCharBackward},{key:"Delete",run:deleteCharForward},{key:"Mod-Backspace",mac:"Alt-Backspace",run:deleteGroupBackward},{key:"Mod-Delete",mac:"Alt-Delete",run:deleteGroupForward},{mac:"Mod-Backspace",run:deleteLineBoundaryBackward},{mac:"Mod-Delete",run:deleteLineBoundaryForward}].concat(emacsStyleKeymap.map(r=>({mac:r.key,run:r.run,shift:r.shift}))),defaultKeymap=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:cursorSyntaxLeft,shift:selectSyntaxLeft},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:cursorSyntaxRight,shift:selectSyntaxRight},{key:"Alt-ArrowUp",run:moveLineUp},{key:"Shift-Alt-ArrowUp",run:copyLineUp},{key:"Alt-ArrowDown",run:moveLineDown},{key:"Shift-Alt-ArrowDown",run:copyLineDown},{key:"Escape",run:simplifySelection},{key:"Mod-Enter",run:insertBlankLine},{key:"Alt-l",mac:"Ctrl-l",run:selectLine},{key:"Mod-i",run:selectParentSyntax,preventDefault:!0},{key:"Mod-[",run:indentLess},{key:"Mod-]",run:indentMore},{key:"Mod-Alt-\\",run:indentSelection},{key:"Shift-Mod-k",run:deleteLine},{key:"Shift-Mod-\\",run:cursorMatchingBracket},{key:"Mod-/",run:toggleComment},{key:"Alt-A",run:toggleBlockComment},{key:"Ctrl-m",mac:"Shift-Alt-m",run:toggleTabFocusMode}].concat(standardKeymap),indentWithTab={key:"Tab",run:indentMore,shift:indentLess},tryOnCleanup=onCleanup;function createHydratableSignal(r,e,n){return createSignal(e(),n)}function makeEventListener(r,e,n,s){return r.addEventListener(e,n,s),tryOnCleanup(r.removeEventListener.bind(r,e,n,s))}function createSingletonRoot(r,e=getOwner()){let n=0,s,o;return()=>(n++,onCleanup(()=>{n--,queueMicrotask(()=>{!n&&o&&(o(),o=s=void 0)})}),o||createRoot(a=>s=r(o=a),e),s)}function createHydratableSingletonRoot(r){const e=getOwner(),n=createSingletonRoot(r,e);return()=>n()}function createMediaQuery(r,e=!1){const n=window.matchMedia(r),[s,o]=createHydratableSignal(e,()=>n.matches);return makeEventListener(n,"change",()=>o(n.matches)),s}function createPrefersDark(r){return createMediaQuery("(prefers-color-scheme: dark)",r)}createPrefersDark.bind(void 0,!1);const basicNormalize=typeof String.prototype.normalize=="function"?r=>r.normalize("NFKD"):r=>r;class SearchCursor{constructor(e,n,s=0,o=e.length,a,l){this.test=l,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(s,o),this.bufferStart=s,this.normalize=a?c=>a(basicNormalize(c)):basicNormalize,this.query=this.normalize(n)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return codePointAt(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let n=fromCodePoint(e),s=this.bufferStart+this.bufferPos;this.bufferPos+=codePointSize(e);let o=this.normalize(n);if(o.length)for(let a=0,l=s;;a++){let c=o.charCodeAt(a),u=this.match(c,l,this.bufferPos+this.bufferStart);if(a==o.length-1){if(u)return this.value=u,this;break}l==s&&a<n.length&&n.charCodeAt(a)==c&&l++}}}match(e,n,s){let o=null;for(let a=0;a<this.matches.length;a+=2){let l=this.matches[a],c=!1;this.query.charCodeAt(l)==e&&(l==this.query.length-1?o={from:this.matches[a+1],to:s}:(this.matches[a]++,c=!0)),c||(this.matches.splice(a,2),a-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?o={from:n,to:s}:this.matches.push(1,n)),o&&this.test&&!this.test(o.from,o.to,this.buffer,this.bufferStart)&&(o=null),o}}typeof Symbol<"u"&&(SearchCursor.prototype[Symbol.iterator]=function(){return this});const empty={from:-1,to:-1,match:/.*/.exec("")},baseFlags="gm"+(/x/.unicode==null?"":"u");class RegExpCursor{constructor(e,n,s,o=0,a=e.length){if(this.text=e,this.to=a,this.curLine="",this.done=!1,this.value=empty,/\\[sWDnr]|\n|\r|\[\^/.test(n))return new MultilineRegExpCursor(e,n,s,o,a);this.re=new RegExp(n,baseFlags+(s?.ignoreCase?"i":"")),this.test=s?.test,this.iter=e.iter();let l=e.lineAt(o);this.curLineStart=l.from,this.matchPos=toCharEnd(e,o),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let n=this.matchPos<=this.to&&this.re.exec(this.curLine);if(n){let s=this.curLineStart+n.index,o=s+n[0].length;if(this.matchPos=toCharEnd(this.text,o+(s==o?1:0)),s==this.curLineStart+this.curLine.length&&this.nextLine(),(s<o||s>this.value.to)&&(!this.test||this.test(s,o,n)))return this.value={from:s,to:o,match:n},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const flattened=new WeakMap;class FlattenedDoc{constructor(e,n){this.from=e,this.text=n}get to(){return this.from+this.text.length}static get(e,n,s){let o=flattened.get(e);if(!o||o.from>=s||o.to<=n){let c=new FlattenedDoc(n,e.sliceString(n,s));return flattened.set(e,c),c}if(o.from==n&&o.to==s)return o;let{text:a,from:l}=o;return l>n&&(a=e.sliceString(n,l)+a,l=n),o.to<s&&(a+=e.sliceString(o.to,s)),flattened.set(e,new FlattenedDoc(l,a)),new FlattenedDoc(n,a.slice(n-l,s-l))}}class MultilineRegExpCursor{constructor(e,n,s,o,a){this.text=e,this.to=a,this.done=!1,this.value=empty,this.matchPos=toCharEnd(e,o),this.re=new RegExp(n,baseFlags+(s?.ignoreCase?"i":"")),this.test=s?.test,this.flat=FlattenedDoc.get(e,o,this.chunkEnd(o+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,n=this.re.exec(this.flat.text);if(n&&!n[0]&&n.index==e&&(this.re.lastIndex=e+1,n=this.re.exec(this.flat.text)),n){let s=this.flat.from+n.index,o=s+n[0].length;if((this.flat.to>=this.to||n.index+n[0].length<=this.flat.text.length-10)&&(!this.test||this.test(s,o,n)))return this.value={from:s,to:o,match:n},this.matchPos=toCharEnd(this.text,o+(s==o?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=FlattenedDoc.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(RegExpCursor.prototype[Symbol.iterator]=MultilineRegExpCursor.prototype[Symbol.iterator]=function(){return this});function validRegExp(r){try{return new RegExp(r,baseFlags),!0}catch{return!1}}function toCharEnd(r,e){if(e>=r.length)return e;let n=r.lineAt(e),s;for(;e<n.to&&(s=n.text.charCodeAt(e-n.from))>=56320&&s<57344;)e++;return e}function createLineDialog(r){let e=String(r.state.doc.lineAt(r.state.selection.main.head).number),n=crelt("input",{class:"cm-textfield",name:"line",value:e}),s=crelt("form",{class:"cm-gotoLine",onkeydown:a=>{a.keyCode==27?(a.preventDefault(),r.dispatch({effects:dialogEffect.of(!1)}),r.focus()):a.keyCode==13&&(a.preventDefault(),o())},onsubmit:a=>{a.preventDefault(),o()}},crelt("label",r.state.phrase("Go to line"),": ",n)," ",crelt("button",{class:"cm-button",type:"submit"},r.state.phrase("go")),crelt("button",{name:"close",onclick:()=>{r.dispatch({effects:dialogEffect.of(!1)}),r.focus()},"aria-label":r.state.phrase("close"),type:"button"},[""]));function o(){let a=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(n.value);if(!a)return;let{state:l}=r,c=l.doc.lineAt(l.selection.main.head),[,u,f,d,p]=a,g=d?+d.slice(1):0,y=f?+f:c.number;if(f&&p){let Y=y/100;u&&(Y=Y*(u=="-"?-1:1)+c.number/l.doc.lines),y=Math.round(l.doc.lines*Y)}else f&&u&&(y=y*(u=="-"?-1:1)+c.number);let x=l.doc.line(Math.max(1,Math.min(l.doc.lines,y))),E=EditorSelection.cursor(x.from+Math.max(0,Math.min(g,x.length)));r.dispatch({effects:[dialogEffect.of(!1),EditorView.scrollIntoView(E.from,{y:"center"})],selection:E}),r.focus()}return{dom:s}}const dialogEffect=StateEffect.define(),dialogField=StateField.define({create(){return!0},update(r,e){for(let n of e.effects)n.is(dialogEffect)&&(r=n.value);return r},provide:r=>showPanel.from(r,e=>e?createLineDialog:null)}),gotoLine=r=>{let e=getPanel(r,createLineDialog);if(!e){let n=[dialogEffect.of(!0)];r.state.field(dialogField,!1)==null&&n.push(StateEffect.appendConfig.of([dialogField,baseTheme$1])),r.dispatch({effects:n}),e=getPanel(r,createLineDialog)}return e&&e.dom.querySelector("input").select(),!0},baseTheme$1=EditorView.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px",position:"relative","& label":{fontSize:"80%"},"& [name=close]":{position:"absolute",top:"0",bottom:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:"0"}}}),defaultHighlightOptions={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},highlightConfig=Facet.define({combine(r){return combineConfig(r,defaultHighlightOptions,{highlightWordAroundCursor:(e,n)=>e||n,minSelectionLength:Math.min,maxMatches:Math.min})}});function highlightSelectionMatches(r){return[defaultTheme,matchHighlighter]}const matchDeco=Decoration.mark({class:"cm-selectionMatch"}),mainMatchDeco=Decoration.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function insideWordBoundaries(r,e,n,s){return(n==0||r(e.sliceDoc(n-1,n))!=CharCategory.Word)&&(s==e.doc.length||r(e.sliceDoc(s,s+1))!=CharCategory.Word)}function insideWord(r,e,n,s){return r(e.sliceDoc(n,n+1))==CharCategory.Word&&r(e.sliceDoc(s-1,s))==CharCategory.Word}const matchHighlighter=ViewPlugin.fromClass(class{constructor(r){this.decorations=this.getDeco(r)}update(r){(r.selectionSet||r.docChanged||r.viewportChanged)&&(this.decorations=this.getDeco(r.view))}getDeco(r){let e=r.state.facet(highlightConfig),{state:n}=r,s=n.selection;if(s.ranges.length>1)return Decoration.none;let o=s.main,a,l=null;if(o.empty){if(!e.highlightWordAroundCursor)return Decoration.none;let u=n.wordAt(o.head);if(!u)return Decoration.none;l=n.charCategorizer(o.head),a=n.sliceDoc(u.from,u.to)}else{let u=o.to-o.from;if(u<e.minSelectionLength||u>200)return Decoration.none;if(e.wholeWords){if(a=n.sliceDoc(o.from,o.to),l=n.charCategorizer(o.head),!(insideWordBoundaries(l,n,o.from,o.to)&&insideWord(l,n,o.from,o.to)))return Decoration.none}else if(a=n.sliceDoc(o.from,o.to),!a)return Decoration.none}let c=[];for(let u of r.visibleRanges){let f=new SearchCursor(n.doc,a,u.from,u.to);for(;!f.next().done;){let{from:d,to:p}=f.value;if((!l||insideWordBoundaries(l,n,d,p))&&(o.empty&&d<=o.from&&p>=o.to?c.push(mainMatchDeco.range(d,p)):(d>=o.to||p<=o.from)&&c.push(matchDeco.range(d,p)),c.length>e.maxMatches))return Decoration.none}}return Decoration.set(c)}},{decorations:r=>r.decorations}),defaultTheme=EditorView.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),selectWord=({state:r,dispatch:e})=>{let{selection:n}=r,s=EditorSelection.create(n.ranges.map(o=>r.wordAt(o.head)||EditorSelection.cursor(o.head)),n.mainIndex);return s.eq(n)?!1:(e(r.update({selection:s})),!0)};function findNextOccurrence(r,e){let{main:n,ranges:s}=r.selection,o=r.wordAt(n.head),a=o&&o.from==n.from&&o.to==n.to;for(let l=!1,c=new SearchCursor(r.doc,e,s[s.length-1].to);;)if(c.next(),c.done){if(l)return null;c=new SearchCursor(r.doc,e,0,Math.max(0,s[s.length-1].from-1)),l=!0}else{if(l&&s.some(u=>u.from==c.value.from))continue;if(a){let u=r.wordAt(c.value.from);if(!u||u.from!=c.value.from||u.to!=c.value.to)continue}return c.value}}const selectNextOccurrence=({state:r,dispatch:e})=>{let{ranges:n}=r.selection;if(n.some(a=>a.from===a.to))return selectWord({state:r,dispatch:e});let s=r.sliceDoc(n[0].from,n[0].to);if(r.selection.ranges.some(a=>r.sliceDoc(a.from,a.to)!=s))return!1;let o=findNextOccurrence(r,s);return o?(e(r.update({selection:r.selection.addRange(EditorSelection.range(o.from,o.to),!1),effects:EditorView.scrollIntoView(o.to)})),!0):!1},searchConfigFacet=Facet.define({combine(r){return combineConfig(r,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new SearchPanel(e),scrollToMatch:e=>EditorView.scrollIntoView(e)})}});class SearchQuery{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||validRegExp(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(n,s)=>s=="n"?`
`:s=="r"?"\r":s=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new RegExpQuery(this):new StringQuery(this)}getCursor(e,n=0,s){let o=e.doc?e:EditorState.create({doc:e});return s==null&&(s=o.doc.length),this.regexp?regexpCursor(this,o,n,s):stringCursor(this,o,n,s)}}class QueryType{constructor(e){this.spec=e}}function stringCursor(r,e,n,s){return new SearchCursor(e.doc,r.unquoted,n,s,r.caseSensitive?void 0:o=>o.toLowerCase(),r.wholeWord?stringWordTest(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function stringWordTest(r,e){return(n,s,o,a)=>((a>n||a+o.length<s)&&(a=Math.max(0,n-2),o=r.sliceString(a,Math.min(r.length,s+2))),(e(charBefore(o,n-a))!=CharCategory.Word||e(charAfter(o,n-a))!=CharCategory.Word)&&(e(charAfter(o,s-a))!=CharCategory.Word||e(charBefore(o,s-a))!=CharCategory.Word))}class StringQuery extends QueryType{constructor(e){super(e)}nextMatch(e,n,s){let o=stringCursor(this.spec,e,s,e.doc.length).nextOverlapping();if(o.done){let a=Math.min(e.doc.length,n+this.spec.unquoted.length);o=stringCursor(this.spec,e,0,a).nextOverlapping()}return o.done||o.value.from==n&&o.value.to==s?null:o.value}prevMatchInRange(e,n,s){for(let o=s;;){let a=Math.max(n,o-1e4-this.spec.unquoted.length),l=stringCursor(this.spec,e,a,o),c=null;for(;!l.nextOverlapping().done;)c=l.value;if(c)return c;if(a==n)return null;o-=1e4}}prevMatch(e,n,s){let o=this.prevMatchInRange(e,0,n);return o||(o=this.prevMatchInRange(e,Math.max(0,s-this.spec.unquoted.length),e.doc.length)),o&&(o.from!=n||o.to!=s)?o:null}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,n){let s=stringCursor(this.spec,e,0,e.doc.length),o=[];for(;!s.next().done;){if(o.length>=n)return null;o.push(s.value)}return o}highlight(e,n,s,o){let a=stringCursor(this.spec,e,Math.max(0,n-this.spec.unquoted.length),Math.min(s+this.spec.unquoted.length,e.doc.length));for(;!a.next().done;)o(a.value.from,a.value.to)}}function regexpCursor(r,e,n,s){return new RegExpCursor(e.doc,r.search,{ignoreCase:!r.caseSensitive,test:r.wholeWord?regexpWordTest(e.charCategorizer(e.selection.main.head)):void 0},n,s)}function charBefore(r,e){return r.slice(findClusterBreak(r,e,!1),e)}function charAfter(r,e){return r.slice(e,findClusterBreak(r,e))}function regexpWordTest(r){return(e,n,s)=>!s[0].length||(r(charBefore(s.input,s.index))!=CharCategory.Word||r(charAfter(s.input,s.index))!=CharCategory.Word)&&(r(charAfter(s.input,s.index+s[0].length))!=CharCategory.Word||r(charBefore(s.input,s.index+s[0].length))!=CharCategory.Word)}class RegExpQuery extends QueryType{nextMatch(e,n,s){let o=regexpCursor(this.spec,e,s,e.doc.length).next();return o.done&&(o=regexpCursor(this.spec,e,0,n).next()),o.done?null:o.value}prevMatchInRange(e,n,s){for(let o=1;;o++){let a=Math.max(n,s-o*1e4),l=regexpCursor(this.spec,e,a,s),c=null;for(;!l.next().done;)c=l.value;if(c&&(a==n||c.from>a+10))return c;if(a==n)return null}}prevMatch(e,n,s){return this.prevMatchInRange(e,0,n)||this.prevMatchInRange(e,s,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,(n,s)=>{if(s=="&")return e.match[0];if(s=="$")return"$";for(let o=s.length;o>0;o--){let a=+s.slice(0,o);if(a>0&&a<e.match.length)return e.match[a]+s.slice(o)}return n})}matchAll(e,n){let s=regexpCursor(this.spec,e,0,e.doc.length),o=[];for(;!s.next().done;){if(o.length>=n)return null;o.push(s.value)}return o}highlight(e,n,s,o){let a=regexpCursor(this.spec,e,Math.max(0,n-250),Math.min(s+250,e.doc.length));for(;!a.next().done;)o(a.value.from,a.value.to)}}const setSearchQuery=StateEffect.define(),togglePanel=StateEffect.define(),searchState=StateField.define({create(r){return new SearchState(defaultQuery(r).create(),null)},update(r,e){for(let n of e.effects)n.is(setSearchQuery)?r=new SearchState(n.value.create(),r.panel):n.is(togglePanel)&&(r=new SearchState(r.query,n.value?createSearchPanel:null));return r},provide:r=>showPanel.from(r,e=>e.panel)});class SearchState{constructor(e,n){this.query=e,this.panel=n}}const matchMark=Decoration.mark({class:"cm-searchMatch"}),selectedMatchMark=Decoration.mark({class:"cm-searchMatch cm-searchMatch-selected"}),searchHighlighter=ViewPlugin.fromClass(class{constructor(r){this.view=r,this.decorations=this.highlight(r.state.field(searchState))}update(r){let e=r.state.field(searchState);(e!=r.startState.field(searchState)||r.docChanged||r.selectionSet||r.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:r,panel:e}){if(!e||!r.spec.valid)return Decoration.none;let{view:n}=this,s=new RangeSetBuilder;for(let o=0,a=n.visibleRanges,l=a.length;o<l;o++){let{from:c,to:u}=a[o];for(;o<l-1&&u>a[o+1].from-2*250;)u=a[++o].to;r.highlight(n.state,c,u,(f,d)=>{let p=n.state.selection.ranges.some(g=>g.from==f&&g.to==d);s.add(f,d,p?selectedMatchMark:matchMark)})}return s.finish()}},{decorations:r=>r.decorations});function searchCommand(r){return e=>{let n=e.state.field(searchState,!1);return n&&n.query.spec.valid?r(e,n):openSearchPanel(e)}}const findNext=searchCommand((r,{query:e})=>{let{to:n}=r.state.selection.main,s=e.nextMatch(r.state,n,n);if(!s)return!1;let o=EditorSelection.single(s.from,s.to),a=r.state.facet(searchConfigFacet);return r.dispatch({selection:o,effects:[announceMatch(r,s),a.scrollToMatch(o.main,r)],userEvent:"select.search"}),selectSearchInput(r),!0}),findPrevious=searchCommand((r,{query:e})=>{let{state:n}=r,{from:s}=n.selection.main,o=e.prevMatch(n,s,s);if(!o)return!1;let a=EditorSelection.single(o.from,o.to),l=r.state.facet(searchConfigFacet);return r.dispatch({selection:a,effects:[announceMatch(r,o),l.scrollToMatch(a.main,r)],userEvent:"select.search"}),selectSearchInput(r),!0}),selectMatches=searchCommand((r,{query:e})=>{let n=e.matchAll(r.state,1e3);return!n||!n.length?!1:(r.dispatch({selection:EditorSelection.create(n.map(s=>EditorSelection.range(s.from,s.to))),userEvent:"select.search.matches"}),!0)}),selectSelectionMatches=({state:r,dispatch:e})=>{let n=r.selection;if(n.ranges.length>1||n.main.empty)return!1;let{from:s,to:o}=n.main,a=[],l=0;for(let c=new SearchCursor(r.doc,r.sliceDoc(s,o));!c.next().done;){if(a.length>1e3)return!1;c.value.from==s&&(l=a.length),a.push(EditorSelection.range(c.value.from,c.value.to))}return e(r.update({selection:EditorSelection.create(a,l),userEvent:"select.search.matches"})),!0},replaceNext=searchCommand((r,{query:e})=>{let{state:n}=r,{from:s,to:o}=n.selection.main;if(n.readOnly)return!1;let a=e.nextMatch(n,s,s);if(!a)return!1;let l=a,c=[],u,f,d=[];l.from==s&&l.to==o&&(f=n.toText(e.getReplacement(l)),c.push({from:l.from,to:l.to,insert:f}),l=e.nextMatch(n,l.from,l.to),d.push(EditorView.announce.of(n.phrase("replaced match on line $",n.doc.lineAt(s).number)+".")));let p=r.state.changes(c);return l&&(u=EditorSelection.single(l.from,l.to).map(p),d.push(announceMatch(r,l)),d.push(n.facet(searchConfigFacet).scrollToMatch(u.main,r))),r.dispatch({changes:p,selection:u,effects:d,userEvent:"input.replace"}),!0}),replaceAll=searchCommand((r,{query:e})=>{if(r.state.readOnly)return!1;let n=e.matchAll(r.state,1e9).map(o=>{let{from:a,to:l}=o;return{from:a,to:l,insert:e.getReplacement(o)}});if(!n.length)return!1;let s=r.state.phrase("replaced $ matches",n.length)+".";return r.dispatch({changes:n,effects:EditorView.announce.of(s),userEvent:"input.replace.all"}),!0});function createSearchPanel(r){return r.state.facet(searchConfigFacet).createPanel(r)}function defaultQuery(r,e){var n,s,o,a,l;let c=r.selection.main,u=c.empty||c.to>c.from+100?"":r.sliceDoc(c.from,c.to);if(e&&!u)return e;let f=r.facet(searchConfigFacet);return new SearchQuery({search:((n=e?.literal)!==null&&n!==void 0?n:f.literal)?u:u.replace(/\n/g,"\\n"),caseSensitive:(s=e?.caseSensitive)!==null&&s!==void 0?s:f.caseSensitive,literal:(o=e?.literal)!==null&&o!==void 0?o:f.literal,regexp:(a=e?.regexp)!==null&&a!==void 0?a:f.regexp,wholeWord:(l=e?.wholeWord)!==null&&l!==void 0?l:f.wholeWord})}function getSearchInput(r){let e=getPanel(r,createSearchPanel);return e&&e.dom.querySelector("[main-field]")}function selectSearchInput(r){let e=getSearchInput(r);e&&e==r.root.activeElement&&e.select()}const openSearchPanel=r=>{let e=r.state.field(searchState,!1);if(e&&e.panel){let n=getSearchInput(r);if(n&&n!=r.root.activeElement){let s=defaultQuery(r.state,e.query.spec);s.valid&&r.dispatch({effects:setSearchQuery.of(s)}),n.focus(),n.select()}}else r.dispatch({effects:[togglePanel.of(!0),e?setSearchQuery.of(defaultQuery(r.state,e.query.spec)):StateEffect.appendConfig.of(searchExtensions)]});return!0},closeSearchPanel=r=>{let e=r.state.field(searchState,!1);if(!e||!e.panel)return!1;let n=getPanel(r,createSearchPanel);return n&&n.dom.contains(r.root.activeElement)&&r.focus(),r.dispatch({effects:togglePanel.of(!1)}),!0},searchKeymap=[{key:"Mod-f",run:openSearchPanel,scope:"editor search-panel"},{key:"F3",run:findNext,shift:findPrevious,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:findNext,shift:findPrevious,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:closeSearchPanel,scope:"editor search-panel"},{key:"Mod-Shift-l",run:selectSelectionMatches},{key:"Mod-Alt-g",run:gotoLine},{key:"Mod-d",run:selectNextOccurrence,preventDefault:!0}];class SearchPanel{constructor(e){this.view=e;let n=this.query=e.state.field(searchState).query.spec;this.commit=this.commit.bind(this),this.searchField=crelt("input",{value:n.search,placeholder:phrase(e,"Find"),"aria-label":phrase(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=crelt("input",{value:n.replace,placeholder:phrase(e,"Replace"),"aria-label":phrase(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=crelt("input",{type:"checkbox",name:"case",form:"",checked:n.caseSensitive,onchange:this.commit}),this.reField=crelt("input",{type:"checkbox",name:"re",form:"",checked:n.regexp,onchange:this.commit}),this.wordField=crelt("input",{type:"checkbox",name:"word",form:"",checked:n.wholeWord,onchange:this.commit});function s(o,a,l){return crelt("button",{class:"cm-button",name:o,onclick:a,type:"button"},l)}this.dom=crelt("div",{onkeydown:o=>this.keydown(o),class:"cm-search"},[this.searchField,s("next",()=>findNext(e),[phrase(e,"next")]),s("prev",()=>findPrevious(e),[phrase(e,"previous")]),s("select",()=>selectMatches(e),[phrase(e,"all")]),crelt("label",null,[this.caseField,phrase(e,"match case")]),crelt("label",null,[this.reField,phrase(e,"regexp")]),crelt("label",null,[this.wordField,phrase(e,"by word")]),...e.state.readOnly?[]:[crelt("br"),this.replaceField,s("replace",()=>replaceNext(e),[phrase(e,"replace")]),s("replaceAll",()=>replaceAll(e),[phrase(e,"replace all")])],crelt("button",{name:"close",onclick:()=>closeSearchPanel(e),"aria-label":phrase(e,"close"),type:"button"},[""])])}commit(){let e=new SearchQuery({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:setSearchQuery.of(e)}))}keydown(e){runScopeHandlers(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?findPrevious:findNext)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),replaceNext(this.view))}update(e){for(let n of e.transactions)for(let s of n.effects)s.is(setSearchQuery)&&!s.value.eq(this.query)&&this.setQuery(s.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(searchConfigFacet).top}}function phrase(r,e){return r.state.phrase(e)}const AnnounceMargin=30,Break=/[\s\.,:;?!]/;function announceMatch(r,{from:e,to:n}){let s=r.state.doc.lineAt(e),o=r.state.doc.lineAt(n).to,a=Math.max(s.from,e-AnnounceMargin),l=Math.min(o,n+AnnounceMargin),c=r.state.sliceDoc(a,l);if(a!=s.from){for(let u=0;u<AnnounceMargin;u++)if(!Break.test(c[u+1])&&Break.test(c[u])){c=c.slice(u);break}}if(l!=o){for(let u=c.length-1;u>c.length-AnnounceMargin;u--)if(!Break.test(c[u-1])&&Break.test(c[u])){c=c.slice(0,u);break}}return EditorView.announce.of(`${r.state.phrase("current match")}. ${c} ${r.state.phrase("on line")} ${s.number}.`)}const baseTheme$2=EditorView.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),searchExtensions=[searchState,Prec.low(searchHighlighter),baseTheme$2];class CompletionContext{constructor(e,n,s,o){this.state=e,this.pos=n,this.explicit=s,this.view=o,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let n=syntaxTree(this.state).resolveInner(this.pos,-1);for(;n&&e.indexOf(n.name)<0;)n=n.parent;return n?{from:n.from,to:this.pos,text:this.state.sliceDoc(n.from,this.pos),type:n.type}:null}matchBefore(e){let n=this.state.doc.lineAt(this.pos),s=Math.max(n.from,this.pos-250),o=n.text.slice(s-n.from,this.pos-n.from),a=o.search(ensureAnchor(e,!1));return a<0?null:{from:s+a,to:this.pos,text:o.slice(a)}}get aborted(){return this.abortListeners==null}addEventListener(e,n,s){e=="abort"&&this.abortListeners&&(this.abortListeners.push(n),s&&s.onDocChange&&(this.abortOnDocChange=!0))}}function toSet(r){let e=Object.keys(r).join(""),n=/\w/.test(e);return n&&(e=e.replace(/\w/g,"")),`[${n?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function prefixMatch(r){let e=Object.create(null),n=Object.create(null);for(let{label:o}of r){e[o[0]]=!0;for(let a=1;a<o.length;a++)n[o[a]]=!0}let s=toSet(e)+toSet(n)+"*$";return[new RegExp("^"+s),new RegExp(s)]}function completeFromList(r){let e=r.map(o=>typeof o=="string"?{label:o}:o),[n,s]=e.every(o=>/^\w+$/.test(o.label))?[/\w*$/,/\w+$/]:prefixMatch(e);return o=>{let a=o.matchBefore(s);return a||o.explicit?{from:a?a.from:o.pos,options:e,validFor:n}:null}}function ifNotIn(r,e){return n=>{for(let s=syntaxTree(n.state).resolveInner(n.pos,-1);s;s=s.parent){if(r.indexOf(s.name)>-1)return null;if(s.type.isTop)break}return e(n)}}class Option{constructor(e,n,s,o){this.completion=e,this.source=n,this.match=s,this.score=o}}function cur(r){return r.selection.main.from}function ensureAnchor(r,e){var n;let{source:s}=r,o=e&&s[0]!="^",a=s[s.length-1]!="$";return!o&&!a?r:new RegExp(`${o?"^":""}(?:${s})${a?"$":""}`,(n=r.flags)!==null&&n!==void 0?n:r.ignoreCase?"i":"")}const pickedCompletion=Annotation.define();function insertCompletionText(r,e,n,s){let{main:o}=r.selection,a=n-o.from,l=s-o.from;return Object.assign(Object.assign({},r.changeByRange(c=>{if(c!=o&&n!=s&&r.sliceDoc(c.from+a,c.from+l)!=r.sliceDoc(n,s))return{range:c};let u=r.toText(e);return{changes:{from:c.from+a,to:s==o.from?c.to:c.from+l,insert:u},range:EditorSelection.cursor(c.from+a+u.length)}})),{scrollIntoView:!0,userEvent:"input.complete"})}const SourceCache=new WeakMap;function asSource(r){if(!Array.isArray(r))return r;let e=SourceCache.get(r);return e||SourceCache.set(r,e=completeFromList(r)),e}const startCompletionEffect=StateEffect.define(),closeCompletionEffect=StateEffect.define();class FuzzyMatcher{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let n=0;n<e.length;){let s=codePointAt(e,n),o=codePointSize(s);this.chars.push(s);let a=e.slice(n,n+o),l=a.toUpperCase();this.folded.push(codePointAt(l==a?a.toLowerCase():l,0)),n+=o}this.astral=e.length!=this.chars.length}ret(e,n){return this.score=e,this.matched=n,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:n,folded:s,any:o,precise:a,byWord:l}=this;if(n.length==1){let te=codePointAt(e,0),ne=codePointSize(te),Ve=ne==e.length?0:-100;if(te!=n[0])if(te==s[0])Ve+=-200;else return null;return this.ret(Ve,[0,ne])}let c=e.indexOf(this.pattern);if(c==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let u=n.length,f=0;if(c<0){for(let te=0,ne=Math.min(e.length,200);te<ne&&f<u;){let Ve=codePointAt(e,te);(Ve==n[f]||Ve==s[f])&&(o[f++]=te),te+=codePointSize(Ve)}if(f<u)return null}let d=0,p=0,g=!1,y=0,x=-1,E=-1,Y=/[a-z]/.test(e),Z=!0;for(let te=0,ne=Math.min(e.length,200),Ve=0;te<ne&&p<u;){let me=codePointAt(e,te);c<0&&(d<u&&me==n[d]&&(a[d++]=te),y<u&&(me==n[y]||me==s[y]?(y==0&&(x=te),E=te+1,y++):y=0));let rt,nt=me<255?me>=48&&me<=57||me>=97&&me<=122?2:me>=65&&me<=90?1:0:(rt=fromCodePoint(me))!=rt.toLowerCase()?1:rt!=rt.toUpperCase()?2:0;(!te||nt==1&&Y||Ve==0&&nt!=0)&&(n[p]==me||s[p]==me&&(g=!0)?l[p++]=te:l.length&&(Z=!1)),Ve=nt,te+=codePointSize(me)}return p==u&&l[0]==0&&Z?this.result(-100+(g?-200:0),l,e):y==u&&x==0?this.ret(-200-e.length+(E==e.length?0:-100),[0,E]):c>-1?this.ret(-700-e.length,[c,c+this.pattern.length]):y==u?this.ret(-900-e.length,[x,E]):p==u?this.result(-100+(g?-200:0)+-700+(Z?0:-1100),l,e):n.length==2?null:this.result((o[0]?-700:0)+-200+-1100,o,e)}result(e,n,s){let o=[],a=0;for(let l of n){let c=l+(this.astral?codePointSize(codePointAt(s,l)):1);a&&o[a-1]==l?o[a-1]=c:(o[a++]=l,o[a++]=c)}return this.ret(e-s.length,o)}}class StrictMatcher{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let n=e.slice(0,this.pattern.length),s=n==this.pattern?0:n.toLowerCase()==this.folded?-200:null;return s==null?null:(this.matched=[0,n.length],this.score=s+(e.length==this.pattern.length?0:-100),this)}}const completionConfig=Facet.define({combine(r){return combineConfig(r,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:defaultPositionInfo,filterStrict:!1,compareCompletions:(e,n)=>e.label.localeCompare(n.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,n)=>e&&n,closeOnBlur:(e,n)=>e&&n,icons:(e,n)=>e&&n,tooltipClass:(e,n)=>s=>joinClass(e(s),n(s)),optionClass:(e,n)=>s=>joinClass(e(s),n(s)),addToOptions:(e,n)=>e.concat(n),filterStrict:(e,n)=>e||n})}});function joinClass(r,e){return r?e?r+" "+e:r:e}function defaultPositionInfo(r,e,n,s,o,a){let l=r.textDirection==Direction.RTL,c=l,u=!1,f="top",d,p,g=e.left-o.left,y=o.right-e.right,x=s.right-s.left,E=s.bottom-s.top;if(c&&g<Math.min(x,y)?c=!1:!c&&y<Math.min(x,g)&&(c=!0),x<=(c?g:y))d=Math.max(o.top,Math.min(n.top,o.bottom-E))-e.top,p=Math.min(400,c?g:y);else{u=!0,p=Math.min(400,(l?e.right:o.right-e.left)-30);let te=o.bottom-e.bottom;te>=E||te>e.top?d=n.bottom-e.top:(f="bottom",d=e.bottom-n.top)}let Y=(e.bottom-e.top)/a.offsetHeight,Z=(e.right-e.left)/a.offsetWidth;return{style:`${f}: ${d/Y}px; max-width: ${p/Z}px`,class:"cm-completionInfo-"+(u?l?"left-narrow":"right-narrow":c?"left":"right")}}function optionContent(r){let e=r.addToOptions.slice();return r.icons&&e.push({render(n){let s=document.createElement("div");return s.classList.add("cm-completionIcon"),n.type&&s.classList.add(...n.type.split(/\s+/g).map(o=>"cm-completionIcon-"+o)),s.setAttribute("aria-hidden","true"),s},position:20}),e.push({render(n,s,o,a){let l=document.createElement("span");l.className="cm-completionLabel";let c=n.displayLabel||n.label,u=0;for(let f=0;f<a.length;){let d=a[f++],p=a[f++];d>u&&l.appendChild(document.createTextNode(c.slice(u,d)));let g=l.appendChild(document.createElement("span"));g.appendChild(document.createTextNode(c.slice(d,p))),g.className="cm-completionMatchedText",u=p}return u<c.length&&l.appendChild(document.createTextNode(c.slice(u))),l},position:50},{render(n){if(!n.detail)return null;let s=document.createElement("span");return s.className="cm-completionDetail",s.textContent=n.detail,s},position:80}),e.sort((n,s)=>n.position-s.position).map(n=>n.render)}function rangeAroundSelected(r,e,n){if(r<=n)return{from:0,to:r};if(e<0&&(e=0),e<=r>>1){let o=Math.floor(e/n);return{from:o*n,to:(o+1)*n}}let s=Math.floor((r-e)/n);return{from:r-(s+1)*n,to:r-s*n}}class CompletionTooltip{constructor(e,n,s){this.view=e,this.stateField=n,this.applyCompletion=s,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:u=>this.placeInfo(u),key:this},this.space=null,this.currentClass="";let o=e.state.field(n),{options:a,selected:l}=o.open,c=e.state.facet(completionConfig);this.optionContent=optionContent(c),this.optionClass=c.optionClass,this.tooltipClass=c.tooltipClass,this.range=rangeAroundSelected(a.length,l,c.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",u=>{let{options:f}=e.state.field(n).open;for(let d=u.target,p;d&&d!=this.dom;d=d.parentNode)if(d.nodeName=="LI"&&(p=/-(\d+)$/.exec(d.id))&&+p[1]<f.length){this.applyCompletion(e,f[+p[1]]),u.preventDefault();return}}),this.dom.addEventListener("focusout",u=>{let f=e.state.field(this.stateField,!1);f&&f.tooltip&&e.state.facet(completionConfig).closeOnBlur&&u.relatedTarget!=e.contentDOM&&e.dispatch({effects:closeCompletionEffect.of(null)})}),this.showOptions(a,o.id)}mount(){this.updateSel()}showOptions(e,n){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,n,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var n;let s=e.state.field(this.stateField),o=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),s!=o){let{options:a,selected:l,disabled:c}=s.open;(!o.open||o.open.options!=a)&&(this.range=rangeAroundSelected(a.length,l,e.state.facet(completionConfig).maxRenderedOptions),this.showOptions(a,s.id)),this.updateSel(),c!=((n=o.open)===null||n===void 0?void 0:n.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!c)}}updateTooltipClass(e){let n=this.tooltipClass(e);if(n!=this.currentClass){for(let s of this.currentClass.split(" "))s&&this.dom.classList.remove(s);for(let s of n.split(" "))s&&this.dom.classList.add(s);this.currentClass=n}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),n=e.open;if((n.selected>-1&&n.selected<this.range.from||n.selected>=this.range.to)&&(this.range=rangeAroundSelected(n.options.length,n.selected,this.view.state.facet(completionConfig).maxRenderedOptions),this.showOptions(n.options,e.id)),this.updateSelectedOption(n.selected)){this.destroyInfo();let{completion:s}=n.options[n.selected],{info:o}=s;if(!o)return;let a=typeof o=="string"?document.createTextNode(o):o(s);if(!a)return;"then"in a?a.then(l=>{l&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(l,s)}).catch(l=>logException(this.view.state,l,"completion info")):this.addInfoPane(a,s)}}addInfoPane(e,n){this.destroyInfo();let s=this.info=document.createElement("div");if(s.className="cm-tooltip cm-completionInfo",e.nodeType!=null)s.appendChild(e),this.infoDestroy=null;else{let{dom:o,destroy:a}=e;s.appendChild(o),this.infoDestroy=a||null}this.dom.appendChild(s),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let n=null;for(let s=this.list.firstChild,o=this.range.from;s;s=s.nextSibling,o++)s.nodeName!="LI"||!s.id?o--:o==e?s.hasAttribute("aria-selected")||(s.setAttribute("aria-selected","true"),n=s):s.hasAttribute("aria-selected")&&s.removeAttribute("aria-selected");return n&&scrollIntoView(this.list,n),n}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let n=this.dom.getBoundingClientRect(),s=this.info.getBoundingClientRect(),o=e.getBoundingClientRect(),a=this.space;if(!a){let l=this.dom.ownerDocument.documentElement;a={left:0,top:0,right:l.clientWidth,bottom:l.clientHeight}}return o.top>Math.min(a.bottom,n.bottom)-10||o.bottom<Math.max(a.top,n.top)+10?null:this.view.state.facet(completionConfig).positionInfo(this.view,n,o,s,a,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,n,s){const o=document.createElement("ul");o.id=n,o.setAttribute("role","listbox"),o.setAttribute("aria-expanded","true"),o.setAttribute("aria-label",this.view.state.phrase("Completions")),o.addEventListener("mousedown",l=>{l.target==o&&l.preventDefault()});let a=null;for(let l=s.from;l<s.to;l++){let{completion:c,match:u}=e[l],{section:f}=c;if(f){let g=typeof f=="string"?f:f.name;if(g!=a&&(l>s.from||s.from==0))if(a=g,typeof f!="string"&&f.header)o.appendChild(f.header(f));else{let y=o.appendChild(document.createElement("completion-section"));y.textContent=g}}const d=o.appendChild(document.createElement("li"));d.id=n+"-"+l,d.setAttribute("role","option");let p=this.optionClass(c);p&&(d.className=p);for(let g of this.optionContent){let y=g(c,this.view.state,this.view,u);y&&d.appendChild(y)}}return s.from&&o.classList.add("cm-completionListIncompleteTop"),s.to<e.length&&o.classList.add("cm-completionListIncompleteBottom"),o}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function completionTooltip(r,e){return n=>new CompletionTooltip(n,r,e)}function scrollIntoView(r,e){let n=r.getBoundingClientRect(),s=e.getBoundingClientRect(),o=n.height/r.offsetHeight;s.top<n.top?r.scrollTop-=(n.top-s.top)/o:s.bottom>n.bottom&&(r.scrollTop+=(s.bottom-n.bottom)/o)}function score(r){return(r.boost||0)*100+(r.apply?10:0)+(r.info?5:0)+(r.type?1:0)}function sortOptions(r,e){let n=[],s=null,o=f=>{n.push(f);let{section:d}=f.completion;if(d){s||(s=[]);let p=typeof d=="string"?d:d.name;s.some(g=>g.name==p)||s.push(typeof d=="string"?{name:p}:d)}},a=e.facet(completionConfig);for(let f of r)if(f.hasResult()){let d=f.result.getMatch;if(f.result.filter===!1)for(let p of f.result.options)o(new Option(p,f.source,d?d(p):[],1e9-n.length));else{let p=e.sliceDoc(f.from,f.to),g,y=a.filterStrict?new StrictMatcher(p):new FuzzyMatcher(p);for(let x of f.result.options)if(g=y.match(x.label)){let E=x.displayLabel?d?d(x,g.matched):[]:g.matched;o(new Option(x,f.source,E,g.score+(x.boost||0)))}}}if(s){let f=Object.create(null),d=0,p=(g,y)=>{var x,E;return((x=g.rank)!==null&&x!==void 0?x:1e9)-((E=y.rank)!==null&&E!==void 0?E:1e9)||(g.name<y.name?-1:1)};for(let g of s.sort(p))d-=1e5,f[g.name]=d;for(let g of n){let{section:y}=g.completion;y&&(g.score+=f[typeof y=="string"?y:y.name])}}let l=[],c=null,u=a.compareCompletions;for(let f of n.sort((d,p)=>p.score-d.score||u(d.completion,p.completion))){let d=f.completion;!c||c.label!=d.label||c.detail!=d.detail||c.type!=null&&d.type!=null&&c.type!=d.type||c.apply!=d.apply||c.boost!=d.boost?l.push(f):score(f.completion)>score(c)&&(l[l.length-1]=f),c=f.completion}return l}class CompletionDialog{constructor(e,n,s,o,a,l){this.options=e,this.attrs=n,this.tooltip=s,this.timestamp=o,this.selected=a,this.disabled=l}setSelected(e,n){return e==this.selected||e>=this.options.length?this:new CompletionDialog(this.options,makeAttrs(n,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,n,s,o,a,l){if(o&&!l&&e.some(f=>f.isPending))return o.setDisabled();let c=sortOptions(e,n);if(!c.length)return o&&e.some(f=>f.isPending)?o.setDisabled():null;let u=n.facet(completionConfig).selectOnOpen?0:-1;if(o&&o.selected!=u&&o.selected!=-1){let f=o.options[o.selected].completion;for(let d=0;d<c.length;d++)if(c[d].completion==f){u=d;break}}return new CompletionDialog(c,makeAttrs(s,u),{pos:e.reduce((f,d)=>d.hasResult()?Math.min(f,d.from):f,1e8),create:createTooltip,above:a.aboveCursor},o?o.timestamp:Date.now(),u,!1)}map(e){return new CompletionDialog(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}setDisabled(){return new CompletionDialog(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class CompletionState{constructor(e,n,s){this.active=e,this.id=n,this.open=s}static start(){return new CompletionState(none,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:n}=e,s=n.facet(completionConfig),a=(s.override||n.languageDataAt("autocomplete",cur(n)).map(asSource)).map(u=>(this.active.find(d=>d.source==u)||new ActiveSource(u,this.active.some(d=>d.state!=0)?1:0)).update(e,s));a.length==this.active.length&&a.every((u,f)=>u==this.active[f])&&(a=this.active);let l=this.open,c=e.effects.some(u=>u.is(setActiveEffect));l&&e.docChanged&&(l=l.map(e.changes)),e.selection||a.some(u=>u.hasResult()&&e.changes.touchesRange(u.from,u.to))||!sameResults(a,this.active)||c?l=CompletionDialog.build(a,n,this.id,l,s,c):l&&l.disabled&&!a.some(u=>u.isPending)&&(l=null),!l&&a.every(u=>!u.isPending)&&a.some(u=>u.hasResult())&&(a=a.map(u=>u.hasResult()?new ActiveSource(u.source,0):u));for(let u of e.effects)u.is(setSelectedEffect)&&(l=l&&l.setSelected(u.value,this.id));return a==this.active&&l==this.open?this:new CompletionState(a,this.id,l)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?baseAttrs:noAttrs}}function sameResults(r,e){if(r==e)return!0;for(let n=0,s=0;;){for(;n<r.length&&!r[n].hasResult();)n++;for(;s<e.length&&!e[s].hasResult();)s++;let o=n==r.length,a=s==e.length;if(o||a)return o==a;if(r[n++].result!=e[s++].result)return!1}}const baseAttrs={"aria-autocomplete":"list"},noAttrs={};function makeAttrs(r,e){let n={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":r};return e>-1&&(n["aria-activedescendant"]=r+"-"+e),n}const none=[];function getUpdateType(r,e){if(r.isUserEvent("input.complete")){let s=r.annotation(pickedCompletion);if(s&&e.activateOnCompletion(s))return 12}let n=r.isUserEvent("input.type");return n&&e.activateOnTyping?5:n?1:r.isUserEvent("delete.backward")?2:r.selection?8:r.docChanged?16:0}class ActiveSource{constructor(e,n,s=!1){this.source=e,this.state=n,this.explicit=s}hasResult(){return!1}get isPending(){return this.state==1}update(e,n){let s=getUpdateType(e,n),o=this;(s&8||s&16&&this.touches(e))&&(o=new ActiveSource(o.source,0)),s&4&&o.state==0&&(o=new ActiveSource(this.source,1)),o=o.updateFor(e,s);for(let a of e.effects)if(a.is(startCompletionEffect))o=new ActiveSource(o.source,1,a.value);else if(a.is(closeCompletionEffect))o=new ActiveSource(o.source,0);else if(a.is(setActiveEffect))for(let l of a.value)l.source==o.source&&(o=l);return o}updateFor(e,n){return this.map(e.changes)}map(e){return this}touches(e){return e.changes.touchesRange(cur(e.state))}}class ActiveResult extends ActiveSource{constructor(e,n,s,o,a,l){super(e,3,n),this.limit=s,this.result=o,this.from=a,this.to=l}hasResult(){return!0}updateFor(e,n){var s;if(!(n&3))return this.map(e.changes);let o=this.result;o.map&&!e.changes.empty&&(o=o.map(o,e.changes));let a=e.changes.mapPos(this.from),l=e.changes.mapPos(this.to,1),c=cur(e.state);if(c>l||!o||n&2&&(cur(e.startState)==this.from||c<this.limit))return new ActiveSource(this.source,n&4?1:0);let u=e.changes.mapPos(this.limit);return checkValid(o.validFor,e.state,a,l)?new ActiveResult(this.source,this.explicit,u,o,a,l):o.update&&(o=o.update(o,a,l,new CompletionContext(e.state,c,!1)))?new ActiveResult(this.source,this.explicit,u,o,o.from,(s=o.to)!==null&&s!==void 0?s:cur(e.state)):new ActiveSource(this.source,1,this.explicit)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new ActiveResult(this.source,this.explicit,e.mapPos(this.limit),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new ActiveSource(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}function checkValid(r,e,n,s){if(!r)return!1;let o=e.sliceDoc(n,s);return typeof r=="function"?r(o,n,s,e):ensureAnchor(r,!0).test(o)}const setActiveEffect=StateEffect.define({map(r,e){return r.map(n=>n.map(e))}}),setSelectedEffect=StateEffect.define(),completionState=StateField.define({create(){return CompletionState.start()},update(r,e){return r.update(e)},provide:r=>[showTooltip.from(r,e=>e.tooltip),EditorView.contentAttributes.from(r,e=>e.attrs)]});function applyCompletion(r,e){const n=e.completion.apply||e.completion.label;let s=r.state.field(completionState).active.find(o=>o.source==e.source);return s instanceof ActiveResult?(typeof n=="string"?r.dispatch(Object.assign(Object.assign({},insertCompletionText(r.state,n,s.from,s.to)),{annotations:pickedCompletion.of(e.completion)})):n(r,e.completion,s.from,s.to),!0):!1}const createTooltip=completionTooltip(completionState,applyCompletion);function moveCompletionSelection(r,e="option"){return n=>{let s=n.state.field(completionState,!1);if(!s||!s.open||s.open.disabled||Date.now()-s.open.timestamp<n.state.facet(completionConfig).interactionDelay)return!1;let o=1,a;e=="page"&&(a=getTooltip(n,s.open.tooltip))&&(o=Math.max(2,Math.floor(a.dom.offsetHeight/a.dom.querySelector("li").offsetHeight)-1));let{length:l}=s.open.options,c=s.open.selected>-1?s.open.selected+o*(r?1:-1):r?0:l-1;return c<0?c=e=="page"?0:l-1:c>=l&&(c=e=="page"?l-1:0),n.dispatch({effects:setSelectedEffect.of(c)}),!0}}const acceptCompletion=r=>{let e=r.state.field(completionState,!1);return r.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<r.state.facet(completionConfig).interactionDelay?!1:applyCompletion(r,e.open.options[e.open.selected])},startCompletion=r=>r.state.field(completionState,!1)?(r.dispatch({effects:startCompletionEffect.of(!0)}),!0):!1,closeCompletion=r=>{let e=r.state.field(completionState,!1);return!e||!e.active.some(n=>n.state!=0)?!1:(r.dispatch({effects:closeCompletionEffect.of(null)}),!0)};class RunningQuery{constructor(e,n){this.active=e,this.context=n,this.time=Date.now(),this.updates=[],this.done=void 0}}const MaxUpdateCount=50,MinAbortTime=1e3,completionPlugin=ViewPlugin.fromClass(class{constructor(r){this.view=r,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let e of r.state.field(completionState).active)e.isPending&&this.startQuery(e)}update(r){let e=r.state.field(completionState),n=r.state.facet(completionConfig);if(!r.selectionSet&&!r.docChanged&&r.startState.field(completionState)==e)return;let s=r.transactions.some(a=>{let l=getUpdateType(a,n);return l&8||(a.selection||a.docChanged)&&!(l&3)});for(let a=0;a<this.running.length;a++){let l=this.running[a];if(s||l.context.abortOnDocChange&&r.docChanged||l.updates.length+r.transactions.length>MaxUpdateCount&&Date.now()-l.time>MinAbortTime){for(let c of l.context.abortListeners)try{c()}catch(u){logException(this.view.state,u)}l.context.abortListeners=null,this.running.splice(a--,1)}else l.updates.push(...r.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),r.transactions.some(a=>a.effects.some(l=>l.is(startCompletionEffect)))&&(this.pendingStart=!0);let o=this.pendingStart?50:n.activateOnTypingDelay;if(this.debounceUpdate=e.active.some(a=>a.isPending&&!this.running.some(l=>l.active.source==a.source))?setTimeout(()=>this.startUpdate(),o):-1,this.composing!=0)for(let a of r.transactions)a.isUserEvent("input.type")?this.composing=2:this.composing==2&&a.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:r}=this.view,e=r.field(completionState);for(let n of e.active)n.isPending&&!this.running.some(s=>s.active.source==n.source)&&this.startQuery(n);this.running.length&&e.open&&e.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(completionConfig).updateSyncTime))}startQuery(r){let{state:e}=this.view,n=cur(e),s=new CompletionContext(e,n,r.explicit,this.view),o=new RunningQuery(r,s);this.running.push(o),Promise.resolve(r.source(s)).then(a=>{o.context.aborted||(o.done=a||null,this.scheduleAccept())},a=>{this.view.dispatch({effects:closeCompletionEffect.of(null)}),logException(this.view.state,a)})}scheduleAccept(){this.running.every(r=>r.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(completionConfig).updateSyncTime))}accept(){var r;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],n=this.view.state.facet(completionConfig),s=this.view.state.field(completionState);for(let o=0;o<this.running.length;o++){let a=this.running[o];if(a.done===void 0)continue;if(this.running.splice(o--,1),a.done){let c=cur(a.updates.length?a.updates[0].startState:this.view.state),u=Math.min(c,a.done.from+(a.active.explicit?0:1)),f=new ActiveResult(a.active.source,a.active.explicit,u,a.done,a.done.from,(r=a.done.to)!==null&&r!==void 0?r:c);for(let d of a.updates)f=f.update(d,n);if(f.hasResult()){e.push(f);continue}}let l=s.active.find(c=>c.source==a.active.source);if(l&&l.isPending)if(a.done==null){let c=new ActiveSource(a.active.source,0);for(let u of a.updates)c=c.update(u,n);c.isPending||e.push(c)}else this.startQuery(l)}(e.length||s.open&&s.open.disabled)&&this.view.dispatch({effects:setActiveEffect.of(e)})}},{eventHandlers:{blur(r){let e=this.view.state.field(completionState,!1);if(e&&e.tooltip&&this.view.state.facet(completionConfig).closeOnBlur){let n=e.open&&getTooltip(this.view,e.open.tooltip);(!n||!n.dom.contains(r.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:closeCompletionEffect.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:startCompletionEffect.of(!1)}),20),this.composing=0}}}),windows=typeof navigator=="object"&&/Win/.test(navigator.platform),commitCharacters=Prec.highest(EditorView.domEventHandlers({keydown(r,e){let n=e.state.field(completionState,!1);if(!n||!n.open||n.open.disabled||n.open.selected<0||r.key.length>1||r.ctrlKey&&!(windows&&r.altKey)||r.metaKey)return!1;let s=n.open.options[n.open.selected],o=n.active.find(l=>l.source==s.source),a=s.completion.commitCharacters||o.result.commitCharacters;return a&&a.indexOf(r.key)>-1&&applyCompletion(e,s),!1}})),baseTheme=EditorView.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'""',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"''"}},".cm-completionIcon-class":{"&:after":{content:"''"}},".cm-completionIcon-interface":{"&:after":{content:"''"}},".cm-completionIcon-variable":{"&:after":{content:"''"}},".cm-completionIcon-constant":{"&:after":{content:"''"}},".cm-completionIcon-type":{"&:after":{content:"''"}},".cm-completionIcon-enum":{"&:after":{content:"''"}},".cm-completionIcon-property":{"&:after":{content:"''"}},".cm-completionIcon-keyword":{"&:after":{content:"''"}},".cm-completionIcon-namespace":{"&:after":{content:"''"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class FieldPos{constructor(e,n,s,o){this.field=e,this.line=n,this.from=s,this.to=o}}class FieldRange{constructor(e,n,s){this.field=e,this.from=n,this.to=s}map(e){let n=e.mapPos(this.from,-1,MapMode.TrackDel),s=e.mapPos(this.to,1,MapMode.TrackDel);return n==null||s==null?null:new FieldRange(this.field,n,s)}}class Snippet{constructor(e,n){this.lines=e,this.fieldPositions=n}instantiate(e,n){let s=[],o=[n],a=e.doc.lineAt(n),l=/^\s*/.exec(a.text)[0];for(let u of this.lines){if(s.length){let f=l,d=/^\t*/.exec(u)[0].length;for(let p=0;p<d;p++)f+=e.facet(indentUnit);o.push(n+f.length-d),u=f+u.slice(d)}s.push(u),n+=u.length+1}let c=this.fieldPositions.map(u=>new FieldRange(u.field,o[u.line]+u.from,o[u.line]+u.to));return{text:s,ranges:c}}static parse(e){let n=[],s=[],o=[],a;for(let l of e.split(/\r\n?|\n/)){for(;a=/[#$]\{(?:(\d+)(?::([^}]*))?|((?:\\[{}]|[^}])*))\}/.exec(l);){let c=a[1]?+a[1]:null,u=a[2]||a[3]||"",f=-1,d=u.replace(/\\[{}]/g,p=>p[1]);for(let p=0;p<n.length;p++)(c!=null?n[p].seq==c:d&&n[p].name==d)&&(f=p);if(f<0){let p=0;for(;p<n.length&&(c==null||n[p].seq!=null&&n[p].seq<c);)p++;n.splice(p,0,{seq:c,name:d}),f=p;for(let g of o)g.field>=f&&g.field++}o.push(new FieldPos(f,s.length,a.index,a.index+d.length)),l=l.slice(0,a.index)+u+l.slice(a.index+a[0].length)}l=l.replace(/\\([{}])/g,(c,u,f)=>{for(let d of o)d.line==s.length&&d.from>f&&(d.from--,d.to--);return u}),s.push(l)}return new Snippet(s,o)}}let fieldMarker=Decoration.widget({widget:new class extends WidgetType{toDOM(){let r=document.createElement("span");return r.className="cm-snippetFieldPosition",r}ignoreEvent(){return!1}}}),fieldRange=Decoration.mark({class:"cm-snippetField"});class ActiveSnippet{constructor(e,n){this.ranges=e,this.active=n,this.deco=Decoration.set(e.map(s=>(s.from==s.to?fieldMarker:fieldRange).range(s.from,s.to)))}map(e){let n=[];for(let s of this.ranges){let o=s.map(e);if(!o)return null;n.push(o)}return new ActiveSnippet(n,this.active)}selectionInsideField(e){return e.ranges.every(n=>this.ranges.some(s=>s.field==this.active&&s.from<=n.from&&s.to>=n.to))}}const setActive=StateEffect.define({map(r,e){return r&&r.map(e)}}),moveToField=StateEffect.define(),snippetState=StateField.define({create(){return null},update(r,e){for(let n of e.effects){if(n.is(setActive))return n.value;if(n.is(moveToField)&&r)return new ActiveSnippet(r.ranges,n.value)}return r&&e.docChanged&&(r=r.map(e.changes)),r&&e.selection&&!r.selectionInsideField(e.selection)&&(r=null),r},provide:r=>EditorView.decorations.from(r,e=>e?e.deco:Decoration.none)});function fieldSelection(r,e){return EditorSelection.create(r.filter(n=>n.field==e).map(n=>EditorSelection.range(n.from,n.to)))}function snippet(r){let e=Snippet.parse(r);return(n,s,o,a)=>{let{text:l,ranges:c}=e.instantiate(n.state,o),{main:u}=n.state.selection,f={changes:{from:o,to:a==u.from?u.to:a,insert:Text.of(l)},scrollIntoView:!0,annotations:s?[pickedCompletion.of(s),Transaction.userEvent.of("input.complete")]:void 0};if(c.length&&(f.selection=fieldSelection(c,0)),c.some(d=>d.field>0)){let d=new ActiveSnippet(c,0),p=f.effects=[setActive.of(d)];n.state.field(snippetState,!1)===void 0&&p.push(StateEffect.appendConfig.of([snippetState,addSnippetKeymap,snippetPointerHandler,baseTheme]))}n.dispatch(n.state.update(f))}}function moveField(r){return({state:e,dispatch:n})=>{let s=e.field(snippetState,!1);if(!s||r<0&&s.active==0)return!1;let o=s.active+r,a=r>0&&!s.ranges.some(l=>l.field==o+r);return n(e.update({selection:fieldSelection(s.ranges,o),effects:setActive.of(a?null:new ActiveSnippet(s.ranges,o)),scrollIntoView:!0})),!0}}const clearSnippet=({state:r,dispatch:e})=>r.field(snippetState,!1)?(e(r.update({effects:setActive.of(null)})),!0):!1,nextSnippetField=moveField(1),prevSnippetField=moveField(-1),defaultSnippetKeymap=[{key:"Tab",run:nextSnippetField,shift:prevSnippetField},{key:"Escape",run:clearSnippet}],snippetKeymap=Facet.define({combine(r){return r.length?r[0]:defaultSnippetKeymap}}),addSnippetKeymap=Prec.highest(keymap.compute([snippetKeymap],r=>r.facet(snippetKeymap)));function snippetCompletion(r,e){return Object.assign(Object.assign({},e),{apply:snippet(r)})}const snippetPointerHandler=EditorView.domEventHandlers({mousedown(r,e){let n=e.state.field(snippetState,!1),s;if(!n||(s=e.posAtCoords({x:r.clientX,y:r.clientY}))==null)return!1;let o=n.ranges.find(a=>a.from<=s&&a.to>=s);return!o||o.field==n.active?!1:(e.dispatch({selection:fieldSelection(n.ranges,o.field),effects:setActive.of(n.ranges.some(a=>a.field>o.field)?new ActiveSnippet(n.ranges,o.field):null),scrollIntoView:!0}),!0)}}),defaults={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},closeBracketEffect=StateEffect.define({map(r,e){let n=e.mapPos(r,-1,MapMode.TrackAfter);return n??void 0}}),closedBracket=new class extends RangeValue{};closedBracket.startSide=1;closedBracket.endSide=-1;const bracketState=StateField.define({create(){return RangeSet.empty},update(r,e){if(r=r.map(e.changes),e.selection){let n=e.state.doc.lineAt(e.selection.main.head);r=r.update({filter:s=>s>=n.from&&s<=n.to})}for(let n of e.effects)n.is(closeBracketEffect)&&(r=r.update({add:[closedBracket.range(n.value,n.value+1)]}));return r}});function closeBrackets(){return[inputHandler,bracketState]}const definedClosing="()[]{}<>";function closing(r){for(let e=0;e<definedClosing.length;e+=2)if(definedClosing.charCodeAt(e)==r)return definedClosing.charAt(e+1);return fromCodePoint(r<128?r:r+1)}function config$1(r,e){return r.languageDataAt("closeBrackets",e)[0]||defaults}const android=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),inputHandler=EditorView.inputHandler.of((r,e,n,s)=>{if((android?r.composing:r.compositionStarted)||r.state.readOnly)return!1;let o=r.state.selection.main;if(s.length>2||s.length==2&&codePointSize(codePointAt(s,0))==1||e!=o.from||n!=o.to)return!1;let a=insertBracket(r.state,s);return a?(r.dispatch(a),!0):!1}),deleteBracketPair=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let s=config$1(r,r.selection.main.head).brackets||defaults.brackets,o=null,a=r.changeByRange(l=>{if(l.empty){let c=prevChar(r.doc,l.head);for(let u of s)if(u==c&&nextChar(r.doc,l.head)==closing(codePointAt(u,0)))return{changes:{from:l.head-u.length,to:l.head+u.length},range:EditorSelection.cursor(l.head-u.length)}}return{range:o=l}});return o||e(r.update(a,{scrollIntoView:!0,userEvent:"delete.backward"})),!o},closeBracketsKeymap=[{key:"Backspace",run:deleteBracketPair}];function insertBracket(r,e){let n=config$1(r,r.selection.main.head),s=n.brackets||defaults.brackets;for(let o of s){let a=closing(codePointAt(o,0));if(e==o)return a==o?handleSame(r,o,s.indexOf(o+o+o)>-1,n):handleOpen(r,o,a,n.before||defaults.before);if(e==a&&closedBracketAt(r,r.selection.main.from))return handleClose(r,o,a)}return null}function closedBracketAt(r,e){let n=!1;return r.field(bracketState).between(0,r.doc.length,s=>{s==e&&(n=!0)}),n}function nextChar(r,e){let n=r.sliceString(e,e+2);return n.slice(0,codePointSize(codePointAt(n,0)))}function prevChar(r,e){let n=r.sliceString(e-2,e);return codePointSize(codePointAt(n,0))==n.length?n:n.slice(1)}function handleOpen(r,e,n,s){let o=null,a=r.changeByRange(l=>{if(!l.empty)return{changes:[{insert:e,from:l.from},{insert:n,from:l.to}],effects:closeBracketEffect.of(l.to+e.length),range:EditorSelection.range(l.anchor+e.length,l.head+e.length)};let c=nextChar(r.doc,l.head);return!c||/\s/.test(c)||s.indexOf(c)>-1?{changes:{insert:e+n,from:l.head},effects:closeBracketEffect.of(l.head+e.length),range:EditorSelection.cursor(l.head+e.length)}:{range:o=l}});return o?null:r.update(a,{scrollIntoView:!0,userEvent:"input.type"})}function handleClose(r,e,n){let s=null,o=r.changeByRange(a=>a.empty&&nextChar(r.doc,a.head)==n?{changes:{from:a.head,to:a.head+n.length,insert:n},range:EditorSelection.cursor(a.head+n.length)}:s={range:a});return s?null:r.update(o,{scrollIntoView:!0,userEvent:"input.type"})}function handleSame(r,e,n,s){let o=s.stringPrefixes||defaults.stringPrefixes,a=null,l=r.changeByRange(c=>{if(!c.empty)return{changes:[{insert:e,from:c.from},{insert:e,from:c.to}],effects:closeBracketEffect.of(c.to+e.length),range:EditorSelection.range(c.anchor+e.length,c.head+e.length)};let u=c.head,f=nextChar(r.doc,u),d;if(f==e){if(nodeStart(r,u))return{changes:{insert:e+e,from:u},effects:closeBracketEffect.of(u+e.length),range:EditorSelection.cursor(u+e.length)};if(closedBracketAt(r,u)){let g=n&&r.sliceDoc(u,u+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:u,to:u+g.length,insert:g},range:EditorSelection.cursor(u+g.length)}}}else{if(n&&r.sliceDoc(u-2*e.length,u)==e+e&&(d=canStartStringAt(r,u-2*e.length,o))>-1&&nodeStart(r,d))return{changes:{insert:e+e+e+e,from:u},effects:closeBracketEffect.of(u+e.length),range:EditorSelection.cursor(u+e.length)};if(r.charCategorizer(u)(f)!=CharCategory.Word&&canStartStringAt(r,u,o)>-1&&!probablyInString(r,u,e,o))return{changes:{insert:e+e,from:u},effects:closeBracketEffect.of(u+e.length),range:EditorSelection.cursor(u+e.length)}}return{range:a=c}});return a?null:r.update(l,{scrollIntoView:!0,userEvent:"input.type"})}function nodeStart(r,e){let n=syntaxTree(r).resolveInner(e+1);return n.parent&&n.from==e}function probablyInString(r,e,n,s){let o=syntaxTree(r).resolveInner(e,-1),a=s.reduce((l,c)=>Math.max(l,c.length),0);for(let l=0;l<5;l++){let c=r.sliceDoc(o.from,Math.min(o.to,o.from+n.length+a)),u=c.indexOf(n);if(!u||u>-1&&s.indexOf(c.slice(0,u))>-1){let d=o.firstChild;for(;d&&d.from==o.from&&d.to-d.from>n.length+u;){if(r.sliceDoc(d.to-n.length,d.to)==n)return!1;d=d.firstChild}return!0}let f=o.to==e&&o.parent;if(!f)break;o=f}return!1}function canStartStringAt(r,e,n){let s=r.charCategorizer(e);if(s(r.sliceDoc(e-1,e))!=CharCategory.Word)return e;for(let o of n){let a=e-o.length;if(r.sliceDoc(a,e)==o&&s(r.sliceDoc(a-1,a))!=CharCategory.Word)return a}return-1}function autocompletion(r={}){return[commitCharacters,completionState,completionConfig.of(r),completionPlugin,completionKeymapExt,baseTheme]}const completionKeymap=[{key:"Ctrl-Space",run:startCompletion},{mac:"Alt-`",run:startCompletion},{key:"Escape",run:closeCompletion},{key:"ArrowDown",run:moveCompletionSelection(!0)},{key:"ArrowUp",run:moveCompletionSelection(!1)},{key:"PageDown",run:moveCompletionSelection(!0,"page")},{key:"PageUp",run:moveCompletionSelection(!1,"page")},{key:"Enter",run:acceptCompletion}],completionKeymapExt=Prec.highest(keymap.computeN([completionConfig],r=>r.facet(completionConfig).defaultKeymap?[completionKeymap]:[])),scriptRel="modulepreload",assetsURL=function(r,e){return new URL(r,e).href},seen={},__vitePreload=function(e,n,s){let o=Promise.resolve();if(n&&n.length>0){let f=function(d){return Promise.all(d.map(p=>Promise.resolve(p).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};const l=document.getElementsByTagName("link"),c=document.querySelector("meta[property=csp-nonce]"),u=c?.nonce||c?.getAttribute("nonce");o=f(n.map(d=>{if(d=assetsURL(d,s),d in seen)return;seen[d]=!0;const p=d.endsWith(".css"),g=p?'[rel="stylesheet"]':"";if(!!s)for(let E=l.length-1;E>=0;E--){const Y=l[E];if(Y.href===d&&(!p||Y.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${d}"]${g}`))return;const x=document.createElement("link");if(x.rel=p?"stylesheet":scriptRel,p||(x.as="script"),x.crossOrigin="",x.href=d,u&&x.setAttribute("nonce",u),document.head.appendChild(x),p)return new Promise((E,Y)=>{x.addEventListener("load",E),x.addEventListener("error",()=>Y(new Error(`Unable to preload CSS for ${d}`)))})}))}function a(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return o.then(l=>{for(const c of l||[])c.status==="rejected"&&a(c.reason);return e().catch(a)})},fileExtensionToLanguage={bat:"batch",c:"c",cc:"cpp",cpp:"cpp",csharp:"csharp",css:"css",env:"dotenv",fish:"fish",go:"go",groovy:"groovy",h:"cpp",hpp:"cpp",hs:"haskell",html:"html",java:"java",javascript:"javascript",js:"javascript",json:"json",json5:"json5",jsx:"jsx",kt:"kotlin",less:"less",lua:"lua",markdown:"markdown",md:"markdown",ml:"ocaml",mli:"ocaml",perl:"perl",php:"php",pl:"prolog",ps1:"powershell",py:"python",python:"python",rb:"ruby",rs:"rust",ruby:"ruby",scss:"scss",sh:"shell",svg:"svg",swift:"swift",toml:"toml",ts:"typescript",tsx:"tsx",wasm:"wasm",wat:"wat",xhtml:"html",xml:"xml",yaml:"yaml",yml:"yaml",zsh:"shell"},getLanguageFromName=r=>{const e=r.split(".").pop()?.toLowerCase();return e&&fileExtensionToLanguage[e]?fileExtensionToLanguage[e]:"plaintext"},langMap={javascript:()=>__vitePreload(()=>import("./index-CF4cTV6D.js"),__vite__mapDeps([0,1]),import.meta.url).then(r=>r.javascript()),typescript:()=>__vitePreload(()=>import("./index-CF4cTV6D.js"),__vite__mapDeps([0,1]),import.meta.url).then(r=>r.javascript({typescript:!0})),jsx:()=>__vitePreload(()=>import("./index-CF4cTV6D.js"),__vite__mapDeps([0,1]),import.meta.url).then(r=>r.javascript({jsx:!0})),tsx:()=>__vitePreload(()=>import("./index-CF4cTV6D.js"),__vite__mapDeps([0,1]),import.meta.url).then(r=>r.javascript({jsx:!0,typescript:!0})),python:()=>__vitePreload(()=>import("./index-BBjCxtyP.js"),__vite__mapDeps([2,1]),import.meta.url).then(r=>r.python()),markdown:()=>__vitePreload(()=>import("./index-D7aDZF-k.js"),__vite__mapDeps([3,1,4,0]),import.meta.url).then(r=>r.markdown()),yaml:()=>__vitePreload(()=>import("./index-CW7xzyij.js"),__vite__mapDeps([5,1]),import.meta.url).then(r=>r.yaml()),go:()=>__vitePreload(()=>import("./index-CR-sOhWl.js"),__vite__mapDeps([6,1]),import.meta.url).then(r=>r.go()),wast:()=>__vitePreload(()=>import("./index-CpQVuVkA.js"),__vite__mapDeps([7,1]),import.meta.url).then(r=>r.wast()),rust:()=>__vitePreload(()=>import("./index-Dsyj-GGR.js"),__vite__mapDeps([8,1]),import.meta.url).then(r=>r.rust()),json:()=>__vitePreload(()=>import("./index-jBL9z0_5.js"),__vite__mapDeps([9,1]),import.meta.url).then(r=>r.json()),css:()=>__vitePreload(()=>import("./index-yv-SWzx9.js"),__vite__mapDeps([4,1]),import.meta.url).then(r=>r.css()),sass:()=>__vitePreload(()=>import("./index-ukvY-B1o.js"),__vite__mapDeps([10,1,4]),import.meta.url).then(r=>r.sass()),scss:()=>__vitePreload(()=>import("./index-ukvY-B1o.js"),__vite__mapDeps([10,1,4]),import.meta.url).then(r=>r.sass()),c:()=>__vitePreload(()=>import("./clike-Cr_nJiF2.js"),[],import.meta.url).then(r=>StreamLanguage.define(r.c)),cpp:()=>__vitePreload(()=>import("./clike-Cr_nJiF2.js"),[],import.meta.url).then(r=>StreamLanguage.define(r.cpp)),java:()=>__vitePreload(()=>import("./clike-Cr_nJiF2.js"),[],import.meta.url).then(r=>StreamLanguage.define(r.java)),html:()=>__vitePreload(()=>import("./xml-BQQZnNBQ.js"),[],import.meta.url).then(r=>StreamLanguage.define(r.html)),scala:()=>__vitePreload(()=>import("./clike-Cr_nJiF2.js"),[],import.meta.url).then(r=>StreamLanguage.define(r.scala)),kotlin:()=>__vitePreload(()=>import("./clike-Cr_nJiF2.js"),[],import.meta.url).then(r=>StreamLanguage.define(r.kotlin)),lua:()=>__vitePreload(()=>import("./lua-BgMRiT3U.js"),[],import.meta.url).then(r=>StreamLanguage.define(r.lua)),powershell:()=>__vitePreload(()=>import("./powershell-CFHJl5sT.js"),[],import.meta.url).then(r=>StreamLanguage.define(r.powerShell)),ruby:()=>__vitePreload(()=>import("./ruby-B2Rjki9n.js"),[],import.meta.url).then(r=>StreamLanguage.define(r.ruby)),shell:()=>__vitePreload(()=>import("./shell-CjFT_Tl9.js"),[],import.meta.url).then(r=>StreamLanguage.define(r.shell)),sql:()=>__vitePreload(()=>import("./sql-D0XecflT.js"),[],import.meta.url).then(r=>StreamLanguage.define(r.pgSQL)),swift:()=>__vitePreload(()=>import("./swift-BzpIVaGY.js"),[],import.meta.url).then(r=>StreamLanguage.define(r.swift)),toml:()=>__vitePreload(()=>import("./toml-BXUEaScT.js"),[],import.meta.url).then(r=>StreamLanguage.define(r.toml)),xml:()=>__vitePreload(()=>import("./xml-BQQZnNBQ.js"),[],import.meta.url).then(r=>StreamLanguage.define(r.xml))},loadedLangs={},cmLangExt=async r=>{if(loadedLangs[r])return loadedLangs[r];const e=langMap[r];if(!e)return[];const n=await e();return loadedLangs[r]=n,n},createTheme=({variant:r,settings:e,styles:n})=>{const s=EditorView.theme({"&":{backgroundColor:e.background,color:e.foreground},".cm-content":{caretColor:e.caret},".cm-cursor, .cm-dropCursor":{borderLeftColor:e.caret},"&.cm-focused .cm-selectionBackgroundm .cm-selectionBackground, .cm-content ::selection":{backgroundColor:e.selection},".cm-activeLine":{backgroundColor:e.lineHighlight},".cm-gutters":{backgroundColor:e.gutterBackground,color:e.gutterForeground},".cm-activeLineGutter":{backgroundColor:e.lineHighlight}},{dark:r==="dark"}),o=HighlightStyle.define(n);return[s,syntaxHighlighting(o)]};createTheme({variant:"dark",settings:{background:"#200020",foreground:"#D0D0FF",caret:"#7070FF",selection:"#80000080",gutterBackground:"#200020",gutterForeground:"#C080C0",lineHighlight:"#80000040"},styles:[{tag:tags.comment,color:"#404080"},{tag:[tags.string,tags.regexp],color:"#999999"},{tag:tags.number,color:"#7090B0"},{tag:[tags.bool,tags.null],color:"#8080A0"},{tag:[tags.punctuation,tags.derefOperator],color:"#805080"},{tag:tags.keyword,color:"#60B0FF"},{tag:tags.definitionKeyword,color:"#B0FFF0"},{tag:tags.moduleKeyword,color:"#60B0FF"},{tag:tags.operator,color:"#A0A0FF"},{tag:[tags.variableName,tags.self],color:"#008080"},{tag:tags.operatorKeyword,color:"#A0A0FF"},{tag:tags.controlKeyword,color:"#80A0FF"},{tag:tags.className,color:"#70E080"},{tag:[tags.function(tags.propertyName),tags.propertyName],color:"#50A0A0"},{tag:tags.tagName,color:"#009090"},{tag:tags.modifier,color:"#B0FFF0"},{tag:[tags.squareBracket,tags.attributeName],color:"#D0D0FF"}]});createTheme({variant:"light",settings:{background:"#fcfcfc",foreground:"#5c6166",caret:"#ffaa33",selection:"#036dd626",gutterBackground:"#fcfcfc",gutterForeground:"#8a919966",lineHighlight:"#8a91991a"},styles:[{tag:tags.comment,color:"#787b8099"},{tag:tags.string,color:"#86b300"},{tag:tags.regexp,color:"#4cbf99"},{tag:[tags.number,tags.bool,tags.null],color:"#ffaa33"},{tag:tags.variableName,color:"#5c6166"},{tag:[tags.definitionKeyword,tags.modifier],color:"#fa8d3e"},{tag:[tags.keyword,tags.special(tags.brace)],color:"#fa8d3e"},{tag:tags.operator,color:"#ed9366"},{tag:tags.separator,color:"#5c6166b3"},{tag:tags.punctuation,color:"#5c6166"},{tag:[tags.definition(tags.propertyName),tags.function(tags.variableName)],color:"#f2ae49"},{tag:[tags.className,tags.definition(tags.typeName)],color:"#22a4e6"},{tag:[tags.tagName,tags.typeName,tags.self,tags.labelName],color:"#55b4d4"},{tag:tags.angleBracket,color:"#55b4d480"},{tag:tags.attributeName,color:"#f2ae49"}]});createTheme({variant:"dark",settings:{background:"#15191EFA",foreground:"#EEF2F7",caret:"#C4C4C4",selection:"#90B2D557",gutterBackground:"#15191EFA",gutterForeground:"#aaaaaa95",lineHighlight:"#57575712"},styles:[{tag:tags.comment,color:"#6E6E6E"},{tag:[tags.string,tags.regexp,tags.special(tags.brace)],color:"#5C81B3"},{tag:tags.number,color:"#C1E1B8"},{tag:tags.bool,color:"#53667D"},{tag:[tags.definitionKeyword,tags.modifier,tags.function(tags.propertyName)],color:"#A3D295",fontWeight:"bold"},{tag:[tags.keyword,tags.moduleKeyword,tags.operatorKeyword,tags.operator],color:"#697A8E",fontWeight:"bold"},{tag:[tags.variableName,tags.attributeName],color:"#708E67"},{tag:[tags.function(tags.variableName),tags.definition(tags.propertyName),tags.derefOperator],color:"#fff"},{tag:tags.tagName,color:"#A3D295"}]});createTheme({variant:"dark",settings:{background:"#2e241d",foreground:"#BAAE9E",caret:"#A7A7A7",selection:"#DDF0FF33",gutterBackground:"#28211C",gutterForeground:"#BAAE9E90",lineHighlight:"#FFFFFF08"},styles:[{tag:tags.comment,color:"#666666"},{tag:[tags.string,tags.special(tags.brace)],color:"#54BE0D"},{tag:tags.regexp,color:"#E9C062"},{tag:tags.number,color:"#CF6A4C"},{tag:[tags.keyword,tags.operator],color:"#5EA6EA"},{tag:tags.variableName,color:"#7587A6"},{tag:[tags.definitionKeyword,tags.modifier],color:"#F9EE98"},{tag:[tags.propertyName,tags.function(tags.variableName)],color:"#937121"},{tag:[tags.typeName,tags.angleBracket,tags.tagName],color:"#9B859D"}]});createTheme({variant:"dark",settings:{background:"#3b2627",foreground:"#E6E1C4",caret:"#E6E1C4",selection:"#16120E",gutterBackground:"#3b2627",gutterForeground:"#E6E1C490",lineHighlight:"#1F1611"},styles:[{tag:tags.comment,color:"#6B4E32"},{tag:[tags.keyword,tags.operator,tags.derefOperator],color:"#EF5D32"},{tag:tags.className,color:"#EFAC32",fontWeight:"bold"},{tag:[tags.typeName,tags.propertyName,tags.function(tags.variableName),tags.definition(tags.variableName)],color:"#EFAC32"},{tag:tags.definition(tags.typeName),color:"#EFAC32",fontWeight:"bold"},{tag:tags.labelName,color:"#EFAC32",fontWeight:"bold"},{tag:[tags.number,tags.bool],color:"#6C99BB"},{tag:[tags.variableName,tags.self],color:"#7DAF9C"},{tag:[tags.string,tags.special(tags.brace),tags.regexp],color:"#D9D762"},{tag:[tags.angleBracket,tags.tagName,tags.attributeName],color:"#EFCB43"}]});createTheme({variant:"dark",settings:{background:"#000205",foreground:"#FFFFFF",caret:"#E60065",selection:"#E60C6559",gutterBackground:"#000205",gutterForeground:"#ffffff90",lineHighlight:"#4DD7FC1A"},styles:[{tag:tags.comment,color:"#404040"},{tag:[tags.string,tags.special(tags.brace),tags.regexp],color:"#00D8FF"},{tag:tags.number,color:"#E62286"},{tag:[tags.variableName,tags.attributeName,tags.self],color:"#E62286",fontWeight:"bold"},{tag:tags.function(tags.variableName),color:"#fff",fontWeight:"bold"}]});createTheme({variant:"light",settings:{background:"#fff",foreground:"#000",caret:"#000",selection:"#BDD5FC",gutterBackground:"#fff",gutterForeground:"#00000070",lineHighlight:"#FFFBD1"},styles:[{tag:tags.comment,color:"#BCC8BA"},{tag:[tags.string,tags.special(tags.brace),tags.regexp],color:"#5D90CD"},{tag:[tags.number,tags.bool,tags.null],color:"#46A609"},{tag:tags.keyword,color:"#AF956F"},{tag:[tags.definitionKeyword,tags.modifier],color:"#C52727"},{tag:[tags.angleBracket,tags.tagName,tags.attributeName],color:"#606060"},{tag:tags.self,color:"#000"}]});createTheme({variant:"dark",settings:{background:"#00254b",foreground:"#FFFFFF",caret:"#FFFFFF",selection:"#B36539BF",gutterBackground:"#00254b",gutterForeground:"#FFFFFF70",lineHighlight:"#00000059"},styles:[{tag:tags.comment,color:"#0088FF"},{tag:tags.string,color:"#3AD900"},{tag:tags.regexp,color:"#80FFC2"},{tag:[tags.number,tags.bool,tags.null],color:"#FF628C"},{tag:[tags.definitionKeyword,tags.modifier],color:"#FFEE80"},{tag:tags.variableName,color:"#CCCCCC"},{tag:tags.self,color:"#FF80E1"},{tag:[tags.className,tags.definition(tags.propertyName),tags.function(tags.variableName),tags.definition(tags.typeName),tags.labelName],color:"#FFDD00"},{tag:[tags.keyword,tags.operator],color:"#FF9D00"},{tag:[tags.propertyName,tags.typeName],color:"#80FFBB"},{tag:tags.special(tags.brace),color:"#EDEF7D"},{tag:tags.attributeName,color:"#9EFFFF"},{tag:tags.derefOperator,color:"#fff"}]});createTheme({variant:"dark",settings:{background:"#060521",foreground:"#E0E0E0",caret:"#FFFFFFA6",selection:"#122BBB",gutterBackground:"#060521",gutterForeground:"#E0E0E090",lineHighlight:"#FFFFFF0F"},styles:[{tag:tags.comment,color:"#AEAEAE"},{tag:[tags.string,tags.special(tags.brace),tags.regexp],color:"#8DFF8E"},{tag:[tags.className,tags.definition(tags.propertyName),tags.function(tags.variableName),tags.function(tags.definition(tags.variableName)),tags.definition(tags.typeName)],color:"#A3EBFF"},{tag:[tags.number,tags.bool,tags.null],color:"#62E9BD"},{tag:[tags.keyword,tags.operator],color:"#2BF1DC"},{tag:[tags.definitionKeyword,tags.modifier],color:"#F8FBB1"},{tag:[tags.variableName,tags.self],color:"#B683CA"},{tag:[tags.angleBracket,tags.tagName,tags.typeName,tags.propertyName],color:"#60A4F1"},{tag:tags.derefOperator,color:"#E0E0E0"},{tag:tags.attributeName,color:"#7BACCA"}]});createTheme({variant:"dark",settings:{background:"#2d2f3f",foreground:"#f8f8f2",caret:"#f8f8f0",selection:"#44475a",gutterBackground:"#282a36",gutterForeground:"rgb(144, 145, 148)",lineHighlight:"#44475a"},styles:[{tag:tags.comment,color:"#6272a4"},{tag:[tags.string,tags.special(tags.brace)],color:"#f1fa8c"},{tag:[tags.number,tags.self,tags.bool,tags.null],color:"#bd93f9"},{tag:[tags.keyword,tags.operator],color:"#ff79c6"},{tag:[tags.definitionKeyword,tags.typeName],color:"#8be9fd"},{tag:tags.definition(tags.typeName),color:"#f8f8f2"},{tag:[tags.className,tags.definition(tags.propertyName),tags.function(tags.variableName),tags.attributeName],color:"#50fa7b"}]});createTheme({variant:"light",settings:{background:"#FFFFFF",foreground:"#000000",caret:"#000000",selection:"#80C7FF",gutterBackground:"#FFFFFF",gutterForeground:"#00000070",lineHighlight:"#C1E2F8"},styles:[{tag:tags.comment,color:"#AAAAAA"},{tag:[tags.keyword,tags.operator,tags.typeName,tags.tagName,tags.propertyName],color:"#2F6F9F",fontWeight:"bold"},{tag:[tags.attributeName,tags.definition(tags.propertyName)],color:"#4F9FD0"},{tag:[tags.className,tags.string,tags.special(tags.brace)],color:"#CF4F5F"},{tag:tags.number,color:"#CF4F5F",fontWeight:"bold"},{tag:tags.variableName,fontWeight:"bold"}]});createTheme({variant:"light",settings:{background:"#f2f1f8",foreground:"#0c006b",caret:"#5c49e9",selection:"#d5d1f2",gutterBackground:"#f2f1f8",gutterForeground:"#0c006b70",lineHighlight:"#e1def3"},styles:[{tag:tags.comment,color:"#9995b7"},{tag:tags.keyword,color:"#ff5792",fontWeight:"bold"},{tag:[tags.definitionKeyword,tags.modifier],color:"#ff5792"},{tag:[tags.className,tags.tagName,tags.definition(tags.typeName)],color:"#0094f0"},{tag:[tags.number,tags.bool,tags.null,tags.special(tags.brace)],color:"#5842ff"},{tag:[tags.definition(tags.propertyName),tags.function(tags.variableName)],color:"#0095a8"},{tag:tags.typeName,color:"#b3694d"},{tag:[tags.propertyName,tags.variableName],color:"#fa8900"},{tag:tags.operator,color:"#ff5792"},{tag:tags.self,color:"#e64100"},{tag:[tags.string,tags.regexp],color:"#00b368"},{tag:[tags.paren,tags.bracket],color:"#0431fa"},{tag:tags.labelName,color:"#00bdd6"},{tag:tags.attributeName,color:"#e64100"},{tag:tags.angleBracket,color:"#9995b7"}]});createTheme({variant:"light",settings:{background:"#faf4ed",foreground:"#575279",caret:"#575279",selection:"#6e6a8614",gutterBackground:"#faf4ed",gutterForeground:"#57527970",lineHighlight:"#6e6a860d"},styles:[{tag:tags.comment,color:"#9893a5"},{tag:[tags.bool,tags.null],color:"#286983"},{tag:tags.number,color:"#d7827e"},{tag:tags.className,color:"#d7827e"},{tag:[tags.angleBracket,tags.tagName,tags.typeName],color:"#56949f"},{tag:tags.attributeName,color:"#907aa9"},{tag:tags.punctuation,color:"#797593"},{tag:[tags.keyword,tags.modifier],color:"#286983"},{tag:[tags.string,tags.regexp],color:"#ea9d34"},{tag:tags.variableName,color:"#d7827e"}]});createTheme({variant:"light",settings:{background:"#FFFFFF",foreground:"#000000",caret:"#000000",selection:"#FFFD0054",gutterBackground:"#FFFFFF",gutterForeground:"#00000070",lineHighlight:"#00000008"},styles:[{tag:tags.comment,color:"#CFCFCF"},{tag:[tags.number,tags.bool,tags.null],color:"#E66C29"},{tag:[tags.className,tags.definition(tags.propertyName),tags.function(tags.variableName),tags.labelName,tags.definition(tags.typeName)],color:"#2EB43B"},{tag:tags.keyword,color:"#D8B229"},{tag:tags.operator,color:"#4EA44E",fontWeight:"bold"},{tag:[tags.definitionKeyword,tags.modifier],color:"#925A47"},{tag:tags.string,color:"#704D3D"},{tag:tags.typeName,color:"#2F8996"},{tag:[tags.variableName,tags.propertyName],color:"#77ACB0"},{tag:tags.self,color:"#77ACB0",fontWeight:"bold"},{tag:tags.regexp,color:"#E3965E"},{tag:[tags.tagName,tags.angleBracket],color:"#BAA827"},{tag:tags.attributeName,color:"#B06520"},{tag:tags.derefOperator,color:"#000"}]});createTheme({variant:"light",settings:{background:"#fef7e5",foreground:"#586E75",caret:"#000000",selection:"#073642",gutterBackground:"#fef7e5",gutterForeground:"#586E7580",lineHighlight:"#EEE8D5"},styles:[{tag:tags.comment,color:"#93A1A1"},{tag:tags.string,color:"#2AA198"},{tag:tags.regexp,color:"#D30102"},{tag:tags.number,color:"#D33682"},{tag:tags.variableName,color:"#268BD2"},{tag:[tags.keyword,tags.operator,tags.punctuation],color:"#859900"},{tag:[tags.definitionKeyword,tags.modifier],color:"#073642",fontWeight:"bold"},{tag:[tags.className,tags.self,tags.definition(tags.propertyName)],color:"#268BD2"},{tag:tags.function(tags.variableName),color:"#268BD2"},{tag:[tags.bool,tags.null],color:"#B58900"},{tag:tags.tagName,color:"#268BD2",fontWeight:"bold"},{tag:tags.angleBracket,color:"#93A1A1"},{tag:tags.attributeName,color:"#93A1A1"},{tag:tags.typeName,color:"#859900"}]});createTheme({variant:"light",settings:{background:"#FFFFFF",foreground:"#4D4D4C",caret:"#AEAFAD",selection:"#D6D6D6",gutterBackground:"#FFFFFF",gutterForeground:"#4D4D4C80",lineHighlight:"#EFEFEF"},styles:[{tag:tags.comment,color:"#8E908C"},{tag:[tags.variableName,tags.self,tags.propertyName,tags.attributeName,tags.regexp],color:"#C82829"},{tag:[tags.number,tags.bool,tags.null],color:"#F5871F"},{tag:[tags.className,tags.typeName,tags.definition(tags.typeName)],color:"#C99E00"},{tag:[tags.string,tags.special(tags.brace)],color:"#718C00"},{tag:tags.operator,color:"#3E999F"},{tag:[tags.definition(tags.propertyName),tags.function(tags.variableName)],color:"#4271AE"},{tag:tags.keyword,color:"#8959A8"},{tag:tags.derefOperator,color:"#4D4D4C"}]});const commonStyles=[{tag:tags.strong,fontWeight:"bold"},{tag:tags.emphasis,fontStyle:"italic"},{tag:tags.link,textDecoration:"underline"},{tag:tags.heading,fontWeight:"bold",textDecoration:"underline"},{tag:tags.strikethrough,textDecoration:"line-through"}],lightPalette={invalid:"#d1242f",comment:"#329033",docComment:"#448c27",literal:"#0550ae",string:"#1d4a8c",keyword:"#cf222e",type:"#c76618",func:"#8250df",var:"#953800",tag:"#116329",link:"#0550ae"},darkPalette={invalid:"#f85149",comment:"#9198a1",docComment:"#9198a1",literal:"#79c0ff",string:"#a5d6ff",keyword:"#ff7b72",type:"#ffa657",func:"#d2a8ff",var:"#ffa657",tag:"#7ee787",link:"#79c0ff"},styles=r=>[...commonStyles,{tag:tags.invalid,color:r.invalid},{tag:[tags.comment,tags.lineComment,tags.blockComment],fontStyle:"italic",color:r.comment},{tag:[tags.docComment,tags.docString,tags.documentMeta],fontStyle:"italic",color:r.docComment},{tag:[tags.null,tags.bool,tags.atom,tags.special(tags.variableName)],fontStyle:"italic",color:r.literal},{tag:[tags.literal,tags.integer,tags.float,tags.number],color:r.literal},{tag:[tags.character,tags.string,tags.regexp,tags.special(tags.string),tags.special(tags.regexp)],color:r.string},{tag:[tags.escape],fontWeight:"bold",color:r.string},{tag:[tags.keyword,tags.controlKeyword,tags.moduleKeyword,tags.definitionKeyword],fontWeight:"bold",color:r.keyword},{tag:[tags.typeName,tags.className],fontWeight:"bold",color:r.type},{tag:[tags.function(tags.variableName),tags.function(tags.propertyName)],color:r.func},{tag:[tags.definition(tags.variableName),tags.propertyName,tags.attributeName],color:r.var},{tag:[tags.macroName,tags.meta],fontWeight:"bold",color:r.func},{tag:[tags.namespace],fontWeight:"bold",color:r.type},{tag:[tags.tagName],fontWeight:"bold",color:r.tag},{tag:[tags.labelName],fontWeight:"bold",fontStyle:"italic",color:r.literal},{tag:[tags.quote],color:r.literal},{tag:[tags.link],textDecoration:"underline",color:r.link}],defaultLight=createTheme({variant:"light",settings:{background:"#ffffff",foreground:"#1f2328",caret:"#0969da",selection:"#006edb80",gutterBackground:"#ffffff",gutterForeground:"#737c86ff",lineHighlight:"#70809018"},styles:styles(lightPalette)}),defaultDark=createTheme({variant:"dark",settings:{background:"#000000",foreground:"#f0f6fc",caret:"#45a6ff",selection:"#0576ff80",gutterBackground:"#000000",gutterForeground:"#75797cff",lineHighlight:"#70809060"},styles:styles(darkPalette)});var _tmpl$$8=template("<div>");const EditorBody=r=>{let e;const[n,s]=createSignal(void 0),[o,a]=createSignal(void 0),[l,c]=createSignal(!1),u=rt=>nt=>{n()?.dispatch({effects:rt.reconfigure(nt)})},f=async()=>await cmLangExt(getLanguageFromName(r.opts().filename));let d=new Compartment;const p=u(d);createEffect(()=>{console.log(r.opts().filename,f()),f().then(rt=>{p(rt)})});let g=new Compartment;const y=u(g),x=createMediaQuery("(prefers-color-scheme: dark)"),E=()=>x()?defaultDark:defaultLight;createEffect(()=>y(E()));const Y=()=>r.opts().wrapMode?EditorView.lineWrapping:[];let Z=new Compartment;const te=u(Z);createEffect(()=>te(Y()));const ne=()=>{const rt=r.opts(),nt=rt.indentMode==="tab"?"	":" ".repeat(rt.indentSize);return[EditorState.tabSize.of(rt.indentSize),indentUnit.of(nt)]};let Ve=new Compartment;const me=u(Ve);return createEffect(()=>me(ne())),createEffect(()=>{const rt=r.code();if(untrack(l)){untrack(()=>c(!1));return}const nt=n(),ct=o();if(!nt||!ct)return;const ot=nt.state.update({changes:{from:0,to:nt.state.doc.length,insert:rt}});console.log("Dispatch code update."),nt.dispatch(ot)}),onMount(()=>{const nt=[EditorView.updateListener.of(ot=>{if(ot.docChanged){const ft=ot.state.doc.toString();c(!0),r.setCode(ft)}}),lineNumbers(),history(),autocompletion(),closeBrackets(),highlightSelectionMatches(),keymap.of([indentWithTab,...closeBracketsKeymap,...defaultKeymap,...searchKeymap,...historyKeymap,...foldKeymap,...completionKeymap]),d.of([]),g.of(E()),Z.of(Y()),Ve.of(ne()),EditorView.theme({"&":{fontFamily:"var(--ff-mono), monospace",fontSize:"16px"},".cm-content":{fontFamily:"var(--ff-mono), monospace",fontSize:"16px"}})],ct=EditorState.create({doc:r.code(),extensions:nt});a(ct),s(new EditorView({state:ct,parent:e}))}),onCleanup(()=>{n()?.destroy()}),(()=>{var rt=_tmpl$$8(),nt=e;return typeof nt=="function"?use(nt,rt):e=rt,rt})()};var _tmpl$$7=template("<div class=e-spinner><div class=e-spinner-circle>"),_tmpl$2$5=template("<div class=e-outputs><div>"),_tmpl$3$4=template("<div>");const Spinner=()=>_tmpl$$7(),EditorOutputs=r=>createComponent(Show,{get when(){return r.loading()||r.outputs()&&r.outputs().length>0},get children(){var e=_tmpl$2$5(),n=e.firstChild;return insert$1(e,createComponent(Show,{get when(){return r.loading()},get children(){return createComponent(Spinner,{})}}),n),insert$1(n,createComponent(For,{get each(){return r.outputs()},children:s=>(()=>{var o=_tmpl$3$4();return insert$1(o,()=>s.value),createRenderEffect(()=>className(o,`e-output-line ${s.kind==="error"?"e-output-error":"e-output-normal"}`)),o})()})),createRenderEffect(()=>className(n,r.loading()?"e-outputs-content loading":"e-outputs-content")),e}});function $constructor(r,e,n){function s(c,u){var f;Object.defineProperty(c,"_zod",{value:c._zod??{},enumerable:!1}),(f=c._zod).traits??(f.traits=new Set),c._zod.traits.add(r),e(c,u);for(const d in l.prototype)d in c||Object.defineProperty(c,d,{value:l.prototype[d].bind(c)});c._zod.constr=l,c._zod.def=u}const o=n?.Parent??Object;class a extends o{}Object.defineProperty(a,"name",{value:r});function l(c){var u;const f=n?.Parent?new a:this;s(f,c),(u=f._zod).deferred??(u.deferred=[]);for(const d of f._zod.deferred)d();return f}return Object.defineProperty(l,"init",{value:s}),Object.defineProperty(l,Symbol.hasInstance,{value:c=>n?.Parent&&c instanceof n.Parent?!0:c?._zod?.traits?.has(r)}),Object.defineProperty(l,"name",{value:r}),l}class $ZodAsyncError extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}const globalConfig={};function config(r){return globalConfig}function getEnumValues(r){const e=Object.values(r).filter(s=>typeof s=="number");return Object.entries(r).filter(([s,o])=>e.indexOf(+s)===-1).map(([s,o])=>o)}function jsonStringifyReplacer(r,e){return typeof e=="bigint"?e.toString():e}function cached(r){return{get value(){{const e=r();return Object.defineProperty(this,"value",{value:e}),e}}}}function nullish(r){return r==null}function cleanRegex(r){const e=r.startsWith("^")?1:0,n=r.endsWith("$")?r.length-1:r.length;return r.slice(e,n)}function floatSafeRemainder(r,e){const n=(r.toString().split(".")[1]||"").length,s=(e.toString().split(".")[1]||"").length,o=n>s?n:s,a=Number.parseInt(r.toFixed(o).replace(".","")),l=Number.parseInt(e.toFixed(o).replace(".",""));return a%l/10**o}function defineLazy(r,e,n){Object.defineProperty(r,e,{get(){{const s=n();return r[e]=s,s}},set(s){Object.defineProperty(r,e,{value:s})},configurable:!0})}function assignProp(r,e,n){Object.defineProperty(r,e,{value:n,writable:!0,enumerable:!0,configurable:!0})}function esc(r){return JSON.stringify(r)}const captureStackTrace=Error.captureStackTrace?Error.captureStackTrace:(...r)=>{};function isObject(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)}const allowsEval=cached(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{const r=Function;return new r(""),!0}catch{return!1}});function isPlainObject(r){if(isObject(r)===!1)return!1;const e=r.constructor;if(e===void 0)return!0;const n=e.prototype;return!(isObject(n)===!1||Object.prototype.hasOwnProperty.call(n,"isPrototypeOf")===!1)}const propertyKeyTypes=new Set(["string","number","symbol"]);function escapeRegex(r){return r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function clone$1(r,e,n){const s=new r._zod.constr(e??r._zod.def);return(!e||n?.parent)&&(s._zod.parent=r),s}function normalizeParams(r){const e=r;if(!e)return{};if(typeof e=="string")return{error:()=>e};if(e?.message!==void 0){if(e?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");e.error=e.message}return delete e.message,typeof e.error=="string"?{...e,error:()=>e.error}:e}function optionalKeys(r){return Object.keys(r).filter(e=>r[e]._zod.optin==="optional"&&r[e]._zod.optout==="optional")}const NUMBER_FORMAT_RANGES={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function pick(r,e){const n={},s=r._zod.def;for(const o in e){if(!(o in s.shape))throw new Error(`Unrecognized key: "${o}"`);e[o]&&(n[o]=s.shape[o])}return clone$1(r,{...r._zod.def,shape:n,checks:[]})}function omit(r,e){const n={...r._zod.def.shape},s=r._zod.def;for(const o in e){if(!(o in s.shape))throw new Error(`Unrecognized key: "${o}"`);e[o]&&delete n[o]}return clone$1(r,{...r._zod.def,shape:n,checks:[]})}function extend(r,e){if(!isPlainObject(e))throw new Error("Invalid input to extend: expected a plain object");const n={...r._zod.def,get shape(){const s={...r._zod.def.shape,...e};return assignProp(this,"shape",s),s},checks:[]};return clone$1(r,n)}function merge(r,e){return clone$1(r,{...r._zod.def,get shape(){const n={...r._zod.def.shape,...e._zod.def.shape};return assignProp(this,"shape",n),n},catchall:e._zod.def.catchall,checks:[]})}function partial(r,e,n){const s=e._zod.def.shape,o={...s};if(n)for(const a in n){if(!(a in s))throw new Error(`Unrecognized key: "${a}"`);n[a]&&(o[a]=r?new r({type:"optional",innerType:s[a]}):s[a])}else for(const a in s)o[a]=r?new r({type:"optional",innerType:s[a]}):s[a];return clone$1(e,{...e._zod.def,shape:o,checks:[]})}function required(r,e,n){const s=e._zod.def.shape,o={...s};if(n)for(const a in n){if(!(a in o))throw new Error(`Unrecognized key: "${a}"`);n[a]&&(o[a]=new r({type:"nonoptional",innerType:s[a]}))}else for(const a in s)o[a]=new r({type:"nonoptional",innerType:s[a]});return clone$1(e,{...e._zod.def,shape:o,checks:[]})}function aborted(r,e=0){for(let n=e;n<r.issues.length;n++)if(r.issues[n]?.continue!==!0)return!0;return!1}function prefixIssues(r,e){return e.map(n=>{var s;return(s=n).path??(s.path=[]),n.path.unshift(r),n})}function unwrapMessage(r){return typeof r=="string"?r:r?.message}function finalizeIssue(r,e,n){const s={...r,path:r.path??[]};if(!r.message){const o=unwrapMessage(r.inst?._zod.def?.error?.(r))??unwrapMessage(e?.error?.(r))??unwrapMessage(n.customError?.(r))??unwrapMessage(n.localeError?.(r))??"Invalid input";s.message=o}return delete s.inst,delete s.continue,e?.reportInput||delete s.input,s}function getLengthableOrigin(r){return Array.isArray(r)?"array":typeof r=="string"?"string":"unknown"}function issue(...r){const[e,n,s]=r;return typeof e=="string"?{message:e,code:"custom",input:n,inst:s}:{...e}}const initializer$1=(r,e)=>{r.name="$ZodError",Object.defineProperty(r,"_zod",{value:r._zod,enumerable:!1}),Object.defineProperty(r,"issues",{value:e,enumerable:!1}),Object.defineProperty(r,"message",{get(){return JSON.stringify(e,jsonStringifyReplacer,2)},enumerable:!0}),Object.defineProperty(r,"toString",{value:()=>r.message,enumerable:!1})},$ZodError=$constructor("$ZodError",initializer$1),$ZodRealError=$constructor("$ZodError",initializer$1,{Parent:Error});function flattenError(r,e=n=>n.message){const n={},s=[];for(const o of r.issues)o.path.length>0?(n[o.path[0]]=n[o.path[0]]||[],n[o.path[0]].push(e(o))):s.push(e(o));return{formErrors:s,fieldErrors:n}}function formatError(r,e){const n=e||function(a){return a.message},s={_errors:[]},o=a=>{for(const l of a.issues)if(l.code==="invalid_union"&&l.errors.length)l.errors.map(c=>o({issues:c}));else if(l.code==="invalid_key")o({issues:l.issues});else if(l.code==="invalid_element")o({issues:l.issues});else if(l.path.length===0)s._errors.push(n(l));else{let c=s,u=0;for(;u<l.path.length;){const f=l.path[u];u===l.path.length-1?(c[f]=c[f]||{_errors:[]},c[f]._errors.push(n(l))):c[f]=c[f]||{_errors:[]},c=c[f],u++}}};return o(r),s}const _parse=r=>(e,n,s,o)=>{const a=s?Object.assign(s,{async:!1}):{async:!1},l=e._zod.run({value:n,issues:[]},a);if(l instanceof Promise)throw new $ZodAsyncError;if(l.issues.length){const c=new(o?.Err??r)(l.issues.map(u=>finalizeIssue(u,a,config())));throw captureStackTrace(c,o?.callee),c}return l.value},_parseAsync=r=>async(e,n,s,o)=>{const a=s?Object.assign(s,{async:!0}):{async:!0};let l=e._zod.run({value:n,issues:[]},a);if(l instanceof Promise&&(l=await l),l.issues.length){const c=new(o?.Err??r)(l.issues.map(u=>finalizeIssue(u,a,config())));throw captureStackTrace(c,o?.callee),c}return l.value},_safeParse=r=>(e,n,s)=>{const o=s?{...s,async:!1}:{async:!1},a=e._zod.run({value:n,issues:[]},o);if(a instanceof Promise)throw new $ZodAsyncError;return a.issues.length?{success:!1,error:new(r??$ZodError)(a.issues.map(l=>finalizeIssue(l,o,config())))}:{success:!0,data:a.value}},safeParse$1=_safeParse($ZodRealError),_safeParseAsync=r=>async(e,n,s)=>{const o=s?Object.assign(s,{async:!0}):{async:!0};let a=e._zod.run({value:n,issues:[]},o);return a instanceof Promise&&(a=await a),a.issues.length?{success:!1,error:new r(a.issues.map(l=>finalizeIssue(l,o,config())))}:{success:!0,data:a.value}},safeParseAsync$1=_safeParseAsync($ZodRealError),cuid=/^[cC][^\s-]{8,}$/,cuid2=/^[0-9a-z]+$/,ulid=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,xid=/^[0-9a-vA-V]{20}$/,ksuid=/^[A-Za-z0-9]{27}$/,nanoid=/^[a-zA-Z0-9_-]{21}$/,duration$1=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,guid=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,uuid=r=>r?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${r}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000)$/,email=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,_emoji$1="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function emoji(){return new RegExp(_emoji$1,"u")}const ipv4=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,cidrv4=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,cidrv6=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,base64url=/^[A-Za-z0-9_-]*$/,hostname=/^([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+$/,e164=/^\+(?:[0-9]){6,14}[0-9]$/,dateSource="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",date$1=new RegExp(`^${dateSource}$`);function timeSource(r){const e="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof r.precision=="number"?r.precision===-1?`${e}`:r.precision===0?`${e}:[0-5]\\d`:`${e}:[0-5]\\d\\.\\d{${r.precision}}`:`${e}(?::[0-5]\\d(?:\\.\\d+)?)?`}function time$1(r){return new RegExp(`^${timeSource(r)}$`)}function datetime$1(r){const e=timeSource({precision:r.precision}),n=["Z"];r.local&&n.push(""),r.offset&&n.push("([+-]\\d{2}:\\d{2})");const s=`${e}(?:${n.join("|")})`;return new RegExp(`^${dateSource}T(?:${s})$`)}const string$1=r=>{const e=r?`[\\s\\S]{${r?.minimum??0},${r?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${e}$`)},integer=/^\d+$/,number$1=/^-?\d+(?:\.\d+)?/i,boolean$1=/true|false/i,lowercase=/^[^A-Z]*$/,uppercase=/^[^a-z]*$/,$ZodCheck=$constructor("$ZodCheck",(r,e)=>{var n;r._zod??(r._zod={}),r._zod.def=e,(n=r._zod).onattach??(n.onattach=[])}),numericOriginMap={number:"number",bigint:"bigint",object:"date"},$ZodCheckLessThan=$constructor("$ZodCheckLessThan",(r,e)=>{$ZodCheck.init(r,e);const n=numericOriginMap[typeof e.value];r._zod.onattach.push(s=>{const o=s._zod.bag,a=(e.inclusive?o.maximum:o.exclusiveMaximum)??Number.POSITIVE_INFINITY;e.value<a&&(e.inclusive?o.maximum=e.value:o.exclusiveMaximum=e.value)}),r._zod.check=s=>{(e.inclusive?s.value<=e.value:s.value<e.value)||s.issues.push({origin:n,code:"too_big",maximum:e.value,input:s.value,inclusive:e.inclusive,inst:r,continue:!e.abort})}}),$ZodCheckGreaterThan=$constructor("$ZodCheckGreaterThan",(r,e)=>{$ZodCheck.init(r,e);const n=numericOriginMap[typeof e.value];r._zod.onattach.push(s=>{const o=s._zod.bag,a=(e.inclusive?o.minimum:o.exclusiveMinimum)??Number.NEGATIVE_INFINITY;e.value>a&&(e.inclusive?o.minimum=e.value:o.exclusiveMinimum=e.value)}),r._zod.check=s=>{(e.inclusive?s.value>=e.value:s.value>e.value)||s.issues.push({origin:n,code:"too_small",minimum:e.value,input:s.value,inclusive:e.inclusive,inst:r,continue:!e.abort})}}),$ZodCheckMultipleOf=$constructor("$ZodCheckMultipleOf",(r,e)=>{$ZodCheck.init(r,e),r._zod.onattach.push(n=>{var s;(s=n._zod.bag).multipleOf??(s.multipleOf=e.value)}),r._zod.check=n=>{if(typeof n.value!=typeof e.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof n.value=="bigint"?n.value%e.value===BigInt(0):floatSafeRemainder(n.value,e.value)===0)||n.issues.push({origin:typeof n.value,code:"not_multiple_of",divisor:e.value,input:n.value,inst:r,continue:!e.abort})}}),$ZodCheckNumberFormat=$constructor("$ZodCheckNumberFormat",(r,e)=>{$ZodCheck.init(r,e),e.format=e.format||"float64";const n=e.format?.includes("int"),s=n?"int":"number",[o,a]=NUMBER_FORMAT_RANGES[e.format];r._zod.onattach.push(l=>{const c=l._zod.bag;c.format=e.format,c.minimum=o,c.maximum=a,n&&(c.pattern=integer)}),r._zod.check=l=>{const c=l.value;if(n){if(!Number.isInteger(c)){l.issues.push({expected:s,format:e.format,code:"invalid_type",input:c,inst:r});return}if(!Number.isSafeInteger(c)){c>0?l.issues.push({input:c,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:r,origin:s,continue:!e.abort}):l.issues.push({input:c,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:r,origin:s,continue:!e.abort});return}}c<o&&l.issues.push({origin:"number",input:c,code:"too_small",minimum:o,inclusive:!0,inst:r,continue:!e.abort}),c>a&&l.issues.push({origin:"number",input:c,code:"too_big",maximum:a,inst:r})}}),$ZodCheckMaxLength=$constructor("$ZodCheckMaxLength",(r,e)=>{var n;$ZodCheck.init(r,e),(n=r._zod.def).when??(n.when=s=>{const o=s.value;return!nullish(o)&&o.length!==void 0}),r._zod.onattach.push(s=>{const o=s._zod.bag.maximum??Number.POSITIVE_INFINITY;e.maximum<o&&(s._zod.bag.maximum=e.maximum)}),r._zod.check=s=>{const o=s.value;if(o.length<=e.maximum)return;const l=getLengthableOrigin(o);s.issues.push({origin:l,code:"too_big",maximum:e.maximum,inclusive:!0,input:o,inst:r,continue:!e.abort})}}),$ZodCheckMinLength=$constructor("$ZodCheckMinLength",(r,e)=>{var n;$ZodCheck.init(r,e),(n=r._zod.def).when??(n.when=s=>{const o=s.value;return!nullish(o)&&o.length!==void 0}),r._zod.onattach.push(s=>{const o=s._zod.bag.minimum??Number.NEGATIVE_INFINITY;e.minimum>o&&(s._zod.bag.minimum=e.minimum)}),r._zod.check=s=>{const o=s.value;if(o.length>=e.minimum)return;const l=getLengthableOrigin(o);s.issues.push({origin:l,code:"too_small",minimum:e.minimum,inclusive:!0,input:o,inst:r,continue:!e.abort})}}),$ZodCheckLengthEquals=$constructor("$ZodCheckLengthEquals",(r,e)=>{var n;$ZodCheck.init(r,e),(n=r._zod.def).when??(n.when=s=>{const o=s.value;return!nullish(o)&&o.length!==void 0}),r._zod.onattach.push(s=>{const o=s._zod.bag;o.minimum=e.length,o.maximum=e.length,o.length=e.length}),r._zod.check=s=>{const o=s.value,a=o.length;if(a===e.length)return;const l=getLengthableOrigin(o),c=a>e.length;s.issues.push({origin:l,...c?{code:"too_big",maximum:e.length}:{code:"too_small",minimum:e.length},inclusive:!0,exact:!0,input:s.value,inst:r,continue:!e.abort})}}),$ZodCheckStringFormat=$constructor("$ZodCheckStringFormat",(r,e)=>{var n,s;$ZodCheck.init(r,e),r._zod.onattach.push(o=>{const a=o._zod.bag;a.format=e.format,e.pattern&&(a.patterns??(a.patterns=new Set),a.patterns.add(e.pattern))}),e.pattern?(n=r._zod).check??(n.check=o=>{e.pattern.lastIndex=0,!e.pattern.test(o.value)&&o.issues.push({origin:"string",code:"invalid_format",format:e.format,input:o.value,...e.pattern?{pattern:e.pattern.toString()}:{},inst:r,continue:!e.abort})}):(s=r._zod).check??(s.check=()=>{})}),$ZodCheckRegex=$constructor("$ZodCheckRegex",(r,e)=>{$ZodCheckStringFormat.init(r,e),r._zod.check=n=>{e.pattern.lastIndex=0,!e.pattern.test(n.value)&&n.issues.push({origin:"string",code:"invalid_format",format:"regex",input:n.value,pattern:e.pattern.toString(),inst:r,continue:!e.abort})}}),$ZodCheckLowerCase=$constructor("$ZodCheckLowerCase",(r,e)=>{e.pattern??(e.pattern=lowercase),$ZodCheckStringFormat.init(r,e)}),$ZodCheckUpperCase=$constructor("$ZodCheckUpperCase",(r,e)=>{e.pattern??(e.pattern=uppercase),$ZodCheckStringFormat.init(r,e)}),$ZodCheckIncludes=$constructor("$ZodCheckIncludes",(r,e)=>{$ZodCheck.init(r,e);const n=escapeRegex(e.includes),s=new RegExp(typeof e.position=="number"?`^.{${e.position}}${n}`:n);e.pattern=s,r._zod.onattach.push(o=>{const a=o._zod.bag;a.patterns??(a.patterns=new Set),a.patterns.add(s)}),r._zod.check=o=>{o.value.includes(e.includes,e.position)||o.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:e.includes,input:o.value,inst:r,continue:!e.abort})}}),$ZodCheckStartsWith=$constructor("$ZodCheckStartsWith",(r,e)=>{$ZodCheck.init(r,e);const n=new RegExp(`^${escapeRegex(e.prefix)}.*`);e.pattern??(e.pattern=n),r._zod.onattach.push(s=>{const o=s._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(n)}),r._zod.check=s=>{s.value.startsWith(e.prefix)||s.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:e.prefix,input:s.value,inst:r,continue:!e.abort})}}),$ZodCheckEndsWith=$constructor("$ZodCheckEndsWith",(r,e)=>{$ZodCheck.init(r,e);const n=new RegExp(`.*${escapeRegex(e.suffix)}$`);e.pattern??(e.pattern=n),r._zod.onattach.push(s=>{const o=s._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(n)}),r._zod.check=s=>{s.value.endsWith(e.suffix)||s.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:e.suffix,input:s.value,inst:r,continue:!e.abort})}}),$ZodCheckOverwrite=$constructor("$ZodCheckOverwrite",(r,e)=>{$ZodCheck.init(r,e),r._zod.check=n=>{n.value=e.tx(n.value)}});class Doc{constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if(typeof e=="function"){e(this,{execution:"sync"}),e(this,{execution:"async"});return}const s=e.split(`
`).filter(l=>l),o=Math.min(...s.map(l=>l.length-l.trimStart().length)),a=s.map(l=>l.slice(o)).map(l=>" ".repeat(this.indent*2)+l);for(const l of a)this.content.push(l)}compile(){const e=Function,n=this?.args,o=[...(this?.content??[""]).map(a=>`  ${a}`)];return new e(...n,o.join(`
`))}}const version={major:4,minor:0,patch:5},$ZodType=$constructor("$ZodType",(r,e)=>{var n;r??(r={}),r._zod.def=e,r._zod.bag=r._zod.bag||{},r._zod.version=version;const s=[...r._zod.def.checks??[]];r._zod.traits.has("$ZodCheck")&&s.unshift(r);for(const o of s)for(const a of o._zod.onattach)a(r);if(s.length===0)(n=r._zod).deferred??(n.deferred=[]),r._zod.deferred?.push(()=>{r._zod.run=r._zod.parse});else{const o=(a,l,c)=>{let u=aborted(a),f;for(const d of l){if(d._zod.def.when){if(!d._zod.def.when(a))continue}else if(u)continue;const p=a.issues.length,g=d._zod.check(a);if(g instanceof Promise&&c?.async===!1)throw new $ZodAsyncError;if(f||g instanceof Promise)f=(f??Promise.resolve()).then(async()=>{await g,a.issues.length!==p&&(u||(u=aborted(a,p)))});else{if(a.issues.length===p)continue;u||(u=aborted(a,p))}}return f?f.then(()=>a):a};r._zod.run=(a,l)=>{const c=r._zod.parse(a,l);if(c instanceof Promise){if(l.async===!1)throw new $ZodAsyncError;return c.then(u=>o(u,s,l))}return o(c,s,l)}}r["~standard"]={validate:o=>{try{const a=safeParse$1(r,o);return a.success?{value:a.data}:{issues:a.error?.issues}}catch{return safeParseAsync$1(r,o).then(l=>l.success?{value:l.data}:{issues:l.error?.issues})}},vendor:"zod",version:1}}),$ZodString=$constructor("$ZodString",(r,e)=>{$ZodType.init(r,e),r._zod.pattern=[...r?._zod.bag?.patterns??[]].pop()??string$1(r._zod.bag),r._zod.parse=(n,s)=>{if(e.coerce)try{n.value=String(n.value)}catch{}return typeof n.value=="string"||n.issues.push({expected:"string",code:"invalid_type",input:n.value,inst:r}),n}}),$ZodStringFormat=$constructor("$ZodStringFormat",(r,e)=>{$ZodCheckStringFormat.init(r,e),$ZodString.init(r,e)}),$ZodGUID=$constructor("$ZodGUID",(r,e)=>{e.pattern??(e.pattern=guid),$ZodStringFormat.init(r,e)}),$ZodUUID=$constructor("$ZodUUID",(r,e)=>{if(e.version){const s={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[e.version];if(s===void 0)throw new Error(`Invalid UUID version: "${e.version}"`);e.pattern??(e.pattern=uuid(s))}else e.pattern??(e.pattern=uuid());$ZodStringFormat.init(r,e)}),$ZodEmail=$constructor("$ZodEmail",(r,e)=>{e.pattern??(e.pattern=email),$ZodStringFormat.init(r,e)}),$ZodURL=$constructor("$ZodURL",(r,e)=>{$ZodStringFormat.init(r,e),r._zod.check=n=>{try{const s=n.value,o=new URL(s),a=o.href;e.hostname&&(e.hostname.lastIndex=0,e.hostname.test(o.hostname)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:hostname.source,input:n.value,inst:r,continue:!e.abort})),e.protocol&&(e.protocol.lastIndex=0,e.protocol.test(o.protocol.endsWith(":")?o.protocol.slice(0,-1):o.protocol)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:e.protocol.source,input:n.value,inst:r,continue:!e.abort})),!s.endsWith("/")&&a.endsWith("/")?n.value=a.slice(0,-1):n.value=a;return}catch{n.issues.push({code:"invalid_format",format:"url",input:n.value,inst:r,continue:!e.abort})}}}),$ZodEmoji=$constructor("$ZodEmoji",(r,e)=>{e.pattern??(e.pattern=emoji()),$ZodStringFormat.init(r,e)}),$ZodNanoID=$constructor("$ZodNanoID",(r,e)=>{e.pattern??(e.pattern=nanoid),$ZodStringFormat.init(r,e)}),$ZodCUID=$constructor("$ZodCUID",(r,e)=>{e.pattern??(e.pattern=cuid),$ZodStringFormat.init(r,e)}),$ZodCUID2=$constructor("$ZodCUID2",(r,e)=>{e.pattern??(e.pattern=cuid2),$ZodStringFormat.init(r,e)}),$ZodULID=$constructor("$ZodULID",(r,e)=>{e.pattern??(e.pattern=ulid),$ZodStringFormat.init(r,e)}),$ZodXID=$constructor("$ZodXID",(r,e)=>{e.pattern??(e.pattern=xid),$ZodStringFormat.init(r,e)}),$ZodKSUID=$constructor("$ZodKSUID",(r,e)=>{e.pattern??(e.pattern=ksuid),$ZodStringFormat.init(r,e)}),$ZodISODateTime=$constructor("$ZodISODateTime",(r,e)=>{e.pattern??(e.pattern=datetime$1(e)),$ZodStringFormat.init(r,e)}),$ZodISODate=$constructor("$ZodISODate",(r,e)=>{e.pattern??(e.pattern=date$1),$ZodStringFormat.init(r,e)}),$ZodISOTime=$constructor("$ZodISOTime",(r,e)=>{e.pattern??(e.pattern=time$1(e)),$ZodStringFormat.init(r,e)}),$ZodISODuration=$constructor("$ZodISODuration",(r,e)=>{e.pattern??(e.pattern=duration$1),$ZodStringFormat.init(r,e)}),$ZodIPv4=$constructor("$ZodIPv4",(r,e)=>{e.pattern??(e.pattern=ipv4),$ZodStringFormat.init(r,e),r._zod.onattach.push(n=>{const s=n._zod.bag;s.format="ipv4"})}),$ZodIPv6=$constructor("$ZodIPv6",(r,e)=>{e.pattern??(e.pattern=ipv6),$ZodStringFormat.init(r,e),r._zod.onattach.push(n=>{const s=n._zod.bag;s.format="ipv6"}),r._zod.check=n=>{try{new URL(`http://[${n.value}]`)}catch{n.issues.push({code:"invalid_format",format:"ipv6",input:n.value,inst:r,continue:!e.abort})}}}),$ZodCIDRv4=$constructor("$ZodCIDRv4",(r,e)=>{e.pattern??(e.pattern=cidrv4),$ZodStringFormat.init(r,e)}),$ZodCIDRv6=$constructor("$ZodCIDRv6",(r,e)=>{e.pattern??(e.pattern=cidrv6),$ZodStringFormat.init(r,e),r._zod.check=n=>{const[s,o]=n.value.split("/");try{if(!o)throw new Error;const a=Number(o);if(`${a}`!==o)throw new Error;if(a<0||a>128)throw new Error;new URL(`http://[${s}]`)}catch{n.issues.push({code:"invalid_format",format:"cidrv6",input:n.value,inst:r,continue:!e.abort})}}});function isValidBase64(r){if(r==="")return!0;if(r.length%4!==0)return!1;try{return atob(r),!0}catch{return!1}}const $ZodBase64=$constructor("$ZodBase64",(r,e)=>{e.pattern??(e.pattern=base64),$ZodStringFormat.init(r,e),r._zod.onattach.push(n=>{n._zod.bag.contentEncoding="base64"}),r._zod.check=n=>{isValidBase64(n.value)||n.issues.push({code:"invalid_format",format:"base64",input:n.value,inst:r,continue:!e.abort})}});function isValidBase64URL(r){if(!base64url.test(r))return!1;const e=r.replace(/[-_]/g,s=>s==="-"?"+":"/"),n=e.padEnd(Math.ceil(e.length/4)*4,"=");return isValidBase64(n)}const $ZodBase64URL=$constructor("$ZodBase64URL",(r,e)=>{e.pattern??(e.pattern=base64url),$ZodStringFormat.init(r,e),r._zod.onattach.push(n=>{n._zod.bag.contentEncoding="base64url"}),r._zod.check=n=>{isValidBase64URL(n.value)||n.issues.push({code:"invalid_format",format:"base64url",input:n.value,inst:r,continue:!e.abort})}}),$ZodE164=$constructor("$ZodE164",(r,e)=>{e.pattern??(e.pattern=e164),$ZodStringFormat.init(r,e)});function isValidJWT(r,e=null){try{const n=r.split(".");if(n.length!==3)return!1;const[s]=n;if(!s)return!1;const o=JSON.parse(atob(s));return!("typ"in o&&o?.typ!=="JWT"||!o.alg||e&&(!("alg"in o)||o.alg!==e))}catch{return!1}}const $ZodJWT=$constructor("$ZodJWT",(r,e)=>{$ZodStringFormat.init(r,e),r._zod.check=n=>{isValidJWT(n.value,e.alg)||n.issues.push({code:"invalid_format",format:"jwt",input:n.value,inst:r,continue:!e.abort})}}),$ZodNumber=$constructor("$ZodNumber",(r,e)=>{$ZodType.init(r,e),r._zod.pattern=r._zod.bag.pattern??number$1,r._zod.parse=(n,s)=>{if(e.coerce)try{n.value=Number(n.value)}catch{}const o=n.value;if(typeof o=="number"&&!Number.isNaN(o)&&Number.isFinite(o))return n;const a=typeof o=="number"?Number.isNaN(o)?"NaN":Number.isFinite(o)?void 0:"Infinity":void 0;return n.issues.push({expected:"number",code:"invalid_type",input:o,inst:r,...a?{received:a}:{}}),n}}),$ZodNumberFormat=$constructor("$ZodNumber",(r,e)=>{$ZodCheckNumberFormat.init(r,e),$ZodNumber.init(r,e)}),$ZodBoolean=$constructor("$ZodBoolean",(r,e)=>{$ZodType.init(r,e),r._zod.pattern=boolean$1,r._zod.parse=(n,s)=>{if(e.coerce)try{n.value=!!n.value}catch{}const o=n.value;return typeof o=="boolean"||n.issues.push({expected:"boolean",code:"invalid_type",input:o,inst:r}),n}}),$ZodUnknown=$constructor("$ZodUnknown",(r,e)=>{$ZodType.init(r,e),r._zod.parse=n=>n}),$ZodNever=$constructor("$ZodNever",(r,e)=>{$ZodType.init(r,e),r._zod.parse=(n,s)=>(n.issues.push({expected:"never",code:"invalid_type",input:n.value,inst:r}),n)});function handleArrayResult(r,e,n){r.issues.length&&e.issues.push(...prefixIssues(n,r.issues)),e.value[n]=r.value}const $ZodArray=$constructor("$ZodArray",(r,e)=>{$ZodType.init(r,e),r._zod.parse=(n,s)=>{const o=n.value;if(!Array.isArray(o))return n.issues.push({expected:"array",code:"invalid_type",input:o,inst:r}),n;n.value=Array(o.length);const a=[];for(let l=0;l<o.length;l++){const c=o[l],u=e.element._zod.run({value:c,issues:[]},s);u instanceof Promise?a.push(u.then(f=>handleArrayResult(f,n,l))):handleArrayResult(u,n,l)}return a.length?Promise.all(a).then(()=>n):n}});function handleObjectResult(r,e,n){r.issues.length&&e.issues.push(...prefixIssues(n,r.issues)),e.value[n]=r.value}function handleOptionalObjectResult(r,e,n,s){r.issues.length?s[n]===void 0?n in s?e.value[n]=void 0:e.value[n]=r.value:e.issues.push(...prefixIssues(n,r.issues)):r.value===void 0?n in s&&(e.value[n]=void 0):e.value[n]=r.value}const $ZodObject=$constructor("$ZodObject",(r,e)=>{$ZodType.init(r,e);const n=cached(()=>{const p=Object.keys(e.shape);for(const y of p)if(!(e.shape[y]instanceof $ZodType))throw new Error(`Invalid element at key "${y}": expected a Zod schema`);const g=optionalKeys(e.shape);return{shape:e.shape,keys:p,keySet:new Set(p),numKeys:p.length,optionalKeys:new Set(g)}});defineLazy(r._zod,"propValues",()=>{const p=e.shape,g={};for(const y in p){const x=p[y]._zod;if(x.values){g[y]??(g[y]=new Set);for(const E of x.values)g[y].add(E)}}return g});const s=p=>{const g=new Doc(["shape","payload","ctx"]),y=n.value,x=te=>{const ne=esc(te);return`shape[${ne}]._zod.run({ value: input[${ne}], issues: [] }, ctx)`};g.write("const input = payload.value;");const E=Object.create(null);let Y=0;for(const te of y.keys)E[te]=`key_${Y++}`;g.write("const newResult = {}");for(const te of y.keys)if(y.optionalKeys.has(te)){const ne=E[te];g.write(`const ${ne} = ${x(te)};`);const Ve=esc(te);g.write(`
        if (${ne}.issues.length) {
          if (input[${Ve}] === undefined) {
            if (${Ve} in input) {
              newResult[${Ve}] = undefined;
            }
          } else {
            payload.issues = payload.issues.concat(
              ${ne}.issues.map((iss) => ({
                ...iss,
                path: iss.path ? [${Ve}, ...iss.path] : [${Ve}],
              }))
            );
          }
        } else if (${ne}.value === undefined) {
          if (${Ve} in input) newResult[${Ve}] = undefined;
        } else {
          newResult[${Ve}] = ${ne}.value;
        }
        `)}else{const ne=E[te];g.write(`const ${ne} = ${x(te)};`),g.write(`
          if (${ne}.issues.length) payload.issues = payload.issues.concat(${ne}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${esc(te)}, ...iss.path] : [${esc(te)}]
          })));`),g.write(`newResult[${esc(te)}] = ${ne}.value`)}g.write("payload.value = newResult;"),g.write("return payload;");const Z=g.compile();return(te,ne)=>Z(p,te,ne)};let o;const a=isObject,l=!globalConfig.jitless,u=l&&allowsEval.value,f=e.catchall;let d;r._zod.parse=(p,g)=>{d??(d=n.value);const y=p.value;if(!a(y))return p.issues.push({expected:"object",code:"invalid_type",input:y,inst:r}),p;const x=[];if(l&&u&&g?.async===!1&&g.jitless!==!0)o||(o=s(e.shape)),p=o(p,g);else{p.value={};const ne=d.shape;for(const Ve of d.keys){const me=ne[Ve],rt=me._zod.run({value:y[Ve],issues:[]},g),nt=me._zod.optin==="optional"&&me._zod.optout==="optional";rt instanceof Promise?x.push(rt.then(ct=>nt?handleOptionalObjectResult(ct,p,Ve,y):handleObjectResult(ct,p,Ve))):nt?handleOptionalObjectResult(rt,p,Ve,y):handleObjectResult(rt,p,Ve)}}if(!f)return x.length?Promise.all(x).then(()=>p):p;const E=[],Y=d.keySet,Z=f._zod,te=Z.def.type;for(const ne of Object.keys(y)){if(Y.has(ne))continue;if(te==="never"){E.push(ne);continue}const Ve=Z.run({value:y[ne],issues:[]},g);Ve instanceof Promise?x.push(Ve.then(me=>handleObjectResult(me,p,ne))):handleObjectResult(Ve,p,ne)}return E.length&&p.issues.push({code:"unrecognized_keys",keys:E,input:y,inst:r}),x.length?Promise.all(x).then(()=>p):p}});function handleUnionResults(r,e,n,s){for(const o of r)if(o.issues.length===0)return e.value=o.value,e;return e.issues.push({code:"invalid_union",input:e.value,inst:n,errors:r.map(o=>o.issues.map(a=>finalizeIssue(a,s,config())))}),e}const $ZodUnion=$constructor("$ZodUnion",(r,e)=>{$ZodType.init(r,e),defineLazy(r._zod,"optin",()=>e.options.some(n=>n._zod.optin==="optional")?"optional":void 0),defineLazy(r._zod,"optout",()=>e.options.some(n=>n._zod.optout==="optional")?"optional":void 0),defineLazy(r._zod,"values",()=>{if(e.options.every(n=>n._zod.values))return new Set(e.options.flatMap(n=>Array.from(n._zod.values)))}),defineLazy(r._zod,"pattern",()=>{if(e.options.every(n=>n._zod.pattern)){const n=e.options.map(s=>s._zod.pattern);return new RegExp(`^(${n.map(s=>cleanRegex(s.source)).join("|")})$`)}}),r._zod.parse=(n,s)=>{let o=!1;const a=[];for(const l of e.options){const c=l._zod.run({value:n.value,issues:[]},s);if(c instanceof Promise)a.push(c),o=!0;else{if(c.issues.length===0)return c;a.push(c)}}return o?Promise.all(a).then(l=>handleUnionResults(l,n,r,s)):handleUnionResults(a,n,r,s)}}),$ZodIntersection=$constructor("$ZodIntersection",(r,e)=>{$ZodType.init(r,e),r._zod.parse=(n,s)=>{const o=n.value,a=e.left._zod.run({value:o,issues:[]},s),l=e.right._zod.run({value:o,issues:[]},s);return a instanceof Promise||l instanceof Promise?Promise.all([a,l]).then(([u,f])=>handleIntersectionResults(n,u,f)):handleIntersectionResults(n,a,l)}});function mergeValues(r,e){if(r===e)return{valid:!0,data:r};if(r instanceof Date&&e instanceof Date&&+r==+e)return{valid:!0,data:r};if(isPlainObject(r)&&isPlainObject(e)){const n=Object.keys(e),s=Object.keys(r).filter(a=>n.indexOf(a)!==-1),o={...r,...e};for(const a of s){const l=mergeValues(r[a],e[a]);if(!l.valid)return{valid:!1,mergeErrorPath:[a,...l.mergeErrorPath]};o[a]=l.data}return{valid:!0,data:o}}if(Array.isArray(r)&&Array.isArray(e)){if(r.length!==e.length)return{valid:!1,mergeErrorPath:[]};const n=[];for(let s=0;s<r.length;s++){const o=r[s],a=e[s],l=mergeValues(o,a);if(!l.valid)return{valid:!1,mergeErrorPath:[s,...l.mergeErrorPath]};n.push(l.data)}return{valid:!0,data:n}}return{valid:!1,mergeErrorPath:[]}}function handleIntersectionResults(r,e,n){if(e.issues.length&&r.issues.push(...e.issues),n.issues.length&&r.issues.push(...n.issues),aborted(r))return r;const s=mergeValues(e.value,n.value);if(!s.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(s.mergeErrorPath)}`);return r.value=s.data,r}const $ZodEnum=$constructor("$ZodEnum",(r,e)=>{$ZodType.init(r,e);const n=getEnumValues(e.entries);r._zod.values=new Set(n),r._zod.pattern=new RegExp(`^(${n.filter(s=>propertyKeyTypes.has(typeof s)).map(s=>typeof s=="string"?escapeRegex(s):s.toString()).join("|")})$`),r._zod.parse=(s,o)=>{const a=s.value;return r._zod.values.has(a)||s.issues.push({code:"invalid_value",values:n,input:a,inst:r}),s}}),$ZodTransform=$constructor("$ZodTransform",(r,e)=>{$ZodType.init(r,e),r._zod.parse=(n,s)=>{const o=e.transform(n.value,n);if(s.async)return(o instanceof Promise?o:Promise.resolve(o)).then(l=>(n.value=l,n));if(o instanceof Promise)throw new $ZodAsyncError;return n.value=o,n}}),$ZodOptional=$constructor("$ZodOptional",(r,e)=>{$ZodType.init(r,e),r._zod.optin="optional",r._zod.optout="optional",defineLazy(r._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,void 0]):void 0),defineLazy(r._zod,"pattern",()=>{const n=e.innerType._zod.pattern;return n?new RegExp(`^(${cleanRegex(n.source)})?$`):void 0}),r._zod.parse=(n,s)=>e.innerType._zod.optin==="optional"?e.innerType._zod.run(n,s):n.value===void 0?n:e.innerType._zod.run(n,s)}),$ZodNullable=$constructor("$ZodNullable",(r,e)=>{$ZodType.init(r,e),defineLazy(r._zod,"optin",()=>e.innerType._zod.optin),defineLazy(r._zod,"optout",()=>e.innerType._zod.optout),defineLazy(r._zod,"pattern",()=>{const n=e.innerType._zod.pattern;return n?new RegExp(`^(${cleanRegex(n.source)}|null)$`):void 0}),defineLazy(r._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,null]):void 0),r._zod.parse=(n,s)=>n.value===null?n:e.innerType._zod.run(n,s)}),$ZodDefault=$constructor("$ZodDefault",(r,e)=>{$ZodType.init(r,e),r._zod.optin="optional",defineLazy(r._zod,"values",()=>e.innerType._zod.values),r._zod.parse=(n,s)=>{if(n.value===void 0)return n.value=e.defaultValue,n;const o=e.innerType._zod.run(n,s);return o instanceof Promise?o.then(a=>handleDefaultResult(a,e)):handleDefaultResult(o,e)}});function handleDefaultResult(r,e){return r.value===void 0&&(r.value=e.defaultValue),r}const $ZodPrefault=$constructor("$ZodPrefault",(r,e)=>{$ZodType.init(r,e),r._zod.optin="optional",defineLazy(r._zod,"values",()=>e.innerType._zod.values),r._zod.parse=(n,s)=>(n.value===void 0&&(n.value=e.defaultValue),e.innerType._zod.run(n,s))}),$ZodNonOptional=$constructor("$ZodNonOptional",(r,e)=>{$ZodType.init(r,e),defineLazy(r._zod,"values",()=>{const n=e.innerType._zod.values;return n?new Set([...n].filter(s=>s!==void 0)):void 0}),r._zod.parse=(n,s)=>{const o=e.innerType._zod.run(n,s);return o instanceof Promise?o.then(a=>handleNonOptionalResult(a,r)):handleNonOptionalResult(o,r)}});function handleNonOptionalResult(r,e){return!r.issues.length&&r.value===void 0&&r.issues.push({code:"invalid_type",expected:"nonoptional",input:r.value,inst:e}),r}const $ZodCatch=$constructor("$ZodCatch",(r,e)=>{$ZodType.init(r,e),r._zod.optin="optional",defineLazy(r._zod,"optout",()=>e.innerType._zod.optout),defineLazy(r._zod,"values",()=>e.innerType._zod.values),r._zod.parse=(n,s)=>{const o=e.innerType._zod.run(n,s);return o instanceof Promise?o.then(a=>(n.value=a.value,a.issues.length&&(n.value=e.catchValue({...n,error:{issues:a.issues.map(l=>finalizeIssue(l,s,config()))},input:n.value}),n.issues=[]),n)):(n.value=o.value,o.issues.length&&(n.value=e.catchValue({...n,error:{issues:o.issues.map(a=>finalizeIssue(a,s,config()))},input:n.value}),n.issues=[]),n)}}),$ZodPipe=$constructor("$ZodPipe",(r,e)=>{$ZodType.init(r,e),defineLazy(r._zod,"values",()=>e.in._zod.values),defineLazy(r._zod,"optin",()=>e.in._zod.optin),defineLazy(r._zod,"optout",()=>e.out._zod.optout),defineLazy(r._zod,"propValues",()=>e.in._zod.propValues),r._zod.parse=(n,s)=>{const o=e.in._zod.run(n,s);return o instanceof Promise?o.then(a=>handlePipeResult(a,e,s)):handlePipeResult(o,e,s)}});function handlePipeResult(r,e,n){return aborted(r)?r:e.out._zod.run({value:r.value,issues:r.issues},n)}const $ZodReadonly=$constructor("$ZodReadonly",(r,e)=>{$ZodType.init(r,e),defineLazy(r._zod,"propValues",()=>e.innerType._zod.propValues),defineLazy(r._zod,"values",()=>e.innerType._zod.values),defineLazy(r._zod,"optin",()=>e.innerType._zod.optin),defineLazy(r._zod,"optout",()=>e.innerType._zod.optout),r._zod.parse=(n,s)=>{const o=e.innerType._zod.run(n,s);return o instanceof Promise?o.then(handleReadonlyResult):handleReadonlyResult(o)}});function handleReadonlyResult(r){return r.value=Object.freeze(r.value),r}const $ZodCustom=$constructor("$ZodCustom",(r,e)=>{$ZodCheck.init(r,e),$ZodType.init(r,e),r._zod.parse=(n,s)=>n,r._zod.check=n=>{const s=n.value,o=e.fn(s);if(o instanceof Promise)return o.then(a=>handleRefineResult(a,n,s,r));handleRefineResult(o,n,s,r)}});function handleRefineResult(r,e,n,s){if(!r){const o={code:"custom",input:n,inst:s,path:[...s._zod.def.path??[]],continue:!s._zod.def.abort};s._zod.def.params&&(o.params=s._zod.def.params),e.issues.push(issue(o))}}class $ZodRegistry{constructor(){this._map=new Map,this._idmap=new Map}add(e,...n){const s=n[0];if(this._map.set(e,s),s&&typeof s=="object"&&"id"in s){if(this._idmap.has(s.id))throw new Error(`ID ${s.id} already exists in the registry`);this._idmap.set(s.id,e)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(e){const n=this._map.get(e);return n&&typeof n=="object"&&"id"in n&&this._idmap.delete(n.id),this._map.delete(e),this}get(e){const n=e._zod.parent;if(n){const s={...this.get(n)??{}};return delete s.id,{...s,...this._map.get(e)}}return this._map.get(e)}has(e){return this._map.has(e)}}function registry(){return new $ZodRegistry}const globalRegistry=registry();function _string(r,e){return new r({type:"string",...normalizeParams(e)})}function _email(r,e){return new r({type:"string",format:"email",check:"string_format",abort:!1,...normalizeParams(e)})}function _guid(r,e){return new r({type:"string",format:"guid",check:"string_format",abort:!1,...normalizeParams(e)})}function _uuid(r,e){return new r({type:"string",format:"uuid",check:"string_format",abort:!1,...normalizeParams(e)})}function _uuidv4(r,e){return new r({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...normalizeParams(e)})}function _uuidv6(r,e){return new r({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...normalizeParams(e)})}function _uuidv7(r,e){return new r({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...normalizeParams(e)})}function _url(r,e){return new r({type:"string",format:"url",check:"string_format",abort:!1,...normalizeParams(e)})}function _emoji(r,e){return new r({type:"string",format:"emoji",check:"string_format",abort:!1,...normalizeParams(e)})}function _nanoid(r,e){return new r({type:"string",format:"nanoid",check:"string_format",abort:!1,...normalizeParams(e)})}function _cuid(r,e){return new r({type:"string",format:"cuid",check:"string_format",abort:!1,...normalizeParams(e)})}function _cuid2(r,e){return new r({type:"string",format:"cuid2",check:"string_format",abort:!1,...normalizeParams(e)})}function _ulid(r,e){return new r({type:"string",format:"ulid",check:"string_format",abort:!1,...normalizeParams(e)})}function _xid(r,e){return new r({type:"string",format:"xid",check:"string_format",abort:!1,...normalizeParams(e)})}function _ksuid(r,e){return new r({type:"string",format:"ksuid",check:"string_format",abort:!1,...normalizeParams(e)})}function _ipv4(r,e){return new r({type:"string",format:"ipv4",check:"string_format",abort:!1,...normalizeParams(e)})}function _ipv6(r,e){return new r({type:"string",format:"ipv6",check:"string_format",abort:!1,...normalizeParams(e)})}function _cidrv4(r,e){return new r({type:"string",format:"cidrv4",check:"string_format",abort:!1,...normalizeParams(e)})}function _cidrv6(r,e){return new r({type:"string",format:"cidrv6",check:"string_format",abort:!1,...normalizeParams(e)})}function _base64(r,e){return new r({type:"string",format:"base64",check:"string_format",abort:!1,...normalizeParams(e)})}function _base64url(r,e){return new r({type:"string",format:"base64url",check:"string_format",abort:!1,...normalizeParams(e)})}function _e164(r,e){return new r({type:"string",format:"e164",check:"string_format",abort:!1,...normalizeParams(e)})}function _jwt(r,e){return new r({type:"string",format:"jwt",check:"string_format",abort:!1,...normalizeParams(e)})}function _isoDateTime(r,e){return new r({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...normalizeParams(e)})}function _isoDate(r,e){return new r({type:"string",format:"date",check:"string_format",...normalizeParams(e)})}function _isoTime(r,e){return new r({type:"string",format:"time",check:"string_format",precision:null,...normalizeParams(e)})}function _isoDuration(r,e){return new r({type:"string",format:"duration",check:"string_format",...normalizeParams(e)})}function _number(r,e){return new r({type:"number",checks:[],...normalizeParams(e)})}function _int(r,e){return new r({type:"number",check:"number_format",abort:!1,format:"safeint",...normalizeParams(e)})}function _boolean(r,e){return new r({type:"boolean",...normalizeParams(e)})}function _unknown(r){return new r({type:"unknown"})}function _never(r,e){return new r({type:"never",...normalizeParams(e)})}function _lt(r,e){return new $ZodCheckLessThan({check:"less_than",...normalizeParams(e),value:r,inclusive:!1})}function _lte(r,e){return new $ZodCheckLessThan({check:"less_than",...normalizeParams(e),value:r,inclusive:!0})}function _gt(r,e){return new $ZodCheckGreaterThan({check:"greater_than",...normalizeParams(e),value:r,inclusive:!1})}function _gte(r,e){return new $ZodCheckGreaterThan({check:"greater_than",...normalizeParams(e),value:r,inclusive:!0})}function _multipleOf(r,e){return new $ZodCheckMultipleOf({check:"multiple_of",...normalizeParams(e),value:r})}function _maxLength(r,e){return new $ZodCheckMaxLength({check:"max_length",...normalizeParams(e),maximum:r})}function _minLength(r,e){return new $ZodCheckMinLength({check:"min_length",...normalizeParams(e),minimum:r})}function _length(r,e){return new $ZodCheckLengthEquals({check:"length_equals",...normalizeParams(e),length:r})}function _regex(r,e){return new $ZodCheckRegex({check:"string_format",format:"regex",...normalizeParams(e),pattern:r})}function _lowercase(r){return new $ZodCheckLowerCase({check:"string_format",format:"lowercase",...normalizeParams(r)})}function _uppercase(r){return new $ZodCheckUpperCase({check:"string_format",format:"uppercase",...normalizeParams(r)})}function _includes(r,e){return new $ZodCheckIncludes({check:"string_format",format:"includes",...normalizeParams(e),includes:r})}function _startsWith(r,e){return new $ZodCheckStartsWith({check:"string_format",format:"starts_with",...normalizeParams(e),prefix:r})}function _endsWith(r,e){return new $ZodCheckEndsWith({check:"string_format",format:"ends_with",...normalizeParams(e),suffix:r})}function _overwrite(r){return new $ZodCheckOverwrite({check:"overwrite",tx:r})}function _normalize(r){return _overwrite(e=>e.normalize(r))}function _trim(){return _overwrite(r=>r.trim())}function _toLowerCase(){return _overwrite(r=>r.toLowerCase())}function _toUpperCase(){return _overwrite(r=>r.toUpperCase())}function _array(r,e,n){return new r({type:"array",element:e,...normalizeParams(n)})}function _refine(r,e,n){return new r({type:"custom",check:"custom",fn:e,...normalizeParams(n)})}const ZodISODateTime=$constructor("ZodISODateTime",(r,e)=>{$ZodISODateTime.init(r,e),ZodStringFormat.init(r,e)});function datetime(r){return _isoDateTime(ZodISODateTime,r)}const ZodISODate=$constructor("ZodISODate",(r,e)=>{$ZodISODate.init(r,e),ZodStringFormat.init(r,e)});function date(r){return _isoDate(ZodISODate,r)}const ZodISOTime=$constructor("ZodISOTime",(r,e)=>{$ZodISOTime.init(r,e),ZodStringFormat.init(r,e)});function time(r){return _isoTime(ZodISOTime,r)}const ZodISODuration=$constructor("ZodISODuration",(r,e)=>{$ZodISODuration.init(r,e),ZodStringFormat.init(r,e)});function duration(r){return _isoDuration(ZodISODuration,r)}const initializer=(r,e)=>{$ZodError.init(r,e),r.name="ZodError",Object.defineProperties(r,{format:{value:n=>formatError(r,n)},flatten:{value:n=>flattenError(r,n)},addIssue:{value:n=>r.issues.push(n)},addIssues:{value:n=>r.issues.push(...n)},isEmpty:{get(){return r.issues.length===0}}})},ZodRealError=$constructor("ZodError",initializer,{Parent:Error}),parse=_parse(ZodRealError),parseAsync=_parseAsync(ZodRealError),safeParse=_safeParse(ZodRealError),safeParseAsync=_safeParseAsync(ZodRealError),ZodType=$constructor("ZodType",(r,e)=>($ZodType.init(r,e),r.def=e,Object.defineProperty(r,"_def",{value:e}),r.check=(...n)=>r.clone({...e,checks:[...e.checks??[],...n.map(s=>typeof s=="function"?{_zod:{check:s,def:{check:"custom"},onattach:[]}}:s)]}),r.clone=(n,s)=>clone$1(r,n,s),r.brand=()=>r,r.register=(n,s)=>(n.add(r,s),r),r.parse=(n,s)=>parse(r,n,s,{callee:r.parse}),r.safeParse=(n,s)=>safeParse(r,n,s),r.parseAsync=async(n,s)=>parseAsync(r,n,s,{callee:r.parseAsync}),r.safeParseAsync=async(n,s)=>safeParseAsync(r,n,s),r.spa=r.safeParseAsync,r.refine=(n,s)=>r.check(refine(n,s)),r.superRefine=n=>r.check(superRefine(n)),r.overwrite=n=>r.check(_overwrite(n)),r.optional=()=>optional(r),r.nullable=()=>nullable(r),r.nullish=()=>optional(nullable(r)),r.nonoptional=n=>nonoptional(r,n),r.array=()=>array(r),r.or=n=>union([r,n]),r.and=n=>intersection(r,n),r.transform=n=>pipe(r,transform(n)),r.default=n=>_default(r,n),r.prefault=n=>prefault(r,n),r.catch=n=>_catch(r,n),r.pipe=n=>pipe(r,n),r.readonly=()=>readonly(r),r.describe=n=>{const s=r.clone();return globalRegistry.add(s,{description:n}),s},Object.defineProperty(r,"description",{get(){return globalRegistry.get(r)?.description},configurable:!0}),r.meta=(...n)=>{if(n.length===0)return globalRegistry.get(r);const s=r.clone();return globalRegistry.add(s,n[0]),s},r.isOptional=()=>r.safeParse(void 0).success,r.isNullable=()=>r.safeParse(null).success,r)),_ZodString=$constructor("_ZodString",(r,e)=>{$ZodString.init(r,e),ZodType.init(r,e);const n=r._zod.bag;r.format=n.format??null,r.minLength=n.minimum??null,r.maxLength=n.maximum??null,r.regex=(...s)=>r.check(_regex(...s)),r.includes=(...s)=>r.check(_includes(...s)),r.startsWith=(...s)=>r.check(_startsWith(...s)),r.endsWith=(...s)=>r.check(_endsWith(...s)),r.min=(...s)=>r.check(_minLength(...s)),r.max=(...s)=>r.check(_maxLength(...s)),r.length=(...s)=>r.check(_length(...s)),r.nonempty=(...s)=>r.check(_minLength(1,...s)),r.lowercase=s=>r.check(_lowercase(s)),r.uppercase=s=>r.check(_uppercase(s)),r.trim=()=>r.check(_trim()),r.normalize=(...s)=>r.check(_normalize(...s)),r.toLowerCase=()=>r.check(_toLowerCase()),r.toUpperCase=()=>r.check(_toUpperCase())}),ZodString=$constructor("ZodString",(r,e)=>{$ZodString.init(r,e),_ZodString.init(r,e),r.email=n=>r.check(_email(ZodEmail,n)),r.url=n=>r.check(_url(ZodURL,n)),r.jwt=n=>r.check(_jwt(ZodJWT,n)),r.emoji=n=>r.check(_emoji(ZodEmoji,n)),r.guid=n=>r.check(_guid(ZodGUID,n)),r.uuid=n=>r.check(_uuid(ZodUUID,n)),r.uuidv4=n=>r.check(_uuidv4(ZodUUID,n)),r.uuidv6=n=>r.check(_uuidv6(ZodUUID,n)),r.uuidv7=n=>r.check(_uuidv7(ZodUUID,n)),r.nanoid=n=>r.check(_nanoid(ZodNanoID,n)),r.guid=n=>r.check(_guid(ZodGUID,n)),r.cuid=n=>r.check(_cuid(ZodCUID,n)),r.cuid2=n=>r.check(_cuid2(ZodCUID2,n)),r.ulid=n=>r.check(_ulid(ZodULID,n)),r.base64=n=>r.check(_base64(ZodBase64,n)),r.base64url=n=>r.check(_base64url(ZodBase64URL,n)),r.xid=n=>r.check(_xid(ZodXID,n)),r.ksuid=n=>r.check(_ksuid(ZodKSUID,n)),r.ipv4=n=>r.check(_ipv4(ZodIPv4,n)),r.ipv6=n=>r.check(_ipv6(ZodIPv6,n)),r.cidrv4=n=>r.check(_cidrv4(ZodCIDRv4,n)),r.cidrv6=n=>r.check(_cidrv6(ZodCIDRv6,n)),r.e164=n=>r.check(_e164(ZodE164,n)),r.datetime=n=>r.check(datetime(n)),r.date=n=>r.check(date(n)),r.time=n=>r.check(time(n)),r.duration=n=>r.check(duration(n))});function string(r){return _string(ZodString,r)}const ZodStringFormat=$constructor("ZodStringFormat",(r,e)=>{$ZodStringFormat.init(r,e),_ZodString.init(r,e)}),ZodEmail=$constructor("ZodEmail",(r,e)=>{$ZodEmail.init(r,e),ZodStringFormat.init(r,e)}),ZodGUID=$constructor("ZodGUID",(r,e)=>{$ZodGUID.init(r,e),ZodStringFormat.init(r,e)}),ZodUUID=$constructor("ZodUUID",(r,e)=>{$ZodUUID.init(r,e),ZodStringFormat.init(r,e)}),ZodURL=$constructor("ZodURL",(r,e)=>{$ZodURL.init(r,e),ZodStringFormat.init(r,e)}),ZodEmoji=$constructor("ZodEmoji",(r,e)=>{$ZodEmoji.init(r,e),ZodStringFormat.init(r,e)}),ZodNanoID=$constructor("ZodNanoID",(r,e)=>{$ZodNanoID.init(r,e),ZodStringFormat.init(r,e)}),ZodCUID=$constructor("ZodCUID",(r,e)=>{$ZodCUID.init(r,e),ZodStringFormat.init(r,e)}),ZodCUID2=$constructor("ZodCUID2",(r,e)=>{$ZodCUID2.init(r,e),ZodStringFormat.init(r,e)}),ZodULID=$constructor("ZodULID",(r,e)=>{$ZodULID.init(r,e),ZodStringFormat.init(r,e)}),ZodXID=$constructor("ZodXID",(r,e)=>{$ZodXID.init(r,e),ZodStringFormat.init(r,e)}),ZodKSUID=$constructor("ZodKSUID",(r,e)=>{$ZodKSUID.init(r,e),ZodStringFormat.init(r,e)}),ZodIPv4=$constructor("ZodIPv4",(r,e)=>{$ZodIPv4.init(r,e),ZodStringFormat.init(r,e)}),ZodIPv6=$constructor("ZodIPv6",(r,e)=>{$ZodIPv6.init(r,e),ZodStringFormat.init(r,e)}),ZodCIDRv4=$constructor("ZodCIDRv4",(r,e)=>{$ZodCIDRv4.init(r,e),ZodStringFormat.init(r,e)}),ZodCIDRv6=$constructor("ZodCIDRv6",(r,e)=>{$ZodCIDRv6.init(r,e),ZodStringFormat.init(r,e)}),ZodBase64=$constructor("ZodBase64",(r,e)=>{$ZodBase64.init(r,e),ZodStringFormat.init(r,e)}),ZodBase64URL=$constructor("ZodBase64URL",(r,e)=>{$ZodBase64URL.init(r,e),ZodStringFormat.init(r,e)}),ZodE164=$constructor("ZodE164",(r,e)=>{$ZodE164.init(r,e),ZodStringFormat.init(r,e)}),ZodJWT=$constructor("ZodJWT",(r,e)=>{$ZodJWT.init(r,e),ZodStringFormat.init(r,e)}),ZodNumber=$constructor("ZodNumber",(r,e)=>{$ZodNumber.init(r,e),ZodType.init(r,e),r.gt=(s,o)=>r.check(_gt(s,o)),r.gte=(s,o)=>r.check(_gte(s,o)),r.min=(s,o)=>r.check(_gte(s,o)),r.lt=(s,o)=>r.check(_lt(s,o)),r.lte=(s,o)=>r.check(_lte(s,o)),r.max=(s,o)=>r.check(_lte(s,o)),r.int=s=>r.check(int(s)),r.safe=s=>r.check(int(s)),r.positive=s=>r.check(_gt(0,s)),r.nonnegative=s=>r.check(_gte(0,s)),r.negative=s=>r.check(_lt(0,s)),r.nonpositive=s=>r.check(_lte(0,s)),r.multipleOf=(s,o)=>r.check(_multipleOf(s,o)),r.step=(s,o)=>r.check(_multipleOf(s,o)),r.finite=()=>r;const n=r._zod.bag;r.minValue=Math.max(n.minimum??Number.NEGATIVE_INFINITY,n.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,r.maxValue=Math.min(n.maximum??Number.POSITIVE_INFINITY,n.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,r.isInt=(n.format??"").includes("int")||Number.isSafeInteger(n.multipleOf??.5),r.isFinite=!0,r.format=n.format??null});function number(r){return _number(ZodNumber,r)}const ZodNumberFormat=$constructor("ZodNumberFormat",(r,e)=>{$ZodNumberFormat.init(r,e),ZodNumber.init(r,e)});function int(r){return _int(ZodNumberFormat,r)}const ZodBoolean=$constructor("ZodBoolean",(r,e)=>{$ZodBoolean.init(r,e),ZodType.init(r,e)});function boolean(r){return _boolean(ZodBoolean,r)}const ZodUnknown=$constructor("ZodUnknown",(r,e)=>{$ZodUnknown.init(r,e),ZodType.init(r,e)});function unknown(){return _unknown(ZodUnknown)}const ZodNever=$constructor("ZodNever",(r,e)=>{$ZodNever.init(r,e),ZodType.init(r,e)});function never(r){return _never(ZodNever,r)}const ZodArray=$constructor("ZodArray",(r,e)=>{$ZodArray.init(r,e),ZodType.init(r,e),r.element=e.element,r.min=(n,s)=>r.check(_minLength(n,s)),r.nonempty=n=>r.check(_minLength(1,n)),r.max=(n,s)=>r.check(_maxLength(n,s)),r.length=(n,s)=>r.check(_length(n,s)),r.unwrap=()=>r.element});function array(r,e){return _array(ZodArray,r,e)}const ZodObject=$constructor("ZodObject",(r,e)=>{$ZodObject.init(r,e),ZodType.init(r,e),defineLazy(r,"shape",()=>e.shape),r.keyof=()=>_enum(Object.keys(r._zod.def.shape)),r.catchall=n=>r.clone({...r._zod.def,catchall:n}),r.passthrough=()=>r.clone({...r._zod.def,catchall:unknown()}),r.loose=()=>r.clone({...r._zod.def,catchall:unknown()}),r.strict=()=>r.clone({...r._zod.def,catchall:never()}),r.strip=()=>r.clone({...r._zod.def,catchall:void 0}),r.extend=n=>extend(r,n),r.merge=n=>merge(r,n),r.pick=n=>pick(r,n),r.omit=n=>omit(r,n),r.partial=(...n)=>partial(ZodOptional,r,n[0]),r.required=(...n)=>required(ZodNonOptional,r,n[0])});function object(r,e){const n={type:"object",get shape(){return assignProp(this,"shape",{...r}),this.shape},...normalizeParams(e)};return new ZodObject(n)}const ZodUnion=$constructor("ZodUnion",(r,e)=>{$ZodUnion.init(r,e),ZodType.init(r,e),r.options=e.options});function union(r,e){return new ZodUnion({type:"union",options:r,...normalizeParams(e)})}const ZodIntersection=$constructor("ZodIntersection",(r,e)=>{$ZodIntersection.init(r,e),ZodType.init(r,e)});function intersection(r,e){return new ZodIntersection({type:"intersection",left:r,right:e})}const ZodEnum=$constructor("ZodEnum",(r,e)=>{$ZodEnum.init(r,e),ZodType.init(r,e),r.enum=e.entries,r.options=Object.values(e.entries);const n=new Set(Object.keys(e.entries));r.extract=(s,o)=>{const a={};for(const l of s)if(n.has(l))a[l]=e.entries[l];else throw new Error(`Key ${l} not found in enum`);return new ZodEnum({...e,checks:[],...normalizeParams(o),entries:a})},r.exclude=(s,o)=>{const a={...e.entries};for(const l of s)if(n.has(l))delete a[l];else throw new Error(`Key ${l} not found in enum`);return new ZodEnum({...e,checks:[],...normalizeParams(o),entries:a})}});function _enum(r,e){const n=Array.isArray(r)?Object.fromEntries(r.map(s=>[s,s])):r;return new ZodEnum({type:"enum",entries:n,...normalizeParams(e)})}const ZodTransform=$constructor("ZodTransform",(r,e)=>{$ZodTransform.init(r,e),ZodType.init(r,e),r._zod.parse=(n,s)=>{n.addIssue=a=>{if(typeof a=="string")n.issues.push(issue(a,n.value,e));else{const l=a;l.fatal&&(l.continue=!1),l.code??(l.code="custom"),l.input??(l.input=n.value),l.inst??(l.inst=r),l.continue??(l.continue=!0),n.issues.push(issue(l))}};const o=e.transform(n.value,n);return o instanceof Promise?o.then(a=>(n.value=a,n)):(n.value=o,n)}});function transform(r){return new ZodTransform({type:"transform",transform:r})}const ZodOptional=$constructor("ZodOptional",(r,e)=>{$ZodOptional.init(r,e),ZodType.init(r,e),r.unwrap=()=>r._zod.def.innerType});function optional(r){return new ZodOptional({type:"optional",innerType:r})}const ZodNullable=$constructor("ZodNullable",(r,e)=>{$ZodNullable.init(r,e),ZodType.init(r,e),r.unwrap=()=>r._zod.def.innerType});function nullable(r){return new ZodNullable({type:"nullable",innerType:r})}const ZodDefault=$constructor("ZodDefault",(r,e)=>{$ZodDefault.init(r,e),ZodType.init(r,e),r.unwrap=()=>r._zod.def.innerType,r.removeDefault=r.unwrap});function _default(r,e){return new ZodDefault({type:"default",innerType:r,get defaultValue(){return typeof e=="function"?e():e}})}const ZodPrefault=$constructor("ZodPrefault",(r,e)=>{$ZodPrefault.init(r,e),ZodType.init(r,e),r.unwrap=()=>r._zod.def.innerType});function prefault(r,e){return new ZodPrefault({type:"prefault",innerType:r,get defaultValue(){return typeof e=="function"?e():e}})}const ZodNonOptional=$constructor("ZodNonOptional",(r,e)=>{$ZodNonOptional.init(r,e),ZodType.init(r,e),r.unwrap=()=>r._zod.def.innerType});function nonoptional(r,e){return new ZodNonOptional({type:"nonoptional",innerType:r,...normalizeParams(e)})}const ZodCatch=$constructor("ZodCatch",(r,e)=>{$ZodCatch.init(r,e),ZodType.init(r,e),r.unwrap=()=>r._zod.def.innerType,r.removeCatch=r.unwrap});function _catch(r,e){return new ZodCatch({type:"catch",innerType:r,catchValue:typeof e=="function"?e:()=>e})}const ZodPipe=$constructor("ZodPipe",(r,e)=>{$ZodPipe.init(r,e),ZodType.init(r,e),r.in=e.in,r.out=e.out});function pipe(r,e){return new ZodPipe({type:"pipe",in:r,out:e})}const ZodReadonly=$constructor("ZodReadonly",(r,e)=>{$ZodReadonly.init(r,e),ZodType.init(r,e)});function readonly(r){return new ZodReadonly({type:"readonly",innerType:r})}const ZodCustom=$constructor("ZodCustom",(r,e)=>{$ZodCustom.init(r,e),ZodType.init(r,e)});function check(r){const e=new $ZodCheck({check:"custom"});return e._zod.check=r,e}function refine(r,e={}){return _refine(ZodCustom,r,e)}function superRefine(r){const e=check(n=>(n.addIssue=s=>{if(typeof s=="string")n.issues.push(issue(s,n.value,e._zod.def));else{const o=s;o.fatal&&(o.continue=!1),o.code??(o.code="custom"),o.input??(o.input=n.value),o.inst??(o.inst=e),o.continue??(o.continue=!e._zod.def.abort),n.issues.push(issue(o))}},r(n.value,n)));return e}object({filename:string(),indentMode:_enum(["space","tab"]),indentSize:number().int().min(2).max(8),wrapMode:boolean()});const defaultOptions=()=>({filename:"",indentMode:"space",indentSize:2,wrapMode:!0});var _tmpl$$6=template("<div class=switch>"),_tmpl$2$4=template("<button>");const SwitchSelector=r=>(()=>{var e=_tmpl$$6();return insert$1(e,createComponent(For,{get each(){return r.items},children:n=>(()=>{var s=_tmpl$2$4();return s.$$click=()=>r.onChange(n.value),insert$1(s,()=>n.label),createRenderEffect(()=>className(s,`switch-item ${r.selected===n.value?"active":""}`)),s})()})),e})();delegateEvents(["click"]);const detectPreviewType=(r,e)=>{switch(r.toLowerCase().split(".").pop()||""){case"md":case"markdown":return"markdown";case"html":case"htm":return"html";case"svg":return"svg";case"json":return"json"}const s=e.trim().toLowerCase();if(s.startsWith("<!doctype html")||s.startsWith("<html"))return"html";if(s.startsWith("<svg"))return"svg";if(s.startsWith("{")||s.startsWith("["))try{return JSON.parse(e),"json"}catch{}return s.includes("#")||s.includes("**")||s.includes("*")||s.includes("```")?"markdown":"none"},isPreviewable=(r,e)=>detectPreviewType(r,e)!=="none";var _tmpl$$5=template("<select><option disabled selected value>Actions"),_tmpl$2$3=template("<option>"),_tmpl$3$3=template("<div class=e-ft><div></div><div>");const ActionSelector=r=>{const[e,n]=splitProps(r,["options"]);return(()=>{var s=_tmpl$$5();return s.firstChild,spread(s,mergeProps(n,{onChange:o=>{const a=o.currentTarget,l=e.options.find(c=>c.label===a.value);l&&l.onSelect(),a.value=""}}),!1,!0),insert$1(s,createComponent(For,{get each(){return e.options},children:o=>(()=>{var a=_tmpl$2$3();return a.selected=!1,insert$1(a,()=>o.label),createRenderEffect(()=>a.value=o.label),a})()}),null),s})()},EditorFooter=r=>{const e=()=>isPreviewable(r.filename,r.code);return(()=>{var n=_tmpl$3$3(),s=n.firstChild,o=s.nextSibling;return insert$1(s,createComponent(Show,{get when(){return e()},get children(){return createComponent(SwitchSelector,{items:[{label:"Code",value:"code"},{label:"Preview",value:"preview"}],get selected(){return r.viewMode},onChange:a=>{r.onViewModeChange(a)}})}})),insert$1(o,createComponent(ActionSelector,{get options(){return r.actions}})),n})()},formatUsingPrettier=async(r,e,n)=>{const s=await __vitePreload(()=>import("./standalone-DeKvpib9.js"),[],import.meta.url),o=await __vitePreload(()=>import("./babel-BxyuU7xl.js").then(d=>d.b),[],import.meta.url),a=(await __vitePreload(async()=>{const{default:d}=await import("./estree-SqGC8b3Z.js");return{default:d}},[],import.meta.url)).default,l=await __vitePreload(()=>import("./html-CVF3HEra.js").then(d=>d.h),[],import.meta.url),c=await __vitePreload(()=>import("./postcss-BoQZ3TuK.js").then(d=>d.p),[],import.meta.url),u=await __vitePreload(()=>import("./markdown-BiNTqDhJ.js").then(d=>d.m),[],import.meta.url);return await s.format(e,{parser:r,plugins:[o,a,l,c,u],useTabs:n.indentMode==="tab",tabWidth:n.indentSize,printWidth:80,proseWrap:"always"})},executeJavaScript=async code=>{const outputs=[],console={log:(...r)=>{const e=r.map(n=>typeof n=="object"?JSON.stringify(n,null,2):String(n)).join(" ");outputs.push({kind:"output",value:e})},error:(...r)=>{const e=r.map(n=>typeof n=="object"?JSON.stringify(n,null,2):String(n)).join(" ");outputs.push({kind:"error",value:e})},warn:(...r)=>{const e=r.map(n=>typeof n=="object"?JSON.stringify(n,null,2):String(n)).join(" ");outputs.push({kind:"output",value:` ${e}`})}};try{const wrappedCode=`(async (console) => {
${code}
})`,asyncFn=eval(wrappedCode),result=await asyncFn(console);result!==void 0&&console.log("Return value:",result),outputs.length===0&&outputs.push({kind:"output",value:"Code executed successfully (no output)"})}catch(r){const e=r instanceof Error?r.message:String(r);outputs.push({kind:"error",value:e})}return outputs},universalActions=[{label:"Save",action:async(r,e)=>{const n=e.filename||"untitled.txt",s=new Blob([r],{type:"text/plain"}),o=URL.createObjectURL(s),a=document.createElement("a");return a.href=o,a.download=n,a.click(),URL.revokeObjectURL(o),{outputs:[{kind:"output",value:`File saved as ${n}`}]}}},{label:"Copy",action:async r=>{try{return await navigator.clipboard.writeText(r),{outputs:[{kind:"output",value:"Code copied to clipboard"}]}}catch{return{outputs:[{kind:"error",value:"Failed to copy to clipboard"}]}}}}],langActionss=[{language:"json",actions:[{label:"Prettify",action:async(r,e)=>({newCode:JSON.stringify(JSON.parse(r),null,e.indentMode==="space"?" ".repeat(e.indentSize):"	"),outputs:[{kind:"output",value:"JSON formatted successfully"}]})},{label:"Minify",action:async r=>({newCode:JSON.stringify(JSON.parse(r)),outputs:[{kind:"output",value:"JSON minified successfully"}]})}]},{language:"javascript",actions:[{label:"Format",action:async(r,e)=>({newCode:await formatUsingPrettier("babel",r,e),outputs:[{kind:"output",value:"JavaScript formatted successfully"}]})},{label:"Run",action:async r=>{const e=await executeJavaScript(r);return{outputs:e.length>0?e:[{kind:"output",value:"No output"}]}}}]},{language:"typescript",actions:[{label:"Format",action:async(r,e)=>({newCode:await formatUsingPrettier("babel",r,e),outputs:[{kind:"output",value:"TypeScript formatted successfully"}]})}]},{language:"jsx",actions:[{label:"Format",action:async(r,e)=>({newCode:await formatUsingPrettier("babel",r,e),outputs:[{kind:"output",value:"JSX formatted successfully"}]})}]},{language:"tsx",actions:[{label:"Format",action:async(r,e)=>({newCode:await formatUsingPrettier("babel",r,e),outputs:[{kind:"output",value:"TSX formatted successfully"}]})}]},{language:"css",actions:[{label:"Format",action:async(r,e)=>({newCode:await formatUsingPrettier("css",r,e),outputs:[{kind:"output",value:"CSS formatted successfully"}]})}]},{language:"scss",actions:[{label:"Format",action:async(r,e)=>({newCode:await formatUsingPrettier("css",r,e),outputs:[{kind:"output",value:"SCSS formatted successfully"}]})}]},{language:"html",actions:[{label:"Format",action:async(r,e)=>({newCode:await formatUsingPrettier("html",r,e),outputs:[{kind:"output",value:"HTML formatted successfully"}]})}]},{language:"yaml",actions:[{label:"Format",action:async(r,e)=>{const n=await __vitePreload(()=>import("./index-CJb7ds1E.js"),[],import.meta.url);try{const s=n.parse(r);return{newCode:n.stringify(s,null,{indent:e.indentMode==="tab"?1:e.indentSize,lineWidth:80,minContentWidth:20}),outputs:[{kind:"output",value:"YAML formatted successfully"}]}}catch(s){return{outputs:[{kind:"error",value:`YAML format error: ${s instanceof Error?s.message:String(s)}`}]}}}}]},{language:"markdown",actions:[{label:"Format",action:async(r,e)=>({newCode:await formatUsingPrettier("markdown",r,e),outputs:[{kind:"output",value:"Markdown formatted successfully"}]})}]}],codeActions=new Map(langActionss.map(r=>[r.language,r.actions])),buildFooterActionItems=r=>{const e=getLanguageFromName(r.opts().filename),n=codeActions.get(e)||[];return[...universalActions,...n].map(o=>({label:o.label,onSelect:async()=>{try{r.setLoading(!0);const a=await o.action(r.code(),r.opts());a.newCode!==void 0&&r.setCode(a.newCode),a.outputs&&r.setOuts(a.outputs),toast.success(`Action "${o.label}" applied successfully.`,{duration:1e3}),console.log(`Action "${o.label}" applied successfully.`)}catch(a){const l=a instanceof Error?a.message:String(a);toast.error(`Error applying action "${o.label}"`,{duration:1e3}),console.error(`Error applying action "${o.label}":`,a),r.setOuts([{kind:"error",value:l}])}finally{r.setLoading(!1)}}}))};function M(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var w=M();function H(r){w=r}var C={exec:()=>null};function h(r,e=""){let n=typeof r=="string"?r:r.source,s={replace:(o,a)=>{let l=typeof a=="string"?a:a.source;return l=l.replace(m.caret,"$1"),n=n.replace(o,l),s},getRegex:()=>new RegExp(n,e)};return s}var m={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:r=>new RegExp(`^( {0,3}${r})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}#`),htmlBeginRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}<(?:[a-z].*>|!--)`,"i")},xe=/^(?:[ \t]*(?:\n|$))+/,be=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Te=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,I=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,we=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,j=/(?:[*+-]|\d{1,9}[.)])/,re=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,ie=h(re).replace(/bull/g,j).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),ye=h(re).replace(/bull/g,j).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),F=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Re=/^[^\n]+/,Q=/(?!\s*\])(?:\\.|[^\[\]\\])+/,Se=h(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",Q).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),$e=h(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,j).getRegex(),v="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",U=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,_e=h("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",U).replace("tag",v).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),oe=h(F).replace("hr",I).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",v).getRegex(),Le=h(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",oe).getRegex(),K={blockquote:Le,code:be,def:Se,fences:Te,heading:we,hr:I,html:_e,lheading:ie,list:$e,newline:xe,paragraph:oe,table:C,text:Re},se=h("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",I).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",v).getRegex(),ze={...K,lheading:ye,table:se,paragraph:h(F).replace("hr",I).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",se).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",v).getRegex()},Me={...K,html:h(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",U).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:C,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:h(F).replace("hr",I).replace("heading",` *#{1,6} *[^
]`).replace("lheading",ie).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Pe=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Ae=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,le=/^( {2,}|\\)\n(?!\s*$)/,Ee=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,D=/[\p{P}\p{S}]/u,X=/[\s\p{P}\p{S}]/u,ae=/[^\s\p{P}\p{S}]/u,Ce=h(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,X).getRegex(),ce=/(?!~)[\p{P}\p{S}]/u,Ie=/(?!~)[\s\p{P}\p{S}]/u,Oe=/(?:[^\s\p{P}\p{S}]|~)/u,Be=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,pe=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,qe=h(pe,"u").replace(/punct/g,D).getRegex(),ve=h(pe,"u").replace(/punct/g,ce).getRegex(),ue="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",De=h(ue,"gu").replace(/notPunctSpace/g,ae).replace(/punctSpace/g,X).replace(/punct/g,D).getRegex(),Ze=h(ue,"gu").replace(/notPunctSpace/g,Oe).replace(/punctSpace/g,Ie).replace(/punct/g,ce).getRegex(),Ge=h("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,ae).replace(/punctSpace/g,X).replace(/punct/g,D).getRegex(),He=h(/\\(punct)/,"gu").replace(/punct/g,D).getRegex(),Ne=h(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),je=h(U).replace("(?:-->|$)","-->").getRegex(),Fe=h("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",je).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),q=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Qe=h(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",q).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),he=h(/^!?\[(label)\]\[(ref)\]/).replace("label",q).replace("ref",Q).getRegex(),ke=h(/^!?\[(ref)\](?:\[\])?/).replace("ref",Q).getRegex(),Ue=h("reflink|nolink(?!\\()","g").replace("reflink",he).replace("nolink",ke).getRegex(),W={_backpedal:C,anyPunctuation:He,autolink:Ne,blockSkip:Be,br:le,code:Ae,del:C,emStrongLDelim:qe,emStrongRDelimAst:De,emStrongRDelimUnd:Ge,escape:Pe,link:Qe,nolink:ke,punctuation:Ce,reflink:he,reflinkSearch:Ue,tag:Fe,text:Ee,url:C},Ke={...W,link:h(/^!?\[(label)\]\((.*?)\)/).replace("label",q).getRegex(),reflink:h(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",q).getRegex()},N={...W,emStrongRDelimAst:Ze,emStrongLDelim:ve,url:h(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Xe={...N,br:h(le).replace("{2,}","*").getRegex(),text:h(N.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},O={normal:K,gfm:ze,pedantic:Me},P={normal:W,gfm:N,breaks:Xe,pedantic:Ke},We={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ge=r=>We[r];function R(r,e){if(e){if(m.escapeTest.test(r))return r.replace(m.escapeReplace,ge)}else if(m.escapeTestNoEncode.test(r))return r.replace(m.escapeReplaceNoEncode,ge);return r}function J(r){try{r=encodeURI(r).replace(m.percentDecode,"%")}catch{return null}return r}function V(r,e){let n=r.replace(m.findPipe,(a,l,c)=>{let u=!1,f=l;for(;--f>=0&&c[f]==="\\";)u=!u;return u?"|":" |"}),s=n.split(m.splitPipe),o=0;if(s[0].trim()||s.shift(),s.length>0&&!s.at(-1)?.trim()&&s.pop(),e)if(s.length>e)s.splice(e);else for(;s.length<e;)s.push("");for(;o<s.length;o++)s[o]=s[o].trim().replace(m.slashPipe,"|");return s}function A(r,e,n){let s=r.length;if(s===0)return"";let o=0;for(;o<s&&r.charAt(s-o-1)===e;)o++;return r.slice(0,s-o)}function fe(r,e){if(r.indexOf(e[1])===-1)return-1;let n=0;for(let s=0;s<r.length;s++)if(r[s]==="\\")s++;else if(r[s]===e[0])n++;else if(r[s]===e[1]&&(n--,n<0))return s;return n>0?-2:-1}function de(r,e,n,s,o){let a=e.href,l=e.title||null,c=r[1].replace(o.other.outputLinkReplace,"$1");s.state.inLink=!0;let u={type:r[0].charAt(0)==="!"?"image":"link",raw:n,href:a,title:l,text:c,tokens:s.inlineTokens(c)};return s.state.inLink=!1,u}function Je(r,e,n){let s=r.match(n.other.indentCodeCompensation);if(s===null)return e;let o=s[1];return e.split(`
`).map(a=>{let l=a.match(n.other.beginningSpace);if(l===null)return a;let[c]=l;return c.length>=o.length?a.slice(o.length):a}).join(`
`)}var S=class{options;rules;lexer;constructor(r){this.options=r||w}space(r){let e=this.rules.block.newline.exec(r);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(r){let e=this.rules.block.code.exec(r);if(e){let n=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?n:A(n,`
`)}}}fences(r){let e=this.rules.block.fences.exec(r);if(e){let n=e[0],s=Je(n,e[3]||"",this.rules);return{type:"code",raw:n,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:s}}}heading(r){let e=this.rules.block.heading.exec(r);if(e){let n=e[2].trim();if(this.rules.other.endingHash.test(n)){let s=A(n,"#");(this.options.pedantic||!s||this.rules.other.endingSpaceChar.test(s))&&(n=s.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(r){let e=this.rules.block.hr.exec(r);if(e)return{type:"hr",raw:A(e[0],`
`)}}blockquote(r){let e=this.rules.block.blockquote.exec(r);if(e){let n=A(e[0],`
`).split(`
`),s="",o="",a=[];for(;n.length>0;){let l=!1,c=[],u;for(u=0;u<n.length;u++)if(this.rules.other.blockquoteStart.test(n[u]))c.push(n[u]),l=!0;else if(!l)c.push(n[u]);else break;n=n.slice(u);let f=c.join(`
`),d=f.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");s=s?`${s}
${f}`:f,o=o?`${o}
${d}`:d;let p=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(d,a,!0),this.lexer.state.top=p,n.length===0)break;let g=a.at(-1);if(g?.type==="code")break;if(g?.type==="blockquote"){let y=g,x=y.raw+`
`+n.join(`
`),E=this.blockquote(x);a[a.length-1]=E,s=s.substring(0,s.length-y.raw.length)+E.raw,o=o.substring(0,o.length-y.text.length)+E.text;break}else if(g?.type==="list"){let y=g,x=y.raw+`
`+n.join(`
`),E=this.list(x);a[a.length-1]=E,s=s.substring(0,s.length-g.raw.length)+E.raw,o=o.substring(0,o.length-y.raw.length)+E.raw,n=x.substring(a.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:s,tokens:a,text:o}}}list(r){let e=this.rules.block.list.exec(r);if(e){let n=e[1].trim(),s=n.length>1,o={type:"list",raw:"",ordered:s,start:s?+n.slice(0,-1):"",loose:!1,items:[]};n=s?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=s?n:"[*+-]");let a=this.rules.other.listItemRegex(n),l=!1;for(;r;){let u=!1,f="",d="";if(!(e=a.exec(r))||this.rules.block.hr.test(r))break;f=e[0],r=r.substring(f.length);let p=e[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,Z=>" ".repeat(3*Z.length)),g=r.split(`
`,1)[0],y=!p.trim(),x=0;if(this.options.pedantic?(x=2,d=p.trimStart()):y?x=e[1].length+1:(x=e[2].search(this.rules.other.nonSpaceChar),x=x>4?1:x,d=p.slice(x),x+=e[1].length),y&&this.rules.other.blankLine.test(g)&&(f+=g+`
`,r=r.substring(g.length+1),u=!0),!u){let Z=this.rules.other.nextBulletRegex(x),te=this.rules.other.hrRegex(x),ne=this.rules.other.fencesBeginRegex(x),Ve=this.rules.other.headingBeginRegex(x),me=this.rules.other.htmlBeginRegex(x);for(;r;){let rt=r.split(`
`,1)[0],nt;if(g=rt,this.options.pedantic?(g=g.replace(this.rules.other.listReplaceNesting,"  "),nt=g):nt=g.replace(this.rules.other.tabCharGlobal,"    "),ne.test(g)||Ve.test(g)||me.test(g)||Z.test(g)||te.test(g))break;if(nt.search(this.rules.other.nonSpaceChar)>=x||!g.trim())d+=`
`+nt.slice(x);else{if(y||p.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||ne.test(p)||Ve.test(p)||te.test(p))break;d+=`
`+g}!y&&!g.trim()&&(y=!0),f+=rt+`
`,r=r.substring(rt.length+1),p=nt.slice(x)}}o.loose||(l?o.loose=!0:this.rules.other.doubleBlankLine.test(f)&&(l=!0));let E=null,Y;this.options.gfm&&(E=this.rules.other.listIsTask.exec(d),E&&(Y=E[0]!=="[ ] ",d=d.replace(this.rules.other.listReplaceTask,""))),o.items.push({type:"list_item",raw:f,task:!!E,checked:Y,loose:!1,text:d,tokens:[]}),o.raw+=f}let c=o.items.at(-1);if(c)c.raw=c.raw.trimEnd(),c.text=c.text.trimEnd();else return;o.raw=o.raw.trimEnd();for(let u=0;u<o.items.length;u++)if(this.lexer.state.top=!1,o.items[u].tokens=this.lexer.blockTokens(o.items[u].text,[]),!o.loose){let f=o.items[u].tokens.filter(p=>p.type==="space"),d=f.length>0&&f.some(p=>this.rules.other.anyLine.test(p.raw));o.loose=d}if(o.loose)for(let u=0;u<o.items.length;u++)o.items[u].loose=!0;return o}}html(r){let e=this.rules.block.html.exec(r);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(r){let e=this.rules.block.def.exec(r);if(e){let n=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),s=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",o=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:n,raw:e[0],href:s,title:o}}}table(r){let e=this.rules.block.table.exec(r);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let n=V(e[1]),s=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),o=e[3]?.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],a={type:"table",raw:e[0],header:[],align:[],rows:[]};if(n.length===s.length){for(let l of s)this.rules.other.tableAlignRight.test(l)?a.align.push("right"):this.rules.other.tableAlignCenter.test(l)?a.align.push("center"):this.rules.other.tableAlignLeft.test(l)?a.align.push("left"):a.align.push(null);for(let l=0;l<n.length;l++)a.header.push({text:n[l],tokens:this.lexer.inline(n[l]),header:!0,align:a.align[l]});for(let l of o)a.rows.push(V(l,a.header.length).map((c,u)=>({text:c,tokens:this.lexer.inline(c),header:!1,align:a.align[u]})));return a}}lheading(r){let e=this.rules.block.lheading.exec(r);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(r){let e=this.rules.block.paragraph.exec(r);if(e){let n=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:n,tokens:this.lexer.inline(n)}}}text(r){let e=this.rules.block.text.exec(r);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(r){let e=this.rules.inline.escape.exec(r);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(r){let e=this.rules.inline.tag.exec(r);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(r){let e=this.rules.inline.link.exec(r);if(e){let n=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;let a=A(n.slice(0,-1),"\\");if((n.length-a.length)%2===0)return}else{let a=fe(e[2],"()");if(a===-2)return;if(a>-1){let l=(e[0].indexOf("!")===0?5:4)+e[1].length+a;e[2]=e[2].substring(0,a),e[0]=e[0].substring(0,l).trim(),e[3]=""}}let s=e[2],o="";if(this.options.pedantic){let a=this.rules.other.pedanticHrefTitle.exec(s);a&&(s=a[1],o=a[3])}else o=e[3]?e[3].slice(1,-1):"";return s=s.trim(),this.rules.other.startAngleBracket.test(s)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?s=s.slice(1):s=s.slice(1,-1)),de(e,{href:s&&s.replace(this.rules.inline.anyPunctuation,"$1"),title:o&&o.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(r,e){let n;if((n=this.rules.inline.reflink.exec(r))||(n=this.rules.inline.nolink.exec(r))){let s=(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," "),o=e[s.toLowerCase()];if(!o){let a=n[0].charAt(0);return{type:"text",raw:a,text:a}}return de(n,o,n[0],this.lexer,this.rules)}}emStrong(r,e,n=""){let s=this.rules.inline.emStrongLDelim.exec(r);if(!(!s||s[3]&&n.match(this.rules.other.unicodeAlphaNumeric))&&(!(s[1]||s[2])||!n||this.rules.inline.punctuation.exec(n))){let o=[...s[0]].length-1,a,l,c=o,u=0,f=s[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(f.lastIndex=0,e=e.slice(-1*r.length+o);(s=f.exec(e))!=null;){if(a=s[1]||s[2]||s[3]||s[4]||s[5]||s[6],!a)continue;if(l=[...a].length,s[3]||s[4]){c+=l;continue}else if((s[5]||s[6])&&o%3&&!((o+l)%3)){u+=l;continue}if(c-=l,c>0)continue;l=Math.min(l,l+c+u);let d=[...s[0]][0].length,p=r.slice(0,o+s.index+d+l);if(Math.min(o,l)%2){let y=p.slice(1,-1);return{type:"em",raw:p,text:y,tokens:this.lexer.inlineTokens(y)}}let g=p.slice(2,-2);return{type:"strong",raw:p,text:g,tokens:this.lexer.inlineTokens(g)}}}}codespan(r){let e=this.rules.inline.code.exec(r);if(e){let n=e[2].replace(this.rules.other.newLineCharGlobal," "),s=this.rules.other.nonSpaceChar.test(n),o=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return s&&o&&(n=n.substring(1,n.length-1)),{type:"codespan",raw:e[0],text:n}}}br(r){let e=this.rules.inline.br.exec(r);if(e)return{type:"br",raw:e[0]}}del(r){let e=this.rules.inline.del.exec(r);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(r){let e=this.rules.inline.autolink.exec(r);if(e){let n,s;return e[2]==="@"?(n=e[1],s="mailto:"+n):(n=e[1],s=n),{type:"link",raw:e[0],text:n,href:s,tokens:[{type:"text",raw:n,text:n}]}}}url(r){let e;if(e=this.rules.inline.url.exec(r)){let n,s;if(e[2]==="@")n=e[0],s="mailto:"+n;else{let o;do o=e[0],e[0]=this.rules.inline._backpedal.exec(e[0])?.[0]??"";while(o!==e[0]);n=e[0],e[1]==="www."?s="http://"+e[0]:s=e[0]}return{type:"link",raw:e[0],text:n,href:s,tokens:[{type:"text",raw:n,text:n}]}}}inlineText(r){let e=this.rules.inline.text.exec(r);if(e){let n=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:n}}}},b=class Sn{tokens;options;state;tokenizer;inlineQueue;constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||w,this.options.tokenizer=this.options.tokenizer||new S,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let n={other:m,block:O.normal,inline:P.normal};this.options.pedantic?(n.block=O.pedantic,n.inline=P.pedantic):this.options.gfm&&(n.block=O.gfm,this.options.breaks?n.inline=P.breaks:n.inline=P.gfm),this.tokenizer.rules=n}static get rules(){return{block:O,inline:P}}static lex(e,n){return new Sn(n).lex(e)}static lexInline(e,n){return new Sn(n).inlineTokens(e)}lex(e){e=e.replace(m.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){let s=this.inlineQueue[n];this.inlineTokens(s.src,s.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,n=[],s=!1){for(this.options.pedantic&&(e=e.replace(m.tabCharGlobal,"    ").replace(m.spaceLine,""));e;){let o;if(this.options.extensions?.block?.some(l=>(o=l.call({lexer:this},e,n))?(e=e.substring(o.raw.length),n.push(o),!0):!1))continue;if(o=this.tokenizer.space(e)){e=e.substring(o.raw.length);let l=n.at(-1);o.raw.length===1&&l!==void 0?l.raw+=`
`:n.push(o);continue}if(o=this.tokenizer.code(e)){e=e.substring(o.raw.length);let l=n.at(-1);l?.type==="paragraph"||l?.type==="text"?(l.raw+=`
`+o.raw,l.text+=`
`+o.text,this.inlineQueue.at(-1).src=l.text):n.push(o);continue}if(o=this.tokenizer.fences(e)){e=e.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.heading(e)){e=e.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.hr(e)){e=e.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.blockquote(e)){e=e.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.list(e)){e=e.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.html(e)){e=e.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.def(e)){e=e.substring(o.raw.length);let l=n.at(-1);l?.type==="paragraph"||l?.type==="text"?(l.raw+=`
`+o.raw,l.text+=`
`+o.raw,this.inlineQueue.at(-1).src=l.text):this.tokens.links[o.tag]||(this.tokens.links[o.tag]={href:o.href,title:o.title});continue}if(o=this.tokenizer.table(e)){e=e.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.lheading(e)){e=e.substring(o.raw.length),n.push(o);continue}let a=e;if(this.options.extensions?.startBlock){let l=1/0,c=e.slice(1),u;this.options.extensions.startBlock.forEach(f=>{u=f.call({lexer:this},c),typeof u=="number"&&u>=0&&(l=Math.min(l,u))}),l<1/0&&l>=0&&(a=e.substring(0,l+1))}if(this.state.top&&(o=this.tokenizer.paragraph(a))){let l=n.at(-1);s&&l?.type==="paragraph"?(l.raw+=`
`+o.raw,l.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=l.text):n.push(o),s=a.length!==e.length,e=e.substring(o.raw.length);continue}if(o=this.tokenizer.text(e)){e=e.substring(o.raw.length);let l=n.at(-1);l?.type==="text"?(l.raw+=`
`+o.raw,l.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=l.text):n.push(o);continue}if(e){let l="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(l);break}else throw new Error(l)}}return this.state.top=!0,n}inline(e,n=[]){return this.inlineQueue.push({src:e,tokens:n}),n}inlineTokens(e,n=[]){let s=e,o=null;if(this.tokens.links){let c=Object.keys(this.tokens.links);if(c.length>0)for(;(o=this.tokenizer.rules.inline.reflinkSearch.exec(s))!=null;)c.includes(o[0].slice(o[0].lastIndexOf("[")+1,-1))&&(s=s.slice(0,o.index)+"["+"a".repeat(o[0].length-2)+"]"+s.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(o=this.tokenizer.rules.inline.anyPunctuation.exec(s))!=null;)s=s.slice(0,o.index)+"++"+s.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(o=this.tokenizer.rules.inline.blockSkip.exec(s))!=null;)s=s.slice(0,o.index)+"["+"a".repeat(o[0].length-2)+"]"+s.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let a=!1,l="";for(;e;){a||(l=""),a=!1;let c;if(this.options.extensions?.inline?.some(f=>(c=f.call({lexer:this},e,n))?(e=e.substring(c.raw.length),n.push(c),!0):!1))continue;if(c=this.tokenizer.escape(e)){e=e.substring(c.raw.length),n.push(c);continue}if(c=this.tokenizer.tag(e)){e=e.substring(c.raw.length),n.push(c);continue}if(c=this.tokenizer.link(e)){e=e.substring(c.raw.length),n.push(c);continue}if(c=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(c.raw.length);let f=n.at(-1);c.type==="text"&&f?.type==="text"?(f.raw+=c.raw,f.text+=c.text):n.push(c);continue}if(c=this.tokenizer.emStrong(e,s,l)){e=e.substring(c.raw.length),n.push(c);continue}if(c=this.tokenizer.codespan(e)){e=e.substring(c.raw.length),n.push(c);continue}if(c=this.tokenizer.br(e)){e=e.substring(c.raw.length),n.push(c);continue}if(c=this.tokenizer.del(e)){e=e.substring(c.raw.length),n.push(c);continue}if(c=this.tokenizer.autolink(e)){e=e.substring(c.raw.length),n.push(c);continue}if(!this.state.inLink&&(c=this.tokenizer.url(e))){e=e.substring(c.raw.length),n.push(c);continue}let u=e;if(this.options.extensions?.startInline){let f=1/0,d=e.slice(1),p;this.options.extensions.startInline.forEach(g=>{p=g.call({lexer:this},d),typeof p=="number"&&p>=0&&(f=Math.min(f,p))}),f<1/0&&f>=0&&(u=e.substring(0,f+1))}if(c=this.tokenizer.inlineText(u)){e=e.substring(c.raw.length),c.raw.slice(-1)!=="_"&&(l=c.raw.slice(-1)),a=!0;let f=n.at(-1);f?.type==="text"?(f.raw+=c.raw,f.text+=c.text):n.push(c);continue}if(e){let f="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(f);break}else throw new Error(f)}}return n}},$=class{options;parser;constructor(r){this.options=r||w}space(r){return""}code({text:r,lang:e,escaped:n}){let s=(e||"").match(m.notSpaceStart)?.[0],o=r.replace(m.endingNewline,"")+`
`;return s?'<pre><code class="language-'+R(s)+'">'+(n?o:R(o,!0))+`</code></pre>
`:"<pre><code>"+(n?o:R(o,!0))+`</code></pre>
`}blockquote({tokens:r}){return`<blockquote>
${this.parser.parse(r)}</blockquote>
`}html({text:r}){return r}heading({tokens:r,depth:e}){return`<h${e}>${this.parser.parseInline(r)}</h${e}>
`}hr(r){return`<hr>
`}list(r){let e=r.ordered,n=r.start,s="";for(let l=0;l<r.items.length;l++){let c=r.items[l];s+=this.listitem(c)}let o=e?"ol":"ul",a=e&&n!==1?' start="'+n+'"':"";return"<"+o+a+`>
`+s+"</"+o+`>
`}listitem(r){let e="";if(r.task){let n=this.checkbox({checked:!!r.checked});r.loose?r.tokens[0]?.type==="paragraph"?(r.tokens[0].text=n+" "+r.tokens[0].text,r.tokens[0].tokens&&r.tokens[0].tokens.length>0&&r.tokens[0].tokens[0].type==="text"&&(r.tokens[0].tokens[0].text=n+" "+R(r.tokens[0].tokens[0].text),r.tokens[0].tokens[0].escaped=!0)):r.tokens.unshift({type:"text",raw:n+" ",text:n+" ",escaped:!0}):e+=n+" "}return e+=this.parser.parse(r.tokens,!!r.loose),`<li>${e}</li>
`}checkbox({checked:r}){return"<input "+(r?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:r}){return`<p>${this.parser.parseInline(r)}</p>
`}table(r){let e="",n="";for(let o=0;o<r.header.length;o++)n+=this.tablecell(r.header[o]);e+=this.tablerow({text:n});let s="";for(let o=0;o<r.rows.length;o++){let a=r.rows[o];n="";for(let l=0;l<a.length;l++)n+=this.tablecell(a[l]);s+=this.tablerow({text:n})}return s&&(s=`<tbody>${s}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+s+`</table>
`}tablerow({text:r}){return`<tr>
${r}</tr>
`}tablecell(r){let e=this.parser.parseInline(r.tokens),n=r.header?"th":"td";return(r.align?`<${n} align="${r.align}">`:`<${n}>`)+e+`</${n}>
`}strong({tokens:r}){return`<strong>${this.parser.parseInline(r)}</strong>`}em({tokens:r}){return`<em>${this.parser.parseInline(r)}</em>`}codespan({text:r}){return`<code>${R(r,!0)}</code>`}br(r){return"<br>"}del({tokens:r}){return`<del>${this.parser.parseInline(r)}</del>`}link({href:r,title:e,tokens:n}){let s=this.parser.parseInline(n),o=J(r);if(o===null)return s;r=o;let a='<a href="'+r+'"';return e&&(a+=' title="'+R(e)+'"'),a+=">"+s+"</a>",a}image({href:r,title:e,text:n,tokens:s}){s&&(n=this.parser.parseInline(s,this.parser.textRenderer));let o=J(r);if(o===null)return R(n);r=o;let a=`<img src="${r}" alt="${n}"`;return e&&(a+=` title="${R(e)}"`),a+=">",a}text(r){return"tokens"in r&&r.tokens?this.parser.parseInline(r.tokens):"escaped"in r&&r.escaped?r.text:R(r.text)}},_=class{strong({text:r}){return r}em({text:r}){return r}codespan({text:r}){return r}del({text:r}){return r}html({text:r}){return r}text({text:r}){return r}link({text:r}){return""+r}image({text:r}){return""+r}br(){return""}},T=class kn{options;renderer;textRenderer;constructor(e){this.options=e||w,this.options.renderer=this.options.renderer||new $,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new _}static parse(e,n){return new kn(n).parse(e)}static parseInline(e,n){return new kn(n).parseInline(e)}parse(e,n=!0){let s="";for(let o=0;o<e.length;o++){let a=e[o];if(this.options.extensions?.renderers?.[a.type]){let c=a,u=this.options.extensions.renderers[c.type].call({parser:this},c);if(u!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(c.type)){s+=u||"";continue}}let l=a;switch(l.type){case"space":{s+=this.renderer.space(l);continue}case"hr":{s+=this.renderer.hr(l);continue}case"heading":{s+=this.renderer.heading(l);continue}case"code":{s+=this.renderer.code(l);continue}case"table":{s+=this.renderer.table(l);continue}case"blockquote":{s+=this.renderer.blockquote(l);continue}case"list":{s+=this.renderer.list(l);continue}case"html":{s+=this.renderer.html(l);continue}case"paragraph":{s+=this.renderer.paragraph(l);continue}case"text":{let c=l,u=this.renderer.text(c);for(;o+1<e.length&&e[o+1].type==="text";)c=e[++o],u+=`
`+this.renderer.text(c);n?s+=this.renderer.paragraph({type:"paragraph",raw:u,text:u,tokens:[{type:"text",raw:u,text:u,escaped:!0}]}):s+=u;continue}default:{let c='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return s}parseInline(e,n=this.renderer){let s="";for(let o=0;o<e.length;o++){let a=e[o];if(this.options.extensions?.renderers?.[a.type]){let c=this.options.extensions.renderers[a.type].call({parser:this},a);if(c!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(a.type)){s+=c||"";continue}}let l=a;switch(l.type){case"escape":{s+=n.text(l);break}case"html":{s+=n.html(l);break}case"link":{s+=n.link(l);break}case"image":{s+=n.image(l);break}case"strong":{s+=n.strong(l);break}case"em":{s+=n.em(l);break}case"codespan":{s+=n.codespan(l);break}case"br":{s+=n.br(l);break}case"del":{s+=n.del(l);break}case"text":{s+=n.text(l);break}default:{let c='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return s}},L=class{options;block;constructor(r){this.options=r||w}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(r){return r}postprocess(r){return r}processAllTokens(r){return r}provideLexer(){return this.block?b.lex:b.lexInline}provideParser(){return this.block?T.parse:T.parseInline}},B=class{defaults=M();options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=T;Renderer=$;TextRenderer=_;Lexer=b;Tokenizer=S;Hooks=L;constructor(...r){this.use(...r)}walkTokens(r,e){let n=[];for(let s of r)switch(n=n.concat(e.call(this,s)),s.type){case"table":{let o=s;for(let a of o.header)n=n.concat(this.walkTokens(a.tokens,e));for(let a of o.rows)for(let l of a)n=n.concat(this.walkTokens(l.tokens,e));break}case"list":{let o=s;n=n.concat(this.walkTokens(o.items,e));break}default:{let o=s;this.defaults.extensions?.childTokens?.[o.type]?this.defaults.extensions.childTokens[o.type].forEach(a=>{let l=o[a].flat(1/0);n=n.concat(this.walkTokens(l,e))}):o.tokens&&(n=n.concat(this.walkTokens(o.tokens,e)))}}return n}use(...r){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return r.forEach(n=>{let s={...n};if(s.async=this.defaults.async||s.async||!1,n.extensions&&(n.extensions.forEach(o=>{if(!o.name)throw new Error("extension name required");if("renderer"in o){let a=e.renderers[o.name];a?e.renderers[o.name]=function(...l){let c=o.renderer.apply(this,l);return c===!1&&(c=a.apply(this,l)),c}:e.renderers[o.name]=o.renderer}if("tokenizer"in o){if(!o.level||o.level!=="block"&&o.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let a=e[o.level];a?a.unshift(o.tokenizer):e[o.level]=[o.tokenizer],o.start&&(o.level==="block"?e.startBlock?e.startBlock.push(o.start):e.startBlock=[o.start]:o.level==="inline"&&(e.startInline?e.startInline.push(o.start):e.startInline=[o.start]))}"childTokens"in o&&o.childTokens&&(e.childTokens[o.name]=o.childTokens)}),s.extensions=e),n.renderer){let o=this.defaults.renderer||new $(this.defaults);for(let a in n.renderer){if(!(a in o))throw new Error(`renderer '${a}' does not exist`);if(["options","parser"].includes(a))continue;let l=a,c=n.renderer[l],u=o[l];o[l]=(...f)=>{let d=c.apply(o,f);return d===!1&&(d=u.apply(o,f)),d||""}}s.renderer=o}if(n.tokenizer){let o=this.defaults.tokenizer||new S(this.defaults);for(let a in n.tokenizer){if(!(a in o))throw new Error(`tokenizer '${a}' does not exist`);if(["options","rules","lexer"].includes(a))continue;let l=a,c=n.tokenizer[l],u=o[l];o[l]=(...f)=>{let d=c.apply(o,f);return d===!1&&(d=u.apply(o,f)),d}}s.tokenizer=o}if(n.hooks){let o=this.defaults.hooks||new L;for(let a in n.hooks){if(!(a in o))throw new Error(`hook '${a}' does not exist`);if(["options","block"].includes(a))continue;let l=a,c=n.hooks[l],u=o[l];L.passThroughHooks.has(a)?o[l]=f=>{if(this.defaults.async)return Promise.resolve(c.call(o,f)).then(p=>u.call(o,p));let d=c.call(o,f);return u.call(o,d)}:o[l]=(...f)=>{let d=c.apply(o,f);return d===!1&&(d=u.apply(o,f)),d}}s.hooks=o}if(n.walkTokens){let o=this.defaults.walkTokens,a=n.walkTokens;s.walkTokens=function(l){let c=[];return c.push(a.call(this,l)),o&&(c=c.concat(o.call(this,l))),c}}this.defaults={...this.defaults,...s}}),this}setOptions(r){return this.defaults={...this.defaults,...r},this}lexer(r,e){return b.lex(r,e??this.defaults)}parser(r,e){return T.parse(r,e??this.defaults)}parseMarkdown(r){return(e,n)=>{let s={...n},o={...this.defaults,...s},a=this.onError(!!o.silent,!!o.async);if(this.defaults.async===!0&&s.async===!1)return a(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));o.hooks&&(o.hooks.options=o,o.hooks.block=r);let l=o.hooks?o.hooks.provideLexer():r?b.lex:b.lexInline,c=o.hooks?o.hooks.provideParser():r?T.parse:T.parseInline;if(o.async)return Promise.resolve(o.hooks?o.hooks.preprocess(e):e).then(u=>l(u,o)).then(u=>o.hooks?o.hooks.processAllTokens(u):u).then(u=>o.walkTokens?Promise.all(this.walkTokens(u,o.walkTokens)).then(()=>u):u).then(u=>c(u,o)).then(u=>o.hooks?o.hooks.postprocess(u):u).catch(a);try{o.hooks&&(e=o.hooks.preprocess(e));let u=l(e,o);o.hooks&&(u=o.hooks.processAllTokens(u)),o.walkTokens&&this.walkTokens(u,o.walkTokens);let f=c(u,o);return o.hooks&&(f=o.hooks.postprocess(f)),f}catch(u){return a(u)}}}onError(r,e){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,r){let s="<p>An error occurred:</p><pre>"+R(n.message+"",!0)+"</pre>";return e?Promise.resolve(s):s}if(e)return Promise.reject(n);throw n}}},z=new B;function k(r,e){return z.parse(r,e)}k.options=k.setOptions=function(r){return z.setOptions(r),k.defaults=z.defaults,H(k.defaults),k};k.getDefaults=M;k.defaults=w;k.use=function(...r){return z.use(...r),k.defaults=z.defaults,H(k.defaults),k};k.walkTokens=function(r,e){return z.walkTokens(r,e)};k.parseInline=z.parseInline;k.Parser=T;k.parser=T.parse;k.Renderer=$;k.TextRenderer=_;k.Lexer=b;k.lexer=b.lex;k.Tokenizer=S;k.Hooks=L;k.parse=k;k.options;k.setOptions;k.use;k.walkTokens;k.parseInline;T.parse;b.lex;/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries,setPrototypeOf,isFrozen,getPrototypeOf,getOwnPropertyDescriptor}=Object;let{freeze,seal,create}=Object,{apply,construct}=typeof Reflect<"u"&&Reflect;freeze||(freeze=function(e){return e});seal||(seal=function(e){return e});apply||(apply=function(e,n,s){return e.apply(n,s)});construct||(construct=function(e,n){return new e(...n)});const arrayForEach=unapply(Array.prototype.forEach),arrayLastIndexOf=unapply(Array.prototype.lastIndexOf),arrayPop=unapply(Array.prototype.pop),arrayPush=unapply(Array.prototype.push),arraySplice=unapply(Array.prototype.splice),stringToLowerCase=unapply(String.prototype.toLowerCase),stringToString=unapply(String.prototype.toString),stringMatch=unapply(String.prototype.match),stringReplace=unapply(String.prototype.replace),stringIndexOf=unapply(String.prototype.indexOf),stringTrim=unapply(String.prototype.trim),objectHasOwnProperty=unapply(Object.prototype.hasOwnProperty),regExpTest=unapply(RegExp.prototype.test),typeErrorCreate=unconstruct(TypeError);function unapply(r){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,s=new Array(n>1?n-1:0),o=1;o<n;o++)s[o-1]=arguments[o];return apply(r,e,s)}}function unconstruct(r){return function(){for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];return construct(r,n)}}function addToSet(r,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:stringToLowerCase;setPrototypeOf&&setPrototypeOf(r,null);let s=e.length;for(;s--;){let o=e[s];if(typeof o=="string"){const a=n(o);a!==o&&(isFrozen(e)||(e[s]=a),o=a)}r[o]=!0}return r}function cleanArray(r){for(let e=0;e<r.length;e++)objectHasOwnProperty(r,e)||(r[e]=null);return r}function clone(r){const e=create(null);for(const[n,s]of entries(r))objectHasOwnProperty(r,n)&&(Array.isArray(s)?e[n]=cleanArray(s):s&&typeof s=="object"&&s.constructor===Object?e[n]=clone(s):e[n]=s);return e}function lookupGetter(r,e){for(;r!==null;){const s=getOwnPropertyDescriptor(r,e);if(s){if(s.get)return unapply(s.get);if(typeof s.value=="function")return unapply(s.value)}r=getPrototypeOf(r)}function n(){return null}return n}const html$1=freeze(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),svg$1=freeze(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),svgFilters=freeze(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),svgDisallowed=freeze(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),mathMl$1=freeze(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),mathMlDisallowed=freeze(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),text=freeze(["#text"]),html=freeze(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),svg=freeze(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),mathMl=freeze(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),xml=freeze(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),MUSTACHE_EXPR=seal(/\{\{[\w\W]*|[\w\W]*\}\}/gm),ERB_EXPR=seal(/<%[\w\W]*|[\w\W]*%>/gm),TMPLIT_EXPR=seal(/\$\{[\w\W]*/gm),DATA_ATTR=seal(/^data-[\-\w.\u00B7-\uFFFF]+$/),ARIA_ATTR=seal(/^aria-[\-\w]+$/),IS_ALLOWED_URI=seal(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),IS_SCRIPT_OR_DATA=seal(/^(?:\w+script|data):/i),ATTR_WHITESPACE=seal(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),DOCTYPE_NAME=seal(/^html$/i),CUSTOM_ELEMENT=seal(/^[a-z][.\w]*(-[.\w]+)+$/i);var EXPRESSIONS=Object.freeze({__proto__:null,ARIA_ATTR,ATTR_WHITESPACE,CUSTOM_ELEMENT,DATA_ATTR,DOCTYPE_NAME,ERB_EXPR,IS_ALLOWED_URI,IS_SCRIPT_OR_DATA,MUSTACHE_EXPR,TMPLIT_EXPR});const NODE_TYPE={element:1,text:3,progressingInstruction:7,comment:8,document:9},getGlobal=function r(){return typeof window>"u"?null:window},_createTrustedTypesPolicy=function r(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let s=null;const o="data-tt-policy-suffix";n&&n.hasAttribute(o)&&(s=n.getAttribute(o));const a="dompurify"+(s?"#"+s:"");try{return e.createPolicy(a,{createHTML(l){return l},createScriptURL(l){return l}})}catch{return console.warn("TrustedTypes policy "+a+" could not be created."),null}},_createHooksMap=function r(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function createDOMPurify(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:getGlobal();const e=Dt=>createDOMPurify(Dt);if(e.version="3.2.6",e.removed=[],!r||!r.document||r.document.nodeType!==NODE_TYPE.document||!r.Element)return e.isSupported=!1,e;let{document:n}=r;const s=n,o=s.currentScript,{DocumentFragment:a,HTMLTemplateElement:l,Node:c,Element:u,NodeFilter:f,NamedNodeMap:d=r.NamedNodeMap||r.MozNamedAttrMap,HTMLFormElement:p,DOMParser:g,trustedTypes:y}=r,x=u.prototype,E=lookupGetter(x,"cloneNode"),Y=lookupGetter(x,"remove"),Z=lookupGetter(x,"nextSibling"),te=lookupGetter(x,"childNodes"),ne=lookupGetter(x,"parentNode");if(typeof l=="function"){const Dt=n.createElement("template");Dt.content&&Dt.content.ownerDocument&&(n=Dt.content.ownerDocument)}let Ve,me="";const{implementation:rt,createNodeIterator:nt,createDocumentFragment:ct,getElementsByTagName:ot}=n,{importNode:ft}=s;let mt=_createHooksMap();e.isSupported=typeof entries=="function"&&typeof ne=="function"&&rt&&rt.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:Ye,ERB_EXPR:ht,TMPLIT_EXPR:ee,DATA_ATTR:pt,ARIA_ATTR:Ot,IS_SCRIPT_OR_DATA:vt,ATTR_WHITESPACE:Rt,CUSTOM_ELEMENT:bt}=EXPRESSIONS;let{IS_ALLOWED_URI:Mt}=EXPRESSIONS,at=null;const lt=addToSet({},[...html$1,...svg$1,...svgFilters,...mathMl$1,...text]);let _t=null;const At=addToSet({},[...html,...svg,...mathMl,...xml]);let wt=Object.seal(create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Nt=null,Vt=null,$t=!0,Lt=!0,Ht=!1,zt=!0,jt=!1,Gt=!0,G=!1,gt=!1,dt=!1,tt=!1,et=!1,st=!1,yt=!0,St=!1;const ut="user-content-";let kt=!0,Et=!1,xt={},Pt=null;const Bt=addToSet({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let It=null;const Yt=addToSet({},["audio","video","img","source","image","track"]);let on=null;const Qt=addToSet({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),nn="http://www.w3.org/1998/Math/MathML",Ft="http://www.w3.org/2000/svg",Xt="http://www.w3.org/1999/xhtml";let rn=Xt,en=!1,cn=null;const yn=addToSet({},[nn,Ft,Xt],stringToString);let hn=addToSet({},["mi","mo","mn","ms","mtext"]),un=addToSet({},["annotation-xml"]);const mn=addToSet({},["title","style","font","a","script"]);let tn=null;const fn=["application/xhtml+xml","text/html"],Ln="text/html";let Wt=null,dn=null;const Nn=n.createElement("form"),xn=function(it){return it instanceof RegExp||it instanceof Function},bn=function(){let it=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(dn&&dn===it)){if((!it||typeof it!="object")&&(it={}),it=clone(it),tn=fn.indexOf(it.PARSER_MEDIA_TYPE)===-1?Ln:it.PARSER_MEDIA_TYPE,Wt=tn==="application/xhtml+xml"?stringToString:stringToLowerCase,at=objectHasOwnProperty(it,"ALLOWED_TAGS")?addToSet({},it.ALLOWED_TAGS,Wt):lt,_t=objectHasOwnProperty(it,"ALLOWED_ATTR")?addToSet({},it.ALLOWED_ATTR,Wt):At,cn=objectHasOwnProperty(it,"ALLOWED_NAMESPACES")?addToSet({},it.ALLOWED_NAMESPACES,stringToString):yn,on=objectHasOwnProperty(it,"ADD_URI_SAFE_ATTR")?addToSet(clone(Qt),it.ADD_URI_SAFE_ATTR,Wt):Qt,It=objectHasOwnProperty(it,"ADD_DATA_URI_TAGS")?addToSet(clone(Yt),it.ADD_DATA_URI_TAGS,Wt):Yt,Pt=objectHasOwnProperty(it,"FORBID_CONTENTS")?addToSet({},it.FORBID_CONTENTS,Wt):Bt,Nt=objectHasOwnProperty(it,"FORBID_TAGS")?addToSet({},it.FORBID_TAGS,Wt):clone({}),Vt=objectHasOwnProperty(it,"FORBID_ATTR")?addToSet({},it.FORBID_ATTR,Wt):clone({}),xt=objectHasOwnProperty(it,"USE_PROFILES")?it.USE_PROFILES:!1,$t=it.ALLOW_ARIA_ATTR!==!1,Lt=it.ALLOW_DATA_ATTR!==!1,Ht=it.ALLOW_UNKNOWN_PROTOCOLS||!1,zt=it.ALLOW_SELF_CLOSE_IN_ATTR!==!1,jt=it.SAFE_FOR_TEMPLATES||!1,Gt=it.SAFE_FOR_XML!==!1,G=it.WHOLE_DOCUMENT||!1,tt=it.RETURN_DOM||!1,et=it.RETURN_DOM_FRAGMENT||!1,st=it.RETURN_TRUSTED_TYPE||!1,dt=it.FORCE_BODY||!1,yt=it.SANITIZE_DOM!==!1,St=it.SANITIZE_NAMED_PROPS||!1,kt=it.KEEP_CONTENT!==!1,Et=it.IN_PLACE||!1,Mt=it.ALLOWED_URI_REGEXP||IS_ALLOWED_URI,rn=it.NAMESPACE||Xt,hn=it.MATHML_TEXT_INTEGRATION_POINTS||hn,un=it.HTML_INTEGRATION_POINTS||un,wt=it.CUSTOM_ELEMENT_HANDLING||{},it.CUSTOM_ELEMENT_HANDLING&&xn(it.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(wt.tagNameCheck=it.CUSTOM_ELEMENT_HANDLING.tagNameCheck),it.CUSTOM_ELEMENT_HANDLING&&xn(it.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(wt.attributeNameCheck=it.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),it.CUSTOM_ELEMENT_HANDLING&&typeof it.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(wt.allowCustomizedBuiltInElements=it.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),jt&&(Lt=!1),et&&(tt=!0),xt&&(at=addToSet({},text),_t=[],xt.html===!0&&(addToSet(at,html$1),addToSet(_t,html)),xt.svg===!0&&(addToSet(at,svg$1),addToSet(_t,svg),addToSet(_t,xml)),xt.svgFilters===!0&&(addToSet(at,svgFilters),addToSet(_t,svg),addToSet(_t,xml)),xt.mathMl===!0&&(addToSet(at,mathMl$1),addToSet(_t,mathMl),addToSet(_t,xml))),it.ADD_TAGS&&(at===lt&&(at=clone(at)),addToSet(at,it.ADD_TAGS,Wt)),it.ADD_ATTR&&(_t===At&&(_t=clone(_t)),addToSet(_t,it.ADD_ATTR,Wt)),it.ADD_URI_SAFE_ATTR&&addToSet(on,it.ADD_URI_SAFE_ATTR,Wt),it.FORBID_CONTENTS&&(Pt===Bt&&(Pt=clone(Pt)),addToSet(Pt,it.FORBID_CONTENTS,Wt)),kt&&(at["#text"]=!0),G&&addToSet(at,["html","head","body"]),at.table&&(addToSet(at,["tbody"]),delete Nt.tbody),it.TRUSTED_TYPES_POLICY){if(typeof it.TRUSTED_TYPES_POLICY.createHTML!="function")throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof it.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');Ve=it.TRUSTED_TYPES_POLICY,me=Ve.createHTML("")}else Ve===void 0&&(Ve=_createTrustedTypesPolicy(y,o)),Ve!==null&&typeof me=="string"&&(me=Ve.createHTML(""));freeze&&freeze(it),dn=it}},Cn=addToSet({},[...svg$1,...svgFilters,...svgDisallowed]),_n=addToSet({},[...mathMl$1,...mathMlDisallowed]),Bn=function(it){let Ct=ne(it);(!Ct||!Ct.tagName)&&(Ct={namespaceURI:rn,tagName:"template"});const Tt=stringToLowerCase(it.tagName),Zt=stringToLowerCase(Ct.tagName);return cn[it.namespaceURI]?it.namespaceURI===Ft?Ct.namespaceURI===Xt?Tt==="svg":Ct.namespaceURI===nn?Tt==="svg"&&(Zt==="annotation-xml"||hn[Zt]):!!Cn[Tt]:it.namespaceURI===nn?Ct.namespaceURI===Xt?Tt==="math":Ct.namespaceURI===Ft?Tt==="math"&&un[Zt]:!!_n[Tt]:it.namespaceURI===Xt?Ct.namespaceURI===Ft&&!un[Zt]||Ct.namespaceURI===nn&&!hn[Zt]?!1:!_n[Tt]&&(mn[Tt]||!Cn[Tt]):!!(tn==="application/xhtml+xml"&&cn[it.namespaceURI]):!1},sn=function(it){arrayPush(e.removed,{element:it});try{ne(it).removeChild(it)}catch{Y(it)}},pn=function(it,Ct){try{arrayPush(e.removed,{attribute:Ct.getAttributeNode(it),from:Ct})}catch{arrayPush(e.removed,{attribute:null,from:Ct})}if(Ct.removeAttribute(it),it==="is")if(tt||et)try{sn(Ct)}catch{}else try{Ct.setAttribute(it,"")}catch{}},An=function(it){let Ct=null,Tt=null;if(dt)it="<remove></remove>"+it;else{const Ut=stringMatch(it,/^[\r\n\t ]+/);Tt=Ut&&Ut[0]}tn==="application/xhtml+xml"&&rn===Xt&&(it='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+it+"</body></html>");const Zt=Ve?Ve.createHTML(it):it;if(rn===Xt)try{Ct=new g().parseFromString(Zt,tn)}catch{}if(!Ct||!Ct.documentElement){Ct=rt.createDocument(rn,"template",null);try{Ct.documentElement.innerHTML=en?me:Zt}catch{}}const qt=Ct.body||Ct.documentElement;return it&&Tt&&qt.insertBefore(n.createTextNode(Tt),qt.childNodes[0]||null),rn===Xt?ot.call(Ct,G?"html":"body")[0]:G?Ct.documentElement:qt},En=function(it){return nt.call(it.ownerDocument||it,it,f.SHOW_ELEMENT|f.SHOW_COMMENT|f.SHOW_TEXT|f.SHOW_PROCESSING_INSTRUCTION|f.SHOW_CDATA_SECTION,null)},wn=function(it){return it instanceof p&&(typeof it.nodeName!="string"||typeof it.textContent!="string"||typeof it.removeChild!="function"||!(it.attributes instanceof d)||typeof it.removeAttribute!="function"||typeof it.setAttribute!="function"||typeof it.namespaceURI!="string"||typeof it.insertBefore!="function"||typeof it.hasChildNodes!="function")},Tn=function(it){return typeof c=="function"&&it instanceof c};function an(Dt,it,Ct){arrayForEach(Dt,Tt=>{Tt.call(e,it,Ct,dn)})}const Pn=function(it){let Ct=null;if(an(mt.beforeSanitizeElements,it,null),wn(it))return sn(it),!0;const Tt=Wt(it.nodeName);if(an(mt.uponSanitizeElement,it,{tagName:Tt,allowedTags:at}),Gt&&it.hasChildNodes()&&!Tn(it.firstElementChild)&&regExpTest(/<[/\w!]/g,it.innerHTML)&&regExpTest(/<[/\w!]/g,it.textContent)||it.nodeType===NODE_TYPE.progressingInstruction||Gt&&it.nodeType===NODE_TYPE.comment&&regExpTest(/<[/\w]/g,it.data))return sn(it),!0;if(!at[Tt]||Nt[Tt]){if(!Nt[Tt]&&Dn(Tt)&&(wt.tagNameCheck instanceof RegExp&&regExpTest(wt.tagNameCheck,Tt)||wt.tagNameCheck instanceof Function&&wt.tagNameCheck(Tt)))return!1;if(kt&&!Pt[Tt]){const Zt=ne(it)||it.parentNode,qt=te(it)||it.childNodes;if(qt&&Zt){const Ut=qt.length;for(let Jt=Ut-1;Jt>=0;--Jt){const ln=E(qt[Jt],!0);ln.__removalCount=(it.__removalCount||0)+1,Zt.insertBefore(ln,Z(it))}}}return sn(it),!0}return it instanceof u&&!Bn(it)||(Tt==="noscript"||Tt==="noembed"||Tt==="noframes")&&regExpTest(/<\/no(script|embed|frames)/i,it.innerHTML)?(sn(it),!0):(jt&&it.nodeType===NODE_TYPE.text&&(Ct=it.textContent,arrayForEach([Ye,ht,ee],Zt=>{Ct=stringReplace(Ct,Zt," ")}),it.textContent!==Ct&&(arrayPush(e.removed,{element:it.cloneNode()}),it.textContent=Ct)),an(mt.afterSanitizeElements,it,null),!1)},On=function(it,Ct,Tt){if(yt&&(Ct==="id"||Ct==="name")&&(Tt in n||Tt in Nn))return!1;if(!(Lt&&!Vt[Ct]&&regExpTest(pt,Ct))){if(!($t&&regExpTest(Ot,Ct))){if(!_t[Ct]||Vt[Ct]){if(!(Dn(it)&&(wt.tagNameCheck instanceof RegExp&&regExpTest(wt.tagNameCheck,it)||wt.tagNameCheck instanceof Function&&wt.tagNameCheck(it))&&(wt.attributeNameCheck instanceof RegExp&&regExpTest(wt.attributeNameCheck,Ct)||wt.attributeNameCheck instanceof Function&&wt.attributeNameCheck(Ct))||Ct==="is"&&wt.allowCustomizedBuiltInElements&&(wt.tagNameCheck instanceof RegExp&&regExpTest(wt.tagNameCheck,Tt)||wt.tagNameCheck instanceof Function&&wt.tagNameCheck(Tt))))return!1}else if(!on[Ct]){if(!regExpTest(Mt,stringReplace(Tt,Rt,""))){if(!((Ct==="src"||Ct==="xlink:href"||Ct==="href")&&it!=="script"&&stringIndexOf(Tt,"data:")===0&&It[it])){if(!(Ht&&!regExpTest(vt,stringReplace(Tt,Rt,"")))){if(Tt)return!1}}}}}}return!0},Dn=function(it){return it!=="annotation-xml"&&stringMatch(it,bt)},Mn=function(it){an(mt.beforeSanitizeAttributes,it,null);const{attributes:Ct}=it;if(!Ct||wn(it))return;const Tt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:_t,forceKeepAttr:void 0};let Zt=Ct.length;for(;Zt--;){const qt=Ct[Zt],{name:Ut,namespaceURI:Jt,value:ln}=qt,gn=Wt(Ut),vn=ln;let Kt=Ut==="value"?vn:stringTrim(vn);if(Tt.attrName=gn,Tt.attrValue=Kt,Tt.keepAttr=!0,Tt.forceKeepAttr=void 0,an(mt.uponSanitizeAttribute,it,Tt),Kt=Tt.attrValue,St&&(gn==="id"||gn==="name")&&(pn(Ut,it),Kt=ut+Kt),Gt&&regExpTest(/((--!?|])>)|<\/(style|title)/i,Kt)){pn(Ut,it);continue}if(Tt.forceKeepAttr)continue;if(!Tt.keepAttr){pn(Ut,it);continue}if(!zt&&regExpTest(/\/>/i,Kt)){pn(Ut,it);continue}jt&&arrayForEach([Ye,ht,ee],$n=>{Kt=stringReplace(Kt,$n," ")});const Rn=Wt(it.nodeName);if(!On(Rn,gn,Kt)){pn(Ut,it);continue}if(Ve&&typeof y=="object"&&typeof y.getAttributeType=="function"&&!Jt)switch(y.getAttributeType(Rn,gn)){case"TrustedHTML":{Kt=Ve.createHTML(Kt);break}case"TrustedScriptURL":{Kt=Ve.createScriptURL(Kt);break}}if(Kt!==vn)try{Jt?it.setAttributeNS(Jt,Ut,Kt):it.setAttribute(Ut,Kt),wn(it)?sn(it):arrayPop(e.removed)}catch{pn(Ut,it)}}an(mt.afterSanitizeAttributes,it,null)},Fn=function Dt(it){let Ct=null;const Tt=En(it);for(an(mt.beforeSanitizeShadowDOM,it,null);Ct=Tt.nextNode();)an(mt.uponSanitizeShadowNode,Ct,null),Pn(Ct),Mn(Ct),Ct.content instanceof a&&Dt(Ct.content);an(mt.afterSanitizeShadowDOM,it,null)};return e.sanitize=function(Dt){let it=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Ct=null,Tt=null,Zt=null,qt=null;if(en=!Dt,en&&(Dt="<!-->"),typeof Dt!="string"&&!Tn(Dt))if(typeof Dt.toString=="function"){if(Dt=Dt.toString(),typeof Dt!="string")throw typeErrorCreate("dirty is not a string, aborting")}else throw typeErrorCreate("toString is not a function");if(!e.isSupported)return Dt;if(gt||bn(it),e.removed=[],typeof Dt=="string"&&(Et=!1),Et){if(Dt.nodeName){const ln=Wt(Dt.nodeName);if(!at[ln]||Nt[ln])throw typeErrorCreate("root node is forbidden and cannot be sanitized in-place")}}else if(Dt instanceof c)Ct=An("<!---->"),Tt=Ct.ownerDocument.importNode(Dt,!0),Tt.nodeType===NODE_TYPE.element&&Tt.nodeName==="BODY"||Tt.nodeName==="HTML"?Ct=Tt:Ct.appendChild(Tt);else{if(!tt&&!jt&&!G&&Dt.indexOf("<")===-1)return Ve&&st?Ve.createHTML(Dt):Dt;if(Ct=An(Dt),!Ct)return tt?null:st?me:""}Ct&&dt&&sn(Ct.firstChild);const Ut=En(Et?Dt:Ct);for(;Zt=Ut.nextNode();)Pn(Zt),Mn(Zt),Zt.content instanceof a&&Fn(Zt.content);if(Et)return Dt;if(tt){if(et)for(qt=ct.call(Ct.ownerDocument);Ct.firstChild;)qt.appendChild(Ct.firstChild);else qt=Ct;return(_t.shadowroot||_t.shadowrootmode)&&(qt=ft.call(s,qt,!0)),qt}let Jt=G?Ct.outerHTML:Ct.innerHTML;return G&&at["!doctype"]&&Ct.ownerDocument&&Ct.ownerDocument.doctype&&Ct.ownerDocument.doctype.name&&regExpTest(DOCTYPE_NAME,Ct.ownerDocument.doctype.name)&&(Jt="<!DOCTYPE "+Ct.ownerDocument.doctype.name+`>
`+Jt),jt&&arrayForEach([Ye,ht,ee],ln=>{Jt=stringReplace(Jt,ln," ")}),Ve&&st?Ve.createHTML(Jt):Jt},e.setConfig=function(){let Dt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};bn(Dt),gt=!0},e.clearConfig=function(){dn=null,gt=!1},e.isValidAttribute=function(Dt,it,Ct){dn||bn({});const Tt=Wt(Dt),Zt=Wt(it);return On(Tt,Zt,Ct)},e.addHook=function(Dt,it){typeof it=="function"&&arrayPush(mt[Dt],it)},e.removeHook=function(Dt,it){if(it!==void 0){const Ct=arrayLastIndexOf(mt[Dt],it);return Ct===-1?void 0:arraySplice(mt[Dt],Ct,1)[0]}return arrayPop(mt[Dt])},e.removeHooks=function(Dt){mt[Dt]=[]},e.removeAllHooks=function(){mt=_createHooksMap()},e}var purify=createDOMPurify(),_tmpl$$4=template('<div class="preview-content markdown-preview">'),_tmpl$2$2=template('<div class="preview-content html-preview">'),_tmpl$3$2=template('<div class="preview-content svg-preview">'),_tmpl$4$1=template('<div class="preview-content json-preview"><pre><code>'),_tmpl$5$1=template('<div class="preview-content no-preview"><p>No preview available for this file type.'),_tmpl$6$1=template("<div class=preview-container>");const MarkdownPreview=r=>{const e=createMemo(()=>{try{const n=k(r.code);return purify.sanitize(n)}catch(n){return`<p style="color: red;">Error rendering markdown: ${n}</p>`}});return(()=>{var n=_tmpl$$4();return createRenderEffect(()=>n.innerHTML=e()),n})()},HtmlPreview=r=>{const e=createMemo(()=>purify.sanitize(r.code));return(()=>{var n=_tmpl$2$2();return createRenderEffect(()=>n.innerHTML=e()),n})()},SvgPreview=r=>{const e=createMemo(()=>purify.sanitize(r.code));return(()=>{var n=_tmpl$3$2();return createRenderEffect(()=>n.innerHTML=e()),n})()},JsonPreview=r=>{const e=createMemo(()=>{try{const n=JSON.parse(r.code);return JSON.stringify(n,null,2)}catch(n){return`Error parsing JSON: ${n}`}});return(()=>{var n=_tmpl$4$1(),s=n.firstChild,o=s.firstChild;return insert$1(o,e),n})()},Preview=r=>{const e=createMemo(()=>detectPreviewType(r.filename,r.code));return(()=>{var n=_tmpl$6$1();return insert$1(n,createComponent(Show,{get when(){return e()==="markdown"},get children(){return createComponent(MarkdownPreview,{get code(){return r.code}})}}),null),insert$1(n,createComponent(Show,{get when(){return e()==="html"},get children(){return createComponent(HtmlPreview,{get code(){return r.code}})}}),null),insert$1(n,createComponent(Show,{get when(){return e()==="svg"},get children(){return createComponent(SvgPreview,{get code(){return r.code}})}}),null),insert$1(n,createComponent(Show,{get when(){return e()==="json"},get children(){return createComponent(JsonPreview,{get code(){return r.code}})}}),null),insert$1(n,createComponent(Show,{get when(){return e()==="none"},get children(){return _tmpl$5$1()}}),null),n})()};var _tmpl$$3=template("<div class=ed>");const emptyEditorState=()=>{const[r,e]=createSignal("",{equals:!1}),[n,s]=createSignal(defaultOptions()),[o,a]=createSignal(void 0),[l,c]=createSignal(!1),[u,f]=createSignal("code");return{code:r,setCode:e,opts:n,setOpts:s,outs:o,setOuts:a,loading:l,setLoading:c,viewMode:u,setViewMode:f}},Editor=r=>(()=>{var e=_tmpl$$3();return insert$1(e,createComponent(EditorHeader,{get opts(){return r.state.opts()},onChange:n=>r.state.setOpts(s=>({...s,...n})),get onDelete(){return r.onDelete}}),null),insert$1(e,createComponent(Show,{get when(){return r.state.viewMode()==="code"},get children(){return[createComponent(EditorBody,{get opts(){return r.state.opts},get code(){return r.state.code},get setCode(){return r.state.setCode}}),createComponent(EditorOutputs,{get outputs(){return r.state.outs},get loading(){return r.state.loading}})]}}),null),insert$1(e,createComponent(Show,{get when(){return r.state.viewMode()==="preview"},get children(){return createComponent(Preview,{get filename(){return r.state.opts().filename},get code(){return r.state.code()}})}}),null),insert$1(e,createComponent(EditorFooter,{actionTitle:"Actions",get actions(){return buildFooterActionItems(r.state)},get filename(){return r.state.opts().filename},get code(){return r.state.code()},get viewMode(){return r.state.viewMode()},get onViewModeChange(){return r.state.setViewMode}}),null),e})(),Editor$1=Object.freeze(Object.defineProperty({__proto__:null,default:Editor,emptyEditorState},Symbol.toStringTag,{value:"Module"}));var _tmpl$$2=template('<nav class=navbar><div class=navbar-content><div class=navbar-brand><h1>Pad</h1></div><div class=navbar-actions><button class="navbar-btn btn-success"title="Create new pad">New</button><button class=navbar-btn title="Browse saved pads">Browse');const NavBar=r=>(()=>{var e=_tmpl$$2(),n=e.firstChild,s=n.firstChild,o=s.nextSibling,a=o.firstChild,l=a.firstChild,c=a.nextSibling;return addEventListener(a,"click",r.onNewPad,!0),insert$1(a,createComponent(TbPlus,{}),l),addEventListener(c,"click",r.onBrowseSaved,!0),e})();delegateEvents(["click"]);const DB_NAME="PadStorage",DB_VERSION=1,STORE_NAME="pads";let db=null;const initDB=()=>new Promise((r,e)=>{if(db){r(db);return}const n=indexedDB.open(DB_NAME,DB_VERSION);n.onerror=()=>e(n.error),n.onsuccess=()=>{db=n.result,r(db)},n.onupgradeneeded=s=>{db=s.target.result,db.objectStoreNames.contains(STORE_NAME)||db.createObjectStore(STORE_NAME,{keyPath:"id"}).createIndex("savedAt","savedAt",{unique:!1})}}),generatePadId=()=>`pad_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,savePad=async(r,e)=>{const n=await initDB(),s=new Date().toISOString(),o=e.editors.filter(l=>l.code.trim()!==""||l.opts.filename?.trim()!=="");if(o.length===0&&e.description.trim()===""){await deletePad(r);return}const a={id:r,savedAt:s,description:e.description,editors:o};return new Promise((l,c)=>{const d=n.transaction([STORE_NAME],"readwrite").objectStore(STORE_NAME).put(a);d.onerror=()=>c(d.error),d.onsuccess=()=>l()})},listPads=async()=>{const r=await initDB();return new Promise((e,n)=>{const l=r.transaction([STORE_NAME],"readonly").objectStore(STORE_NAME).index("savedAt").getAll();l.onerror=()=>n(l.error),l.onsuccess=()=>{const c=l.result.sort((u,f)=>new Date(f.savedAt).getTime()-new Date(u.savedAt).getTime());e(c)}})},deletePad=async r=>{const e=await initDB();return new Promise((n,s)=>{const l=e.transaction([STORE_NAME],"readwrite").objectStore(STORE_NAME).delete(r);l.onerror=()=>{l.error?.name==="NotFoundError"?n():s(l.error)},l.onsuccess=()=>n()})};var _tmpl$$1=template('<button class="btn-danger btn-small">Delete (<!>)'),_tmpl$2$1=template("<div class=bulk-actions><label class=checkbox-label><input type=checkbox>Select All"),_tmpl$3$1=template("<div class=loading>Loading..."),_tmpl$4=template("<div class=empty-state>No saved pads found"),_tmpl$5=template("<div class=pads-list>"),_tmpl$6=template("<div class=modal-backdrop><div class=modal-content><div class=modal-header><div class=modal-header-left><h2>Saved Pads</h2></div><button class=modal-close></button></div><div class=modal-body>"),_tmpl$7=template("<div class=pad-item><label class=pad-checkbox><input type=checkbox></label><div class=pad-info><div class=pad-description></div><div class=pad-meta><span class=pad-date></span><span class=pad-editors> file");const SavedPadsModal=r=>{const[e,n]=createSignal([]),[s,o]=createSignal(!1),[a,l]=createSignal(new Set),c=async()=>{o(!0);try{const g=await listPads();n(g)}catch(g){console.error("Failed to load pads:",g)}finally{o(!1)}},u=async g=>{try{const{emptyEditorState:y}=await __vitePreload(async()=>{const{emptyEditorState:E}=await Promise.resolve().then(()=>Editor$1);return{emptyEditorState:E}},void 0,import.meta.url),x=g.editors.map(E=>{const Y=y();return Y.setCode(E.code),Y.setOpts(E.opts),Y});r.onLoadPad(g.id,g.description,x),r.onClose()}catch(y){console.error("Failed to load pad:",y)}},f=g=>{l(y=>{const x=new Set(y);return x.has(g)?x.delete(g):x.add(g),x})},d=()=>{const g=a().size===e().length;l(g?new Set:new Set(e().map(y=>y.id)))},p=async()=>{const g=a().size;if(g!==0&&confirm(`Are you sure you want to delete ${g} pad${g>1?"s":""}? This action cannot be undone.`))try{const y=Array.from(a()).map(x=>deletePad(x));await Promise.all(y),l(new Set),await c()}catch(y){console.error("Failed to delete pads:",y)}};return createEffect(()=>{r.isOpen&&(c(),l(new Set))}),createComponent(Show,{get when(){return r.isOpen},get children(){var g=_tmpl$6(),y=g.firstChild,x=y.firstChild,E=x.firstChild;E.firstChild;var Y=E.nextSibling,Z=x.nextSibling;return addEventListener(g,"click",r.onClose,!0),y.$$click=te=>te.stopPropagation(),insert$1(E,createComponent(Show,{get when(){return memo(()=>!s())()&&e().length>0},get children(){var te=_tmpl$2$1(),ne=te.firstChild,Ve=ne.firstChild;return Ve.addEventListener("change",d),use(me=>{me&&(me.indeterminate=a().size>0&&a().size<e().length)},Ve),insert$1(te,createComponent(Show,{get when(){return a().size>0},get children(){var me=_tmpl$$1(),rt=me.firstChild,nt=rt.nextSibling;return nt.nextSibling,me.$$click=p,insert$1(me,()=>a().size,nt),me}}),null),createRenderEffect(()=>Ve.checked=a().size===e().length),te}}),null),addEventListener(Y,"click",r.onClose,!0),insert$1(Z,createComponent(Show,{get when(){return s()},get children(){return _tmpl$3$1()}}),null),insert$1(Z,createComponent(Show,{get when(){return memo(()=>!s())()&&e().length===0},get children(){return _tmpl$4()}}),null),insert$1(Z,createComponent(Show,{get when(){return memo(()=>!s())()&&e().length>0},get children(){var te=_tmpl$5();return insert$1(te,createComponent(For,{get each(){return e()},children:ne=>(()=>{var Ve=_tmpl$7(),me=Ve.firstChild,rt=me.firstChild,nt=me.nextSibling,ct=nt.firstChild,ot=ct.nextSibling,ft=ot.firstChild,mt=ft.nextSibling,Ye=mt.firstChild;return rt.addEventListener("change",()=>f(ne.id)),nt.$$click=()=>u(ne),insert$1(ct,()=>ne.description||"Untitled Pad"),insert$1(ft,()=>new Date(ne.savedAt).toLocaleString()),insert$1(mt,()=>ne.editors.length,Ye),insert$1(mt,()=>ne.editors.length!==1?"s":"",null),createRenderEffect(()=>rt.checked=a().has(ne.id)),Ve})()})),te}}),null),g}})};delegateEvents(["click"]);var _tmpl$=template('<div class=container><div class=pad-header><input type=text class=description-input placeholder="Description here..."><div class=saved-at></div></div><div class=editors></div><div class=app-actions><div class=app-actions-left><button>Add</button><button>Upload</button></div><div class=app-actions-right><button class=btn-success>Save'),_tmpl$2=template("<div class=drag-overlay><div class=drag-message>Drop files here to upload"),_tmpl$3=template("<div class=ed-container>");const App=()=>{const[r,e]=createSignal([emptyEditorState()]),[n,s]=createSignal(""),[o,a]=createSignal(""),[l,c]=createSignal(!1),[u,f]=createSignal(!1),[d,p]=createSignal(generatePadId()),g=()=>{e([emptyEditorState()]),s(""),a(""),p(generatePadId())},y=()=>{confirm("Are you sure you want to delete the current pad? This action cannot be undone.")&&g()},x=()=>{c(!0)},E=(me,rt,nt)=>{p(me),s(rt),e(nt),a("")},Y=async me=>{const rt=[];for(let nt=0;nt<me.length;nt++){const ct=me[nt],ot=await ct.text(),ft=emptyEditorState();ft.setCode(ot),ft.setOpts(mt=>({...mt,filename:ct.name})),rt.push(ft)}rt.length>0&&e(nt=>[...nt,...rt])},Z=()=>{const me=document.createElement("input");me.type="file",me.multiple=!0,me.webkitdirectory=!1,me.onchange=async rt=>{const nt=rt.target.files;nt&&await Y(nt)},me.click()},te=async()=>{const me=new JSZip,nt=r().filter(ct=>ct.code().trim()!==""||ct.opts().filename?.trim()!=="");if(nt.length===0){alert("No files to save!");return}nt.forEach((ct,ot)=>{let ft=ct.opts().filename||`untitled-${ot+1}`;const mt=ct.code();if(!ft.includes(".")){const Ye=mt.trim().toLowerCase();let ht="txt";Ye.includes("<!doctype")||Ye.includes("<html")?ht="html":Ye.includes("function")||Ye.includes("const ")||Ye.includes("let ")?ht="js":Ye.includes("def ")||Ye.includes("import ")&&!Ye.includes("from ")?ht="py":Ye.includes("{")&&Ye.includes('"')&&(ht="json"),ft+=`.${ht}`}me.file(ft,mt)});try{const ct=await me.generateAsync({type:"blob"}),ot=URL.createObjectURL(ct),ft=document.createElement("a");ft.href=ot,ft.download=n()||"pad-export.zip",ft.download.endsWith(".zip")||(ft.download+=".zip"),ft.click(),URL.revokeObjectURL(ot)}catch(ct){console.error("Failed to create ZIP file:",ct),alert("Failed to create ZIP file")}},ne=me=>{e(rt=>rt.filter((nt,ct)=>ct!==me))},Ve=async()=>{try{const me=r().map(rt=>({code:rt.code(),opts:rt.opts()}));await savePad(d(),{description:n(),editors:me}),a(new Date().toLocaleString())}catch(me){console.error("Failed to save pad:",me)}};return createEffect(()=>{n(),r().forEach(rt=>{rt.code(),rt.opts()});const me=setTimeout(Ve,2e3);return()=>clearTimeout(me)}),createEffect(()=>{let me=0;const rt=ft=>{ft.preventDefault(),me++,me===1&&f(!0)},nt=ft=>{ft.preventDefault()},ct=ft=>{ft.preventDefault(),me--,me===0&&f(!1)},ot=async ft=>{ft.preventDefault(),me=0,f(!1);const mt=ft.dataTransfer?.files;!mt||mt.length===0||await Y(mt)};return document.addEventListener("dragenter",rt),document.addEventListener("dragover",nt),document.addEventListener("dragleave",ct),document.addEventListener("drop",ot),()=>{document.removeEventListener("dragenter",rt),document.removeEventListener("dragover",nt),document.removeEventListener("dragleave",ct),document.removeEventListener("drop",ot)}}),[createComponent(Toaster,{}),memo(()=>memo(()=>!!u())()&&_tmpl$2()),createComponent(NavBar,{onNewPad:g,onDeleteCurrent:y,onBrowseSaved:x}),createComponent(SavedPadsModal,{get isOpen(){return l()},onClose:()=>c(!1),onLoadPad:E}),(()=>{var me=_tmpl$(),rt=me.firstChild,nt=rt.firstChild,ct=nt.nextSibling,ot=rt.nextSibling,ft=ot.nextSibling,mt=ft.firstChild,Ye=mt.firstChild,ht=Ye.firstChild,ee=Ye.nextSibling,pt=ee.firstChild,Ot=mt.nextSibling,vt=Ot.firstChild,Rt=vt.firstChild;return nt.$$input=bt=>s(bt.currentTarget.value),insert$1(ct,(()=>{var bt=memo(()=>!!o());return()=>bt()&&`Saved at: ${o()}`})()),insert$1(ot,createComponent(For,{get each(){return r()},children:(bt,Mt)=>(()=>{var at=_tmpl$3();return insert$1(at,createComponent(Editor,{state:bt,get onDelete(){return r().length>1?()=>ne(Mt()):void 0}})),at})()})),Ye.$$click=()=>{e(bt=>[...bt,emptyEditorState()])},insert$1(Ye,createComponent(TbPlus,{}),ht),ee.$$click=Z,insert$1(ee,createComponent(TbUpload,{}),pt),vt.$$click=te,insert$1(vt,createComponent(TbFileZip,{}),Rt),createRenderEffect(()=>nt.value=n()),me})()]};delegateEvents(["input","click"]);const root=document.getElementById("root");render(()=>createComponent(App,{}),root);export{EditorState as A,LanguageDescription as B,CompletionContext as C,ParseContext as D,EditorView as E,continuedIndent as F,flatIndent as G,sublanguageProp as H,IterMode as I,DefaultBufferLength as J,getDefaultExportFromCjs as K,LRLanguage as L,NodeWeakMap as N,Parser as P,Tag as T,syntaxTree as a,LanguageSupport as b,indentNodeProp as c,delimitedIndent as d,foldInside as e,foldNodeProp as f,completeFromList as g,snippetCompletion as h,ifNotIn as i,NodeType as j,NodeProp as k,NodeSet as l,Tree as m,bracketMatchingHandle as n,EditorSelection as o,parseMixed as p,Language as q,defineLanguageFacet as r,styleTags as s,tags as t,foldService as u,countColumn as v,Prec as w,keymap as x,indentUnit as y,languageDataProp as z};
